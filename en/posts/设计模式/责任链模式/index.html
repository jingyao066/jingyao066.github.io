<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>è´£ä»»é“¾æ¨¡å¼ | Wjy&#39;s Blog</title>
<meta name="keywords" content="è®¾è®¡æ¨¡å¼">
<meta name="description" content="å¿«é€Ÿå­¦ä¹ 

ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚
">
<meta name="author" content="">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="è´£ä»»é“¾æ¨¡å¼" />
<meta property="og:description" content="å¿«é€Ÿå­¦ä¹ 

ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-10T17:41:36+00:00" />
<meta property="article:modified_time" content="2018-12-10T17:41:36+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="è´£ä»»é“¾æ¨¡å¼"/>
<meta name="twitter:description" content="å¿«é€Ÿå­¦ä¹ 

ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚
"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "è´£ä»»é“¾æ¨¡å¼",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "è´£ä»»é“¾æ¨¡å¼",
  "name": "è´£ä»»é“¾æ¨¡å¼",
  "description": "å¿«é€Ÿå­¦ä¹  ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚\n",
  "keywords": [
    "è®¾è®¡æ¨¡å¼"
  ],
  "articleBody": "å¿«é€Ÿå­¦ä¹  ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚\nè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰æ˜¯ä¸€ç§å¤„ç†è¯·æ±‚çš„æ¨¡å¼ï¼Œå®ƒè®©å¤šä¸ªå¤„ç†å™¨éƒ½æœ‰æœºä¼šå¤„ç†è¯¥è¯·æ±‚ï¼Œç›´åˆ°å…¶ä¸­æŸä¸ªå¤„ç†æˆåŠŸä¸ºæ­¢ã€‚è´£ä»»é“¾æ¨¡å¼æŠŠå¤šä¸ªå¤„ç†å™¨ä¸²æˆé“¾ï¼Œç„¶åè®©è¯·æ±‚åœ¨é“¾ä¸Šä¼ é€’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Request â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œ â”€ â”€ â”€ â”€ â”¼ â”€ â”€ â”€ â”€ â” â–¼ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ ProcessorA â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â–¼ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ ProcessorB â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â–¼ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ ProcessorC â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”” â”€ â”€ â”€ â”€ â”¼ â”€ â”€ â”€ â”€ â”˜ â”‚ â–¼ åœ¨å®é™…åœºæ™¯ä¸­ï¼Œè´¢åŠ¡å®¡æ‰¹å°±æ˜¯ä¸€ä¸ªè´£ä»»é“¾æ¨¡å¼ã€‚å‡è®¾æŸä¸ªå‘˜å·¥éœ€è¦æŠ¥é”€ä¸€ç¬”è´¹ç”¨ï¼Œå®¡æ ¸è€…å¯ä»¥åˆ†ä¸ºï¼š\nManagerï¼šåªèƒ½å®¡æ ¸1000å…ƒä»¥ä¸‹çš„æŠ¥é”€ï¼› Directorï¼šåªèƒ½å®¡æ ¸10000å…ƒä»¥ä¸‹çš„æŠ¥é”€ï¼› CEOï¼šå¯ä»¥å®¡æ ¸ä»»æ„é¢åº¦ã€‚ ç”¨è´£ä»»é“¾æ¨¡å¼è®¾è®¡æ­¤æŠ¥é”€æµç¨‹æ—¶ï¼Œæ¯ä¸ªå®¡æ ¸è€…åªå…³å¿ƒè‡ªå·±è´£ä»»èŒƒå›´å†…çš„è¯·æ±‚ï¼Œå¹¶ä¸”å¤„ç†å®ƒã€‚å¯¹äºè¶…å‡ºè‡ªå·±è´£ä»»èŒƒå›´çš„ï¼Œæ‰”ç»™ä¸‹ä¸€ä¸ªå®¡æ ¸è€…å¤„ç†ï¼Œè¿™æ ·ï¼Œå°†æ¥ç»§ç»­æ·»åŠ å®¡æ ¸è€…çš„æ—¶å€™ï¼Œä¸ç”¨æ”¹åŠ¨ç°æœ‰é€»è¾‘ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°è´£ä»»é“¾æ¨¡å¼ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬è¦æŠ½è±¡å‡ºè¯·æ±‚å¯¹è±¡ï¼Œå®ƒå°†åœ¨è´£ä»»é“¾ä¸Šä¼ é€’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public class Request { private String name; private BigDecimal amount; public Request(String name, BigDecimal amount) { this.name = name; this.amount = amount; } public String getName() { return name; } public BigDecimal getAmount() { return amount; } } å…¶æ¬¡ï¼Œæˆ‘ä»¬è¦æŠ½è±¡å‡ºå¤„ç†å™¨ï¼š\n1 2 3 4 5 6 public interface Handler { // è¿”å›Boolean.TRUE = æˆåŠŸ // è¿”å›Boolean.FALSE = æ‹’ç» // è¿”å›null = äº¤ä¸‹ä¸€ä¸ªå¤„ç† Boolean process(Request request); } å¹¶ä¸”åšå¥½çº¦å®šï¼šå¦‚æœè¿”å›Boolean.TRUEï¼Œè¡¨ç¤ºå¤„ç†æˆåŠŸï¼Œå¦‚æœè¿”å›Boolean.FALSEï¼Œè¡¨ç¤ºå¤„ç†å¤±è´¥ï¼ˆè¯·æ±‚è¢«æ‹’ç»ï¼‰ï¼Œå¦‚æœè¿”å›nullï¼Œåˆ™äº¤ç”±ä¸‹ä¸€ä¸ªHandlerå¤„ç†ã€‚\nç„¶åï¼Œä¾æ¬¡ç¼–å†™ManagerHandlerã€DirectorHandlerå’ŒCEOHandlerã€‚ä»¥ManagerHandlerä¸ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 public class ManagerHandler implements Handler { public Boolean process(Request request) { // å¦‚æœè¶…è¿‡1000å…ƒï¼Œå¤„ç†ä¸äº†ï¼Œäº¤ä¸‹ä¸€ä¸ªå¤„ç†: if (request.getAmount().compareTo(BigDecimal.valueOf(1000)) \u003e 0) { return null; } // å¯¹Bobæœ‰åè§: return !request.getName().equalsIgnoreCase(\"bob\"); } } æœ‰äº†ä¸åŒçš„Handleråï¼Œæˆ‘ä»¬è¿˜è¦æŠŠè¿™äº›Handlerç»„åˆèµ·æ¥ï¼Œå˜æˆä¸€ä¸ªé“¾ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç»Ÿä¸€å…¥å£å¤„ç†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public class HandlerChain { // æŒæœ‰æ‰€æœ‰Handler: private List handlers = new ArrayList\u003c\u003e(); public void addHandler(Handler handler) { this.handlers.add(handler); } public boolean process(Request request) { // ä¾æ¬¡è°ƒç”¨æ¯ä¸ªHandler: for (Handler handler : handlers) { Boolean r = handler.process(request); if (r != null) { // å¦‚æœè¿”å›TRUEæˆ–FALSEï¼Œå¤„ç†ç»“æŸ: System.out.println(request + \" \" + (r ? \"Approved by \" : \"Denied by \") + handler.getClass().getSimpleName()); return r; } } throw new RuntimeException(\"Could not handle request: \" + request); } } ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ç»„è£…å‡ºè´£ä»»é“¾ï¼Œç„¶åç”¨è´£ä»»é“¾æ¥å¤„ç†è¯·æ±‚ï¼š\n1 2 3 4 5 6 7 8 9 10 // æ„é€ è´£ä»»é“¾: HandlerChain chain = new HandlerChain(); chain.addHandler(new ManagerHandler()); chain.addHandler(new DirectorHandler()); chain.addHandler(new CEOHandler()); // å¤„ç†è¯·æ±‚: chain.process(new Request(\"Bob\", new BigDecimal(\"123.45\"))); chain.process(new Request(\"Alice\", new BigDecimal(\"1234.56\"))); chain.process(new Request(\"Bill\", new BigDecimal(\"12345.67\"))); chain.process(new Request(\"John\", new BigDecimal(\"123456.78\"))); è´£ä»»é“¾æ¨¡å¼æœ¬èº«å¾ˆå®¹æ˜“ç†è§£ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHandleræ·»åŠ çš„é¡ºåºå¾ˆé‡è¦ï¼Œå¦‚æœé¡ºåºä¸å¯¹ï¼Œå¤„ç†çš„ç»“æœå¯èƒ½å°±ä¸æ˜¯ç¬¦åˆè¦æ±‚çš„ã€‚\næ­¤å¤–ï¼Œè´£ä»»é“¾æ¨¡å¼æœ‰å¾ˆå¤šå˜ç§ã€‚æœ‰äº›è´£ä»»é“¾çš„å®ç°æ–¹å¼æ˜¯é€šè¿‡æŸä¸ªHandleræ‰‹åŠ¨è°ƒç”¨ä¸‹ä¸€ä¸ªHandleræ¥ä¼ é€’Requestï¼Œä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 public class AHandler implements Handler { private Handler next; public void process(Request request) { if (!canProcess(request)) { // æ‰‹åŠ¨äº¤ç»™ä¸‹ä¸€ä¸ªHandlerå¤„ç†: next.process(request); } else { ... } } } è¿˜æœ‰ä¸€äº›è´£ä»»é“¾æ¨¡å¼ï¼Œæ¯ä¸ªHandleréƒ½æœ‰æœºä¼šå¤„ç†Requestï¼Œé€šå¸¸è¿™ç§è´£ä»»é“¾è¢«ç§°ä¸ºæ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–è€…è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œå®ƒçš„ç›®çš„ä¸æ˜¯æ‰¾åˆ°æŸä¸ªHandlerå¤„ç†æ‰Requestï¼Œè€Œæ˜¯æ¯ä¸ªHandleréƒ½åšä¸€äº›å·¥ä½œï¼Œæ¯”å¦‚ï¼š\nè®°å½•æ—¥å¿—ï¼› æ£€æŸ¥æƒé™ï¼› å‡†å¤‡ç›¸å…³èµ„æºï¼› â€¦ ä¾‹å¦‚ï¼ŒJavaEEçš„Servletè§„èŒƒå®šä¹‰çš„Filterå°±æ˜¯ä¸€ç§è´£ä»»é“¾æ¨¡å¼ï¼Œå®ƒä¸ä½†å…è®¸æ¯ä¸ªFilteréƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œè¿˜å…è®¸æ¯ä¸ªFilterå†³å®šæ˜¯å¦å°†è¯·æ±‚â€œæ”¾è¡Œâ€ç»™ä¸‹ä¸€ä¸ªFilterï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 public class AuditFilter implements Filter { public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) throws IOException, ServletException { log(req); if (check(req)) { // æ”¾è¡Œ: chain.doFilter(req, resp); } else { // æ‹’ç»: sendError(resp); } } } è¿™ç§æ¨¡å¼ä¸ä½†å…è®¸ä¸€ä¸ªFilterè‡ªè¡Œå†³å®šå¤„ç†ServletRequestå’ŒServletResponseï¼Œè¿˜å¯ä»¥â€œä¼ªé€ â€ServletRequestå’ŒServletResponseä»¥ä¾¿è®©ä¸‹ä¸€ä¸ªFilterå¤„ç†ï¼Œèƒ½å®ç°éå¸¸å¤æ‚çš„åŠŸèƒ½ã€‚\næ¦‚è¿° ç±»å‹ï¼šè¡Œä¸ºå‹ è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ã€‚ åœ¨è´£ä»»é“¾æ¨¡å¼é‡Œï¼Œå¾ˆå¤šå¯¹è±¡ç”±æ¯ä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä¸‹å®¶çš„çš„å¼•ç”¨è€Œè¿èµ·æ¥å½¢æˆä¸€æ¡é“¾ã€‚ è¯·æ±‚åœ¨è¿™æ¡é“¾ä¸Šä¼ é€’ï¼Œç›´åˆ°é“¾ä¸Šçš„æŸä¸€ä¸ªå¯¹è±¡å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚ å‘å‡ºè¿™ä¸ªè¯·æ±‚çš„å®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“é“¾ä¸Šçš„å“ªä¸€ä¸ªå¯¹è±¡æœ€ç»ˆå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œ è¿™ä½¿å¾—ç³»ç»Ÿå¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€çš„é‡æ–°ç»„ç»‡å’Œåˆ†é…è´£ä»»ã€‚\næ„å›¾ï¼šé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚\nä¸»è¦è§£å†³ï¼šèŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚\nä½•æ—¶ä½¿ç”¨ï¼šåœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶ï¼Œéœ€è¦è¿‡æ»¤å¾ˆå¤šé“ç¨‹åºã€‚ å¦‚ä½•è§£å†³ï¼šæ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚ å…³é”®ä»£ç ï¼šHandler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ HandlerRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ï¼Œå‘è°ä¼ é€’ä¹‹å‰ set è¿›å»ã€‚\nåº”ç”¨å®ä¾‹ï¼š\nçº¢æ¥¼æ¢¦ä¸­çš„\"å‡»é¼“ä¼ èŠ±\"ã€‚ JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚ JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ã€‚ jsp servlet çš„ Filterã€‚ ä¼˜ç‚¹ï¼š\né™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚ ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚ å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚ å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚ ç¼ºç‚¹ï¼š\nä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚ ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚ å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚ ä½¿ç”¨åœºæ™¯ï¼š\næœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚ åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ã€‚ å‡»é¼“ä¼ èŠ± å‡»é¼“ä¼ èŠ±æ˜¯ä¸€ç§çƒ­é—¹è€Œåˆç´§å¼ çš„é¥®é…’æ¸¸æˆã€‚åœ¨é…’å®´ä¸Šå®¾å®¢ä¾æ¬¡åå®šä½ç½®ï¼Œç”±ä¸€äººå‡»é¼“ï¼Œå‡»é¼“çš„åœ°æ–¹ä¸ä¼ èŠ±çš„åœ°æ–¹æ˜¯åˆ†å¼€çš„ï¼Œä»¥ç¤ºå…¬æ­£ã€‚å¼€å§‹å‡»é¼“æ—¶ï¼ŒèŠ±æŸå°±å¼€å§‹ä¾æ¬¡ä¼ é€’ï¼Œé¼“å£°ä¸€è½ï¼Œå¦‚æœèŠ±æŸåœ¨æŸäººæ‰‹ä¸­ï¼Œåˆ™è¯¥äººå°±å¾—é¥®é…’ã€‚æ¯”å¦‚è¯´ï¼Œè´¾æ¯ã€è´¾èµ¦ã€è´¾æ”¿ã€è´¾å®ç‰å’Œè´¾ç¯æ˜¯äº”ä¸ªå‚åŠ å‡»é¼“ä¼ èŠ±æ¸¸æˆçš„ä¼ èŠ±è€…ï¼Œä»–ä»¬ç»„æˆä¸€ä¸ªç¯é“¾ã€‚å‡»é¼“è€…å°†èŠ±ä¼ ç»™è´¾æ¯ï¼Œå¼€å§‹ä¼ èŠ±æ¸¸æˆã€‚èŠ±ç”±è´¾æ¯ä¼ ç»™è´¾èµ¦ï¼Œç”±è´¾èµ¦ä¼ ç»™è´¾æ”¿ï¼Œç”±è´¾æ”¿ä¼ ç»™è´¾å®ç‰ï¼Œåˆè´¾å®ç‰ä¼ ç»™è´¾ç¯ï¼Œç”±è´¾ç¯ä¼ å›ç»™è´¾æ¯ï¼Œå¦‚æ­¤å¾€å¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å½“é¼“å£°åœæ­¢æ—¶ï¼Œæ‰‹ä¸­æœ‰èŠ±çš„äººå°±å¾—æ‰§è¡Œé…’ä»¤ã€‚ å‡»é¼“ä¼ èŠ±ä¾¿æ˜¯è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨ã€‚ è´£ä»»é“¾å¯ä»¥æ˜¯ä¸€æ¡ç›´çº¿ï¼Œä¸€ä¸ªç¯é“¾æˆ–è€…ä¸€ä¸ªæ ‘çŠ¶ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚\nè´£ä»»é“¾æ¨¡å¼çš„ç»“æ„ ä¸‹é¢ä½¿ç”¨äº†ä¸€ä¸ªè´£ä»»é“¾æ¨¡å¼çš„æœ€ç®€å•çš„å®ç°ã€‚ è´£ä»»é“¾æ¨¡å¼æ¶‰åŠåˆ°çš„è§’è‰²å¦‚ä¸‹æ‰€ç¤ºï¼š æŠ½è±¡å¤„ç†è€…(Handler)ï¼šä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ã€‚\nå¦‚æœéœ€è¦ï¼Œæ¥å£å¯ä»¥å®šä¹‰å‡ºä¸€ä¸ªæ–¹æ³•ä»¥è®¾å®šå’Œè¿”å›å¯¹ä¸‹å®¶çš„å¼•ç”¨ã€‚ è¿™ä¸ªè§’è‰²é€šå¸¸ç”±ä¸€ä¸ªJAVAæŠ½è±¡ç±»æˆ–è€…JAVAæ¥å£å®ç°ã€‚ ä¸Šå›¾ä¸­çš„Handlerç±»çš„èšåˆå…³ç³»ç»™å‡ºäº†å…·ä½“å­ç±»å¯¹ä¸‹å®¶çš„å¼•ç”¨ã€‚ æŠ½è±¡æ–¹æ³•handlerReuqest()è§„èŒƒäº†ç±»å¤„ç†è¯·æ±‚çš„æ“ä½œã€‚ å…·ä½“å¤„ç†è€…(ConcreteHandler)ï¼š\nå…·ä½“å¤„ç†è€…æ¥åˆ°è¯·æ±‚åï¼Œå¯ä»¥é€‰æ‹©å°†è¯·æ±‚å¤„ç†æ‰ï¼Œæˆ–è€…å°†è¯·æ±‚ä¼ ç»™ä¸‹å®¶ã€‚ ä»£ç  æŠ½è±¡å¤„ç†è€…ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public abstract class Handler { //æŒæœ‰åç»§çš„è´£ä»»å¯¹è±¡ protected Handler successor; /** * ç¤ºæ„å¤„ç†è¯·æ±‚çš„æ–¹æ³•ï¼Œè™½ç„¶è¿™ä¸ªç¤ºæ„æ–¹æ³•æ˜¯æ²¡æœ‰ä¼ å…¥å‚æ•°çš„ï¼Œ * ä½†å®é™…æ˜¯å¯ä»¥ä¼ å…¥å‚æ•°çš„ï¼Œæ ¹æ®å…·ä½“éœ€æ±‚æ¥é€‰æ‹©æ˜¯å¦ä¼ é€’å‚æ•° */ public abstract void handlerRequest(); public Handler getSuccessor() { return successor; } public void setSuccessor(Handler successor) { this.successor = successor; } } å…·ä½“å¤„ç†è€…ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 public class ConcreteHandler extends Handler{ /** * å¤„ç†æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å¤„ç†è¯·æ±‚ */ @Override public void handlerRequest() { /** * åˆ¤æ–­æ˜¯å¦æœ‰åç»§çš„è´£ä»»å¯¹è±¡ * å¦‚æœæœ‰ï¼Œå°±è½¬å‘è¯·æ±‚æœ‰ç»™åç»§çš„è´£ä»»å¯¹è±¡ * å¦‚æœæ²¡æœ‰ï¼Œåˆ™å¤„ç†è¯·æ±‚ * */ if (getSuccessor() != null) { System.out.println(\"æ”¾è¿‡è¯·æ±‚\"); getSuccessor().handlerRequest(); } else { System.out.println(\"å¤„ç†è¯·æ±‚\"); } } } å®¢æˆ·ç«¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 public class Client { public static void main(String[] args) { //ç»„è£…è´£ä»»é“¾ Handler h1 = new ConcreteHandler(); Handler h2 = new ConcreteHandler(); h1.setSuccessor(h2); //æäº¤è¯·æ±‚ h1.handlerRequest(); } } å¯ä»¥çœ‹å‡ºï¼Œå®¢æˆ·ç«¯åˆ›å»ºäº†ä¸¤ä¸ªå¤„ç†è€…å¯¹è±¡ï¼Œå¹¶æŒ‡å®šç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡çš„ä¸‹å®¶æ˜¯ç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡ï¼Œè€Œç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡æ²¡æœ‰ä¸‹å®¶ã€‚ç„¶åå®¢æˆ·ç«¯å°†è¯·æ±‚ä¼ é€’ç»™ç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡ã€‚\nç”±äºæœ¬å®ä¾‹çš„ä¼ é€’é€»è¾‘éå¸¸ç®€å•ï¼š\nåªè¦æœ‰ä¸‹å®¶ï¼Œå°±ä¼ é€’ç»™ä¸‹å®¶å¤„ç†ï¼› å¦‚æœæ²¡æœ‰ä¸‹å®¶ï¼Œå°±è‡ªè¡Œå¤„ç†ã€‚ å› æ­¤ï¼Œç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ¥åˆ°è¯·æ±‚åï¼Œä¼šå°†è¯·æ±‚ä¼ é€’ç»™ç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡ã€‚ç”±äºç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡æ²¡æœ‰ä¸‹å®¶ï¼Œäºæ˜¯è‡ªè¡Œå¤„ç†è¯·æ±‚ã€‚ æ´»åŠ¨æ—¶åºå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä½¿ç”¨åœºæ™¯1ï¼ˆç”³è¯·æµç¨‹ï¼‰ åœºæ™¯ï¼šç”³è¯·èšé¤è´¹ç”¨çš„ç®¡ç†ã€‚ ç”³è¯·èšé¤è´¹ç”¨çš„æµç¨‹ä¸€èˆ¬æ˜¯ï¼š\nç”±ç”³è¯·äººå…ˆå¡«å†™ç”³è¯·å•ï¼Œç„¶åäº¤ç»™é¢†å¯¼å®¡æ‰¹ã€‚ è‹¥æ‰¹å‡†é€šè¿‡ï¼Œé¢†å¯¼ä¼šé€šçŸ¥ç”³è¯·äººå®¡æ‰¹é€šè¿‡ï¼Œç„¶åç”³è¯·äººå»è´¢åŠ¡é¢†å–è´¹ç”¨ã€‚ è‹¥å®¡æ‰¹æœªé€šè¿‡ï¼Œé¢†å¯¼ä¼šé€šçŸ¥ç”³è¯·äººå®¡æ‰¹æœªé€šè¿‡ï¼Œæ­¤äº‹ä¹Ÿå°±æ­¤ä½œç½¢ã€‚ ä¸åŒçº§åˆ«çš„é¢†å¯¼ï¼Œå¯¹äºå®¡æ‰¹çš„é¢åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚ï¼Œ é¡¹ç›®ç»ç†åªèƒ½å®¡æ‰¹500å…ƒä»¥å†…çš„ç”³è¯·ï¼› éƒ¨é—¨ç»ç†èƒ½å®¡æ‰¹1000å…ƒä»¥å†…çš„ç”³è¯·ï¼› è€Œæ€»ç»ç†å¯ä»¥å®¡æ ¸ä»»æ„é¢åº¦çš„ç”³è¯·ã€‚\næŸäººæå‡ºç”³è¯·åï¼Œè¯¥è¯·æ±‚ä¼šç”±é¡¹ç›®ç»ç†ã€éƒ¨é—¨ç»ç†ã€æ€»ç»ç†ä¹‹ä¸­çš„æŸä¸€ä½é¢†å¯¼æ¥è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä½†æ˜¯æå‡ºç”³è¯·çš„äººå¹¶ä¸çŸ¥é“æœ€ç»ˆä¼šç”±è°æ¥å¤„ç†ä»–çš„è¯·æ±‚ã€‚\nä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š\næŸäººæå‡ºç”³è¯· è¯¥è¯·æ±‚ä¼šåœ¨ é¡¹ç›®ç»ç†-\u003eéƒ¨é—¨ç»ç†-\u003eæ€»ç»ç† è¿™æ ·ä¸€æ¡é¢†å¯¼å¤„ç†é“¾ä¸Šè¿›è¡Œä¼ é€’ æ¯ä¸ªé¢†å¯¼ä¼šæ ¹æ®è‡ªå·±çš„èŒè´£èŒƒå›´ï¼Œæ¥åˆ¤æ–­æ˜¯å¤„ç†è¯·æ±‚è¿˜æ˜¯æŠŠè¯·æ±‚äº¤ç»™æ›´é«˜çº§åˆ«çš„é¢†å¯¼ï¼Œåªè¦æœ‰é¢†å¯¼å¤„ç†äº†ï¼Œä¼ é€’å°±ç»“æŸäº†ã€‚ éœ€è¦æŠŠæ¯ä½é¢†å¯¼çš„å¤„ç†ç‹¬ç«‹å‡ºæ¥ï¼Œå®ç°æˆå•ç‹¬çš„èŒè´£å¤„ç†å¯¹è±¡ï¼Œç„¶åä¸ºå®ƒä»¬æä¾›ä¸€ä¸ªå…¬å…±çš„ã€æŠ½è±¡çš„çˆ¶èŒè´£å¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯æ¥åŠ¨æ€åœ°ç»„åˆèŒè´£é“¾ï¼Œå®ç°ä¸åŒçš„åŠŸèƒ½è¦æ±‚äº†ã€‚\nä»£ç  æŠ½è±¡å¤„ç†è€…è§’è‰²ç±»ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public abstract class Handler { //æŒæœ‰ä¸‹ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å¯¹è±¡ protected Handler successor = null; //å–å€¼æ–¹æ³• public Handler getSuccessor() { return successor; } //è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å¯¹è±¡ public void setSuccessor(Handler successor) { this.successor = successor; } /** * å¤„ç†èšé¤è´¹ç”¨çš„ç”³è¯· * @param user ç”³è¯·äºº * @param fee ç”³è¯·çš„é’±æ•° * @return æˆåŠŸæˆ–å¤±è´¥çš„å…·ä½“é€šçŸ¥ */ public abstract String handleFeeRequest(String user , double fee); } å…·ä½“å¤„ç†è€…è§’è‰²ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public class ProjectManager extends Handler { @Override public String handleFeeRequest(String user, double fee) { String str = \"\"; //é¡¹ç›®ç»ç†æƒé™æ¯”è¾ƒå°ï¼Œåªèƒ½åœ¨500ä»¥å†… if (fee \u003c 500) { //ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚ if (\"å¼ ä¸‰\".equals(user)) { str = \"æˆåŠŸï¼šé¡¹ç›®ç»ç†åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } else { //å…¶ä»–äººä¸€å¾‹ä¸åŒæ„ str = \"å¤±è´¥ï¼šé¡¹ç›®ç»ç†ä¸åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } } else { //è¶…è¿‡500ï¼Œç»§ç»­ä¼ é€’ç»™çº§åˆ«æ›´é«˜çš„äººå¤„ç† if (getSuccessor() != null) { return getSuccessor().handleFeeRequest(user, fee); } } return str; } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public class DeptManager extends Handler { @Override public String handleFeeRequest(String user, double fee) { String str = \"\"; //éƒ¨é—¨ç»ç†çš„æƒé™åªèƒ½åœ¨1000ä»¥å†… if (fee \u003c 1000) { //ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚ if (\"å¼ ä¸‰\".equals(user)) { str = \"æˆåŠŸï¼šéƒ¨é—¨ç»ç†åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } else { //å…¶ä»–äººä¸€å¾‹ä¸åŒæ„ str = \"å¤±è´¥ï¼šéƒ¨é—¨ç»ç†ä¸åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } } else { //è¶…è¿‡1000ï¼Œç»§ç»­ä¼ é€’ç»™çº§åˆ«æ›´é«˜çš„äººå¤„ç† if (getSuccessor() != null) { return getSuccessor().handleFeeRequest(user, fee); } } return str; } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public class GeneralManager extends Handler { @Override public String handleFeeRequest(String user, double fee) { String str = \"\"; //æ€»ç»ç†çš„æƒé™å¾ˆå¤§ï¼Œåªè¦è¯·æ±‚åˆ°äº†è¿™é‡Œï¼Œä»–éƒ½å¯ä»¥å¤„ç† if (fee \u003e= 1000) { //ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚ if (\"å¼ ä¸‰\".equals(user)) { str = \"æˆåŠŸï¼šæ€»ç»ç†åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } else { //å…¶ä»–äººä¸€å¾‹ä¸åŒæ„ str = \"å¤±è´¥ï¼šæ€»ç»ç†ä¸åŒæ„ã€\" + user + \"ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º\" + fee + \"å…ƒ\"; } } else { //å¦‚æœè¿˜æœ‰åç»§çš„å¤„ç†å¯¹è±¡ï¼Œç»§ç»­ä¼ é€’ if (getSuccessor() != null) { return getSuccessor().handleFeeRequest(user, fee); } } return str; } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 public class Client { public static void main(String[] args) { //å…ˆè¦ç»„è£…è´£ä»»é“¾ Handler h1 = new GeneralManager(); Handler h2 = new DeptManager(); Handler h3 = new ProjectManager(); h3.setSuccessor(h2); h2.setSuccessor(h1); //å¼€å§‹æµ‹è¯• String test1 = h3.handleFeeRequest(\"å¼ ä¸‰\", 300); System.out.println(\"test1 = \" + test1); String test2 = h3.handleFeeRequest(\"æå››\", 300); System.out.println(\"test2 = \" + test2); System.out.println(\"---------------------------------------\"); String test3 = h3.handleFeeRequest(\"å¼ ä¸‰\", 700); System.out.println(\"test3 = \" + test3); String test4 = h3.handleFeeRequest(\"æå››\", 700); System.out.println(\"test4 = \" + test4); System.out.println(\"---------------------------------------\"); String test5 = h3.handleFeeRequest(\"å¼ ä¸‰\", 1500); System.out.println(\"test5 = \" + test5); String test6 = h3.handleFeeRequest(\"æå››\", 1500); System.out.println(\"test6 = \" + test6); } } ä½¿ç”¨åœºæ™¯2ï¼ˆæ—¥å¿—æ‰“å°ï¼‰ åˆ›å»ºæŠ½è±¡çš„è®°å½•å™¨ç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 public abstract class AbstractLogger { public static int INFO = 1; public static int DEBUG = 2; public static int ERROR = 3; protected int level; //è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´  protected AbstractLogger nextLogger; public void setNextLogger(AbstractLogger nextLogger){ this.nextLogger = nextLogger; } public void logMessage(int level, String message){ if(this.level \u003c= level){ write(message); } if(nextLogger !=null){ nextLogger.logMessage(level, message); } } abstract protected void write(String message); } ä¸‰ä¸ªæ‰©å±•ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 public class ConsoleLogger extends AbstractLogger { public ConsoleLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(\"Standard Console::Logger: \" + message); } } public class ErrorLogger extends AbstractLogger { public ErrorLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(\"Error Console::Logger: \" + message); } } public class FileLogger extends AbstractLogger { public FileLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(\"File::Logger: \" + message); } } åˆ›å»ºä¸åŒç±»å‹çš„è®°å½•å™¨ã€‚èµ‹äºˆå®ƒä»¬ä¸åŒçš„é”™è¯¯çº§åˆ«ï¼Œå¹¶åœ¨æ¯ä¸ªè®°å½•å™¨ä¸­è®¾ç½®ä¸‹ä¸€ä¸ªè®°å½•å™¨ã€‚æ¯ä¸ªè®°å½•å™¨ä¸­çš„ä¸‹ä¸€ä¸ªè®°å½•å™¨ä»£è¡¨çš„æ˜¯é“¾çš„ä¸€éƒ¨åˆ†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 public class ChainPatternDemo { private static AbstractLogger getChainOfLoggers(){ AbstractLogger errorLogger = new ErrorLogger(AbstractLogger.ERROR); AbstractLogger fileLogger = new FileLogger(AbstractLogger.DEBUG); AbstractLogger consoleLogger = new ConsoleLogger(AbstractLogger.INFO); errorLogger.setNextLogger(fileLogger); fileLogger.setNextLogger(consoleLogger); return errorLogger; } public static void main(String[] args) { AbstractLogger loggerChain = getChainOfLoggers(); loggerChain.logMessage(AbstractLogger.INFO, \"This is an information.\"); loggerChain.logMessage(AbstractLogger.DEBUG, \"This is a debug level information.\"); loggerChain.logMessage(AbstractLogger.ERROR, \"This is an error information.\"); } } çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼ ä¸€ä¸ªçº¯çš„è´£ä»»é“¾æ¨¡å¼è¦æ±‚ä¸€ä¸ªå…·ä½“çš„å¤„ç†è€…å¯¹è±¡åªèƒ½åœ¨ä¸¤ä¸ªè¡Œä¸ºä¸­é€‰æ‹©ä¸€ä¸ªï¼šè¦ä¹ˆæ‰¿æ‹…è´£ä»»ï¼Œè¦ä¹ˆæŠŠè´£ä»»æ¨ç»™ä¸‹å®¶ã€‚ä¸å…è®¸å‡ºç°æŸä¸€ä¸ªå…·ä½“çš„å¤„ç†è€…å¯¹è±¡åœ¨æ‰¿æ‹…äº†ä¸€éƒ¨åˆ†è´£ä»»åï¼ŒåˆæŠŠè´£ä»»å‘ä¸‹ä¼ é€’çš„æƒ…å†µã€‚\nåœ¨ä¸€ä¸ªçº¯çš„è´£ä»»é“¾æ¨¡å¼é‡Œé¢ï¼Œä¸€ä¸ªè¯·æ±‚å¿…é¡»è¢«æŸä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ‰€æ¥æ”¶ï¼› åœ¨ä¸€ä¸ªä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼é‡Œé¢ï¼Œä¸€ä¸ªè¯·æ±‚æœ€ç»ˆå¯ä»¥ä¸è¢«ä»»ä½•æ¥æ”¶ç«¯å¯¹è±¡æ‰€æ¥æ”¶ã€‚\nçº¯çš„è´£ä»»é“¾æ¨¡å¼çš„å®é™…ä¾‹å­å¾ˆéš¾æ‰¾åˆ°ï¼Œä¸€èˆ¬çœ‹åˆ°çš„ä¾‹å­å‡æ˜¯ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼çš„å®ç°ã€‚ æœ‰äº›äººè®¤ä¸ºä¸çº¯çš„è´£ä»»é“¾æ ¹æœ¬ä¸æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œè¿™ä¹Ÿè®¸æ˜¯æœ‰é“ç†çš„ã€‚ä½†æ˜¯åœ¨å®é™…çš„ç³»ç»Ÿé‡Œï¼Œçº¯çš„è´£ä»»é“¾å¾ˆéš¾æ‰¾åˆ°ã€‚å¦‚æœåšæŒè´£ä»»é“¾ä¸çº¯ä¾¿ä¸æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œé‚£ä¹ˆè´£ä»»é“¾æ¨¡å¼ä¾¿ä¸ä¼šæœ‰å¤ªå¤§æ„ä¹‰äº†ã€‚\nè´£ä»»é“¾æ¨¡å¼åœ¨Tomcatä¸­çš„åº”ç”¨ ä¼—æ‰€å‘¨çŸ¥Tomcatä¸­çš„Filterå°±æ˜¯ä½¿ç”¨äº†è´£ä»»é“¾æ¨¡å¼ï¼Œåˆ›å»ºä¸€ä¸ªFilteré™¤äº†è¦åœ¨web.xmlæ–‡ä»¶ä¸­åšç›¸åº”é…ç½®å¤–ï¼Œè¿˜éœ€è¦å®ç°javax.servlet.Filteræ¥å£ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public class TestFilter implements Filter{ public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { chain.doFilter(request, response); } public void destroy() { } public void init(FilterConfig filterConfig) throws ServletException { } } å…¶å®åœ¨çœŸæ­£æ‰§è¡Œåˆ°TestFilterç±»ä¹‹å‰ï¼Œä¼šç»è¿‡å¾ˆå¤šTomcatå†…éƒ¨çš„ç±»ã€‚ é¡ºå¸¦æä¸€ä¸‹å…¶å®Tomcatçš„å®¹å™¨è®¾ç½®ä¹Ÿæ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œæ³¨æ„è¢«çº¢è‰²æ–¹æ¡†æ‰€åœˆä¸­çš„ç±»ï¼Œä»Engineåˆ°Hostå†åˆ°Contextä¸€ç›´åˆ°Wrapperéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªé“¾ä¼ é€’è¯·æ±‚ã€‚ è¢«ç»¿è‰²æ–¹æ¡†æ‰€åœˆä¸­çš„åœ°æ–¹æœ‰ä¸€ä¸ªåä¸ºApplicationFilterChainçš„ç±»ï¼ŒApplicationFilterChainç±»æ‰€æ‰®æ¼”çš„å°±æ˜¯æŠ½è±¡å¤„ç†è€…è§’è‰²ï¼Œè€Œå…·ä½“å¤„ç†è€…è§’è‰²ç”±å„ä¸ªFilteræ‰®æ¼”ã€‚\nç¬¬ä¸€ä¸ªç–‘é—®æ˜¯ApplicationFilterChainå°†æ‰€æœ‰çš„Filterå­˜æ”¾åœ¨å“ªé‡Œï¼Ÿ ç­”æ¡ˆæ˜¯ä¿å­˜åœ¨ApplicationFilterChainç±»ä¸­çš„ä¸€ä¸ªApplicationFilterConfigå¯¹è±¡çš„æ•°ç»„ä¸­ã€‚\n1 2 3 4 /** * Filters. */ private ApplicationFilterConfig[] filters = new ApplicationFilterConfig[0]; é‚£ApplicationFilterConfigå¯¹è±¡åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ApplicationFilterConfigæ˜¯ä¸€ä¸ªFilterå®¹å™¨ã€‚ä»¥ä¸‹æ˜¯ApplicationFilterConfigç±»çš„å£°æ˜ï¼š\n1 2 3 4 5 6 7 8 /** * Implementation of a javax.servlet.FilterConfig useful in * managing the filter instances instantiated when a web application * is first started. * * @author Craig R. McClanahan * @version $Id: ApplicationFilterConfig.java 1201569 2011-11-14 01:36:07Z kkolinko $ */ å½“ä¸€ä¸ªwebåº”ç”¨é¦–æ¬¡å¯åŠ¨æ—¶ApplicationFilterConfigä¼šè‡ªåŠ¨å®ä¾‹åŒ–ï¼Œå®ƒä¼šä»è¯¥webåº”ç”¨çš„web.xmlæ–‡ä»¶ä¸­è¯»å–é…ç½®çš„Filterçš„ä¿¡æ¯ï¼Œç„¶åè£…è¿›è¯¥å®¹å™¨ã€‚ åˆšåˆšçœ‹åˆ°åœ¨ApplicationFilterChainç±»ä¸­æ‰€åˆ›å»ºçš„ApplicationFilterConfigæ•°ç»„é•¿åº¦ä¸ºé›¶ï¼Œé‚£å®ƒæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™è¢«é‡æ–°èµ‹å€¼çš„å‘¢ï¼Ÿ private ApplicationFilterConfig[] filters = new ApplicationFilterConfig[0]; æ˜¯åœ¨è°ƒç”¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³•æ—¶ã€‚\n1 2 3 4 /** * The int which gives the current number of filters in the chain. */ private int n = 0; public static final int INCREMENT = 10;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 void addFilter(ApplicationFilterConfig filterConfig) { // Prevent the same filter being added multiple times for(ApplicationFilterConfig filter:filters) if(filter==filterConfig) return; if (n == filters.length) { ApplicationFilterConfig[] newFilters = new ApplicationFilterConfig[n + INCREMENT]; System.arraycopy(filters, 0, newFilters, 0, n); filters = newFilters; } filters[n++] = filterConfig; } å˜é‡nç”¨æ¥è®°å½•å½“å‰è¿‡æ»¤å™¨é“¾é‡Œé¢æ‹¥æœ‰çš„è¿‡æ»¤å™¨æ•°ç›®ï¼Œé»˜è®¤æƒ…å†µä¸‹nç­‰äº0ï¼ŒApplicationFilterConfigå¯¹è±¡æ•°ç»„çš„é•¿åº¦ä¹Ÿç­‰äº0ï¼Œæ‰€ä»¥å½“ç¬¬ä¸€æ¬¡è°ƒç”¨addFilter()æ–¹æ³•æ—¶ï¼Œif (n == filters.length)çš„æ¡ä»¶æˆç«‹ï¼Œ ApplicationFilterConfigæ•°ç»„é•¿åº¦è¢«æ”¹å˜ã€‚ä¹‹åfilters[n++] = filterConfig;å°†å˜é‡filterConfigæ”¾å…¥ ApplicationFilterConfigæ•°ç»„ä¸­å¹¶å°†å½“å‰è¿‡æ»¤å™¨é“¾é‡Œé¢æ‹¥æœ‰çš„è¿‡æ»¤å™¨æ•°ç›®+1ã€‚\né‚£ApplicationFilterChainçš„addFilter()æ–¹æ³•åˆæ˜¯åœ¨ä»€ä¹ˆåœ°æ–¹è¢«è°ƒç”¨çš„å‘¢ï¼Ÿ æ˜¯åœ¨ApplicationFilterFactoryç±»çš„createFilterChain()æ–¹æ³•ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 public ApplicationFilterChain createFilterChain (ServletRequest request, Wrapper wrapper, Servlet servlet) { // get the dispatcher type DispatcherType dispatcher = null; if (request.getAttribute(DISPATCHER_TYPE_ATTR) != null) { dispatcher = (DispatcherType) request.getAttribute(DISPATCHER_TYPE_ATTR); } String requestPath = null; Object attribute = request.getAttribute(DISPATCHER_REQUEST_PATH_ATTR); if (attribute != null){ requestPath = attribute.toString(); } // If there is no servlet to execute, return null if (servlet == null) return (null); boolean comet = false; // Create and initialize a filter chain object ApplicationFilterChain filterChain = null; if (request instanceof Request) { Request req = (Request) request; comet = req.isComet(); if (Globals.IS_SECURITY_ENABLED) { // Security: Do not recycle filterChain = new ApplicationFilterChain(); if (comet) { req.setFilterChain(filterChain); } } else { filterChain = (ApplicationFilterChain) req.getFilterChain(); if (filterChain == null) { filterChain = new ApplicationFilterChain(); req.setFilterChain(filterChain); } } } else { // Request dispatcher in use filterChain = new ApplicationFilterChain(); } filterChain.setServlet(servlet); filterChain.setSupport (((StandardWrapper)wrapper).getInstanceSupport()); // Acquire the filter mappings for this Context StandardContext context = (StandardContext) wrapper.getParent(); FilterMap filterMaps[] = context.findFilterMaps(); // If there are no filter mappings, we are done if ((filterMaps == null) || (filterMaps.length == 0)) return (filterChain); // Acquire the information we will need to match filter mappings String servletName = wrapper.getName(); // Add the relevant path-mapped filters to this filter chain for (int i = 0; i \u003c filterMaps.length; i++) { if (!matchDispatcher(filterMaps[i] ,dispatcher)) { continue; } if (!matchFiltersURL(filterMaps[i], requestPath)) continue; ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) context.findFilterConfig(filterMaps[i].getFilterName()); if (filterConfig == null) { // FIXME - log configuration problem continue; } boolean isCometFilter = false; if (comet) { try { isCometFilter = filterConfig.getFilter() instanceof CometFilter; } catch (Exception e) { // Note: The try catch is there because getFilter has a lot of // declared exceptions. However, the filter is allocated much // earlier Throwable t = ExceptionUtils.unwrapInvocationTargetException(e); ExceptionUtils.handleThrowable(t); } if (isCometFilter) { filterChain.addFilter(filterConfig); } } else { filterChain.addFilter(filterConfig); } } // Add filters that match on servlet name second for (int i = 0; i \u003c filterMaps.length; i++) { if (!matchDispatcher(filterMaps[i] ,dispatcher)) { continue; } if (!matchFiltersServlet(filterMaps[i], servletName)) continue; ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) context.findFilterConfig(filterMaps[i].getFilterName()); if (filterConfig == null) { // FIXME - log configuration problem continue; } boolean isCometFilter = false; if (comet) { try { isCometFilter = filterConfig.getFilter() instanceof CometFilter; } catch (Exception e) { // Note: The try catch is there because getFilter has a lot of // declared exceptions. However, the filter is allocated much // earlier } if (isCometFilter) { filterChain.addFilter(filterConfig); } } else { filterChain.addFilter(filterConfig); } } // Return the completed filter chain return (filterChain); } å¯ä»¥å°†å¦‚ä¸Šä»£ç åˆ†ä¸ºä¸¤æ®µï¼Œ51è¡Œä¹‹å‰ä¸ºç¬¬ä¸€æ®µï¼Œ51è¡Œä¹‹åä¸ºç¬¬äºŒæ®µã€‚ ç¬¬ä¸€æ®µçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºApplicationFilterChainå¯¹è±¡ä»¥åŠä¸€äº›å‚æ•°è®¾ç½®ã€‚ ç¬¬äºŒæ®µçš„ä¸»è¦ç›®çš„æ˜¯ä»ä¸Šä¸‹æ–‡ä¸­è·å–æ‰€æœ‰Filterä¿¡æ¯ï¼Œä¹‹åä½¿ç”¨forå¾ªç¯éå†å¹¶è°ƒç”¨ filterChain.addFilter(filterConfig); å°† filterConfig æ”¾å…¥ ApplicationFilterChain å¯¹è±¡çš„ ApplicationFilterConfig æ•°ç»„ä¸­ã€‚\né‚£ApplicationFilterFactoryç±»çš„createFilterChain()æ–¹æ³•åˆæ˜¯åœ¨ä»€ä¹ˆåœ°æ–¹è¢«è°ƒç”¨çš„å‘¢ï¼Ÿ æ˜¯åœ¨StandardWrapperValueç±»çš„invoke()æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ã€‚ ç”±äºinvoke()æ–¹æ³•è¾ƒé•¿ï¼Œæ‰€ä»¥å°†å¾ˆå¤šåœ°æ–¹çœç•¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 public final void invoke(Request request, Response response) throws IOException, ServletException { ...çœç•¥ä¸­é—´ä»£ç  // Create the filter chain for this request ApplicationFilterFactory factory = ApplicationFilterFactory.getInstance(); ApplicationFilterChain filterChain = factory.createFilterChain(request, wrapper, servlet); ...çœç•¥ä¸­é—´ä»£ç  filterChain.doFilter(request.getRequest(), response.getResponse()); ...çœç•¥ä¸­é—´ä»£ç  } é‚£æ­£å¸¸çš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š åœ¨StandardWrapperValueç±»çš„invoke()æ–¹æ³•ä¸­è°ƒç”¨ApplicationFilterChaiç±»çš„createFilterChain()æ–¹æ³• â€“\u003e åœ¨ApplicationFilterChaiç±»çš„createFilterChain()æ–¹æ³•ä¸­è°ƒç”¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³• â€“\u003e åœ¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³•ä¸­ç»™ApplicationFilterConfigæ•°ç»„èµ‹å€¼ã€‚\næ ¹æ®ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºStandardWrapperValueç±»çš„invoke()æ–¹æ³•åœ¨æ‰§è¡Œå®ŒcreateFilterChain()æ–¹æ³•åï¼Œä¼šç»§ç»­æ‰§è¡ŒApplicationFilterChainç±»çš„doFilter()æ–¹æ³•ï¼Œç„¶ååœ¨doFilter()æ–¹æ³•ä¸­ä¼šè°ƒç”¨internalDoFilter()æ–¹æ³•ã€‚\nä»¥ä¸‹æ˜¯internalDoFilter()æ–¹æ³•çš„éƒ¨åˆ†ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // Call the next filter if there is one if (pos \u003c n) { //æ‹¿åˆ°ä¸‹ä¸€ä¸ªFilterï¼Œå°†æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ä¸€ä½ //poså®ƒæ¥æ ‡è¯†å½“å‰ApplicationFilterChainï¼ˆå½“å‰è¿‡æ»¤å™¨é“¾ï¼‰æ‰§è¡Œåˆ°å“ªä¸ªè¿‡æ»¤å™¨ ApplicationFilterConfig filterConfig = filters[pos++]; Filter filter = null; try { //è·å–å½“å‰æŒ‡å‘çš„Filterçš„å®ä¾‹ filter = filterConfig.getFilter(); support.fireInstanceEvent(InstanceEvent.BEFORE_FILTER_EVENT, filter, request, response); if (request.isAsyncSupported() \u0026\u0026 \"false\".equalsIgnoreCase( filterConfig.getFilterDef().getAsyncSupported())) { request.setAttribute(Globals.ASYNC_SUPPORTED_ATTR, Boolean.FALSE); } if( Globals.IS_SECURITY_ENABLED ) { final ServletRequest req = request; final ServletResponse res = response; Principal principal = ((HttpServletRequest) req).getUserPrincipal(); Object[] args = new Object[]{req, res, this}; SecurityUtil.doAsPrivilege (\"doFilter\", filter, classType, args, principal); } else { //è°ƒç”¨Filterçš„doFilter()æ–¹æ³• filter.doFilter(request, response, this); } è¿™é‡Œçš„filter.doFilter(request, response, this);å°±æ˜¯è°ƒç”¨æˆ‘ä»¬å‰é¢åˆ›å»ºçš„TestFilterä¸­çš„doFilter()æ–¹æ³•ã€‚ è€ŒTestFilterä¸­çš„doFilter()æ–¹æ³•ä¼šç»§ç»­è°ƒç”¨chain.doFilter(request, response);æ–¹æ³•ï¼Œè€Œè¿™ä¸ªchainå…¶å®å°±æ˜¯ApplicationFilterChain,æ‰€ä»¥è°ƒç”¨è¿‡ç¨‹åˆå›åˆ°äº†ä¸Šé¢è°ƒç”¨dofilterå’Œè°ƒç”¨internalDoFilteræ–¹æ³•ï¼Œè¿™æ ·æ‰§è¡Œç›´åˆ°é‡Œé¢çš„è¿‡æ»¤å™¨å…¨éƒ¨æ‰§è¡Œã€‚\nå¦‚æœå®šä¹‰ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œåˆ™Debugç»“æœå¦‚ä¸‹ï¼š\ntomcatä¸­çš„è´£ä»»é“¾å’Œä¸Šè¾¹è¯´çš„è´£ä»»é“¾è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚ å‰é¢è¯´çš„è´£ä»»é“¾ï¼Œæ˜¯é æ¯ä¸ªé“¾ä¸‹é¢æ”¾ç½®ä¸€ä¸ªè´£ä»»çš„å‚æ•°ï¼Œæ¥å®šä¹‰è´£ä»»çš„å…ˆåå¤„ç†é¡ºåºã€‚ tomcatçš„è´£ä»»é“¾åˆ™æ˜¯é€šè¿‡æ•°ç»„æ¥å®šä¹‰è´£ä»»çš„å…ˆåé¡ºåºï¼Œtomcatè´£ä»»é“¾çš„æ¨¡å¼æ›´ç±»ä¼¼è¿™æ ·ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 class filterChain{ private List filters; public void addFilter(Filter filter){ filters.add(filter); } public void do(HttpRequest request){ for(Filter filter:filters){ filter.do(request); } } } public class ConcreateFilter1 extends Filter{ public void do(HttpRequest request){ //do something } } public class ConcreateFilter2 extends Filter{ public void do(HttpRequest request){ //do something } } public class Client{ public void main(String[] args){ HttpRequest request = ..... FilterChain filterChain = new FilterChain(); filterChain.addFilter(new ConcreateFilter1()); filterChain.addFilter(new ConcreateFilter2()); filterChain.addFilter(new ConcreateFilter2()); filterChain.do(request); } } åŸæ–‡\n",
  "wordCount" : "9305",
  "inLanguage": "en",
  "datePublished": "2018-12-10T17:41:36Z",
  "dateModified": "2018-12-10T17:41:36Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/en/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/links" title="ğŸ¤å‹é“¾">
                    <span>ğŸ¤å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/en/posts/">Posts</a></div>
    <h1 class="post-title">
      è´£ä»»é“¾æ¨¡å¼
    </h1>
    <div class="post-meta"><span title='2018-12-10 17:41:36 +0000 UTC'>2018-12-10</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%ad%a6%e4%b9%a0" aria-label="å¿«é€Ÿå­¦ä¹ ">å¿«é€Ÿå­¦ä¹ </a></li>
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="æ¦‚è¿°">æ¦‚è¿°</a></li>
                <li>
                    <a href="#%e5%87%bb%e9%bc%93%e4%bc%a0%e8%8a%b1" aria-label="å‡»é¼“ä¼ èŠ±">å‡»é¼“ä¼ èŠ±</a></li>
                <li>
                    <a href="#%e8%b4%a3%e4%bb%bb%e9%93%be%e6%a8%a1%e5%bc%8f%e7%9a%84%e7%bb%93%e6%9e%84" aria-label="è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„">è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81" aria-label="ä»£ç ">ä»£ç </a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af1%e7%94%b3%e8%af%b7%e6%b5%81%e7%a8%8b" aria-label="ä½¿ç”¨åœºæ™¯1ï¼ˆç”³è¯·æµç¨‹ï¼‰">ä½¿ç”¨åœºæ™¯1ï¼ˆç”³è¯·æµç¨‹ï¼‰</a><ul>
                        
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81-1" aria-label="ä»£ç ">ä»£ç </a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af2%e6%97%a5%e5%bf%97%e6%89%93%e5%8d%b0" aria-label="ä½¿ç”¨åœºæ™¯2ï¼ˆæ—¥å¿—æ‰“å°ï¼‰">ä½¿ç”¨åœºæ™¯2ï¼ˆæ—¥å¿—æ‰“å°ï¼‰</a></li>
                <li>
                    <a href="#%e7%ba%af%e4%b8%8e%e4%b8%8d%e7%ba%af%e7%9a%84%e8%b4%a3%e4%bb%bb%e9%93%be%e6%a8%a1%e5%bc%8f" aria-label="çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼">çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼</a></li>
                <li>
                    <a href="#%e8%b4%a3%e4%bb%bb%e9%93%be%e6%a8%a1%e5%bc%8f%e5%9c%a8tomcat%e4%b8%ad%e7%9a%84%e5%ba%94%e7%94%a8" aria-label="è´£ä»»é“¾æ¨¡å¼åœ¨Tomcatä¸­çš„åº”ç”¨">è´£ä»»é“¾æ¨¡å¼åœ¨Tomcatä¸­çš„åº”ç”¨</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="å¿«é€Ÿå­¦ä¹ ">å¿«é€Ÿå­¦ä¹ <a hidden class="anchor" aria-hidden="true" href="#å¿«é€Ÿå­¦ä¹ ">#</a></h1>
<blockquote>
<p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p>
</blockquote>
<p>è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰æ˜¯ä¸€ç§å¤„ç†è¯·æ±‚çš„æ¨¡å¼ï¼Œå®ƒè®©å¤šä¸ªå¤„ç†å™¨éƒ½æœ‰æœºä¼šå¤„ç†è¯¥è¯·æ±‚ï¼Œç›´åˆ°å…¶ä¸­æŸä¸ªå¤„ç†æˆåŠŸä¸ºæ­¢ã€‚è´£ä»»é“¾æ¨¡å¼æŠŠå¤šä¸ªå¤„ç†å™¨ä¸²æˆé“¾ï¼Œç„¶åè®©è¯·æ±‚åœ¨é“¾ä¸Šä¼ é€’ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>     â”‚ Request â”‚
</span></span><span style="display:flex;"><span>     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>          â”‚
</span></span><span style="display:flex;"><span>â”Œ â”€ â”€ â”€ â”€ â”¼ â”€ â”€ â”€ â”€ â”
</span></span><span style="display:flex;"><span>          â–¼
</span></span><span style="display:flex;"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
</span></span><span style="display:flex;"><span>   â”‚ ProcessorA  â”‚
</span></span><span style="display:flex;"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
</span></span><span style="display:flex;"><span>          â”‚
</span></span><span style="display:flex;"><span>â”‚         â–¼         â”‚
</span></span><span style="display:flex;"><span>   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>â”‚  â”‚ ProcessorB  â”‚  â”‚
</span></span><span style="display:flex;"><span>   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>â”‚         â”‚         â”‚
</span></span><span style="display:flex;"><span>          â–¼
</span></span><span style="display:flex;"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
</span></span><span style="display:flex;"><span>   â”‚ ProcessorC  â”‚
</span></span><span style="display:flex;"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
</span></span><span style="display:flex;"><span>          â”‚
</span></span><span style="display:flex;"><span>â”” â”€ â”€ â”€ â”€ â”¼ â”€ â”€ â”€ â”€ â”˜
</span></span><span style="display:flex;"><span>          â”‚
</span></span><span style="display:flex;"><span>          â–¼
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨å®é™…åœºæ™¯ä¸­ï¼Œè´¢åŠ¡å®¡æ‰¹å°±æ˜¯ä¸€ä¸ªè´£ä»»é“¾æ¨¡å¼ã€‚å‡è®¾æŸä¸ªå‘˜å·¥éœ€è¦æŠ¥é”€ä¸€ç¬”è´¹ç”¨ï¼Œå®¡æ ¸è€…å¯ä»¥åˆ†ä¸ºï¼š</p>
<ul>
<li>Managerï¼šåªèƒ½å®¡æ ¸1000å…ƒä»¥ä¸‹çš„æŠ¥é”€ï¼›</li>
<li>Directorï¼šåªèƒ½å®¡æ ¸10000å…ƒä»¥ä¸‹çš„æŠ¥é”€ï¼›</li>
<li>CEOï¼šå¯ä»¥å®¡æ ¸ä»»æ„é¢åº¦ã€‚</li>
</ul>
<p>ç”¨è´£ä»»é“¾æ¨¡å¼è®¾è®¡æ­¤æŠ¥é”€æµç¨‹æ—¶ï¼Œæ¯ä¸ªå®¡æ ¸è€…åªå…³å¿ƒè‡ªå·±è´£ä»»èŒƒå›´å†…çš„è¯·æ±‚ï¼Œå¹¶ä¸”å¤„ç†å®ƒã€‚å¯¹äºè¶…å‡ºè‡ªå·±è´£ä»»èŒƒå›´çš„ï¼Œæ‰”ç»™ä¸‹ä¸€ä¸ªå®¡æ ¸è€…å¤„ç†ï¼Œè¿™æ ·ï¼Œå°†æ¥ç»§ç»­æ·»åŠ å®¡æ ¸è€…çš„æ—¶å€™ï¼Œä¸ç”¨æ”¹åŠ¨ç°æœ‰é€»è¾‘ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°è´£ä»»é“¾æ¨¡å¼ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æŠ½è±¡å‡ºè¯·æ±‚å¯¹è±¡ï¼Œå®ƒå°†åœ¨è´£ä»»é“¾ä¸Šä¼ é€’ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Request {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> BigDecimal amount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Request(String name, BigDecimal amount) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">name</span> = name;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">amount</span> = amount;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getName() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> BigDecimal getAmount() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> amount;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬è¦æŠ½è±¡å‡ºå¤„ç†å™¨ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">interface</span> Handler {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è¿”å›Boolean.TRUE = æˆåŠŸ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">// è¿”å›Boolean.FALSE = æ‹’ç»
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">// è¿”å›null = äº¤ä¸‹ä¸€ä¸ªå¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	Boolean process(Request request);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¹¶ä¸”åšå¥½çº¦å®šï¼šå¦‚æœè¿”å›<code>Boolean.TRUE</code>ï¼Œè¡¨ç¤ºå¤„ç†æˆåŠŸï¼Œå¦‚æœè¿”å›<code>Boolean.FALSE</code>ï¼Œè¡¨ç¤ºå¤„ç†å¤±è´¥ï¼ˆè¯·æ±‚è¢«æ‹’ç»ï¼‰ï¼Œå¦‚æœè¿”å›<code>null</code>ï¼Œåˆ™äº¤ç”±ä¸‹ä¸€ä¸ª<code>Handler</code>å¤„ç†ã€‚</p>
<p>ç„¶åï¼Œä¾æ¬¡ç¼–å†™ManagerHandlerã€DirectorHandlerå’ŒCEOHandlerã€‚ä»¥ManagerHandlerä¸ºä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ManagerHandler <span style="color:#fff;font-weight:bold">implements</span> Handler {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Boolean process(Request request) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å¦‚æœè¶…è¿‡1000å…ƒï¼Œå¤„ç†ä¸äº†ï¼Œäº¤ä¸‹ä¸€ä¸ªå¤„ç†:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span> (request.<span style="color:#007f7f">getAmount</span>().<span style="color:#007f7f">compareTo</span>(BigDecimal.<span style="color:#007f7f">valueOf</span>(<span style="color:#ff0;font-weight:bold">1000</span>)) &gt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å¯¹Bobæœ‰åè§:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">return</span> !request.<span style="color:#007f7f">getName</span>().<span style="color:#007f7f">equalsIgnoreCase</span>(<span style="color:#0ff;font-weight:bold">&#34;bob&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ‰äº†ä¸åŒçš„<code>Handler</code>åï¼Œæˆ‘ä»¬è¿˜è¦æŠŠè¿™äº›<code>Handler</code>ç»„åˆèµ·æ¥ï¼Œå˜æˆä¸€ä¸ªé“¾ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç»Ÿä¸€å…¥å£å¤„ç†ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> HandlerChain {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æŒæœ‰æ‰€æœ‰Handler:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">private</span> List&lt;Handler&gt; handlers = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> addHandler(Handler handler) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">handlers</span>.<span style="color:#007f7f">add</span>(handler);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> process(Request request) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¾æ¬¡è°ƒç”¨æ¯ä¸ªHandler:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">for</span> (Handler handler : handlers) {
</span></span><span style="display:flex;"><span>            Boolean r = handler.<span style="color:#007f7f">process</span>(request);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (r != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// å¦‚æœè¿”å›TRUEæˆ–FALSEï¼Œå¤„ç†ç»“æŸ:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(request + <span style="color:#0ff;font-weight:bold">&#34; &#34;</span> + (r ? <span style="color:#0ff;font-weight:bold">&#34;Approved by &#34;</span> : <span style="color:#0ff;font-weight:bold">&#34;Denied by &#34;</span>) + handler.<span style="color:#007f7f">getClass</span>().<span style="color:#007f7f">getSimpleName</span>());
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> r;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(<span style="color:#0ff;font-weight:bold">&#34;Could not handle request: &#34;</span> + request);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ç»„è£…å‡ºè´£ä»»é“¾ï¼Œç„¶åç”¨è´£ä»»é“¾æ¥å¤„ç†è¯·æ±‚ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// æ„é€ è´£ä»»é“¾:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>HandlerChain chain = <span style="color:#fff;font-weight:bold">new</span> HandlerChain();
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">addHandler</span>(<span style="color:#fff;font-weight:bold">new</span> ManagerHandler());
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">addHandler</span>(<span style="color:#fff;font-weight:bold">new</span> DirectorHandler());
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">addHandler</span>(<span style="color:#fff;font-weight:bold">new</span> CEOHandler());
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// å¤„ç†è¯·æ±‚:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>chain.<span style="color:#007f7f">process</span>(<span style="color:#fff;font-weight:bold">new</span> Request(<span style="color:#0ff;font-weight:bold">&#34;Bob&#34;</span>, <span style="color:#fff;font-weight:bold">new</span> BigDecimal(<span style="color:#0ff;font-weight:bold">&#34;123.45&#34;</span>)));
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">process</span>(<span style="color:#fff;font-weight:bold">new</span> Request(<span style="color:#0ff;font-weight:bold">&#34;Alice&#34;</span>, <span style="color:#fff;font-weight:bold">new</span> BigDecimal(<span style="color:#0ff;font-weight:bold">&#34;1234.56&#34;</span>)));
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">process</span>(<span style="color:#fff;font-weight:bold">new</span> Request(<span style="color:#0ff;font-weight:bold">&#34;Bill&#34;</span>, <span style="color:#fff;font-weight:bold">new</span> BigDecimal(<span style="color:#0ff;font-weight:bold">&#34;12345.67&#34;</span>)));
</span></span><span style="display:flex;"><span>chain.<span style="color:#007f7f">process</span>(<span style="color:#fff;font-weight:bold">new</span> Request(<span style="color:#0ff;font-weight:bold">&#34;John&#34;</span>, <span style="color:#fff;font-weight:bold">new</span> BigDecimal(<span style="color:#0ff;font-weight:bold">&#34;123456.78&#34;</span>)));
</span></span></code></pre></td></tr></table>
</div>
</div><p>è´£ä»»é“¾æ¨¡å¼æœ¬èº«å¾ˆå®¹æ˜“ç†è§£ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>Handler</code>æ·»åŠ çš„é¡ºåºå¾ˆé‡è¦ï¼Œå¦‚æœé¡ºåºä¸å¯¹ï¼Œå¤„ç†çš„ç»“æœå¯èƒ½å°±ä¸æ˜¯ç¬¦åˆè¦æ±‚çš„ã€‚</p>
<p>æ­¤å¤–ï¼Œè´£ä»»é“¾æ¨¡å¼æœ‰å¾ˆå¤šå˜ç§ã€‚æœ‰äº›è´£ä»»é“¾çš„å®ç°æ–¹å¼æ˜¯é€šè¿‡æŸä¸ª<code>Handler</code>æ‰‹åŠ¨è°ƒç”¨ä¸‹ä¸€ä¸ª<code>Handler</code>æ¥ä¼ é€’<code>Request</code>ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> AHandler <span style="color:#fff;font-weight:bold">implements</span> Handler {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> Handler next;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> process(Request request) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (!canProcess(request)) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ‰‹åŠ¨äº¤ç»™ä¸‹ä¸€ä¸ªHandlerå¤„ç†:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            next.<span style="color:#007f7f">process</span>(request);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜æœ‰ä¸€äº›è´£ä»»é“¾æ¨¡å¼ï¼Œæ¯ä¸ª<code>Handler</code>éƒ½æœ‰æœºä¼šå¤„ç†<code>Request</code>ï¼Œé€šå¸¸è¿™ç§è´£ä»»é“¾è¢«ç§°ä¸ºæ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–è€…è¿‡æ»¤å™¨ï¼ˆFilterï¼‰ï¼Œå®ƒçš„ç›®çš„ä¸æ˜¯æ‰¾åˆ°æŸä¸ª<code>Handler</code>å¤„ç†æ‰<code>Request</code>ï¼Œè€Œæ˜¯æ¯ä¸ª<code>Handler</code>éƒ½åšä¸€äº›å·¥ä½œï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>è®°å½•æ—¥å¿—ï¼›</li>
<li>æ£€æŸ¥æƒé™ï¼›</li>
<li>å‡†å¤‡ç›¸å…³èµ„æºï¼›</li>
<li>&hellip;</li>
</ul>
<p>ä¾‹å¦‚ï¼ŒJavaEEçš„Servletè§„èŒƒå®šä¹‰çš„<code>Filter</code>å°±æ˜¯ä¸€ç§è´£ä»»é“¾æ¨¡å¼ï¼Œå®ƒä¸ä½†å…è®¸æ¯ä¸ª<code>Filter</code>éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œè¿˜å…è®¸æ¯ä¸ª<code>Filter</code>å†³å®šæ˜¯å¦å°†è¯·æ±‚â€œæ”¾è¡Œâ€ç»™ä¸‹ä¸€ä¸ª<code>Filter</code>ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> AuditFilter <span style="color:#fff;font-weight:bold">implements</span> Filter {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) <span style="color:#fff;font-weight:bold">throws</span> IOException, ServletException {
</span></span><span style="display:flex;"><span>        log(req);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (check(req)) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ”¾è¡Œ:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            chain.<span style="color:#007f7f">doFilter</span>(req, resp);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ‹’ç»:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            sendError(resp);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ç§æ¨¡å¼ä¸ä½†å…è®¸ä¸€ä¸ª<code>Filter</code>è‡ªè¡Œå†³å®šå¤„ç†<code>ServletRequest</code>å’Œ<code>ServletResponse</code>ï¼Œè¿˜å¯ä»¥â€œä¼ªé€ â€<code>ServletRequest</code>å’Œ<code>ServletResponse</code>ä»¥ä¾¿è®©ä¸‹ä¸€ä¸ª<code>Filter</code>å¤„ç†ï¼Œèƒ½å®ç°éå¸¸å¤æ‚çš„åŠŸèƒ½ã€‚</p>
<h1 id="æ¦‚è¿°">æ¦‚è¿°<a hidden class="anchor" aria-hidden="true" href="#æ¦‚è¿°">#</a></h1>
<p>ç±»å‹ï¼šè¡Œä¸ºå‹
è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ã€‚
åœ¨è´£ä»»é“¾æ¨¡å¼é‡Œï¼Œå¾ˆå¤šå¯¹è±¡ç”±æ¯ä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä¸‹å®¶çš„çš„å¼•ç”¨è€Œè¿èµ·æ¥å½¢æˆä¸€æ¡é“¾ã€‚
è¯·æ±‚åœ¨è¿™æ¡é“¾ä¸Šä¼ é€’ï¼Œç›´åˆ°é“¾ä¸Šçš„æŸä¸€ä¸ªå¯¹è±¡å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚
å‘å‡ºè¿™ä¸ªè¯·æ±‚çš„å®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“é“¾ä¸Šçš„å“ªä¸€ä¸ªå¯¹è±¡æœ€ç»ˆå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œ
è¿™ä½¿å¾—ç³»ç»Ÿå¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€çš„é‡æ–°ç»„ç»‡å’Œåˆ†é…è´£ä»»ã€‚</p>
<p>æ„å›¾ï¼šé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p>
<p>ä¸»è¦è§£å†³ï¼šèŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</p>
<p>ä½•æ—¶ä½¿ç”¨ï¼šåœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶ï¼Œéœ€è¦è¿‡æ»¤å¾ˆå¤šé“ç¨‹åºã€‚
å¦‚ä½•è§£å†³ï¼šæ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚
å…³é”®ä»£ç ï¼šHandler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ HandlerRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ï¼Œå‘è°ä¼ é€’ä¹‹å‰ set è¿›å»ã€‚</p>
<p>åº”ç”¨å®ä¾‹ï¼š</p>
<ul>
<li>çº¢æ¥¼æ¢¦ä¸­çš„&quot;å‡»é¼“ä¼ èŠ±&quot;ã€‚</li>
<li>JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚</li>
<li>JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ã€‚</li>
<li>jsp servlet çš„ Filterã€‚</li>
</ul>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚</li>
<li>ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚</li>
<li>å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</li>
<li>å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚</li>
<li>ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</li>
<li>å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚</li>
</ul>
<p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚</li>
<li>åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚</li>
<li>å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ã€‚</li>
</ul>
<h1 id="å‡»é¼“ä¼ èŠ±">å‡»é¼“ä¼ èŠ±<a hidden class="anchor" aria-hidden="true" href="#å‡»é¼“ä¼ èŠ±">#</a></h1>
<p>å‡»é¼“ä¼ èŠ±æ˜¯ä¸€ç§çƒ­é—¹è€Œåˆç´§å¼ çš„é¥®é…’æ¸¸æˆã€‚åœ¨é…’å®´ä¸Šå®¾å®¢ä¾æ¬¡åå®šä½ç½®ï¼Œç”±ä¸€äººå‡»é¼“ï¼Œå‡»é¼“çš„åœ°æ–¹ä¸ä¼ èŠ±çš„åœ°æ–¹æ˜¯åˆ†å¼€çš„ï¼Œä»¥ç¤ºå…¬æ­£ã€‚å¼€å§‹å‡»é¼“æ—¶ï¼ŒèŠ±æŸå°±å¼€å§‹ä¾æ¬¡ä¼ é€’ï¼Œé¼“å£°ä¸€è½ï¼Œå¦‚æœèŠ±æŸåœ¨æŸäººæ‰‹ä¸­ï¼Œåˆ™è¯¥äººå°±å¾—é¥®é…’ã€‚æ¯”å¦‚è¯´ï¼Œè´¾æ¯ã€è´¾èµ¦ã€è´¾æ”¿ã€è´¾å®ç‰å’Œè´¾ç¯æ˜¯äº”ä¸ªå‚åŠ å‡»é¼“ä¼ èŠ±æ¸¸æˆçš„ä¼ èŠ±è€…ï¼Œä»–ä»¬ç»„æˆä¸€ä¸ªç¯é“¾ã€‚å‡»é¼“è€…å°†èŠ±ä¼ ç»™è´¾æ¯ï¼Œå¼€å§‹ä¼ èŠ±æ¸¸æˆã€‚èŠ±ç”±è´¾æ¯ä¼ ç»™è´¾èµ¦ï¼Œç”±è´¾èµ¦ä¼ ç»™è´¾æ”¿ï¼Œç”±è´¾æ”¿ä¼ ç»™è´¾å®ç‰ï¼Œåˆè´¾å®ç‰ä¼ ç»™è´¾ç¯ï¼Œç”±è´¾ç¯ä¼ å›ç»™è´¾æ¯ï¼Œå¦‚æ­¤å¾€å¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å½“é¼“å£°åœæ­¢æ—¶ï¼Œæ‰‹ä¸­æœ‰èŠ±çš„äººå°±å¾—æ‰§è¡Œé…’ä»¤ã€‚
<img loading="lazy" src="1.png" alt=""  />
</p>
<p>å‡»é¼“ä¼ èŠ±ä¾¿æ˜¯è´£ä»»é“¾æ¨¡å¼çš„åº”ç”¨ã€‚
è´£ä»»é“¾å¯ä»¥æ˜¯ä¸€æ¡ç›´çº¿ï¼Œä¸€ä¸ªç¯é“¾æˆ–è€…ä¸€ä¸ªæ ‘çŠ¶ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚</p>
<h1 id="è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„">è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#è´£ä»»é“¾æ¨¡å¼çš„ç»“æ„">#</a></h1>
<p>ä¸‹é¢ä½¿ç”¨äº†ä¸€ä¸ªè´£ä»»é“¾æ¨¡å¼çš„æœ€ç®€å•çš„å®ç°ã€‚
<img loading="lazy" src="2.png" alt=""  />
</p>
<p>è´£ä»»é“¾æ¨¡å¼æ¶‰åŠåˆ°çš„è§’è‰²å¦‚ä¸‹æ‰€ç¤ºï¼š
æŠ½è±¡å¤„ç†è€…(Handler)ï¼šä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ã€‚</p>
<ul>
<li>å¦‚æœéœ€è¦ï¼Œæ¥å£å¯ä»¥å®šä¹‰å‡ºä¸€ä¸ªæ–¹æ³•ä»¥è®¾å®šå’Œè¿”å›å¯¹ä¸‹å®¶çš„å¼•ç”¨ã€‚</li>
<li>è¿™ä¸ªè§’è‰²é€šå¸¸ç”±ä¸€ä¸ªJAVAæŠ½è±¡ç±»æˆ–è€…JAVAæ¥å£å®ç°ã€‚</li>
<li>ä¸Šå›¾ä¸­çš„Handlerç±»çš„èšåˆå…³ç³»ç»™å‡ºäº†å…·ä½“å­ç±»å¯¹ä¸‹å®¶çš„å¼•ç”¨ã€‚</li>
<li>æŠ½è±¡æ–¹æ³•handlerReuqest()è§„èŒƒäº†ç±»å¤„ç†è¯·æ±‚çš„æ“ä½œã€‚</li>
</ul>
<p>å…·ä½“å¤„ç†è€…(ConcreteHandler)ï¼š</p>
<ul>
<li>å…·ä½“å¤„ç†è€…æ¥åˆ°è¯·æ±‚åï¼Œå¯ä»¥é€‰æ‹©å°†è¯·æ±‚å¤„ç†æ‰ï¼Œæˆ–è€…å°†è¯·æ±‚ä¼ ç»™ä¸‹å®¶ã€‚</li>
</ul>
<h1 id="ä»£ç ">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç ">#</a></h1>
<p>æŠ½è±¡å¤„ç†è€…ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> Handler {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//æŒæœ‰åç»§çš„è´£ä»»å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">protected</span> Handler successor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç¤ºæ„å¤„ç†è¯·æ±‚çš„æ–¹æ³•ï¼Œè™½ç„¶è¿™ä¸ªç¤ºæ„æ–¹æ³•æ˜¯æ²¡æœ‰ä¼ å…¥å‚æ•°çš„ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä½†å®é™…æ˜¯å¯ä»¥ä¼ å…¥å‚æ•°çš„ï¼Œæ ¹æ®å…·ä½“éœ€æ±‚æ¥é€‰æ‹©æ˜¯å¦ä¼ é€’å‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">void</span> handlerRequest();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Handler getSuccessor() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> successor;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setSuccessor(Handler successor) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">successor</span> = successor;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“å¤„ç†è€…ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ConcreteHandler <span style="color:#fff;font-weight:bold">extends</span> Handler{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å¤„ç†æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å¤„ç†è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> handlerRequest() {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         * åˆ¤æ–­æ˜¯å¦æœ‰åç»§çš„è´£ä»»å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         * å¦‚æœæœ‰ï¼Œå°±è½¬å‘è¯·æ±‚æœ‰ç»™åç»§çš„è´£ä»»å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         * å¦‚æœæ²¡æœ‰ï¼Œåˆ™å¤„ç†è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         * */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (getSuccessor() != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ”¾è¿‡è¯·æ±‚&#34;</span>);
</span></span><span style="display:flex;"><span>            getSuccessor().<span style="color:#007f7f">handlerRequest</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å¤„ç†è¯·æ±‚&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¢æˆ·ç«¯ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Client {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ç»„è£…è´£ä»»é“¾
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Handler h1 = <span style="color:#fff;font-weight:bold">new</span> ConcreteHandler();
</span></span><span style="display:flex;"><span>        Handler h2 = <span style="color:#fff;font-weight:bold">new</span> ConcreteHandler();
</span></span><span style="display:flex;"><span>        h1.<span style="color:#007f7f">setSuccessor</span>(h2);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//æäº¤è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        h1.<span style="color:#007f7f">handlerRequest</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹å‡ºï¼Œå®¢æˆ·ç«¯åˆ›å»ºäº†ä¸¤ä¸ªå¤„ç†è€…å¯¹è±¡ï¼Œå¹¶æŒ‡å®šç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡çš„ä¸‹å®¶æ˜¯ç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡ï¼Œè€Œç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡æ²¡æœ‰ä¸‹å®¶ã€‚ç„¶åå®¢æˆ·ç«¯å°†è¯·æ±‚ä¼ é€’ç»™ç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡ã€‚</p>
<p>ç”±äºæœ¬å®ä¾‹çš„ä¼ é€’é€»è¾‘éå¸¸ç®€å•ï¼š</p>
<ul>
<li>åªè¦æœ‰ä¸‹å®¶ï¼Œå°±ä¼ é€’ç»™ä¸‹å®¶å¤„ç†ï¼›</li>
<li>å¦‚æœæ²¡æœ‰ä¸‹å®¶ï¼Œå°±è‡ªè¡Œå¤„ç†ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œç¬¬ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ¥åˆ°è¯·æ±‚åï¼Œä¼šå°†è¯·æ±‚ä¼ é€’ç»™ç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡ã€‚ç”±äºç¬¬äºŒä¸ªå¤„ç†è€…å¯¹è±¡æ²¡æœ‰ä¸‹å®¶ï¼Œäºæ˜¯è‡ªè¡Œå¤„ç†è¯·æ±‚ã€‚
æ´»åŠ¨æ—¶åºå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š
<img loading="lazy" src="3.png" alt=""  />
</p>
<h1 id="ä½¿ç”¨åœºæ™¯1ç”³è¯·æµç¨‹">ä½¿ç”¨åœºæ™¯1ï¼ˆç”³è¯·æµç¨‹ï¼‰<a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨åœºæ™¯1ç”³è¯·æµç¨‹">#</a></h1>
<p>åœºæ™¯ï¼šç”³è¯·èšé¤è´¹ç”¨çš„ç®¡ç†ã€‚
ç”³è¯·èšé¤è´¹ç”¨çš„æµç¨‹ä¸€èˆ¬æ˜¯ï¼š</p>
<ol>
<li>ç”±ç”³è¯·äººå…ˆå¡«å†™ç”³è¯·å•ï¼Œç„¶åäº¤ç»™é¢†å¯¼å®¡æ‰¹ã€‚</li>
<li>è‹¥æ‰¹å‡†é€šè¿‡ï¼Œé¢†å¯¼ä¼šé€šçŸ¥ç”³è¯·äººå®¡æ‰¹é€šè¿‡ï¼Œç„¶åç”³è¯·äººå»è´¢åŠ¡é¢†å–è´¹ç”¨ã€‚</li>
<li>è‹¥å®¡æ‰¹æœªé€šè¿‡ï¼Œé¢†å¯¼ä¼šé€šçŸ¥ç”³è¯·äººå®¡æ‰¹æœªé€šè¿‡ï¼Œæ­¤äº‹ä¹Ÿå°±æ­¤ä½œç½¢ã€‚</li>
</ol>
<p>ä¸åŒçº§åˆ«çš„é¢†å¯¼ï¼Œå¯¹äºå®¡æ‰¹çš„é¢åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚ï¼Œ
é¡¹ç›®ç»ç†åªèƒ½å®¡æ‰¹500å…ƒä»¥å†…çš„ç”³è¯·ï¼›
éƒ¨é—¨ç»ç†èƒ½å®¡æ‰¹1000å…ƒä»¥å†…çš„ç”³è¯·ï¼›
è€Œæ€»ç»ç†å¯ä»¥å®¡æ ¸ä»»æ„é¢åº¦çš„ç”³è¯·ã€‚</p>
<p>æŸäººæå‡ºç”³è¯·åï¼Œè¯¥è¯·æ±‚ä¼šç”±é¡¹ç›®ç»ç†ã€éƒ¨é—¨ç»ç†ã€æ€»ç»ç†ä¹‹ä¸­çš„æŸä¸€ä½é¢†å¯¼æ¥è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä½†æ˜¯æå‡ºç”³è¯·çš„äººå¹¶ä¸çŸ¥é“æœ€ç»ˆä¼šç”±è°æ¥å¤„ç†ä»–çš„è¯·æ±‚ã€‚</p>
<p>ä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š</p>
<ol>
<li>æŸäººæå‡ºç”³è¯·</li>
<li>è¯¥è¯·æ±‚ä¼šåœ¨ é¡¹ç›®ç»ç†-&gt;éƒ¨é—¨ç»ç†-&gt;æ€»ç»ç† è¿™æ ·ä¸€æ¡é¢†å¯¼å¤„ç†é“¾ä¸Šè¿›è¡Œä¼ é€’</li>
<li>æ¯ä¸ªé¢†å¯¼ä¼šæ ¹æ®è‡ªå·±çš„èŒè´£èŒƒå›´ï¼Œæ¥åˆ¤æ–­æ˜¯å¤„ç†è¯·æ±‚è¿˜æ˜¯æŠŠè¯·æ±‚äº¤ç»™æ›´é«˜çº§åˆ«çš„é¢†å¯¼ï¼Œåªè¦æœ‰é¢†å¯¼å¤„ç†äº†ï¼Œä¼ é€’å°±ç»“æŸäº†ã€‚</li>
</ol>
<p>éœ€è¦æŠŠæ¯ä½é¢†å¯¼çš„å¤„ç†ç‹¬ç«‹å‡ºæ¥ï¼Œå®ç°æˆå•ç‹¬çš„èŒè´£å¤„ç†å¯¹è±¡ï¼Œç„¶åä¸ºå®ƒä»¬æä¾›ä¸€ä¸ªå…¬å…±çš„ã€æŠ½è±¡çš„çˆ¶èŒè´£å¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å®¢æˆ·ç«¯æ¥åŠ¨æ€åœ°ç»„åˆèŒè´£é“¾ï¼Œå®ç°ä¸åŒçš„åŠŸèƒ½è¦æ±‚äº†ã€‚</p>
<p><img loading="lazy" src="4.png" alt=""  />
</p>
<h2 id="ä»£ç -1">ä»£ç <a hidden class="anchor" aria-hidden="true" href="#ä»£ç -1">#</a></h2>
<p>æŠ½è±¡å¤„ç†è€…è§’è‰²ç±»ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> Handler {
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//æŒæœ‰ä¸‹ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">protected</span> Handler successor = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//å–å€¼æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">public</span> Handler getSuccessor() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> successor;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setSuccessor(Handler successor) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">successor</span> = successor;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å¤„ç†èšé¤è´¹ç”¨çš„ç”³è¯·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param user    ç”³è¯·äºº
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param fee    ç”³è¯·çš„é’±æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return        æˆåŠŸæˆ–å¤±è´¥çš„å…·ä½“é€šçŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> String handleFeeRequest(String user , <span style="color:#fff;font-weight:bold">double</span> fee);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“å¤„ç†è€…è§’è‰²ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ProjectManager <span style="color:#fff;font-weight:bold">extends</span> Handler {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String handleFeeRequest(String user, <span style="color:#fff;font-weight:bold">double</span> fee) {
</span></span><span style="display:flex;"><span>        String str = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//é¡¹ç›®ç»ç†æƒé™æ¯”è¾ƒå°ï¼Œåªèƒ½åœ¨500ä»¥å†…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span> (fee &lt; <span style="color:#ff0;font-weight:bold">500</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>.<span style="color:#007f7f">equals</span>(user)) {
</span></span><span style="display:flex;"><span>                str = <span style="color:#0ff;font-weight:bold">&#34;æˆåŠŸï¼šé¡¹ç›®ç»ç†åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">//å…¶ä»–äººä¸€å¾‹ä¸åŒæ„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                str = <span style="color:#0ff;font-weight:bold">&#34;å¤±è´¥ï¼šé¡¹ç›®ç»ç†ä¸åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//è¶…è¿‡500ï¼Œç»§ç»­ä¼ é€’ç»™çº§åˆ«æ›´é«˜çš„äººå¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (getSuccessor() != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> getSuccessor().<span style="color:#007f7f">handleFeeRequest</span>(user, fee);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> str;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> DeptManager <span style="color:#fff;font-weight:bold">extends</span> Handler {
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String handleFeeRequest(String user, <span style="color:#fff;font-weight:bold">double</span> fee) {
</span></span><span style="display:flex;"><span>        String str = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//éƒ¨é—¨ç»ç†çš„æƒé™åªèƒ½åœ¨1000ä»¥å†…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span> (fee &lt; <span style="color:#ff0;font-weight:bold">1000</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>.<span style="color:#007f7f">equals</span>(user)) {
</span></span><span style="display:flex;"><span>                str = <span style="color:#0ff;font-weight:bold">&#34;æˆåŠŸï¼šéƒ¨é—¨ç»ç†åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">//å…¶ä»–äººä¸€å¾‹ä¸åŒæ„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                str = <span style="color:#0ff;font-weight:bold">&#34;å¤±è´¥ï¼šéƒ¨é—¨ç»ç†ä¸åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//è¶…è¿‡1000ï¼Œç»§ç»­ä¼ é€’ç»™çº§åˆ«æ›´é«˜çš„äººå¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (getSuccessor() != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> getSuccessor().<span style="color:#007f7f">handleFeeRequest</span>(user, fee);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> str;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> GeneralManager <span style="color:#fff;font-weight:bold">extends</span> Handler {
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String handleFeeRequest(String user, <span style="color:#fff;font-weight:bold">double</span> fee) {
</span></span><span style="display:flex;"><span>        String str = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//æ€»ç»ç†çš„æƒé™å¾ˆå¤§ï¼Œåªè¦è¯·æ±‚åˆ°äº†è¿™é‡Œï¼Œä»–éƒ½å¯ä»¥å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span> (fee &gt;= <span style="color:#ff0;font-weight:bold">1000</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//ä¸ºäº†æµ‹è¯•ï¼Œç®€å•ç‚¹ï¼ŒåªåŒæ„å¼ ä¸‰çš„è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>.<span style="color:#007f7f">equals</span>(user)) {
</span></span><span style="display:flex;"><span>                str = <span style="color:#0ff;font-weight:bold">&#34;æˆåŠŸï¼šæ€»ç»ç†åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">//å…¶ä»–äººä¸€å¾‹ä¸åŒæ„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                str = <span style="color:#0ff;font-weight:bold">&#34;å¤±è´¥ï¼šæ€»ç»ç†ä¸åŒæ„ã€&#34;</span> + user + <span style="color:#0ff;font-weight:bold">&#34;ã€‘çš„èšé¤è´¹ç”¨ï¼Œé‡‘é¢ä¸º&#34;</span> + fee + <span style="color:#0ff;font-weight:bold">&#34;å…ƒ&#34;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//å¦‚æœè¿˜æœ‰åç»§çš„å¤„ç†å¯¹è±¡ï¼Œç»§ç»­ä¼ é€’
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (getSuccessor() != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> getSuccessor().<span style="color:#007f7f">handleFeeRequest</span>(user, fee);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> str;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Client {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å…ˆè¦ç»„è£…è´£ä»»é“¾
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Handler h1 = <span style="color:#fff;font-weight:bold">new</span> GeneralManager();
</span></span><span style="display:flex;"><span>        Handler h2 = <span style="color:#fff;font-weight:bold">new</span> DeptManager();
</span></span><span style="display:flex;"><span>        Handler h3 = <span style="color:#fff;font-weight:bold">new</span> ProjectManager();
</span></span><span style="display:flex;"><span>        h3.<span style="color:#007f7f">setSuccessor</span>(h2);
</span></span><span style="display:flex;"><span>        h2.<span style="color:#007f7f">setSuccessor</span>(h1);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å¼€å§‹æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        String test1 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>, <span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test1 = &#34;</span> + test1);
</span></span><span style="display:flex;"><span>        String test2 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;æå››&#34;</span>, <span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test2 = &#34;</span> + test2);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;---------------------------------------&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        String test3 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>, <span style="color:#ff0;font-weight:bold">700</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test3 = &#34;</span> + test3);
</span></span><span style="display:flex;"><span>        String test4 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;æå››&#34;</span>, <span style="color:#ff0;font-weight:bold">700</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test4 = &#34;</span> + test4);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;---------------------------------------&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        String test5 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;å¼ ä¸‰&#34;</span>, <span style="color:#ff0;font-weight:bold">1500</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test5 = &#34;</span> + test5);
</span></span><span style="display:flex;"><span>        String test6 = h3.<span style="color:#007f7f">handleFeeRequest</span>(<span style="color:#0ff;font-weight:bold">&#34;æå››&#34;</span>, <span style="color:#ff0;font-weight:bold">1500</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test6 = &#34;</span> + test6);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="5.png" alt=""  />
</p>
<h1 id="ä½¿ç”¨åœºæ™¯2æ—¥å¿—æ‰“å°">ä½¿ç”¨åœºæ™¯2ï¼ˆæ—¥å¿—æ‰“å°ï¼‰<a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨åœºæ™¯2æ—¥å¿—æ‰“å°">#</a></h1>
<p>åˆ›å»ºæŠ½è±¡çš„è®°å½•å™¨ç±»ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> AbstractLogger {
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">int</span> INFO = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">int</span> DEBUG = <span style="color:#ff0;font-weight:bold">2</span>;
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">int</span> ERROR = <span style="color:#ff0;font-weight:bold">3</span>;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">int</span> level;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#007f7f">//è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>   <span style="color:#fff;font-weight:bold">protected</span> AbstractLogger nextLogger;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setNextLogger(AbstractLogger nextLogger){
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">nextLogger</span> = nextLogger;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> logMessage(<span style="color:#fff;font-weight:bold">int</span> level, String message){
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">if</span>(<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">level</span> &lt;= level){
</span></span><span style="display:flex;"><span>         write(message);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">if</span>(nextLogger !=<span style="color:#fff;font-weight:bold">null</span>){
</span></span><span style="display:flex;"><span>         nextLogger.<span style="color:#007f7f">logMessage</span>(level, message);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> write(String message);
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‰ä¸ªæ‰©å±•ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ConsoleLogger <span style="color:#fff;font-weight:bold">extends</span> AbstractLogger {
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> ConsoleLogger(<span style="color:#fff;font-weight:bold">int</span> level){
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">level</span> = level;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   @Override
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> write(String message) {    
</span></span><span style="display:flex;"><span>      System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;Standard Console::Logger: &#34;</span> + message);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ErrorLogger <span style="color:#fff;font-weight:bold">extends</span> AbstractLogger {
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> ErrorLogger(<span style="color:#fff;font-weight:bold">int</span> level){
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">level</span> = level;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   @Override
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> write(String message) {    
</span></span><span style="display:flex;"><span>      System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;Error Console::Logger: &#34;</span> + message);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> FileLogger <span style="color:#fff;font-weight:bold">extends</span> AbstractLogger {
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> FileLogger(<span style="color:#fff;font-weight:bold">int</span> level){
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">level</span> = level;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   @Override
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> write(String message) {    
</span></span><span style="display:flex;"><span>      System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;File::Logger: &#34;</span> + message);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºä¸åŒç±»å‹çš„è®°å½•å™¨ã€‚èµ‹äºˆå®ƒä»¬ä¸åŒçš„é”™è¯¯çº§åˆ«ï¼Œå¹¶åœ¨æ¯ä¸ªè®°å½•å™¨ä¸­è®¾ç½®ä¸‹ä¸€ä¸ªè®°å½•å™¨ã€‚æ¯ä¸ªè®°å½•å™¨ä¸­çš„ä¸‹ä¸€ä¸ªè®°å½•å™¨ä»£è¡¨çš„æ˜¯é“¾çš„ä¸€éƒ¨åˆ†ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ChainPatternDemo {
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> AbstractLogger getChainOfLoggers(){
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      AbstractLogger errorLogger = <span style="color:#fff;font-weight:bold">new</span> ErrorLogger(AbstractLogger.<span style="color:#007f7f">ERROR</span>);
</span></span><span style="display:flex;"><span>      AbstractLogger fileLogger = <span style="color:#fff;font-weight:bold">new</span> FileLogger(AbstractLogger.<span style="color:#007f7f">DEBUG</span>);
</span></span><span style="display:flex;"><span>      AbstractLogger consoleLogger = <span style="color:#fff;font-weight:bold">new</span> ConsoleLogger(AbstractLogger.<span style="color:#007f7f">INFO</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      errorLogger.<span style="color:#007f7f">setNextLogger</span>(fileLogger);
</span></span><span style="display:flex;"><span>      fileLogger.<span style="color:#007f7f">setNextLogger</span>(consoleLogger);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">return</span> errorLogger;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>      AbstractLogger loggerChain = getChainOfLoggers();
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      loggerChain.<span style="color:#007f7f">logMessage</span>(AbstractLogger.<span style="color:#007f7f">INFO</span>, <span style="color:#0ff;font-weight:bold">&#34;This is an information.&#34;</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      loggerChain.<span style="color:#007f7f">logMessage</span>(AbstractLogger.<span style="color:#007f7f">DEBUG</span>, 
</span></span><span style="display:flex;"><span>         <span style="color:#0ff;font-weight:bold">&#34;This is a debug level information.&#34;</span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>      loggerChain.<span style="color:#007f7f">logMessage</span>(AbstractLogger.<span style="color:#007f7f">ERROR</span>, 
</span></span><span style="display:flex;"><span>         <span style="color:#0ff;font-weight:bold">&#34;This is an error information.&#34;</span>);
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼">çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#çº¯ä¸ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼">#</a></h1>
<p>ä¸€ä¸ªçº¯çš„è´£ä»»é“¾æ¨¡å¼è¦æ±‚ä¸€ä¸ªå…·ä½“çš„å¤„ç†è€…å¯¹è±¡åªèƒ½åœ¨ä¸¤ä¸ªè¡Œä¸ºä¸­é€‰æ‹©ä¸€ä¸ªï¼šè¦ä¹ˆæ‰¿æ‹…è´£ä»»ï¼Œè¦ä¹ˆæŠŠè´£ä»»æ¨ç»™ä¸‹å®¶ã€‚ä¸å…è®¸å‡ºç°æŸä¸€ä¸ªå…·ä½“çš„å¤„ç†è€…å¯¹è±¡åœ¨æ‰¿æ‹…äº†ä¸€éƒ¨åˆ†è´£ä»»åï¼ŒåˆæŠŠè´£ä»»å‘ä¸‹ä¼ é€’çš„æƒ…å†µã€‚</p>
<p>åœ¨ä¸€ä¸ªçº¯çš„è´£ä»»é“¾æ¨¡å¼é‡Œé¢ï¼Œä¸€ä¸ªè¯·æ±‚å¿…é¡»è¢«æŸä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ‰€æ¥æ”¶ï¼›
åœ¨ä¸€ä¸ªä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼é‡Œé¢ï¼Œä¸€ä¸ªè¯·æ±‚æœ€ç»ˆå¯ä»¥ä¸è¢«ä»»ä½•æ¥æ”¶ç«¯å¯¹è±¡æ‰€æ¥æ”¶ã€‚</p>
<p>çº¯çš„è´£ä»»é“¾æ¨¡å¼çš„å®é™…ä¾‹å­å¾ˆéš¾æ‰¾åˆ°ï¼Œä¸€èˆ¬çœ‹åˆ°çš„ä¾‹å­å‡æ˜¯ä¸çº¯çš„è´£ä»»é“¾æ¨¡å¼çš„å®ç°ã€‚
æœ‰äº›äººè®¤ä¸ºä¸çº¯çš„è´£ä»»é“¾æ ¹æœ¬ä¸æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œè¿™ä¹Ÿè®¸æ˜¯æœ‰é“ç†çš„ã€‚ä½†æ˜¯åœ¨å®é™…çš„ç³»ç»Ÿé‡Œï¼Œçº¯çš„è´£ä»»é“¾å¾ˆéš¾æ‰¾åˆ°ã€‚å¦‚æœåšæŒè´£ä»»é“¾ä¸çº¯ä¾¿ä¸æ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œé‚£ä¹ˆè´£ä»»é“¾æ¨¡å¼ä¾¿ä¸ä¼šæœ‰å¤ªå¤§æ„ä¹‰äº†ã€‚</p>
<h1 id="è´£ä»»é“¾æ¨¡å¼åœ¨tomcatä¸­çš„åº”ç”¨">è´£ä»»é“¾æ¨¡å¼åœ¨Tomcatä¸­çš„åº”ç”¨<a hidden class="anchor" aria-hidden="true" href="#è´£ä»»é“¾æ¨¡å¼åœ¨tomcatä¸­çš„åº”ç”¨">#</a></h1>
<p>ä¼—æ‰€å‘¨çŸ¥Tomcatä¸­çš„Filterå°±æ˜¯ä½¿ç”¨äº†è´£ä»»é“¾æ¨¡å¼ï¼Œåˆ›å»ºä¸€ä¸ªFilteré™¤äº†è¦åœ¨web.xmlæ–‡ä»¶ä¸­åšç›¸åº”é…ç½®å¤–ï¼Œè¿˜éœ€è¦å®ç°javax.servlet.Filteræ¥å£ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> TestFilter <span style="color:#fff;font-weight:bold">implements</span> Filter{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> doFilter(ServletRequest request, ServletResponse response,
</span></span><span style="display:flex;"><span>            FilterChain chain) <span style="color:#fff;font-weight:bold">throws</span> IOException, ServletException {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        chain.<span style="color:#007f7f">doFilter</span>(request, response);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> destroy() {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> init(FilterConfig filterConfig) <span style="color:#fff;font-weight:bold">throws</span> ServletException {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="6.png" alt=""  />
</p>
<p>å…¶å®åœ¨çœŸæ­£æ‰§è¡Œåˆ°TestFilterç±»ä¹‹å‰ï¼Œä¼šç»è¿‡å¾ˆå¤šTomcatå†…éƒ¨çš„ç±»ã€‚
é¡ºå¸¦æä¸€ä¸‹å…¶å®Tomcatçš„å®¹å™¨è®¾ç½®ä¹Ÿæ˜¯è´£ä»»é“¾æ¨¡å¼ï¼Œæ³¨æ„è¢«çº¢è‰²æ–¹æ¡†æ‰€åœˆä¸­çš„ç±»ï¼Œä»Engineåˆ°Hostå†åˆ°Contextä¸€ç›´åˆ°Wrapperéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªé“¾ä¼ é€’è¯·æ±‚ã€‚
è¢«ç»¿è‰²æ–¹æ¡†æ‰€åœˆä¸­çš„åœ°æ–¹æœ‰ä¸€ä¸ªåä¸ºApplicationFilterChainçš„ç±»ï¼ŒApplicationFilterChainç±»æ‰€æ‰®æ¼”çš„å°±æ˜¯æŠ½è±¡å¤„ç†è€…è§’è‰²ï¼Œè€Œå…·ä½“å¤„ç†è€…è§’è‰²ç”±å„ä¸ªFilteræ‰®æ¼”ã€‚</p>
<p>ç¬¬ä¸€ä¸ªç–‘é—®æ˜¯ApplicationFilterChainå°†æ‰€æœ‰çš„Filterå­˜æ”¾åœ¨å“ªé‡Œï¼Ÿ
ç­”æ¡ˆæ˜¯ä¿å­˜åœ¨ApplicationFilterChainç±»ä¸­çš„ä¸€ä¸ªApplicationFilterConfigå¯¹è±¡çš„æ•°ç»„ä¸­ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/**
</span></span><span style="display:flex;"><span>* Filters.
</span></span><span style="display:flex;"><span>*/
</span></span><span style="display:flex;"><span>private ApplicationFilterConfig[] filters = new ApplicationFilterConfig[0];
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ApplicationFilterConfigå¯¹è±¡åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
ApplicationFilterConfigæ˜¯ä¸€ä¸ªFilterå®¹å™¨ã€‚ä»¥ä¸‹æ˜¯ApplicationFilterConfigç±»çš„å£°æ˜ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/**
</span></span><span style="display:flex;"><span> * Implementation of a &lt;code&gt;javax.servlet.FilterConfig&lt;/code&gt; useful in
</span></span><span style="display:flex;"><span> * managing the filter instances instantiated when a web application
</span></span><span style="display:flex;"><span> * is first started.
</span></span><span style="display:flex;"><span> *
</span></span><span style="display:flex;"><span> * @author Craig R. McClanahan
</span></span><span style="display:flex;"><span> * @version $Id: ApplicationFilterConfig.java 1201569 2011-11-14 01:36:07Z kkolinko $
</span></span><span style="display:flex;"><span> */
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ä¸€ä¸ªwebåº”ç”¨é¦–æ¬¡å¯åŠ¨æ—¶ApplicationFilterConfigä¼šè‡ªåŠ¨å®ä¾‹åŒ–ï¼Œå®ƒä¼šä»è¯¥webåº”ç”¨çš„web.xmlæ–‡ä»¶ä¸­è¯»å–é…ç½®çš„Filterçš„ä¿¡æ¯ï¼Œç„¶åè£…è¿›è¯¥å®¹å™¨ã€‚
åˆšåˆšçœ‹åˆ°åœ¨ApplicationFilterChainç±»ä¸­æ‰€åˆ›å»ºçš„ApplicationFilterConfigæ•°ç»„é•¿åº¦ä¸ºé›¶ï¼Œé‚£å®ƒæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™è¢«é‡æ–°èµ‹å€¼çš„å‘¢ï¼Ÿ
<code> private ApplicationFilterConfig[] filters = new ApplicationFilterConfig[0];</code>
æ˜¯åœ¨è°ƒç”¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³•æ—¶ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/**
</span></span><span style="display:flex;"><span> * The int which gives the current number of filters in the chain.
</span></span><span style="display:flex;"><span> */
</span></span><span style="display:flex;"><span>private int n = 0;
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>public static final int INCREMENT = 10;</code></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span> addFilter(ApplicationFilterConfig filterConfig) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Prevent the same filter being added multiple times
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">for</span>(ApplicationFilterConfig filter:filters)
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span>(filter==filterConfig)
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (n == filters.<span style="color:#007f7f">length</span>) {
</span></span><span style="display:flex;"><span>		ApplicationFilterConfig[] newFilters =
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">new</span> ApplicationFilterConfig[n + INCREMENT];
</span></span><span style="display:flex;"><span>		System.<span style="color:#007f7f">arraycopy</span>(filters, <span style="color:#ff0;font-weight:bold">0</span>, newFilters, <span style="color:#ff0;font-weight:bold">0</span>, n);
</span></span><span style="display:flex;"><span>		filters = newFilters;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	filters[n++] = filterConfig;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å˜é‡nç”¨æ¥è®°å½•å½“å‰è¿‡æ»¤å™¨é“¾é‡Œé¢æ‹¥æœ‰çš„è¿‡æ»¤å™¨æ•°ç›®ï¼Œé»˜è®¤æƒ…å†µä¸‹nç­‰äº0ï¼ŒApplicationFilterConfigå¯¹è±¡æ•°ç»„çš„é•¿åº¦ä¹Ÿç­‰äº0ï¼Œæ‰€ä»¥å½“ç¬¬ä¸€æ¬¡è°ƒç”¨addFilter()æ–¹æ³•æ—¶ï¼Œif (n == filters.length)çš„æ¡ä»¶æˆç«‹ï¼Œ
ApplicationFilterConfigæ•°ç»„é•¿åº¦è¢«æ”¹å˜ã€‚ä¹‹åfilters[n++] = filterConfig;å°†å˜é‡filterConfigæ”¾å…¥
ApplicationFilterConfigæ•°ç»„ä¸­å¹¶å°†å½“å‰è¿‡æ»¤å™¨é“¾é‡Œé¢æ‹¥æœ‰çš„è¿‡æ»¤å™¨æ•°ç›®+1ã€‚</p>
<p>é‚£ApplicationFilterChainçš„addFilter()æ–¹æ³•åˆæ˜¯åœ¨ä»€ä¹ˆåœ°æ–¹è¢«è°ƒç”¨çš„å‘¢ï¼Ÿ
æ˜¯åœ¨ApplicationFilterFactoryç±»çš„createFilterChain()æ–¹æ³•ä¸­ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> ApplicationFilterChain createFilterChain
</span></span><span style="display:flex;"><span>        (ServletRequest request, Wrapper wrapper, Servlet servlet) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// get the dispatcher type
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	DispatcherType dispatcher = <span style="color:#fff;font-weight:bold">null</span>; 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (request.<span style="color:#007f7f">getAttribute</span>(DISPATCHER_TYPE_ATTR) != <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>		dispatcher = (DispatcherType) request.<span style="color:#007f7f">getAttribute</span>(DISPATCHER_TYPE_ATTR);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	String requestPath = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>	Object attribute = request.<span style="color:#007f7f">getAttribute</span>(DISPATCHER_REQUEST_PATH_ATTR);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (attribute != <span style="color:#fff;font-weight:bold">null</span>){
</span></span><span style="display:flex;"><span>		requestPath = attribute.<span style="color:#007f7f">toString</span>();
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// If there is no servlet to execute, return null
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">if</span> (servlet == <span style="color:#fff;font-weight:bold">null</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">return</span> (<span style="color:#fff;font-weight:bold">null</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">boolean</span> comet = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Create and initialize a filter chain object
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	ApplicationFilterChain filterChain = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (request <span style="color:#fff;font-weight:bold">instanceof</span> Request) {
</span></span><span style="display:flex;"><span>		Request req = (Request) request;
</span></span><span style="display:flex;"><span>		comet = req.<span style="color:#007f7f">isComet</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (Globals.<span style="color:#007f7f">IS_SECURITY_ENABLED</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#007f7f">// Security: Do not recycle
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>			filterChain = <span style="color:#fff;font-weight:bold">new</span> ApplicationFilterChain();
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">if</span> (comet) {
</span></span><span style="display:flex;"><span>				req.<span style="color:#007f7f">setFilterChain</span>(filterChain);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>			filterChain = (ApplicationFilterChain) req.<span style="color:#007f7f">getFilterChain</span>();
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">if</span> (filterChain == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>				filterChain = <span style="color:#fff;font-weight:bold">new</span> ApplicationFilterChain();
</span></span><span style="display:flex;"><span>				req.<span style="color:#007f7f">setFilterChain</span>(filterChain);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// Request dispatcher in use
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>		filterChain = <span style="color:#fff;font-weight:bold">new</span> ApplicationFilterChain();
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	filterChain.<span style="color:#007f7f">setServlet</span>(servlet);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	filterChain.<span style="color:#007f7f">setSupport</span>
</span></span><span style="display:flex;"><span>		(((StandardWrapper)wrapper).<span style="color:#007f7f">getInstanceSupport</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Acquire the filter mappings for this Context
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	StandardContext context = (StandardContext) wrapper.<span style="color:#007f7f">getParent</span>();
</span></span><span style="display:flex;"><span>	FilterMap filterMaps[] = context.<span style="color:#007f7f">findFilterMaps</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// If there are no filter mappings, we are done
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">if</span> ((filterMaps == <span style="color:#fff;font-weight:bold">null</span>) || (filterMaps.<span style="color:#007f7f">length</span> == <span style="color:#ff0;font-weight:bold">0</span>))
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">return</span> (filterChain);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Acquire the information we will need to match filter mappings
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	String servletName = wrapper.<span style="color:#007f7f">getName</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Add the relevant path-mapped filters to this filter chain
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">0</span>; i &lt; filterMaps.<span style="color:#007f7f">length</span>; i++) {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (!matchDispatcher(filterMaps[i] ,dispatcher)) {
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (!matchFiltersURL(filterMaps[i], requestPath))
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		ApplicationFilterConfig filterConfig = (ApplicationFilterConfig)
</span></span><span style="display:flex;"><span>			context.<span style="color:#007f7f">findFilterConfig</span>(filterMaps[i].<span style="color:#007f7f">getFilterName</span>());
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (filterConfig == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#007f7f">// FIXME - log configuration problem
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">boolean</span> isCometFilter = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (comet) {
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>				isCometFilter = filterConfig.<span style="color:#007f7f">getFilter</span>() <span style="color:#fff;font-weight:bold">instanceof</span> CometFilter;
</span></span><span style="display:flex;"><span>			} <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>				<span style="color:#007f7f">// Note: The try catch is there because getFilter has a lot of 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>				<span style="color:#007f7f">// declared exceptions. However, the filter is allocated much
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>				<span style="color:#007f7f">// earlier
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>				Throwable t = ExceptionUtils.<span style="color:#007f7f">unwrapInvocationTargetException</span>(e);
</span></span><span style="display:flex;"><span>				ExceptionUtils.<span style="color:#007f7f">handleThrowable</span>(t);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">if</span> (isCometFilter) {
</span></span><span style="display:flex;"><span>				filterChain.<span style="color:#007f7f">addFilter</span>(filterConfig);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>			filterChain.<span style="color:#007f7f">addFilter</span>(filterConfig);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Add filters that match on servlet name second
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">0</span>; i &lt; filterMaps.<span style="color:#007f7f">length</span>; i++) {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (!matchDispatcher(filterMaps[i] ,dispatcher)) {
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (!matchFiltersServlet(filterMaps[i], servletName))
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		ApplicationFilterConfig filterConfig = (ApplicationFilterConfig)
</span></span><span style="display:flex;"><span>			context.<span style="color:#007f7f">findFilterConfig</span>(filterMaps[i].<span style="color:#007f7f">getFilterName</span>());
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (filterConfig == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#007f7f">// FIXME - log configuration problem
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>			<span style="color:#fff;font-weight:bold">continue</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">boolean</span> isCometFilter = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (comet) {
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>				isCometFilter = filterConfig.<span style="color:#007f7f">getFilter</span>() <span style="color:#fff;font-weight:bold">instanceof</span> CometFilter;
</span></span><span style="display:flex;"><span>			} <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>				<span style="color:#007f7f">// Note: The try catch is there because getFilter has a lot of 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>				<span style="color:#007f7f">// declared exceptions. However, the filter is allocated much
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>				<span style="color:#007f7f">// earlier
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">if</span> (isCometFilter) {
</span></span><span style="display:flex;"><span>				filterChain.<span style="color:#007f7f">addFilter</span>(filterConfig);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>			filterChain.<span style="color:#007f7f">addFilter</span>(filterConfig);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Return the completed filter chain
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#fff;font-weight:bold">return</span> (filterChain);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥å°†å¦‚ä¸Šä»£ç åˆ†ä¸ºä¸¤æ®µï¼Œ51è¡Œä¹‹å‰ä¸ºç¬¬ä¸€æ®µï¼Œ51è¡Œä¹‹åä¸ºç¬¬äºŒæ®µã€‚
ç¬¬ä¸€æ®µçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºApplicationFilterChainå¯¹è±¡ä»¥åŠä¸€äº›å‚æ•°è®¾ç½®ã€‚
ç¬¬äºŒæ®µçš„ä¸»è¦ç›®çš„æ˜¯ä»ä¸Šä¸‹æ–‡ä¸­è·å–æ‰€æœ‰Filterä¿¡æ¯ï¼Œä¹‹åä½¿ç”¨forå¾ªç¯éå†å¹¶è°ƒç”¨
<code>filterChain.addFilter(filterConfig);</code>
å°† filterConfig æ”¾å…¥ ApplicationFilterChain å¯¹è±¡çš„ ApplicationFilterConfig æ•°ç»„ä¸­ã€‚</p>
<p>é‚£ApplicationFilterFactoryç±»çš„createFilterChain()æ–¹æ³•åˆæ˜¯åœ¨ä»€ä¹ˆåœ°æ–¹è¢«è°ƒç”¨çš„å‘¢ï¼Ÿ
æ˜¯åœ¨StandardWrapperValueç±»çš„invoke()æ–¹æ³•ä¸­è¢«è°ƒç”¨çš„ã€‚
<img loading="lazy" src="7.png" alt=""  />
</p>
<p>ç”±äºinvoke()æ–¹æ³•è¾ƒé•¿ï¼Œæ‰€ä»¥å°†å¾ˆå¤šåœ°æ–¹çœç•¥ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">void</span> invoke(Request request, Response response)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">throws</span> IOException, ServletException {
</span></span><span style="display:flex;"><span>	...<span style="color:#f00">çœç•¥ä¸­é—´ä»£ç </span>
</span></span><span style="display:flex;"><span><span style="color:#f00">ã€€ã€€ã€€ã€€</span> <span style="color:#007f7f">// Create the filter chain for this request
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	ApplicationFilterFactory factory =
</span></span><span style="display:flex;"><span>		ApplicationFilterFactory.<span style="color:#007f7f">getInstance</span>();
</span></span><span style="display:flex;"><span>	ApplicationFilterChain filterChain =
</span></span><span style="display:flex;"><span>		factory.<span style="color:#007f7f">createFilterChain</span>(request, wrapper, servlet);
</span></span><span style="display:flex;"><span><span style="color:#f00">ã€€ã€€</span>...<span style="color:#f00">çœç•¥ä¸­é—´ä»£ç </span>
</span></span><span style="display:flex;"><span>	 filterChain.<span style="color:#007f7f">doFilter</span>(request.<span style="color:#007f7f">getRequest</span>(), response.<span style="color:#007f7f">getResponse</span>());
</span></span><span style="display:flex;"><span><span style="color:#f00">ã€€ã€€</span>...<span style="color:#f00">çœç•¥ä¸­é—´ä»£ç </span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£æ­£å¸¸çš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
åœ¨StandardWrapperValueç±»çš„invoke()æ–¹æ³•ä¸­è°ƒç”¨ApplicationFilterChaiç±»çš„createFilterChain()æ–¹æ³•
&ndash;&gt;
åœ¨ApplicationFilterChaiç±»çš„createFilterChain()æ–¹æ³•ä¸­è°ƒç”¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³•
&ndash;&gt;
åœ¨ApplicationFilterChainç±»çš„addFilter()æ–¹æ³•ä¸­ç»™ApplicationFilterConfigæ•°ç»„èµ‹å€¼ã€‚</p>
<p><img loading="lazy" src="8.png" alt=""  />

æ ¹æ®ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºStandardWrapperValueç±»çš„invoke()æ–¹æ³•åœ¨æ‰§è¡Œå®ŒcreateFilterChain()æ–¹æ³•åï¼Œä¼šç»§ç»­æ‰§è¡ŒApplicationFilterChainç±»çš„doFilter()æ–¹æ³•ï¼Œç„¶ååœ¨doFilter()æ–¹æ³•ä¸­ä¼šè°ƒç”¨internalDoFilter()æ–¹æ³•ã€‚</p>
<p>ä»¥ä¸‹æ˜¯internalDoFilter()æ–¹æ³•çš„éƒ¨åˆ†ä»£ç </p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// Call the next filter if there is one
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">if</span> (pos &lt; n) {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//æ‹¿åˆ°ä¸‹ä¸€ä¸ªFilterï¼Œå°†æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ä¸€ä½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">//poså®ƒæ¥æ ‡è¯†å½“å‰ApplicationFilterChainï¼ˆå½“å‰è¿‡æ»¤å™¨é“¾ï¼‰æ‰§è¡Œåˆ°å“ªä¸ªè¿‡æ»¤å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    ApplicationFilterConfig filterConfig = filters[pos++];
</span></span><span style="display:flex;"><span>    Filter filter = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//è·å–å½“å‰æŒ‡å‘çš„Filterçš„å®ä¾‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        filter = filterConfig.<span style="color:#007f7f">getFilter</span>();
</span></span><span style="display:flex;"><span>        support.<span style="color:#007f7f">fireInstanceEvent</span>(InstanceEvent.<span style="color:#007f7f">BEFORE_FILTER_EVENT</span>,
</span></span><span style="display:flex;"><span>                                  filter, request, response);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (request.<span style="color:#007f7f">isAsyncSupported</span>() &amp;&amp; <span style="color:#0ff;font-weight:bold">&#34;false&#34;</span>.<span style="color:#007f7f">equalsIgnoreCase</span>(
</span></span><span style="display:flex;"><span>            filterConfig.<span style="color:#007f7f">getFilterDef</span>().<span style="color:#007f7f">getAsyncSupported</span>())) {
</span></span><span style="display:flex;"><span>            request.<span style="color:#007f7f">setAttribute</span>(Globals.<span style="color:#007f7f">ASYNC_SUPPORTED_ATTR</span>,
</span></span><span style="display:flex;"><span>                                 Boolean.<span style="color:#007f7f">FALSE</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>( Globals.<span style="color:#007f7f">IS_SECURITY_ENABLED</span> ) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">final</span> ServletRequest req = request;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">final</span> ServletResponse res = response;
</span></span><span style="display:flex;"><span>            Principal principal = 
</span></span><span style="display:flex;"><span>                ((HttpServletRequest) req).<span style="color:#007f7f">getUserPrincipal</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Object[] args = <span style="color:#fff;font-weight:bold">new</span> Object[]{req, res, <span style="color:#fff;font-weight:bold">this</span>};
</span></span><span style="display:flex;"><span>            SecurityUtil.<span style="color:#007f7f">doAsPrivilege</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#0ff;font-weight:bold">&#34;doFilter&#34;</span>, filter, classType, args, principal);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//è°ƒç”¨Filterçš„doFilter()æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            filter.<span style="color:#007f7f">doFilter</span>(request, response, <span style="color:#fff;font-weight:bold">this</span>);
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„filter.doFilter(request, response, this);å°±æ˜¯è°ƒç”¨æˆ‘ä»¬å‰é¢åˆ›å»ºçš„TestFilterä¸­çš„doFilter()æ–¹æ³•ã€‚
è€ŒTestFilterä¸­çš„doFilter()æ–¹æ³•ä¼šç»§ç»­è°ƒç”¨chain.doFilter(request, response);æ–¹æ³•ï¼Œè€Œè¿™ä¸ªchainå…¶å®å°±æ˜¯ApplicationFilterChain,æ‰€ä»¥è°ƒç”¨è¿‡ç¨‹åˆå›åˆ°äº†ä¸Šé¢è°ƒç”¨dofilterå’Œè°ƒç”¨internalDoFilteræ–¹æ³•ï¼Œè¿™æ ·æ‰§è¡Œç›´åˆ°é‡Œé¢çš„è¿‡æ»¤å™¨å…¨éƒ¨æ‰§è¡Œã€‚</p>
<p>å¦‚æœå®šä¹‰ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œåˆ™Debugç»“æœå¦‚ä¸‹ï¼š</p>
<p>tomcatä¸­çš„è´£ä»»é“¾å’Œä¸Šè¾¹è¯´çš„è´£ä»»é“¾è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚
å‰é¢è¯´çš„è´£ä»»é“¾ï¼Œæ˜¯é æ¯ä¸ªé“¾ä¸‹é¢æ”¾ç½®ä¸€ä¸ªè´£ä»»çš„å‚æ•°ï¼Œæ¥å®šä¹‰è´£ä»»çš„å…ˆåå¤„ç†é¡ºåºã€‚
tomcatçš„è´£ä»»é“¾åˆ™æ˜¯é€šè¿‡æ•°ç»„æ¥å®šä¹‰è´£ä»»çš„å…ˆåé¡ºåºï¼Œtomcatè´£ä»»é“¾çš„æ¨¡å¼æ›´ç±»ä¼¼è¿™æ ·ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">class</span> filterChain{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> List&lt;Filter&gt; filters;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> addFilter(Filter filter){
</span></span><span style="display:flex;"><span>         filters.<span style="color:#007f7f">add</span>(filter);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> do(HttpRequest request){
</span></span><span style="display:flex;"><span>         <span style="color:#fff;font-weight:bold">for</span>(Filter filter:filters){
</span></span><span style="display:flex;"><span>              filter.<span style="color:#007f7f">do</span>(request);
</span></span><span style="display:flex;"><span>         }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ConcreateFilter1 <span style="color:#fff;font-weight:bold">extends</span> Filter{
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> do(HttpRequest request){
</span></span><span style="display:flex;"><span>          <span style="color:#007f7f">//do something
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>      }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ConcreateFilter2 <span style="color:#fff;font-weight:bold">extends</span> Filter{
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> do(HttpRequest request){
</span></span><span style="display:flex;"><span>          <span style="color:#007f7f">//do something
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>      }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span>  Client{
</span></span><span style="display:flex;"><span>      <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args){
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>            HttpRequest request = .....
</span></span><span style="display:flex;"><span>            FilterChain filterChain = <span style="color:#fff;font-weight:bold">new</span> FilterChain();
</span></span><span style="display:flex;"><span>            filterChain.<span style="color:#007f7f">addFilter</span>(<span style="color:#fff;font-weight:bold">new</span> ConcreateFilter1());
</span></span><span style="display:flex;"><span>            filterChain.<span style="color:#007f7f">addFilter</span>(<span style="color:#fff;font-weight:bold">new</span> ConcreateFilter2());
</span></span><span style="display:flex;"><span>            filterChain.<span style="color:#007f7f">addFilter</span>(<span style="color:#fff;font-weight:bold">new</span> ConcreateFilter2());
</span></span><span style="display:flex;"><span>            filterChain.<span style="color:#007f7f">do</span>(request);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="9.png" alt=""  />

<a href="https://www.cnblogs.com/java-my-life/archive/2012/05/28/2516865.html">åŸæ–‡</a></p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/en/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://funny-toffee-4aa7c3.netlify.app/en/">Wjy&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
