<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ | Wjy&#39;s Blog</title>
<meta name="keywords" content="è®¾è®¡æ¨¡å¼">
<meta name="description" content="å¿«é€Ÿå­¦ä¹ 
ç±»å‹ï¼šè¡Œä¸ºå‹

å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚
">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/">
  <meta property="og:site_name" content="Wjy&#39;s Blog">
  <meta property="og:title" content="æ¨¡æ¿æ–¹æ³•æ¨¡å¼">
  <meta property="og:description" content="å¿«é€Ÿå­¦ä¹  ç±»å‹ï¼šè¡Œä¸ºå‹
å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-12-21T17:39:33+00:00">
    <meta property="article:modified_time" content="2018-12-21T17:39:33+00:00">
    <meta property="article:tag" content="è®¾è®¡æ¨¡å¼">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="æ¨¡æ¿æ–¹æ³•æ¨¡å¼">
<meta name="twitter:description" content="å¿«é€Ÿå­¦ä¹ 
ç±»å‹ï¼šè¡Œä¸ºå‹

å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "æ¨¡æ¿æ–¹æ³•æ¨¡å¼",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æ¨¡æ¿æ–¹æ³•æ¨¡å¼",
  "name": "æ¨¡æ¿æ–¹æ³•æ¨¡å¼",
  "description": "å¿«é€Ÿå­¦ä¹  ç±»å‹ï¼šè¡Œä¸ºå‹\nå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚\n",
  "keywords": [
    "è®¾è®¡æ¨¡å¼"
  ],
  "articleBody": "å¿«é€Ÿå­¦ä¹  ç±»å‹ï¼šè¡Œä¸ºå‹\nå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚\næ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¨¡å¼ã€‚å®ƒçš„ä¸»è¦æ€æƒ³æ˜¯ï¼Œå®šä¹‰ä¸€ä¸ªæ“ä½œçš„ä¸€ç³»åˆ—æ­¥éª¤ï¼Œå¯¹äºæŸäº›æš‚æ—¶ç¡®å®šä¸ä¸‹æ¥çš„æ­¥éª¤ï¼Œå°±ç•™ç»™å­ç±»å»å®ç°å¥½äº†ï¼Œè¿™æ ·ä¸åŒçš„å­ç±»å°±å¯ä»¥å®šä¹‰å‡ºä¸åŒçš„æ­¥éª¤ã€‚\nå› æ­¤ï¼Œæ¨¡æ¿æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºå®šä¹‰ä¸€ä¸ªâ€œéª¨æ¶â€ã€‚æˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¾‹è¯´æ˜ã€‚\nå‡è®¾æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªä»æ•°æ®åº“è¯»å–è®¾ç½®çš„ç±»ï¼š\n1 2 3 4 5 6 7 8 9 10 public class Setting { public final String getSetting(String key) { String value = readFromDatabase(key); return value; } private String readFromDatabase(String key) { // TODO: ä»æ•°æ®åº“è¯»å– } } ç”±äºä»æ•°æ®åº“è¯»å–æ•°æ®è¾ƒæ…¢ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠè¯»å–çš„è®¾ç½®ç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è¯»å–åŒæ ·çš„keyå°±ä¸å¿…å†è®¿é—®æ•°æ®åº“äº†ã€‚ä½†æ˜¯æ€ä¹ˆå®ç°ç¼“å­˜ï¼Œæš‚æ—¶æ²¡æƒ³å¥½ï¼Œä½†ä¸å¦¨ç¢æˆ‘ä»¬å…ˆå†™å‡ºä½¿ç”¨ç¼“å­˜çš„ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public class Setting { public final String getSetting(String key) { // å…ˆä»ç¼“å­˜è¯»å–: String value = lookupCache(key); if (value == null) { // åœ¨ç¼“å­˜ä¸­æœªæ‰¾åˆ°,ä»æ•°æ®åº“è¯»å–: value = readFromDatabase(key); System.out.println(\"[DEBUG] load from db: \" + key + \" = \" + value); // æ”¾å…¥ç¼“å­˜: putIntoCache(key, value); } else { System.out.println(\"[DEBUG] load from cache: \" + key + \" = \" + value); } return value; } } æ•´ä¸ªæµç¨‹æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ï¼ŒlookupCache(key)å’ŒputIntoCache(key, value)è¿™ä¸¤ä¸ªæ–¹æ³•è¿˜æ ¹æœ¬æ²¡å®ç°ï¼Œæ€ä¹ˆç¼–è¯‘é€šè¿‡ï¼Ÿè¿™ä¸ªä¸è¦ç´§ï¼Œæˆ‘ä»¬å£°æ˜æŠ½è±¡æ–¹æ³•å°±å¯ä»¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 public abstract class AbstractSetting { public final String getSetting(String key) { String value = lookupCache(key); if (value == null) { value = readFromDatabase(key); putIntoCache(key, value); } return value; } protected abstract String lookupCache(String key); protected abstract void putIntoCache(String key, String value); } å› ä¸ºå£°æ˜äº†æŠ½è±¡æ–¹æ³•ï¼Œè‡ªç„¶æ•´ä¸ªç±»ä¹Ÿå¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚å¦‚ä½•å®ç°lookupCache(key)å’ŒputIntoCache(key, value)è¿™ä¸¤ä¸ªæ–¹æ³•å°±äº¤ç»™å­ç±»äº†ã€‚å­ç±»å…¶å®å¹¶ä¸å…³å¿ƒæ ¸å¿ƒä»£ç getSetting(key)çš„é€»è¾‘ï¼Œå®ƒåªéœ€è¦å…³å¿ƒå¦‚ä½•å®Œæˆä¸¤ä¸ªå°å°çš„å­ä»»åŠ¡å°±å¯ä»¥äº†ã€‚\nå‡è®¾æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ªMapåšç¼“å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å†™ä¸€ä¸ªLocalSettingï¼š\n1 2 3 4 5 6 7 8 9 10 11 public class LocalSetting extends AbstractSetting { private Map cache = new HashMap\u003c\u003e(); protected String lookupCache(String key) { return cache.get(key); } protected void putIntoCache(String key, String value) { cache.put(key, value); } } å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨Redisåšç¼“å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å†å†™ä¸€ä¸ªRedisSettingï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public class RedisSetting extends AbstractSetting { private RedisClient client = RedisClient.create(\"redis://localhost:6379\"); protected String lookupCache(String key) { try (StatefulRedisConnection connection = client.connect()) { RedisCommands commands = connection.sync(); return commands.get(key); } } protected void putIntoCache(String key, String value) { try (StatefulRedisConnection connection = client.connect()) { RedisCommands commands = connection.sync(); commands.set(key, value); } } } å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„ä»£ç è¿™ä¹ˆå†™ï¼š\n1 2 3 AbstractSetting setting1 = new LocalSetting(); System.out.println(\"test = \" + setting1.getSetting(\"test\")); System.out.println(\"test = \" + setting1.getSetting(\"test\")); è¦æ”¹æˆRedisç¼“å­˜ï¼Œåªéœ€è¦æŠŠLocalSettingæ›¿æ¢ä¸ºRedisSettingï¼š\n1 2 3 AbstractSetting setting2 = new RedisSetting(); System.out.println(\"autosave = \" + setting2.getSetting(\"autosave\")); System.out.println(\"autosave = \" + setting2.getSetting(\"autosave\")); å¯è§ï¼Œæ¨¡æ¿æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šçˆ¶ç±»å®šä¹‰éª¨æ¶ï¼Œå­ç±»å®ç°æŸäº›ç»†èŠ‚ã€‚\nä¸ºäº†é˜²æ­¢å­ç±»é‡å†™çˆ¶ç±»çš„éª¨æ¶æ–¹æ³•ï¼Œå¯ä»¥åœ¨çˆ¶ç±»ä¸­å¯¹éª¨æ¶æ–¹æ³•ä½¿ç”¨finalã€‚å¯¹äºéœ€è¦å­ç±»å®ç°çš„æŠ½è±¡æ–¹æ³•ï¼Œä¸€èˆ¬å£°æ˜ä¸ºprotectedï¼Œä½¿å¾—è¿™äº›æ–¹æ³•å¯¹å¤–éƒ¨å®¢æˆ·ç«¯ä¸å¯è§ã€‚\nJavaæ ‡å‡†åº“ä¹Ÿæœ‰å¾ˆå¤šæ¨¡æ¿æ–¹æ³•çš„åº”ç”¨ã€‚åœ¨é›†åˆç±»ä¸­ï¼ŒAbstractListå’ŒAbstractQueuedSynchronizeréƒ½å®šä¹‰äº†å¾ˆå¤šé€šç”¨æ“ä½œï¼Œå­ç±»åªéœ€è¦å®ç°æŸäº›å¿…è¦æ–¹æ³•ã€‚\næ¦‚è¿° æ¨¡æ¿æ–¹æ³•æ¶‰åŠåˆ°ä¸¤ä¸ªè§’è‰²ï¼š\næŠ½è±¡æ¨¡æ¿\nå®šä¹‰äº†ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ“ä½œï¼Œä»¥ä¾¿è®©å­ç±»å®ç°ã€‚è¿™äº›æŠ½è±¡æ“ä½œå«åšåŸºæœ¬æ“ä½œï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚ å®šä¹‰å¹¶å®ç°äº†ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ã€‚è¿™ä¸ªæ¨¡æ¿æ–¹æ³•ä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„éª¨æ¶ï¼Œè€Œé€»è¾‘çš„ç»„æˆæ­¥éª¤åœ¨ç›¸åº”çš„æŠ½è±¡æ“ä½œä¸­ï¼Œæ¨è¿Ÿåˆ°å­ç±»å®ç°ã€‚é¡¶çº§é€»è¾‘ä¹Ÿæœ‰å¯èƒ½è°ƒç”¨ä¸€äº›å…·ä½“æ–¹æ³•ã€‚ å…·ä½“æ¨¡æ¿\nå®ç°çˆ¶ç±»æ‰€å®šä¹‰çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚ æ¯ä¸€ä¸ªæŠ½è±¡æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥æœ‰ä»»æ„å¤šä¸ªå…·ä½“æ¨¡æ¿è§’è‰²ä¸ä¹‹å¯¹åº”ï¼Œè€Œæ¯ä¸€ä¸ªå…·ä½“æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥ç»™å‡ºè¿™äº›æŠ½è±¡æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯é¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ï¼‰çš„ä¸åŒå®ç°ï¼Œä»è€Œä½¿å¾—é¡¶çº§é€»è¾‘çš„å®ç°å„ä¸ç›¸åŒã€‚ ç®€å•ç¤ºä¾‹ æŠ½è±¡æ¨¡æ¿è§’è‰²ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public abstract class AbstractTemplate { /** * æ¨¡æ¿æ–¹æ³• */ public void templateMethod(){ //è°ƒç”¨åŸºæœ¬æ–¹æ³• abstractMethod(); hookMethod(); concreteMethod(); } /** * åŸºæœ¬æ–¹æ³•çš„å£°æ˜ï¼ˆç”±å­ç±»å®ç°ï¼‰ */ protected abstract void abstractMethod(); /** * åŸºæœ¬æ–¹æ³•(ç©ºæ–¹æ³•) */ protected void hookMethod(){} /** * åŸºæœ¬æ–¹æ³•ï¼ˆå·²ç»å®ç°ï¼‰ */ private final void concreteMethod(){ //ä¸šåŠ¡ç›¸å…³çš„ä»£ç  } } å…·ä½“æ¨¡æ¿è§’è‰²ç±»ï¼Œå®ç°äº†çˆ¶ç±»æ‰€å£°æ˜çš„åŸºæœ¬æ–¹æ³•ï¼ŒabstractMethod()æ–¹æ³•æ‰€ä»£è¡¨çš„å°±æ˜¯å¼ºåˆ¶å­ç±»å®ç°çš„å‰©ä½™é€»è¾‘ï¼Œè€ŒhookMethod()æ–¹æ³•æ˜¯å¯é€‰æ‹©å®ç°çš„é€»è¾‘ï¼Œä¸æ˜¯å¿…é¡»å®ç°çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 public class ConcreteTemplate extends AbstractTemplate{ //åŸºæœ¬æ–¹æ³•çš„å®ç° @Override public void abstractMethod() { //ä¸šåŠ¡ç›¸å…³çš„ä»£ç  } //é‡å†™çˆ¶ç±»çš„æ–¹æ³• @Override public void hookMethod() { //ä¸šåŠ¡ç›¸å…³çš„ä»£ç  } } æ¨¡æ¿æ¨¡å¼çš„å…³é”®æ˜¯ï¼šå­ç±»å¯ä»¥ç½®æ¢æ‰çˆ¶ç±»çš„å¯å˜éƒ¨åˆ†ï¼Œä½†æ˜¯å­ç±»å´ä¸å¯ä»¥æ”¹å˜æ¨¡æ¿æ–¹æ³•æ‰€ä»£è¡¨çš„é¡¶çº§é€»è¾‘ã€‚æ¯å½“å®šä¹‰ä¸€ä¸ªæ–°çš„å­ç±»æ—¶ï¼Œä¸è¦æŒ‰ç…§æ§åˆ¶æµç¨‹çš„æ€è·¯å»æƒ³ï¼Œè€Œåº”å½“æŒ‰ç…§â€œè´£ä»»â€çš„æ€è·¯å»æƒ³ã€‚æ¢è¨€ä¹‹ï¼Œåº”å½“è€ƒè™‘å“ªäº›æ“ä½œæ˜¯å¿…é¡»ç½®æ¢æ‰çš„ï¼Œå“ªäº›æ“ä½œæ˜¯å¯ä»¥ç½®æ¢æ‰çš„ï¼Œä»¥åŠå“ªäº›æ“ä½œæ˜¯ä¸å¯ä»¥ç½®æ¢æ‰çš„ã€‚ä½¿ç”¨æ¨¡æ¿æ¨¡å¼å¯ä»¥ä½¿è¿™äº›è´£ä»»å˜å¾—æ¸…æ™°ã€‚\næ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³• æ¨¡æ¿æ–¹æ³•ä¸­çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ¨¡æ¿æ–¹æ³•å’ŒåŸºæœ¬æ–¹æ³•ã€‚\næ¨¡æ¿æ–¹æ³• ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ˜¯å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­çš„ï¼ŒæŠŠåŸºæœ¬æ“ä½œæ–¹æ³•ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ€»ç®—æ³•æˆ–ä¸€ä¸ªæ€»è¡Œä¸ºçš„æ–¹æ³•ã€‚ä¸€ä¸ªæŠ½è±¡ç±»å¯ä»¥æœ‰ä»»æ„å¤šä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œè€Œä¸é™äºä¸€ä¸ªã€‚æ¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•éƒ½å¯ä»¥è°ƒç”¨ä»»æ„å¤šä¸ªå…·ä½“æ–¹æ³•ã€‚\nåŸºæœ¬æ–¹æ³• åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼šæŠ½è±¡æ–¹æ³•(Abstract Method)ã€å…·ä½“æ–¹æ³•(Concrete Method)å’Œé’©å­æ–¹æ³•(Hook Method)ã€‚\næŠ½è±¡æ–¹æ³•ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ï¼Œç”±å…·ä½“å­ç±»å®ç°ã€‚åœ¨Javaè¯­è¨€é‡ŒæŠ½è±¡æ–¹æ³•ä»¥abstractå…³é”®å­—æ ‡ç¤ºã€‚ å…·ä½“æ–¹æ³•ï¼šä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ï¼Œè€Œå­ç±»å¹¶ä¸å®ç°æˆ–ç½®æ¢ã€‚ é’©å­æ–¹æ³•ï¼šä¸€ä¸ªé’©å­æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ï¼Œè€Œå­ç±»ä¼šåŠ ä»¥æ‰©å±•ã€‚é€šå¸¸æŠ½è±¡ç±»ç»™å‡ºçš„å®ç°æ˜¯ä¸€ä¸ªç©ºå®ç°ï¼Œä½œä¸ºæ–¹æ³•çš„é»˜è®¤å®ç°ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒAbstractTemplateæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¸¦æœ‰ä¸‰ä¸ªæ–¹æ³•ã€‚å…¶ä¸­abstractMethod()æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå¹¶ç”±å­ç±»å®ç°ï¼›hookMethod()æ˜¯ä¸€ä¸ªé’©å­æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜å¹¶æä¾›é»˜è®¤å®ç°ï¼Œå¹¶ä¸”ç”±å­ç±»ç½®æ¢æ‰ã€‚concreteMethod()æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ã€‚\né»˜è®¤é’©å­æ–¹æ³• ä¸€ä¸ªé’©å­æ–¹æ³•å¸¸å¸¸ç”±æŠ½è±¡ç±»ç»™å‡ºä¸€ä¸ªç©ºå®ç°ä½œä¸ºæ­¤æ–¹æ³•çš„é»˜è®¤å®ç°ã€‚è¿™ç§ç©ºçš„é’©å­æ–¹æ³•å«åš â€œDo Nothing Hookâ€ã€‚æ˜¾ç„¶ï¼Œè¿™ç§é»˜è®¤é’©å­æ–¹æ³•åœ¨ç¼ºçœé€‚é…æ¨¡å¼é‡Œé¢å·²ç»è§è¿‡äº†ï¼Œä¸€ä¸ªç¼ºçœé€‚é…æ¨¡å¼è®²çš„æ˜¯ä¸€ä¸ªç±»ä¸ºä¸€ä¸ªæ¥å£æä¾›ä¸€ä¸ªé»˜è®¤çš„ç©ºå®ç°ï¼Œä»è€Œä½¿å¾—ç¼ºçœé€‚é…ç±»çš„å­ç±»ä¸å¿…åƒå®ç°æ¥å£é‚£æ ·å¿…é¡»ç»™å‡ºæ‰€æœ‰æ–¹æ³•çš„å®ç°ï¼Œå› ä¸ºé€šå¸¸ä¸€ä¸ªå…·ä½“ç±»å¹¶ä¸éœ€è¦æ‰€æœ‰çš„æ–¹æ³•ã€‚\nå‘½åè§„åˆ™ å‘½åè§„åˆ™æ˜¯è®¾è®¡å¸ˆä¹‹é—´èµ–ä»¥æ²Ÿé€šçš„ç®¡é“ä¹‹ä¸€ï¼Œä½¿ç”¨æ°å½“çš„å‘½åè§„åˆ™å¯ä»¥å¸®åŠ©ä¸åŒè®¾è®¡å¸ˆä¹‹é—´çš„æ²Ÿé€šã€‚é’©å­æ–¹æ³•çš„åå­—åº”å½“ä»¥doå¼€å§‹ï¼Œè¿™æ˜¯ç†Ÿæ‚‰è®¾è®¡æ¨¡å¼çš„Javaå¼€å‘äººå‘˜çš„æ ‡å‡†åšæ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé’©å­æ–¹æ³•hookMethod()åº”å½“ä»¥doå¼€å¤´ï¼›åœ¨HttpServletç±»ä¸­ï¼Œä¹Ÿéµä»è¿™ä¸€å‘½åè§„åˆ™ï¼Œå¦‚doGet()ã€doPost()ç­‰æ–¹æ³•ã€‚\nä½¿ç”¨åœºæ™¯ è€ƒè™‘ä¸€ä¸ªè®¡ç®—å­˜æ¬¾åˆ©æ¯çš„ä¾‹å­ã€‚å‡è®¾ç³»ç»Ÿéœ€è¦æ”¯æŒä¸¤ç§å­˜æ¬¾è´¦å·ï¼Œå³è´§å¸å¸‚åœº(Money Market)è´¦å·å’Œå®šæœŸå­˜æ¬¾(Certificate of Deposite)è´¦å·ã€‚è¿™ä¸¤ç§è´¦å·çš„å­˜æ¬¾åˆ©æ¯æ˜¯ä¸åŒçš„ï¼Œå› æ­¤ï¼Œåœ¨è®¡ç®—ä¸€ä¸ªå­˜æˆ·çš„å­˜æ¬¾åˆ©æ¯é¢æ—¶ï¼Œå¿…é¡»åŒºåˆ†ä¸¤ç§ä¸åŒçš„è´¦å·ç±»å‹ã€‚\nè¿™ä¸ªç³»ç»Ÿçš„æ€»è¡Œä¸ºåº”å½“æ˜¯è®¡ç®—å‡ºåˆ©æ¯ï¼Œè¿™ä¹Ÿå°±å†³å®šäº†ä½œä¸ºä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é¡¶çº§é€»è¾‘åº”å½“æ˜¯åˆ©æ¯è®¡ç®—ã€‚ç”±äºåˆ©æ¯è®¡ç®—æ¶‰åŠåˆ°ä¸¤ä¸ªæ­¥éª¤ï¼šä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºè´¦å·ç§ç±»ï¼Œå¦ä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºåˆ©æ¯ç™¾åˆ†æ¯”ã€‚è¿™ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•æ„æˆå…·ä½“é€»è¾‘ï¼Œå› ä¸ºè´¦å·çš„ç±»å‹ä¸åŒï¼Œæ‰€ä»¥å…·ä½“é€»è¾‘ä¼šæœ‰æ‰€ä¸åŒã€‚\næ˜¾ç„¶ï¼Œç³»ç»Ÿéœ€è¦ä¸€ä¸ªæŠ½è±¡è§’è‰²ç»™å‡ºé¡¶çº§è¡Œä¸ºçš„å®ç°ï¼Œè€Œå°†ä¸¤ä¸ªä½œä¸ºç»†èŠ‚æ­¥éª¤çš„åŸºæœ¬æ–¹æ³•ç•™ç»™å…·ä½“å­ç±»å®ç°ã€‚ç”±äºéœ€è¦è€ƒè™‘çš„è´¦å·æœ‰ä¸¤ç§ï¼šä¸€æ˜¯è´§å¸å¸‚åœºè´¦å·ï¼ŒäºŒæ˜¯å®šæœŸå­˜æ¬¾è´¦å·ã€‚\næŠ½è±¡æ¨¡æ¿è§’è‰²ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 public abstract class Account { /** * æ¨¡æ¿æ–¹æ³•ï¼Œè®¡ç®—åˆ©æ¯æ•°é¢ * @return è¿”å›åˆ©æ¯æ•°é¢ */ public final double calculateInterest(){ double interestRate = doCalculateInterestRate(); String accountType = doCalculateAccountType(); double amount = calculateAmount(accountType); return amount * interestRate; } /** * åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®ç° */ protected abstract String doCalculateAccountType(); /** * åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®ç° */ protected abstract double doCalculateInterestRate(); /** * åŸºæœ¬æ–¹æ³•ï¼Œå·²ç»å®ç° */ private double calculateAmount(String accountType){ /** * çœç•¥ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ */ return 7243.00; } } å…·ä½“æ¨¡æ¿è§’è‰²ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 public class MoneyMarketAccount extends Account { @Override protected String doCalculateAccountType() { return \"Money Market\"; } @Override protected double doCalculateInterestRate() { return 0.045; } } public class CDAccount extends Account { @Override protected String doCalculateAccountType() { return \"Certificate of Deposite\"; } @Override protected double doCalculateInterestRate() { return 0.06; } } å®¢æˆ·ç«¯ç±»\n1 2 3 4 5 6 7 8 9 10 public class Client { public static void main(String[] args) { Account account = new MoneyMarketAccount(); System.out.println(\"è´§å¸å¸‚åœºè´¦å·çš„åˆ©æ¯æ•°é¢ä¸ºï¼š\" + account.calculateInterest()); account = new CDAccount(); System.out.println(\"å®šæœŸè´¦å·çš„åˆ©æ¯æ•°é¢ä¸ºï¼š\" + account.calculateInterest()); } } æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨Servletä¸­çš„åº”ç”¨ ä½¿ç”¨è¿‡Servletçš„äººéƒ½æ¸…æ¥šï¼Œé™¤äº†è¦åœ¨web.xmlåšç›¸åº”çš„é…ç½®å¤–ï¼Œè¿˜éœ€ç»§æ‰¿ä¸€ä¸ªå« HttpServlet çš„æŠ½è±¡ç±»ã€‚HttpServlet ç±»æä¾›äº†ä¸€ä¸ªservice()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è°ƒç”¨ä¸ƒä¸ªdoæ–¹æ³•ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªï¼Œå®Œæˆå¯¹å®¢æˆ·ç«¯è°ƒç”¨çš„å“åº”ã€‚è¿™äº›doæ–¹æ³•éœ€è¦ç”±HttpServletçš„å…·ä½“å­ç±»æä¾›ï¼Œå› æ­¤è¿™æ˜¯å…¸å‹çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ ä¸‹é¢æ˜¯service()æ–¹æ³•çš„æºä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { String method = req.getMethod(); if (method.equals(METHOD_GET)) { long lastModified = getLastModified(req); if (lastModified == -1) { // servlet doesn't support if-modified-since, no reason // to go through further expensive logic doGet(req, resp); } else { long ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE); if (ifModifiedSince \u003c (lastModified / 1000 * 1000)) { // If the servlet mod time is later, call doGet() // Round down to the nearest second for a proper compare // A ifModifiedSince of -1 will always be less maybeSetLastModified(resp, lastModified); doGet(req, resp); } else { resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED); } } } else if (method.equals(METHOD_HEAD)) { long lastModified = getLastModified(req); maybeSetLastModified(resp, lastModified); doHead(req, resp); } else if (method.equals(METHOD_POST)) { doPost(req, resp); } else if (method.equals(METHOD_PUT)) { doPut(req, resp); } else if (method.equals(METHOD_DELETE)) { doDelete(req, resp); } else if (method.equals(METHOD_OPTIONS)) { doOptions(req,resp); } else if (method.equals(METHOD_TRACE)) { doTrace(req,resp); } else { // // Note that this means NO servlet supports whatever // method was requested, anywhere on this server. // String errMsg = lStrings.getString(\"http.method_not_implemented\"); Object[] errArgs = new Object[1]; errArgs[0] = method; errMsg = MessageFormat.format(errMsg, errArgs); resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg); } } å½“ç„¶ï¼Œè¿™ä¸ªservice()æ–¹æ³•ä¹Ÿå¯ä»¥è¢«å­ç±»ç½®æ¢æ‰ã€‚ ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„Servletä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public class TestServlet extends HttpServlet { public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { System.out.println(\"using the GET method\"); } public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { System.out.println(\"using the POST method\"); } } ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ HttpServletæ‹…ä»»æŠ½è±¡æ¨¡æ¿è§’è‰² æ¨¡æ¿æ–¹æ³•ï¼šç”±service()æ–¹æ³•æ‹…ä»»ã€‚ åŸºæœ¬æ–¹æ³•ï¼šç”±doPost()ã€doGet()ç­‰æ–¹æ³•æ‹…ä»»ã€‚ TestServletæ‹…ä»»å…·ä½“æ¨¡æ¿è§’è‰² TestServletç½®æ¢æ‰äº†çˆ¶ç±»HttpServletä¸­ä¸ƒä¸ªåŸºæœ¬æ–¹æ³•ä¸­çš„å…¶ä¸­ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯doGet()å’ŒdoPost()ã€‚\nå‚è€ƒ å‚è€ƒ\n",
  "wordCount" : "4156",
  "inLanguage": "en",
  "datePublished": "2018-12-21T17:39:33Z",
  "dateModified": "2018-12-21T17:39:33Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/en/posts/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.min.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/en/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/en/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      æ¨¡æ¿æ–¹æ³•æ¨¡å¼
    </h1>
    <div class="post-meta"><span title='2018-12-21 17:39:33 +0000 UTC'>2018-12-21</span>&nbsp;Â·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%ad%a6%e4%b9%a0" aria-label="å¿«é€Ÿå­¦ä¹ ">å¿«é€Ÿå­¦ä¹ </a></li>
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="æ¦‚è¿°">æ¦‚è¿°</a></li>
                <li>
                    <a href="#%e7%ae%80%e5%8d%95%e7%a4%ba%e4%be%8b" aria-label="ç®€å•ç¤ºä¾‹">ç®€å•ç¤ºä¾‹</a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e6%96%b9%e6%b3%95%e6%a8%a1%e5%bc%8f%e4%b8%ad%e7%9a%84%e6%96%b9%e6%b3%95" aria-label="æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•">æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•</a><ul>
                        
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e6%96%b9%e6%b3%95" aria-label="æ¨¡æ¿æ–¹æ³•">æ¨¡æ¿æ–¹æ³•</a></li>
                <li>
                    <a href="#%e5%9f%ba%e6%9c%ac%e6%96%b9%e6%b3%95" aria-label="åŸºæœ¬æ–¹æ³•">åŸºæœ¬æ–¹æ³•</a></li>
                <li>
                    <a href="#%e9%bb%98%e8%ae%a4%e9%92%a9%e5%ad%90%e6%96%b9%e6%b3%95" aria-label="é»˜è®¤é’©å­æ–¹æ³•">é»˜è®¤é’©å­æ–¹æ³•</a></li>
                <li>
                    <a href="#%e5%91%bd%e5%90%8d%e8%a7%84%e5%88%99" aria-label="å‘½åè§„åˆ™">å‘½åè§„åˆ™</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af" aria-label="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e6%96%b9%e6%b3%95%e6%a8%a1%e5%bc%8f%e5%9c%a8servlet%e4%b8%ad%e7%9a%84%e5%ba%94%e7%94%a8" aria-label="æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨Servletä¸­çš„åº”ç”¨">æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨Servletä¸­çš„åº”ç”¨</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="å¿«é€Ÿå­¦ä¹ ">å¿«é€Ÿå­¦ä¹ <a hidden class="anchor" aria-hidden="true" href="#å¿«é€Ÿå­¦ä¹ ">#</a></h1>
<p>ç±»å‹ï¼šè¡Œä¸ºå‹</p>
<blockquote>
<p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p>
</blockquote>
<p>æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¨¡å¼ã€‚å®ƒçš„ä¸»è¦æ€æƒ³æ˜¯ï¼Œå®šä¹‰ä¸€ä¸ªæ“ä½œçš„ä¸€ç³»åˆ—æ­¥éª¤ï¼Œå¯¹äºæŸäº›æš‚æ—¶ç¡®å®šä¸ä¸‹æ¥çš„æ­¥éª¤ï¼Œå°±ç•™ç»™å­ç±»å»å®ç°å¥½äº†ï¼Œè¿™æ ·ä¸åŒçš„å­ç±»å°±å¯ä»¥å®šä¹‰å‡ºä¸åŒçš„æ­¥éª¤ã€‚</p>
<p>å› æ­¤ï¼Œæ¨¡æ¿æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºå®šä¹‰ä¸€ä¸ªâ€œéª¨æ¶â€ã€‚æˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¾‹è¯´æ˜ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªä»æ•°æ®åº“è¯»å–è®¾ç½®çš„ç±»ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Setting {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">final</span> String getSetting(String key) {
</span></span><span style="display:flex;"><span>        String value = readFromDatabase(key);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">private</span> String readFromDatabase(String key) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// TODO: ä»æ•°æ®åº“è¯»å–</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºä»æ•°æ®åº“è¯»å–æ•°æ®è¾ƒæ…¢ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠè¯»å–çš„è®¾ç½®ç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è¯»å–åŒæ ·çš„keyå°±ä¸å¿…å†è®¿é—®æ•°æ®åº“äº†ã€‚ä½†æ˜¯æ€ä¹ˆå®ç°ç¼“å­˜ï¼Œæš‚æ—¶æ²¡æƒ³å¥½ï¼Œä½†ä¸å¦¨ç¢æˆ‘ä»¬å…ˆå†™å‡ºä½¿ç”¨ç¼“å­˜çš„ä»£ç ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Setting {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">final</span> String getSetting(String key) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å…ˆä»ç¼“å­˜è¯»å–:</span>
</span></span><span style="display:flex;"><span>        String value = lookupCache(key);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (value == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// åœ¨ç¼“å­˜ä¸­æœªæ‰¾åˆ°,ä»æ•°æ®åº“è¯»å–:</span>
</span></span><span style="display:flex;"><span>            value = readFromDatabase(key);
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;[DEBUG] load from db: &#34;</span> + key + <span style="color:#0ff;font-weight:bold">&#34; = &#34;</span> + value);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ”¾å…¥ç¼“å­˜:</span>
</span></span><span style="display:flex;"><span>            putIntoCache(key, value);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;[DEBUG] load from cache: &#34;</span> + key + <span style="color:#0ff;font-weight:bold">&#34; = &#34;</span> + value);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•´ä¸ªæµç¨‹æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ï¼Œ<code>lookupCache(key)</code>å’Œ<code>putIntoCache(key, value)</code>è¿™ä¸¤ä¸ªæ–¹æ³•è¿˜æ ¹æœ¬æ²¡å®ç°ï¼Œæ€ä¹ˆç¼–è¯‘é€šè¿‡ï¼Ÿè¿™ä¸ªä¸è¦ç´§ï¼Œæˆ‘ä»¬å£°æ˜æŠ½è±¡æ–¹æ³•å°±å¯ä»¥ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> AbstractSetting {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">final</span> String getSetting(String key) {
</span></span><span style="display:flex;"><span>        String value = lookupCache(key);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (value == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>            value = readFromDatabase(key);
</span></span><span style="display:flex;"><span>            putIntoCache(key, value);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">abstract</span> String lookupCache(String key);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">void</span> putIntoCache(String key, String value);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºå£°æ˜äº†æŠ½è±¡æ–¹æ³•ï¼Œè‡ªç„¶æ•´ä¸ªç±»ä¹Ÿå¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚å¦‚ä½•å®ç°<code>lookupCache(key)</code>å’Œ<code>putIntoCache(key, value)</code>è¿™ä¸¤ä¸ªæ–¹æ³•å°±äº¤ç»™å­ç±»äº†ã€‚å­ç±»å…¶å®å¹¶ä¸å…³å¿ƒæ ¸å¿ƒä»£ç <code>getSetting(key)</code>çš„é€»è¾‘ï¼Œå®ƒåªéœ€è¦å…³å¿ƒå¦‚ä½•å®Œæˆä¸¤ä¸ªå°å°çš„å­ä»»åŠ¡å°±å¯ä»¥äº†ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ª<code>Map</code>åšç¼“å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å†™ä¸€ä¸ª<code>LocalSetting</code>ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> LocalSetting <span style="color:#fff;font-weight:bold">extends</span> AbstractSetting {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> Map&lt;String, String&gt; cache = <span style="color:#fff;font-weight:bold">new</span> HashMap&lt;&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> String lookupCache(String key) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> cache.<span style="color:#007f7f">get</span>(key);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> putIntoCache(String key, String value) {
</span></span><span style="display:flex;"><span>        cache.<span style="color:#007f7f">put</span>(key, value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨Redisåšç¼“å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å†å†™ä¸€ä¸ª<code>RedisSetting</code>ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedisSetting <span style="color:#fff;font-weight:bold">extends</span> AbstractSetting {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> RedisClient client = RedisClient.<span style="color:#007f7f">create</span>(<span style="color:#0ff;font-weight:bold">&#34;redis://localhost:6379&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> String lookupCache(String key) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> (StatefulRedisConnection&lt;String, String&gt; connection = client.<span style="color:#007f7f">connect</span>()) {
</span></span><span style="display:flex;"><span>            RedisCommands&lt;String, String&gt; commands = connection.<span style="color:#007f7f">sync</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> commands.<span style="color:#007f7f">get</span>(key);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> putIntoCache(String key, String value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> (StatefulRedisConnection&lt;String, String&gt; connection = client.<span style="color:#007f7f">connect</span>()) {
</span></span><span style="display:flex;"><span>            RedisCommands&lt;String, String&gt; commands = connection.<span style="color:#007f7f">sync</span>();
</span></span><span style="display:flex;"><span>            commands.<span style="color:#007f7f">set</span>(key, value);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„ä»£ç è¿™ä¹ˆå†™ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>AbstractSetting setting1 = <span style="color:#fff;font-weight:bold">new</span> LocalSetting();
</span></span><span style="display:flex;"><span>System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test = &#34;</span> + setting1.<span style="color:#007f7f">getSetting</span>(<span style="color:#0ff;font-weight:bold">&#34;test&#34;</span>));
</span></span><span style="display:flex;"><span>System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;test = &#34;</span> + setting1.<span style="color:#007f7f">getSetting</span>(<span style="color:#0ff;font-weight:bold">&#34;test&#34;</span>));
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¦æ”¹æˆRedisç¼“å­˜ï¼Œåªéœ€è¦æŠŠ<code>LocalSetting</code>æ›¿æ¢ä¸º<code>RedisSetting</code>ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>AbstractSetting setting2 = <span style="color:#fff;font-weight:bold">new</span> RedisSetting();
</span></span><span style="display:flex;"><span>System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;autosave = &#34;</span> + setting2.<span style="color:#007f7f">getSetting</span>(<span style="color:#0ff;font-weight:bold">&#34;autosave&#34;</span>));
</span></span><span style="display:flex;"><span>System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;autosave = &#34;</span> + setting2.<span style="color:#007f7f">getSetting</span>(<span style="color:#0ff;font-weight:bold">&#34;autosave&#34;</span>));
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯è§ï¼Œæ¨¡æ¿æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šçˆ¶ç±»å®šä¹‰éª¨æ¶ï¼Œå­ç±»å®ç°æŸäº›ç»†èŠ‚ã€‚</p>
<p>ä¸ºäº†é˜²æ­¢å­ç±»é‡å†™çˆ¶ç±»çš„éª¨æ¶æ–¹æ³•ï¼Œå¯ä»¥åœ¨çˆ¶ç±»ä¸­å¯¹éª¨æ¶æ–¹æ³•ä½¿ç”¨<code>final</code>ã€‚å¯¹äºéœ€è¦å­ç±»å®ç°çš„æŠ½è±¡æ–¹æ³•ï¼Œä¸€èˆ¬å£°æ˜ä¸º<code>protected</code>ï¼Œä½¿å¾—è¿™äº›æ–¹æ³•å¯¹å¤–éƒ¨å®¢æˆ·ç«¯ä¸å¯è§ã€‚</p>
<p>Javaæ ‡å‡†åº“ä¹Ÿæœ‰å¾ˆå¤šæ¨¡æ¿æ–¹æ³•çš„åº”ç”¨ã€‚åœ¨é›†åˆç±»ä¸­ï¼Œ<code>AbstractList</code>å’Œ<code>AbstractQueuedSynchronizer</code>éƒ½å®šä¹‰äº†å¾ˆå¤šé€šç”¨æ“ä½œï¼Œå­ç±»åªéœ€è¦å®ç°æŸäº›å¿…è¦æ–¹æ³•ã€‚</p>
<h1 id="æ¦‚è¿°">æ¦‚è¿°<a hidden class="anchor" aria-hidden="true" href="#æ¦‚è¿°">#</a></h1>
<p>æ¨¡æ¿æ–¹æ³•æ¶‰åŠåˆ°ä¸¤ä¸ªè§’è‰²ï¼š</p>
<p>æŠ½è±¡æ¨¡æ¿</p>
<ul>
<li>å®šä¹‰äº†ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ“ä½œï¼Œä»¥ä¾¿è®©å­ç±»å®ç°ã€‚è¿™äº›æŠ½è±¡æ“ä½œå«åšåŸºæœ¬æ“ä½œï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚</li>
<li>å®šä¹‰å¹¶å®ç°äº†ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ã€‚è¿™ä¸ªæ¨¡æ¿æ–¹æ³•ä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„éª¨æ¶ï¼Œè€Œé€»è¾‘çš„ç»„æˆæ­¥éª¤åœ¨ç›¸åº”çš„æŠ½è±¡æ“ä½œä¸­ï¼Œæ¨è¿Ÿåˆ°å­ç±»å®ç°ã€‚é¡¶çº§é€»è¾‘ä¹Ÿæœ‰å¯èƒ½è°ƒç”¨ä¸€äº›å…·ä½“æ–¹æ³•ã€‚</li>
</ul>
<p>å…·ä½“æ¨¡æ¿</p>
<ul>
<li>å®ç°çˆ¶ç±»æ‰€å®šä¹‰çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚</li>
<li>æ¯ä¸€ä¸ªæŠ½è±¡æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥æœ‰ä»»æ„å¤šä¸ªå…·ä½“æ¨¡æ¿è§’è‰²ä¸ä¹‹å¯¹åº”ï¼Œè€Œæ¯ä¸€ä¸ªå…·ä½“æ¨¡æ¿è§’è‰²éƒ½å¯ä»¥ç»™å‡ºè¿™äº›æŠ½è±¡æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯é¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ï¼‰çš„ä¸åŒå®ç°ï¼Œä»è€Œä½¿å¾—é¡¶çº§é€»è¾‘çš„å®ç°å„ä¸ç›¸åŒã€‚</li>
</ul>
<h1 id="ç®€å•ç¤ºä¾‹">ç®€å•ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#ç®€å•ç¤ºä¾‹">#</a></h1>
<p>æŠ½è±¡æ¨¡æ¿è§’è‰²ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> AbstractTemplate {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ¨¡æ¿æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> templateMethod(){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//è°ƒç”¨åŸºæœ¬æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>        abstractMethod();
</span></span><span style="display:flex;"><span>        hookMethod();
</span></span><span style="display:flex;"><span>        concreteMethod();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•çš„å£°æ˜ï¼ˆç”±å­ç±»å®ç°ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">void</span> abstractMethod();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•(ç©ºæ–¹æ³•)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> hookMethod(){}
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•ï¼ˆå·²ç»å®ç°ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">void</span> concreteMethod(){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä¸šåŠ¡ç›¸å…³çš„ä»£ç </span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“æ¨¡æ¿è§’è‰²ç±»ï¼Œå®ç°äº†çˆ¶ç±»æ‰€å£°æ˜çš„åŸºæœ¬æ–¹æ³•ï¼ŒabstractMethod()æ–¹æ³•æ‰€ä»£è¡¨çš„å°±æ˜¯å¼ºåˆ¶å­ç±»å®ç°çš„å‰©ä½™é€»è¾‘ï¼Œè€ŒhookMethod()æ–¹æ³•æ˜¯å¯é€‰æ‹©å®ç°çš„é€»è¾‘ï¼Œä¸æ˜¯å¿…é¡»å®ç°çš„ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ConcreteTemplate <span style="color:#fff;font-weight:bold">extends</span> AbstractTemplate{
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//åŸºæœ¬æ–¹æ³•çš„å®ç°</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> abstractMethod() {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä¸šåŠ¡ç›¸å…³çš„ä»£ç </span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//é‡å†™çˆ¶ç±»çš„æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> hookMethod() {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä¸šåŠ¡ç›¸å…³çš„ä»£ç </span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¨¡æ¿æ¨¡å¼çš„å…³é”®æ˜¯ï¼šå­ç±»å¯ä»¥ç½®æ¢æ‰çˆ¶ç±»çš„å¯å˜éƒ¨åˆ†ï¼Œä½†æ˜¯å­ç±»å´ä¸å¯ä»¥æ”¹å˜æ¨¡æ¿æ–¹æ³•æ‰€ä»£è¡¨çš„é¡¶çº§é€»è¾‘ã€‚æ¯å½“å®šä¹‰ä¸€ä¸ªæ–°çš„å­ç±»æ—¶ï¼Œä¸è¦æŒ‰ç…§æ§åˆ¶æµç¨‹çš„æ€è·¯å»æƒ³ï¼Œè€Œåº”å½“æŒ‰ç…§â€œè´£ä»»â€çš„æ€è·¯å»æƒ³ã€‚æ¢è¨€ä¹‹ï¼Œåº”å½“è€ƒè™‘å“ªäº›æ“ä½œæ˜¯å¿…é¡»ç½®æ¢æ‰çš„ï¼Œå“ªäº›æ“ä½œæ˜¯å¯ä»¥ç½®æ¢æ‰çš„ï¼Œä»¥åŠå“ªäº›æ“ä½œæ˜¯ä¸å¯ä»¥ç½®æ¢æ‰çš„ã€‚ä½¿ç”¨æ¨¡æ¿æ¨¡å¼å¯ä»¥ä½¿è¿™äº›è´£ä»»å˜å¾—æ¸…æ™°ã€‚</p>
<h1 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•">æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•">#</a></h1>
<p>æ¨¡æ¿æ–¹æ³•ä¸­çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ¨¡æ¿æ–¹æ³•å’ŒåŸºæœ¬æ–¹æ³•ã€‚</p>
<h2 id="æ¨¡æ¿æ–¹æ³•">æ¨¡æ¿æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#æ¨¡æ¿æ–¹æ³•">#</a></h2>
<p>ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ˜¯å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­çš„ï¼ŒæŠŠåŸºæœ¬æ“ä½œæ–¹æ³•ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ€»ç®—æ³•æˆ–ä¸€ä¸ªæ€»è¡Œä¸ºçš„æ–¹æ³•ã€‚ä¸€ä¸ªæŠ½è±¡ç±»å¯ä»¥æœ‰ä»»æ„å¤šä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œè€Œä¸é™äºä¸€ä¸ªã€‚æ¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•éƒ½å¯ä»¥è°ƒç”¨ä»»æ„å¤šä¸ªå…·ä½“æ–¹æ³•ã€‚</p>
<h2 id="åŸºæœ¬æ–¹æ³•">åŸºæœ¬æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#åŸºæœ¬æ–¹æ³•">#</a></h2>
<p>åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼šæŠ½è±¡æ–¹æ³•(Abstract Method)ã€å…·ä½“æ–¹æ³•(Concrete Method)å’Œé’©å­æ–¹æ³•(Hook Method)ã€‚</p>
<ul>
<li>æŠ½è±¡æ–¹æ³•ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ï¼Œç”±å…·ä½“å­ç±»å®ç°ã€‚åœ¨Javaè¯­è¨€é‡ŒæŠ½è±¡æ–¹æ³•ä»¥abstractå…³é”®å­—æ ‡ç¤ºã€‚</li>
<li>å…·ä½“æ–¹æ³•ï¼šä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ï¼Œè€Œå­ç±»å¹¶ä¸å®ç°æˆ–ç½®æ¢ã€‚</li>
<li>é’©å­æ–¹æ³•ï¼šä¸€ä¸ªé’©å­æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ï¼Œè€Œå­ç±»ä¼šåŠ ä»¥æ‰©å±•ã€‚é€šå¸¸æŠ½è±¡ç±»ç»™å‡ºçš„å®ç°æ˜¯ä¸€ä¸ªç©ºå®ç°ï¼Œä½œä¸ºæ–¹æ³•çš„é»˜è®¤å®ç°ã€‚</li>
</ul>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒAbstractTemplateæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¸¦æœ‰ä¸‰ä¸ªæ–¹æ³•ã€‚å…¶ä¸­abstractMethod()æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå¹¶ç”±å­ç±»å®ç°ï¼›hookMethod()æ˜¯ä¸€ä¸ªé’©å­æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜å¹¶æä¾›é»˜è®¤å®ç°ï¼Œå¹¶ä¸”ç”±å­ç±»ç½®æ¢æ‰ã€‚concreteMethod()æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç”±æŠ½è±¡ç±»å£°æ˜å¹¶å®ç°ã€‚</p>
<h2 id="é»˜è®¤é’©å­æ–¹æ³•">é»˜è®¤é’©å­æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#é»˜è®¤é’©å­æ–¹æ³•">#</a></h2>
<p>ä¸€ä¸ªé’©å­æ–¹æ³•å¸¸å¸¸ç”±æŠ½è±¡ç±»ç»™å‡ºä¸€ä¸ªç©ºå®ç°ä½œä¸ºæ­¤æ–¹æ³•çš„é»˜è®¤å®ç°ã€‚è¿™ç§ç©ºçš„é’©å­æ–¹æ³•å«åš
â€œDo Nothing Hookâ€ã€‚æ˜¾ç„¶ï¼Œè¿™ç§é»˜è®¤é’©å­æ–¹æ³•åœ¨ç¼ºçœé€‚é…æ¨¡å¼é‡Œé¢å·²ç»è§è¿‡äº†ï¼Œä¸€ä¸ªç¼ºçœé€‚é…æ¨¡å¼è®²çš„æ˜¯ä¸€ä¸ªç±»ä¸ºä¸€ä¸ªæ¥å£æä¾›ä¸€ä¸ªé»˜è®¤çš„ç©ºå®ç°ï¼Œä»è€Œä½¿å¾—ç¼ºçœé€‚é…ç±»çš„å­ç±»ä¸å¿…åƒå®ç°æ¥å£é‚£æ ·å¿…é¡»ç»™å‡ºæ‰€æœ‰æ–¹æ³•çš„å®ç°ï¼Œå› ä¸ºé€šå¸¸ä¸€ä¸ªå…·ä½“ç±»å¹¶ä¸éœ€è¦æ‰€æœ‰çš„æ–¹æ³•ã€‚</p>
<h2 id="å‘½åè§„åˆ™">å‘½åè§„åˆ™<a hidden class="anchor" aria-hidden="true" href="#å‘½åè§„åˆ™">#</a></h2>
<p>å‘½åè§„åˆ™æ˜¯è®¾è®¡å¸ˆä¹‹é—´èµ–ä»¥æ²Ÿé€šçš„ç®¡é“ä¹‹ä¸€ï¼Œä½¿ç”¨æ°å½“çš„å‘½åè§„åˆ™å¯ä»¥å¸®åŠ©ä¸åŒè®¾è®¡å¸ˆä¹‹é—´çš„æ²Ÿé€šã€‚é’©å­æ–¹æ³•çš„åå­—åº”å½“ä»¥doå¼€å§‹ï¼Œè¿™æ˜¯ç†Ÿæ‚‰è®¾è®¡æ¨¡å¼çš„Javaå¼€å‘äººå‘˜çš„æ ‡å‡†åšæ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé’©å­æ–¹æ³•hookMethod()åº”å½“ä»¥doå¼€å¤´ï¼›åœ¨HttpServletç±»ä¸­ï¼Œä¹Ÿéµä»è¿™ä¸€å‘½åè§„åˆ™ï¼Œå¦‚doGet()ã€doPost()ç­‰æ–¹æ³•ã€‚</p>
<h1 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯<a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨åœºæ™¯">#</a></h1>
<p>è€ƒè™‘ä¸€ä¸ªè®¡ç®—å­˜æ¬¾åˆ©æ¯çš„ä¾‹å­ã€‚å‡è®¾ç³»ç»Ÿéœ€è¦æ”¯æŒä¸¤ç§å­˜æ¬¾è´¦å·ï¼Œå³è´§å¸å¸‚åœº(Money Market)è´¦å·å’Œå®šæœŸå­˜æ¬¾(Certificate of Deposite)è´¦å·ã€‚è¿™ä¸¤ç§è´¦å·çš„å­˜æ¬¾åˆ©æ¯æ˜¯ä¸åŒçš„ï¼Œå› æ­¤ï¼Œåœ¨è®¡ç®—ä¸€ä¸ªå­˜æˆ·çš„å­˜æ¬¾åˆ©æ¯é¢æ—¶ï¼Œå¿…é¡»åŒºåˆ†ä¸¤ç§ä¸åŒçš„è´¦å·ç±»å‹ã€‚</p>
<p>è¿™ä¸ªç³»ç»Ÿçš„æ€»è¡Œä¸ºåº”å½“æ˜¯è®¡ç®—å‡ºåˆ©æ¯ï¼Œè¿™ä¹Ÿå°±å†³å®šäº†ä½œä¸ºä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é¡¶çº§é€»è¾‘åº”å½“æ˜¯åˆ©æ¯è®¡ç®—ã€‚ç”±äºåˆ©æ¯è®¡ç®—æ¶‰åŠåˆ°ä¸¤ä¸ªæ­¥éª¤ï¼šä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºè´¦å·ç§ç±»ï¼Œå¦ä¸€ä¸ªåŸºæœ¬æ–¹æ³•ç»™å‡ºåˆ©æ¯ç™¾åˆ†æ¯”ã€‚è¿™ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•æ„æˆå…·ä½“é€»è¾‘ï¼Œå› ä¸ºè´¦å·çš„ç±»å‹ä¸åŒï¼Œæ‰€ä»¥å…·ä½“é€»è¾‘ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<p>æ˜¾ç„¶ï¼Œç³»ç»Ÿéœ€è¦ä¸€ä¸ªæŠ½è±¡è§’è‰²ç»™å‡ºé¡¶çº§è¡Œä¸ºçš„å®ç°ï¼Œè€Œå°†ä¸¤ä¸ªä½œä¸ºç»†èŠ‚æ­¥éª¤çš„åŸºæœ¬æ–¹æ³•ç•™ç»™å…·ä½“å­ç±»å®ç°ã€‚ç”±äºéœ€è¦è€ƒè™‘çš„è´¦å·æœ‰ä¸¤ç§ï¼šä¸€æ˜¯è´§å¸å¸‚åœºè´¦å·ï¼ŒäºŒæ˜¯å®šæœŸå­˜æ¬¾è´¦å·ã€‚</p>
<p>æŠ½è±¡æ¨¡æ¿è§’è‰²ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> Account {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ¨¡æ¿æ–¹æ³•ï¼Œè®¡ç®—åˆ©æ¯æ•°é¢
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return    è¿”å›åˆ©æ¯æ•°é¢
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">double</span> calculateInterest(){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">double</span> interestRate = doCalculateInterestRate();
</span></span><span style="display:flex;"><span>        String accountType = doCalculateAccountType();
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">double</span> amount = calculateAmount(accountType);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> amount * interestRate;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">abstract</span> String doCalculateAccountType();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•ç•™ç»™å­ç±»å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">double</span> doCalculateInterestRate();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åŸºæœ¬æ–¹æ³•ï¼Œå·²ç»å®ç°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">double</span> calculateAmount(String accountType){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         * çœç•¥ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> 7243.<span style="color:#007f7f">00</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“æ¨¡æ¿è§’è‰²ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MoneyMarketAccount <span style="color:#fff;font-weight:bold">extends</span> Account {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> String doCalculateAccountType() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;Money Market&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">double</span> doCalculateInterestRate() {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> 0.<span style="color:#007f7f">045</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> CDAccount <span style="color:#fff;font-weight:bold">extends</span> Account {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> String doCalculateAccountType() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;Certificate of Deposite&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">double</span> doCalculateInterestRate() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> 0.<span style="color:#007f7f">06</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¢æˆ·ç«¯ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Client {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        Account account = <span style="color:#fff;font-weight:bold">new</span> MoneyMarketAccount();
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è´§å¸å¸‚åœºè´¦å·çš„åˆ©æ¯æ•°é¢ä¸ºï¼š&#34;</span> + account.<span style="color:#007f7f">calculateInterest</span>());
</span></span><span style="display:flex;"><span>        account = <span style="color:#fff;font-weight:bold">new</span> CDAccount();
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å®šæœŸè´¦å·çš„åˆ©æ¯æ•°é¢ä¸ºï¼š&#34;</span> + account.<span style="color:#007f7f">calculateInterest</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨servletä¸­çš„åº”ç”¨">æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨Servletä¸­çš„åº”ç”¨<a hidden class="anchor" aria-hidden="true" href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨servletä¸­çš„åº”ç”¨">#</a></h1>
<p>ä½¿ç”¨è¿‡Servletçš„äººéƒ½æ¸…æ¥šï¼Œé™¤äº†è¦åœ¨web.xmlåšç›¸åº”çš„é…ç½®å¤–ï¼Œè¿˜éœ€ç»§æ‰¿ä¸€ä¸ªå« HttpServlet çš„æŠ½è±¡ç±»ã€‚HttpServlet ç±»æä¾›äº†ä¸€ä¸ªservice()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è°ƒç”¨ä¸ƒä¸ªdoæ–¹æ³•ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªï¼Œå®Œæˆå¯¹å®¢æˆ·ç«¯è°ƒç”¨çš„å“åº”ã€‚è¿™äº›doæ–¹æ³•éœ€è¦ç”±HttpServletçš„å…·ä½“å­ç±»æä¾›ï¼Œå› æ­¤è¿™æ˜¯å…¸å‹çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚
ä¸‹é¢æ˜¯service()æ–¹æ³•çš„æºä»£ç ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> service(HttpServletRequest req, HttpServletResponse resp)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">throws</span> ServletException, IOException {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	String method = req.<span style="color:#007f7f">getMethod</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_GET)) {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">long</span> lastModified = getLastModified(req);
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">if</span> (lastModified == -1) {
</span></span><span style="display:flex;"><span>			<span style="color:#007f7f">// servlet doesn&#39;t support if-modified-since, no reason</span>
</span></span><span style="display:flex;"><span>			<span style="color:#007f7f">// to go through further expensive logic</span>
</span></span><span style="display:flex;"><span>			doGet(req, resp);
</span></span><span style="display:flex;"><span>		} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">long</span> ifModifiedSince = req.<span style="color:#007f7f">getDateHeader</span>(HEADER_IFMODSINCE);
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">if</span> (ifModifiedSince &lt; (lastModified / 1000 * 1000)) {
</span></span><span style="display:flex;"><span>				<span style="color:#007f7f">// If the servlet mod time is later, call doGet()</span>
</span></span><span style="display:flex;"><span>				<span style="color:#007f7f">// Round down to the nearest second for a proper compare</span>
</span></span><span style="display:flex;"><span>				<span style="color:#007f7f">// A ifModifiedSince of -1 will always be less</span>
</span></span><span style="display:flex;"><span>				maybeSetLastModified(resp, lastModified);
</span></span><span style="display:flex;"><span>				doGet(req, resp);
</span></span><span style="display:flex;"><span>			} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>				resp.<span style="color:#007f7f">setStatus</span>(HttpServletResponse.<span style="color:#007f7f">SC_NOT_MODIFIED</span>);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_HEAD)) {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">long</span> lastModified = getLastModified(req);
</span></span><span style="display:flex;"><span>		maybeSetLastModified(resp, lastModified);
</span></span><span style="display:flex;"><span>		doHead(req, resp);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_POST)) {
</span></span><span style="display:flex;"><span>		doPost(req, resp);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_PUT)) {
</span></span><span style="display:flex;"><span>		doPut(req, resp);        
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_DELETE)) {
</span></span><span style="display:flex;"><span>		doDelete(req, resp);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_OPTIONS)) {
</span></span><span style="display:flex;"><span>		doOptions(req,resp);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (method.<span style="color:#007f7f">equals</span>(METHOD_TRACE)) {
</span></span><span style="display:flex;"><span>		doTrace(req,resp);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">//</span>
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// Note that this means NO servlet supports whatever</span>
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// method was requested, anywhere on this server.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">//</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		String errMsg = lStrings.<span style="color:#007f7f">getString</span>(<span style="color:#0ff;font-weight:bold">&#34;http.method_not_implemented&#34;</span>);
</span></span><span style="display:flex;"><span>		Object[] errArgs = <span style="color:#fff;font-weight:bold">new</span> Object[1];
</span></span><span style="display:flex;"><span>		errArgs[0] = method;
</span></span><span style="display:flex;"><span>		errMsg = MessageFormat.<span style="color:#007f7f">format</span>(errMsg, errArgs);
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		resp.<span style="color:#007f7f">sendError</span>(HttpServletResponse.<span style="color:#007f7f">SC_NOT_IMPLEMENTED</span>, errMsg);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ç„¶ï¼Œè¿™ä¸ªservice()æ–¹æ³•ä¹Ÿå¯ä»¥è¢«å­ç±»ç½®æ¢æ‰ã€‚
ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•çš„Servletä¾‹å­ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> TestServlet <span style="color:#fff;font-weight:bold">extends</span> HttpServlet {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> doGet(HttpServletRequest request, HttpServletResponse response)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throws</span> ServletException, IOException {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;using the GET method&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> doPost(HttpServletRequest request, HttpServletResponse response)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throws</span> ServletException, IOException {
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;using the POST method&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚
HttpServletæ‹…ä»»æŠ½è±¡æ¨¡æ¿è§’è‰²
æ¨¡æ¿æ–¹æ³•ï¼šç”±service()æ–¹æ³•æ‹…ä»»ã€‚
åŸºæœ¬æ–¹æ³•ï¼šç”±doPost()ã€doGet()ç­‰æ–¹æ³•æ‹…ä»»ã€‚
TestServletæ‹…ä»»å…·ä½“æ¨¡æ¿è§’è‰²
TestServletç½®æ¢æ‰äº†çˆ¶ç±»HttpServletä¸­ä¸ƒä¸ªåŸºæœ¬æ–¹æ³•ä¸­çš„å…¶ä¸­ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯doGet()å’ŒdoPost()ã€‚</p>
<p><a href="https://www.cnblogs.com/java-my-life/archive/2012/05/14/2495235.html">å‚è€ƒ</a>
<a href="https://blog.csdn.net/zhengzhb/article/details/7405608">å‚è€ƒ</a></p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/en/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://funny-toffee-4aa7c3.netlify.app/en/">Wjy&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>