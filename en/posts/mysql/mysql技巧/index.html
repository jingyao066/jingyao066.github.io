<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>mysqlæŠ€å·§ | Wjy&#39;s Blog</title>
<meta name="keywords" content="mysql">
<meta name="description" content="selectæ‰§è¡Œé¡ºåº


 1
 2
 3
 4
 5
 6
 7
 8
 9
10


(7) SELECT
(8) DISTINCT &lt;select_list&gt;
(1) FROM &lt;left_table&gt;
(3) &lt;join_type&gt; JOIN &lt;right_table&gt;
(2) ON &lt;join_condition&gt;
(4) WHERE &lt;where_condition&gt;
(5) GROUP BY &lt;group_by_list&gt;
(6) HAVING &lt;having_condition&gt;
(9) ORDER BY &lt;order_by_condition&gt;
(10) LIMIT &lt;limit_number&gt;


">
<meta name="author" content="">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/en/posts/mysql/mysql%E6%8A%80%E5%B7%A7/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="mysqlæŠ€å·§" />
<meta property="og:description" content="selectæ‰§è¡Œé¡ºåº


 1
 2
 3
 4
 5
 6
 7
 8
 9
10


(7) SELECT
(8) DISTINCT &lt;select_list&gt;
(1) FROM &lt;left_table&gt;
(3) &lt;join_type&gt; JOIN &lt;right_table&gt;
(2) ON &lt;join_condition&gt;
(4) WHERE &lt;where_condition&gt;
(5) GROUP BY &lt;group_by_list&gt;
(6) HAVING &lt;having_condition&gt;
(9) ORDER BY &lt;order_by_condition&gt;
(10) LIMIT &lt;limit_number&gt;


" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/en/posts/mysql/mysql%E6%8A%80%E5%B7%A7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-02T18:13:55+00:00" />
<meta property="article:modified_time" content="2019-12-02T18:13:55+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="mysqlæŠ€å·§"/>
<meta name="twitter:description" content="selectæ‰§è¡Œé¡ºåº


 1
 2
 3
 4
 5
 6
 7
 8
 9
10


(7) SELECT
(8) DISTINCT &lt;select_list&gt;
(1) FROM &lt;left_table&gt;
(3) &lt;join_type&gt; JOIN &lt;right_table&gt;
(2) ON &lt;join_condition&gt;
(4) WHERE &lt;where_condition&gt;
(5) GROUP BY &lt;group_by_list&gt;
(6) HAVING &lt;having_condition&gt;
(9) ORDER BY &lt;order_by_condition&gt;
(10) LIMIT &lt;limit_number&gt;


"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "mysqlæŠ€å·§",
      "item": "https://funny-toffee-4aa7c3.netlify.app/en/posts/mysql/mysql%E6%8A%80%E5%B7%A7/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "mysqlæŠ€å·§",
  "name": "mysqlæŠ€å·§",
  "description": "selectæ‰§è¡Œé¡ºåº 1 2 3 4 5 6 7 8 9 10 (7) SELECT (8) DISTINCT \u0026lt;select_list\u0026gt; (1) FROM \u0026lt;left_table\u0026gt; (3) \u0026lt;join_type\u0026gt; JOIN \u0026lt;right_table\u0026gt; (2) ON \u0026lt;join_condition\u0026gt; (4) WHERE \u0026lt;where_condition\u0026gt; (5) GROUP BY \u0026lt;group_by_list\u0026gt; (6) HAVING \u0026lt;having_condition\u0026gt; (9) ORDER BY \u0026lt;order_by_condition\u0026gt; (10) LIMIT \u0026lt;limit_number\u0026gt; ",
  "keywords": [
    "mysql"
  ],
  "articleBody": "selectæ‰§è¡Œé¡ºåº 1 2 3 4 5 6 7 8 9 10 (7) SELECT (8) DISTINCT (1) FROM (3) JOIN (2) ON (4) WHERE (5) GROUP BY (6) HAVING (9) ORDER BY (10) LIMIT select æ‰§è¡Œé¡ºåºä¸€å…±åˆ†ä¸º10æ­¥ã€‚å…¶ä¸­æ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šäº§ç”Ÿä¸€å¼ è™šæ‹Ÿçš„è¡¨ï¼Œåªæ˜¯è¿™äº›è™šæ‹Ÿçš„è¡¨å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä½†æ˜¯åªæœ‰æœ€åä¸€ä¸ªè™šæ‹Ÿçš„è¡¨æ‰ä¼šè¢«ä½œä¸ºç»“æœè¿”å›ã€‚å¦‚æœæ²¡æœ‰åœ¨è¯­å¥ä¸­æŒ‡å®šæŸä¸€ä¸ªå­å¥ï¼Œé‚£ä¹ˆå°†ä¼šè·³è¿‡ç›¸åº”çš„æ­¥éª¤ã€‚\nfromï¼šå¯¹ from å·¦è¾¹çš„è¡¨å’Œå³è¾¹çš„è¡¨è®¡ç®—ç¬›å¡å°”ç§¯ï¼Œäº§ç”Ÿè™šè¡¨VT1ã€‚ onï¼šå¯¹è™šè¡¨VT1è¿›è¡ŒONè¿‡æ»¤ï¼Œåªæœ‰é‚£äº›ç¬¦åˆ join çš„è¡Œæ‰ä¼šè¢«è®°å½•åœ¨è™šè¡¨VT2ä¸­ã€‚ joinï¼š å¦‚æœæŒ‡å®šäº†OUTER JOINï¼ˆæ¯”å¦‚left joinã€ right joinï¼‰ï¼Œé‚£ä¹ˆä¿ç•™è¡¨ä¸­æœªåŒ¹é…çš„è¡Œå°±ä¼šä½œä¸ºå¤–éƒ¨è¡Œæ·»åŠ åˆ°è™šæ‹Ÿè¡¨VT2ä¸­ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT3ã€‚ whereï¼š å¯¹è™šæ‹Ÿè¡¨VT3è¿›è¡ŒWHEREæ¡ä»¶è¿‡æ»¤ã€‚åªæœ‰ç¬¦åˆ where çš„è®°å½•æ‰ä¼šè¢«æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT4ä¸­ã€‚ group by ï¼šæ ¹æ®group byå­å¥ä¸­çš„åˆ—ï¼Œå¯¹VT4ä¸­çš„è®°å½•è¿›è¡Œåˆ†ç»„æ“ä½œï¼Œäº§ç”ŸVT5ã€‚ havingï¼š å¯¹è™šæ‹Ÿè¡¨VT5åº”ç”¨havingè¿‡æ»¤ï¼Œåªæœ‰ç¬¦åˆ having çš„è®°å½•æ‰ä¼šè¢« æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT6ä¸­ã€‚ selectï¼šæ‰§è¡Œselectæ“ä½œï¼Œé€‰æ‹©æŒ‡å®šçš„åˆ—ï¼Œæ’å…¥åˆ°è™šæ‹Ÿè¡¨VT7ä¸­ã€‚ distinctï¼šå¯¹VT7ä¸­çš„è®°å½•è¿›è¡Œå»é‡ã€‚äº§ç”Ÿè™šæ‹Ÿè¡¨VT8ã€‚ order by ï¼šå°†è™šæ‹Ÿè¡¨VT8ä¸­çš„è®°å½•æŒ‰ç…§ order by è¿›è¡Œæ’åºæ“ä½œï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT9ã€‚ limitï¼šå–å‡ºæŒ‡å®šè¡Œçš„è®°å½•ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT10ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ æ—¶é—´ç›¸å…³ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 è·å–ä»Šå¤©åˆ°æ˜å¤©çš„æ•°æ® where date_format(create_date,'%y-%m-%d') BETWEEN date_format(curdate(),'%y-%m-%d') and DATE_SUB(curdate(),INTERVAL -1 DAY) å½“å¤©æ•°æ®1 where date_format(create_date,'%y-%m-%d') = date_format(curdate(),'%y-%m-%d') å½“å¤©æ•°æ®2 select * from è¡¨å where to_days(æ—¶é—´å­—æ®µå) = to_days(now()); æ³¨ï¼što_days æ˜¯mysqlçš„å‡½æ•° æ˜¨å¤©æ•°æ® SELECT * FROM è¡¨å WHERE TO_DAYS( NOW( ) ) - TO_DAYS( æ—¶é—´å­—æ®µå) \u003c= 1 è¿‘7å¤© SELECT * FROM è¡¨å where DATE_SUB(CURDATE(), INTERVAL 7 DAY) \u003c= date(æ—¶é—´å­—æ®µå) è¿‘30å¤© SELECT * FROM è¡¨å where DATE_SUB(CURDATE(), INTERVAL 30 DAY) \u003c= date(æ—¶é—´å­—æ®µå) æœ¬æœˆ SELECT * FROM è¡¨å WHERE DATE_FORMAT( æ—¶é—´å­—æ®µå, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' ) ä¸Šä¸€æœˆ SELECT * FROM è¡¨å WHERE PERIOD_DIFF( date_format( now( ) , '%Y%m' ) , date_format( æ—¶é—´å­—æ®µå, '%Y%m' ) ) =1 æŸ¥è¯¢æœ¬å­£åº¦æ•°æ® select * from `ht_invoice_information` where QUARTER(create_date)=QUARTER(now()); æŸ¥è¯¢ä¸Šå­£åº¦æ•°æ® select * from `ht_invoice_information` where QUARTER(create_date)=QUARTER(DATE_SUB(now(),interval 1 QUARTER)); æŸ¥è¯¢æœ¬å¹´æ•°æ® select * from `ht_invoice_information` where YEAR(create_date)=YEAR(NOW()); æŸ¥è¯¢ä¸Šå¹´æ•°æ® select * from `ht_invoice_information` where year(create_date)=year(date_sub(now(),interval 1 year)); æŸ¥è¯¢å½“å‰è¿™å‘¨çš„æ•°æ® SELECT name,create_time FROM enterprise WHERE YEARWEEK(date_format(create_time,'%Y-%m-%d')) = YEARWEEK(now()); æŸ¥è¯¢ä¸Šå‘¨çš„æ•°æ® SELECT name,submittime FROM enterprise WHERE YEARWEEK(date_format(submittime,'%Y-%m-%d')) = YEARWEEK(now())-1; æŸ¥è¯¢ä¸Šä¸ªæœˆçš„æ•°æ® select name,submittime from enterprise where date_format(submittime,'%Y-%m') = date_format(DATE_SUB(curdate(), INTERVAL 1 MONTH),'%Y-%m') select * from user where DATE_FORMAT(pudate,'%Y%m') = DATE_FORMAT(CURDATE(),'%Y%m') ; select * from user where WEEKOFYEAR(FROM_UNIXTIME(pudate,'%y-%m-%d')) = WEEKOFYEAR(now()) select * from user where MONTH(FROM_UNIXTIME(pudate,'%y-%m-%d')) = MONTH(now()) select * from user where YEAR(FROM_UNIXTIME(pudate,'%y-%m-%d')) = YEAR(now()) and MONTH(FROM_UNIXTIME(pudate,'%y-%m-%d')) = MONTH(now()) select * from user where pudate between ä¸Šæœˆæœ€åä¸€å¤© and ä¸‹æœˆç¬¬ä¸€å¤© æŸ¥è¯¢å½“å‰æœˆä»½çš„æ•°æ® select name,submittime from enterprise where date_format(submittime,'%Y-%m')=date_format(now(),'%Y-%m') æŸ¥è¯¢è·ç¦»å½“å‰ç°åœ¨6ä¸ªæœˆçš„æ•°æ® select name,submittime from enterprise where submittime between date_sub(now(),interval 6 month) and now(); rand() order by RAND()ï¼šéšæœºè¿”å›ç»“æœï¼Œéšæœºå‡½æ•°æ•ˆç‡å¾ˆä½ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ï¼Œå› ä¸ºå®ƒçš„æ•ˆç‡ä¼šéšç€æ•°æ®é‡çš„å¢å¤§ï¼Œæ•ˆç‡è¶Šæ¥è¶Šä½ã€‚\næ¨èä¸€ç§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 SELECT * FROM `question` AS t1 JOIN ( SELECT ROUND( RAND( ) * ( ( SELECT MAX( id ) FROM `question` ) - ( SELECT MIN( id ) FROM `question` ) ) + ( SELECT MIN( id ) FROM `question` ) ) AS id ) AS t2 WHERE t1.id \u003e= t2.id ORDER BY t1.id LIMIT 5; åŠ ä¸ŠMIN(id)çš„åˆ¤æ–­ï¼Œæ˜¯å› ä¸ºæœ€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ï¼Œå› ä¸ºæ²¡æœ‰åŠ ä¸ŠMIN(id)çš„åˆ¤æ–­ï¼Œç»“æœæœ‰ä¸€åŠçš„æ—¶é—´æ€»æ˜¯æŸ¥è¯¢åˆ°è¡¨ä¸­çš„å‰é¢å‡ è¡Œã€‚è¿™ç§æ–¹æ³•ç¼ºç‚¹æ˜¯ä¼šäº§ç”Ÿidè¿ç»­çš„æ•°æ®ã€‚\nå¹¶å‘æ’å…¥ã€å­˜åœ¨ä¸æ’å…¥ã€å­˜åœ¨æ›´æ–°æ“ä½œ é€šå¸¸ä¼šï¼Œå…ˆæŸ¥è¯¢ï¼Œä¸å­˜åœ¨å†æ’å…¥ï¼Œä½†æ˜¯è¿™æ ·æ— æ³•é¿å…å¹¶å‘é—®é¢˜ï¼Œä¸ç”¨è€ƒè™‘äº†ã€‚\nä½¿ç”¨replace intoï¼Œå­˜åœ¨å³æ›´æ–°ï¼Œä¸å­˜åœ¨å³æ’å…¥ replace into table (id,name) values(1,\"å°æ˜\") å¦‚æœå‘ç°è¡¨ä¸­å·²ç»æœ‰æ­¤è¡Œæ•°æ®ï¼ˆæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•åˆ¤æ–­ï¼‰ï¼Œåˆ™å…ˆåˆ é™¤æ­¤è¡Œæ•°æ®ï¼Œç„¶åæ’å…¥æ–°çš„æ•°æ®ï¼Œå¦åˆ™ï¼Œç›´æ¥æ’å…¥æ–°æ•°æ®ã€‚æ‰€ä»¥ï¼Œæ’å…¥æ—¶å¦‚æœä¸æ’å…¥ä¸»é”®(é€æ¸é»˜è®¤é€’å¢)ï¼Œå°±éœ€è¦ä¿è¯ä¸€åˆ—æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä¿è¯å”¯ä¸€ï¼Œæ‰å¯ä»¥ã€‚\nå­˜åœ¨ä¸æ’å…¥ï¼Œä¸å­˜åœ¨å†æ’å…¥(æ„Ÿè§‰è¿™ç§æ–¹æ³•æ˜¯æœ€å¥½çš„) mysql ä¸èƒ½åœ¨æ’å…¥æ—¶å¸¦whereæ¡ä»¶ï¼Œæ•…ç”¨ä¸´æ—¶è¡¨å¤„ç†\n1 2 3 INSERT INTO demo_in(a,b,c) SELECT 123, 2, 4 FROM DUAL WHERE NOT EXISTS(SELECT c FROM demo_in WHERE c = 4); ç”¨ä¸´æ—¶è¡¨DUALæ¥æ ‡è®°æ•°æ®ï¼Œç„¶åæ’å…¥åˆ°demo_inè¡¨ä¸­ã€‚ æ¡ä»¶æ˜¯c=4ï¼Œå¹¶ä¸”not existsï¼Œä¹Ÿå°±æ˜¯å½“c=4æ¡ä»¶æ»¡è¶³ï¼Œåˆ™ä¸æ’å…¥ã€‚\nunion allå’Œorder by å¤šä¸ªselect è¯­å¥ union æ—¶ä¸æ˜¯ç®€å•çš„å°†æŸ¥è¯¢ç»“æœæ‹¼æ¥èµ·æ¥ è€Œæ˜¯å°†sqlæ‹¼æ¥èµ·æ¥ç¼–è¯‘ï¼ˆåšä¸ºä¸€ä¸ªsqlè¯­å¥ï¼‰ï¼Œç„¶åå»æ‰§è¡Œã€‚æ‰€ä»¥union è¿æ¥çš„è¯­å¥ä¸­åªä¼šå‡ºç°ä¸€ä¸ªorder by ï¼ˆä¸åŒ…å«å­æŸ¥è¯¢ä¸­çš„ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥ sqlæœªæ­£ç¡®ç»“æŸçš„é”™è¯¯ã€‚è§£å†³æ–¹æ³•ï¼šå°†order by è¯­å¥æ”¾åˆ°å­æŸ¥è¯¢ä¸­ã€‚\n1 2 3 4 5 6 7 8 å°†æ’åºåçš„æŸ¥è¯¢ç»“æœæ‹¼æ¥èµ·æ¥ select * from(select * from table order by a) union select * from (select * from table1 order by b) union select * from (select * from table2 order by c);//æ³¨æ„ï¼Œè¿™é‡Œçš„order byä¼šå¤±æ•ˆ order by d æ­¤å¤„çš„order by æ˜¯å°†æœ€åçš„æ‹¼æ¥ç»“æœé›†æ’åºï¼Œæ‰“ä¹±äº†ä¹‹å‰é€šè¿‡ aã€bã€cçš„æ’åºã€‚ MySQLå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜ï¼Ÿ å¾ˆå¤šé«˜æ€§èƒ½çš„åº”ç”¨éƒ½ä¼šå¯¹å…³è”æŸ¥è¯¢è¿›è¡Œåˆ†è§£ã€‚ ç®€å•åœ°ï¼Œå¯ä»¥å¯¹æ¯ä¸ªè¡¨è¿›è¡Œä¸€æ¬¡å•è¡¨æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœåœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œå…³è”ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ï¼š\n1 2 3 4 select * from tableA a join tableB b on b.tableA_id = a.id join tableC c on c.tableB_id = b.id where a.name = '123'; å¯ä»¥åˆ†è§£æˆä¸‹é¢è¿™äº›æŸ¥è¯¢æ¥ä»£æ›¿ï¼š\n1 2 3 select id from tableA where name = '123'; -- ç»“æœA select * from tableB where tableA_id = id(ç»“æœA) -- ç»“æœB select * from tableC where id in (ç»“æœB) åˆ°åº•ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ èµ·åˆæ„Ÿè§‰ï¼Œè¿™æ ·åšå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼ŒåŸæœ¬ä¸€æ¡æŸ¥è¯¢ï¼Œè¿™é‡Œå´å˜æˆäº†å¤šæ¡æŸ¥è¯¢ï¼Œè¿”å›ç»“æœåˆæ˜¯ä¸€æ¨¡ä¸€æ ·ã€‚ äº‹å®ä¸Šï¼Œç”¨åˆ†è§£å…³è”æŸ¥è¯¢çš„æ–¹å¼é‡æ„æŸ¥è¯¢å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š\nè®©ç¼“å­˜æ•ˆç‡æ›´é«˜ å¯¹äºMySQLçš„æŸ¥è¯¢ç¼“å­˜æ¥è¯´ï¼Œå¦‚æœå…³è”ä¸­çš„æŸä¸ªè¡¨å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜äº†ï¼Œè€Œæ‹†åˆ†åï¼Œå¦‚æœæŸä¸ªè¡¨å¾ˆå°‘æ”¹å˜ï¼Œé‚£ä¹ˆåŸºäºè¯¥è¡¨çš„æŸ¥è¯¢å°±å¯ä»¥é‡å¤åˆ©ç”¨æŸ¥è¯¢ç¼“å­˜ç»“æœäº†ã€‚ å¯ä»¥å‡å°‘å†—ä½™è®°å½•çš„æŸ¥è¯¢ã€‚ æŸ¥è¯¢æœ¬èº«æ•ˆç‡ä¹Ÿå¯èƒ½ä¼šæœ‰æ‰€æå‡ å°†æŸ¥è¯¢åˆ†è§£åï¼Œæ‰§è¡Œå•ä¸ªæŸ¥è¯¢å¯ä»¥å‡å°‘é”çš„ç«äº‰ã€‚ åœ¨åº”ç”¨å±‚åšå…³è”ï¼Œå¯ä»¥æ›´å®¹æ˜“å¯¹æ•°æ®åº“è¿›è¡Œæ‹†åˆ†ï¼Œæ›´å®¹æ˜“åšåˆ°é«˜æ€§èƒ½å’Œå¯æ‰©å±•ã€‚ è¿™æ ·åšç›¸å½“äºåœ¨åº”ç”¨ä¸­å®ç°äº†å“ˆå¸Œå…³è”ï¼Œè€Œä¸æ˜¯ä½¿ç”¨MySQLçš„åµŒå¥—ç¯å…³è”ï¼ŒæŸäº›åœºæ™¯å“ˆå¸Œå…³è”çš„æ•ˆç‡æ›´é«˜å¾ˆå¤šã€‚ mysqlå­˜å‚¨è¡¨æƒ… å­˜å‚¨è¡¨æƒ…æ—¶æŠ¥é”™ï¼š java.sql.SQLException: Incorrect string value: '\\xF0\\x9F\\x92\\x94' for colum n 'name' at row 1 ä½¿ç”¨mysqlæ•°æ®åº“çš„æ—¶å€™ï¼Œå¦‚æœå­—ç¬¦é›†æ˜¯UTF-8ï¼Œå½“å­˜å‚¨emojiè¡¨æƒ…çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºä»¥ä¸Šå¼‚å¸¸ã€‚ è¿™æ˜¯ç”±äºå­—ç¬¦é›†ä¸æ”¯æŒçš„å¼‚å¸¸ï¼Œå› ä¸ºutf-8ç¼–ç æœ‰å¯èƒ½æ˜¯ä¸¤ä¸ªï¼Œä¸‰ä¸ªï¼Œå››ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­Emojiè¡¨æƒ…æ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œmysqlçš„utf-8ç¼–ç æœ€å¤šä¸‰ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´æ•°æ®æ’ä¸è¿›å»ã€‚ è§£å†³ï¼š\nä¿®æ”¹databaseã€tableã€columnå­—ç¬¦é›† 1 2 3 ALTER DATABASE database_name CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci; ALTER TABLE table_name CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; ALTER TABLE table_name CHANGE column_name VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; é™¤äº†columnçš„å­—ç¬¦é›†ï¼Œåº“å’Œè¡¨çš„å­—ç¬¦é›†ä¸æ˜¯å¿…é¡»ä¿®æ”¹ã€‚\nä¿®æ”¹mysqlé…ç½®æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 [client] default-character-set = utf8mb4 [mysql] default-character-set = utf8mb4 [mysqld] character-set-client-handshake = FALSE character-set-server = utf8mb4 collation-server = utf8mb4_unicode_ci init_connect='SET NAMES utf8mb4' æ£€æŸ¥mysql-connector-javaç‰ˆæœ¬ï¼Œå¿…é¡»é«˜äº5.1.13å¦åˆ™ä»ç„¶ä¸èƒ½è¯•ç”¨utf8mb4 ä¿®æ”¹é“¾æ¥æ•°æ®åº“åœ°å€ 1 2 3 4 5 6 7 8 jdbc:mysql://localhost:3306/test? \"useUnicode=true\" + \"\u0026characterEncoding=UTF-8\" + \"\u0026zeroDateTimeBehavior=convertToNull\" + \"\u0026useSSL=false\" + \"\u0026allowMultiQueries=true\" + \"\u0026autoReconnect=true\" + \"\u0026rewriteBatchedStatements=TRUE\"); å¦‚æœå‡çº§äº†mysql-connectorï¼Œå…¶ä¸­çš„characterEncoding=utf8å¯ä»¥è‡ªåŠ¨è¢«è¯†åˆ«ä¸ºutf8mb4ï¼ˆå…¼å®¹åŸæ¥çš„utf8ï¼‰ï¼Œè€ŒautoReconnectionï¼ˆå½“æ•°æ®åº“è¿æ¥å¼‚å¸¸ä¸­æ–­æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨é‡æ–°è¿æ¥ï¼Ÿé»˜è®¤ä¸ºfalseï¼‰å¼ºçƒˆå»ºè®®é…ä¸Šï¼Œå¿½ç•¥è¿™ä¸ªå±æ€§ï¼Œå¯èƒ½å¯¼è‡´ç¼“å­˜ç¼˜æ•… ï¼Œæ²¡æœ‰è¯»å–åˆ°DBæœ€æ–°çš„é…ç½®ï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•è¯•ç”¨utf8mb4å­—ç¬¦é›†ã€‚\næŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹ åœ¨Oracle ä¸­æˆ‘ä»¬çŸ¥é“æœ‰ä¸€ä¸ª Hierarchical Queries é€šè¿‡CONNECT BY æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æŸ¥äº†æ‰€æœ‰å½“å‰èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ä½†å¾ˆé—æ†¾ï¼Œåœ¨MySQLçš„ç›®å‰ç‰ˆæœ¬ä¸­è¿˜æ²¡æœ‰å¯¹åº”çš„åŠŸèƒ½ã€‚ åœ¨MySQLä¸­å¦‚æœæ˜¯æœ‰é™çš„å±‚æ¬¡ï¼Œæ¯”å¦‚æˆ‘ä»¬äº‹å…ˆå¦‚æœå¯ä»¥ç¡®å®šè¿™ä¸ªæ ‘çš„æœ€å¤§æ·±åº¦æ˜¯4, é‚£ä¹ˆæ‰€æœ‰èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘çš„æ·±åº¦å‡ä¸ä¼šè¶…è¿‡4ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡left join æ¥å®ç°ã€‚ ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ— æ³•æ§åˆ¶æ ‘çš„æ·±åº¦ã€‚è¿™æ—¶å°±éœ€è¦åœ¨MySQLä¸­ç”¨å­˜å‚¨è¿‡ç¨‹æ¥å®ç°æˆ–åœ¨ä½ çš„ç¨‹åºä¸­æ¥å®ç°è¿™ä¸ªé€’å½’ã€‚æœ¬æ–‡è®¨è®ºä¸€ä¸‹å‡ ç§å®ç°çš„æ–¹æ³•ã€‚\næ–°çš„æ€è·¯ è§£å†³è¿™ç§æ ‘çŠ¶ç»“æ„é—®é¢˜ï¼Œå¯ä»¥åœ¨è¡¨ä¸­åŠ ä¸€ä¸ªå­—æ®µpathï¼Œæ ‡è¯†è¿™æ¡æ•°æ®çš„è·¯å¾„ï¼Œå³çˆ¶å­çº§ç»“æ„è·¯å¾„ã€‚\nid å…¬å¸å parent_id path 1 æ€»å…¬å¸ 0 1 2 æŠ€æœ¯éƒ¨ 1 1,2 3 äººåŠ›éƒ¨ 1 1,3 4 æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨ 2 1,2,4 è¿™æ ·å¦‚æœæˆ‘æƒ³æŸ¥æ€»å…¬å¸ä¸‹æœ‰å“ªäº›éƒ¨é—¨ï¼Œéœ€è¦ä½¿ç”¨mysql å‡½æ•°FIND_IN_SET(str,strlist)ï¼Œlikeæ˜¯ä¸è¡Œçš„ã€‚\næ ·ä¾‹æ•°æ® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 create table treeNodes ( id int primary key, nodename varchar(20), pid int ); select * from treenodes; +----+----------+------+ | id | nodename | pidÂ | +----+----------+------+ |Â 1 | AÂ |Â 0 | |Â 2 | BÂ |Â 1 | |Â 3 | CÂ |Â 1 | |Â 4 | DÂ |Â 2 | |Â 5 | EÂ |Â 2 | |Â 6 | FÂ |Â 3 | |Â 7 | GÂ |Â 6 | |Â 8 | HÂ |Â 0 | |Â 9 | IÂ |Â 8 | | 10 | JÂ |Â 8 | | 11 | KÂ |Â 8 | | 12 | LÂ |Â 9 | | 13 | MÂ |Â 9 | | 14 | NÂ |Â 12 | | 15 | OÂ |Â 12 | | 16 | PÂ |Â 15 | | 17 | QÂ |Â 15 | +----+----------+------+\tæ ‘å½¢å›¾å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 1:A +-- 2:B |Â +-- 4:D |Â +-- 5:E +-- 3:C +-- 6:F +-- 7:G 8:H +-- 9:I |Â +-- 12:L |Â |Â +--14:N |Â |Â +--15:O |Â |Â +--16:P |Â |Â +--17:Q |Â +-- 13:M +-- 10:J +-- 11:K æ–¹æ³•ä¸€ï¼šåˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å· åˆ›å»ºä¸€ä¸ªfunction getChildLst, å¾—åˆ°ä¸€ä¸ªç”±æ‰€æœ‰å­èŠ‚ç‚¹å·ç»„æˆçš„å­—ç¬¦ä¸²ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 CREATE FUNCTION `getChildLst` ( rootId INT ) RETURNS VARCHAR(1000) BEGIN DECLARE sTemp VARCHAR ( 1000 ); DECLARE sTempChd VARCHAR ( 1000 );Â SET sTemp = '$'; SET sTempChd = cast( rootId AS CHAR );\tWHILE sTempChd IS NOT NULL DO SET sTemp = concat( sTemp, ',', sTempChd ); SELECT group_concat( id ) INTO sTempChd FROM treeNodes WHERE FIND_IN_SET( pid, sTempChd ) \u003e 0;Â END WHILE; RETURN sTemp; END ä½¿ç”¨æˆ‘ä»¬ç›´æ¥åˆ©ç”¨find_in_setå‡½æ•°é…åˆè¿™ä¸ªgetChildlstæ¥æŸ¥æ‰¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 select getChildLst(1); +-----------------+ | getChildLst(1)Â | +-----------------+ | $,1,2,3,4,5,6,7 | +-----------------+ select * from treeNodes where FIND_IN_SET(id, getChildLst(1)); +----+----------+------+ | id | nodename | pidÂ | +----+----------+------+ |Â 1 | AÂ |Â 0 | |Â 2 | BÂ |Â 1 | |Â 3 | CÂ |Â 1 | |Â 4 | DÂ |Â 2 | |Â 5 | EÂ |Â 2 | |Â 6 | FÂ |Â 3 | |Â 7 | GÂ |Â 6 | +----+----------+------+ select * from treeNodes where FIND_IN_SET(id, getChildLst(3)); +----+----------+------+ | id | nodename | pidÂ | +----+----------+------+ |Â 3 | CÂ |Â 1 | |Â 6 | FÂ |Â 3 | |Â 7 | GÂ |Â 6 | +----+----------+------+ ä¼˜ç‚¹: ç®€å•ï¼Œæ–¹ä¾¿ï¼Œæ²¡æœ‰é€’å½’è°ƒç”¨å±‚æ¬¡æ·±åº¦çš„é™åˆ¶ (max_sp_recursion_depth,æœ€å¤§255) ï¼› ç¼ºç‚¹ï¼šé•¿åº¦å—é™ï¼Œè™½ç„¶å¯ä»¥æ‰©å¤§ RETURNS varchar(1000)ï¼Œä½†æ€»æ˜¯æœ‰æœ€å¤§é™åˆ¶çš„ã€‚ MySQLç›®å‰ç‰ˆæœ¬( 5.1.33-community)ä¸­è¿˜ä¸æ”¯æŒfunction çš„é€’å½’è°ƒç”¨ã€‚\næ–¹æ³•äºŒï¼šåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’ åˆ›å»ºå­˜å‚¨è¿‡ç¨‹å¦‚ä¸‹ã€‚createChildLst ä¸ºé€’å½’è¿‡ç¨‹ï¼ŒshowChildLstä¸ºè°ƒç”¨å…¥å£è¿‡ç¨‹ï¼Œå‡†å¤‡ä¸´æ—¶è¡¨åŠåˆå§‹åŒ–ã€‚\nå…¥å£è¿‡ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 CREATE PROCEDURE showChildLst ( IN rootId INT ) BEGIN CREATE TEMPORARY TABLE IF NOT EXISTS tmpLst ( sno INT PRIMARY KEY auto_increment, id INT, depth INT ); DELETE FROM tmpLst; CALL createChildLst ( rootId, 0 ); SELECT tmpLst.*, treeNodes.* FROM tmpLst, treeNodes WHERE tmpLst.id = treeNodes.id ORDER BY tmpLst.sno; END; é€’å½’è¿‡ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 CREATE PROCEDURE createChildLst ( IN rootId INT, IN nDepth INT ) BEGIN DECLARE done INT DEFAULT 0; DECLARE b INT; DECLARE cur1 CURSOR FOR SELECT id FROM treeNodes WHERE pid = rootId; DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1; INSERT INTO tmpLst VALUES ( NULL, rootId, nDepth ); OPEN cur1; FETCH cur1 INTO b; WHILE done = 0 DO CALL createChildLst ( b, nDepth + 1 ); FETCH cur1 INTO b; END WHILE; CLOSE cur1; END; è°ƒç”¨æ—¶ä¼ å…¥ç»“ç‚¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 call showChildLst(1); +-----+------+-------+----+----------+------+ | sno | idÂ | depth | id | nodename | pidÂ | +-----+------+-------+----+----------+------+ |Â 4 |Â 1 |Â 0 |Â 1 | AÂ |Â 0 | |Â 5 |Â 2 |Â 1 |Â 2 | BÂ |Â 1 | |Â 6 |Â 4 |Â 2 |Â 4 | DÂ |Â 2 | |Â 7 |Â 5 |Â 2 |Â 5 | EÂ |Â 2 | |Â 8 |Â 3 |Â 1 |Â 3 | CÂ |Â 1 | |Â 9 |Â 6 |Â 2 |Â 6 | FÂ |Â 3 | |Â 10 |Â 7 |Â 3 |Â 7 | GÂ |Â 6 | +-----+------+-------+----+----------+------+ call showChildLst(3); +-----+------+-------+----+----------+------+ | sno | idÂ | depth | id | nodename | pidÂ | +-----+------+-------+----+----------+------+ |Â 1 |Â 3 |Â 0 |Â 3 | CÂ |Â 1 | |Â 2 |Â 6 |Â 1 |Â 6 | FÂ |Â 3 | |Â 3 |Â 7 |Â 2 |Â 7 | GÂ |Â 6 | +-----+------+-------+----+----------+------+ depth ä¸ºæ·±åº¦ï¼Œè¿™æ ·å¯ä»¥åœ¨ç¨‹åºè¿›è¡Œä¸€äº›æ˜¾ç¤ºä¸Šçš„æ ¼å¼åŒ–å¤„ç†ã€‚ç±»ä¼¼äºoracleä¸­çš„Â level ä¼ªåˆ—ã€‚sno ä»…ä¾›æ’åºæ§åˆ¶ã€‚è¿™æ ·ä½ è¿˜å¯ä»¥é€šè¿‡ä¸´æ—¶è¡¨tmpLstä¸æ•°æ®åº“ä¸­å…¶å®ƒè¡¨è¿›è¡Œè”æ¥æŸ¥è¯¢ã€‚\nMySQLä¸­ä½ å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‚æ•° max_sp_recursion_depth æ¥æ§åˆ¶é€’å½’è°ƒç”¨çš„å±‚æ•°ä¸Šé™ã€‚å¦‚ä¸‹ä¾‹è®¾ä¸º12 set max_sp_recursion_depth=12;\nä¼˜ç‚¹ï¼šå¯ä»¥æ›´çµæ´»å¤„ç†ï¼ŒåŠå±‚æ•°çš„æ˜¾ç¤ºã€‚å¹¶ä¸”å¯ä»¥æŒ‰ç…§æ ‘çš„éå†é¡ºåºå¾—åˆ°ç»“æœã€‚ ç¼ºç‚¹ï¼šé€’å½’æœ‰255çš„é™åˆ¶\næ–¹æ³•ä¸‰ï¼šåˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹ åˆ›å»ºå­˜å‚¨è¿‡ç¨‹å¦‚ä¸‹ã€‚ç”±äºMySQLä¸­ä¸å…è®¸åœ¨åŒä¸€è¯­å¥ä¸­å¯¹ä¸´æ—¶è¡¨å¤šæ¬¡å¼•ç”¨ï¼Œåªä»¥ä½¿ç”¨æ™®é€šè¡¨tmpLstæ¥å®ç°äº†ã€‚å½“ç„¶ä½ çš„ç¨‹åºä¸­è´Ÿè´£åœ¨ç”¨å®Œåæ¸…é™¤è¿™ä¸ªè¡¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 drop PROCEDURE IF EXISTS showTreeNodes; CREATE PROCEDURE showTreeNodes (IN rootid INT) BEGIN DECLARE Level int; drop TABLE IF EXISTS tmpLst; CREATE TABLE tmpLst ( id int, nLevel int, sCort varchar(8000) ); Set Level = 0; INSERT into tmpLst SELECT id,Level,ID FROM category WHERE parent_id = rootid; WHILE ROW_COUNT() \u003e 0 DO SET Level = Level + 1; INSERT into tmpLst SELECT A.ID,Level,concat(B.sCort,A.ID) FROM category A,tmpLst B WHERE A.parent_id = B.ID AND B.nLevel = Level-1; END WHILE; END; CALL showTreeNodes(0); æ‰§è¡Œå®Œåä¼šäº§ç”Ÿä¸€ä¸ªtmpLstè¡¨ï¼ŒnLevel ä¸ºèŠ‚ç‚¹æ·±åº¦ï¼ŒsCort ä¸ºæ’åºå­—æ®µã€‚ ä½¿ç”¨æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 SELECT concat(SPACE(B.nLevel*2),'+--',A.nodename) FROM treeNodes A,tmpLst B WHERE A.ID=B.ID ORDER BY B.sCort; +--------------------------------------------+ | concat(SPACE(B.nLevel*2),'+--',A.nodename) | +--------------------------------------------+ | +--AÂ | |Â +--BÂ | |Â +--DÂ | |Â +--EÂ | |Â +--CÂ | |Â +--FÂ | |Â +--GÂ | | +--HÂ | |Â +--JÂ | |Â +--KÂ | |Â +--IÂ | |Â +--LÂ | |Â +--NÂ | |Â +--OÂ | |Â +--PÂ | |Â +--QÂ | |Â +--MÂ | +--------------------------------------------+ ä¼˜ç‚¹ï¼šå±‚æ•°çš„æ˜¾ç¤ºã€‚å¹¶ä¸”å¯ä»¥æŒ‰ç…§æ ‘çš„éå†é¡ºåºå¾—åˆ°ç»“æœã€‚æ²¡æœ‰é€’å½’é™åˆ¶ã€‚ ç¼ºç‚¹ï¼šMySQLä¸­å¯¹ä¸´æ—¶è¡¨çš„é™åˆ¶ï¼Œåªèƒ½ä½¿ç”¨æ™®é€šè¡¨ï¼Œéœ€åšäº‹åæ¸…ç†ã€‚\nå‚è€ƒåœ°å€\nä¸€äº›ç‰¹æ®Šçš„sql å‡ºè‡ªï¼šarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿï¼ŒArchiveMapper.xml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u003c!-- æ¡ˆä»¶åˆ—è¡¨ --\u003e \u003cselect id=\"caseList\" resultType=\"map\"\u003e select id, concat( \"list\" separator=\",\" item=\"i\"\u003e ${i.columnEnglish} \u003cif test=\"null != i.connector and '' != i.connector\"\u003e ,${i.connector} \u003c/if\u003e ) dataName from `${tableName}` \u003c/select\u003e 2 1 2 3 4 5 select * from table_name where id in (1,2,3) order by field(id,1,2,3) æ ¹æ®iné‡Œçš„å‚æ•°æ’åºã€‚ xmlå†™æ³•ï¼š\n1 2 3 4 5 order by field(q.id, #{i} ) åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ® 1 2 3 4 5 6 DELETE FROM parents WHERE mobile IN ( SELECT mobile FROM ( SELECT id, mobile, count( id ) count FROM parents GROUP BY mobile HAVING count \u003e 1 ) a ) AND id NOT IN ( SELECT id FROM ( SELECT id, mobile, count( id ) count FROM parents GROUP BY mobile HAVING count \u003e 1 ) a ) ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ® 1 2 3 4 5 select sum(if(status = 1,1,0)) finished_no, sum(if(status = 0,1,0)) unfinished_no from message_task where message_id = #{_parameter} æ›´æ–°æ•°æ® 1 2 3 4 update process_video_data t1 left join process_video_data t2 on t1.album_name = t2.album_name set t1.album_id = t2.album_id where t1.album_id is null mysql order by å­—æ®µæœ‰ç›¸åŒå€¼ï¼Œæ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº ä¸€äº›æ•°æ®ï¼Œåˆ›å»ºæ—¶é—´ä¼šæœ‰ç›¸åŒçš„ã€‚ä½†æ˜¯æˆ‘éœ€è¦æŒ‰ç…§æ—¶é—´æ’åºï¼Œæ­¤æ—¶mysqlè¿”å›çš„æ•°æ®ä¼šå‡ºç°éšæœºã€‚ select * from table_a order by create_time desc æŸ¥é˜…å®˜ç½‘å‘ç° â€œIf multiple rows have identical values in theÂ ORDER BYÂ columns, the server is free to return those rows in any order, and may do so differently depending on the overall execution plan. In other words, the sort order of those rows is nondeterministic with respect to the nonordered columns.â€ ç¿»è¯‘ï¼šå¦‚æœåœ¨ORDER BYåˆ—ä¸­æœ‰å¤šä¸ªè¡Œå…·æœ‰ç›¸åŒçš„å€¼ï¼Œåˆ™æœåŠ¡å™¨å¯ä»¥è‡ªç”±ä»¥ä»»ä½•é¡ºåºè¿”å›è¿™äº›è¡Œï¼Œå¹¶ä¸”æ ¹æ®æ•´ä½“æ‰§è¡Œè®¡åˆ’çš„ä¸åŒï¼Œè¿”å›å€¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ æ¢å¥è¯è¯´ï¼Œè¿™äº›è¡Œçš„æ’åºé¡ºåºç›¸å¯¹äºæ— åºåˆ—æ˜¯ä¸ç¡®å®šçš„ã€‚ MySQLå®˜ç½‘ä¸Šä¹Ÿç»™å‡ºäº†ä¸€ç§æ–¹æ¡ˆï¼š â€œIf it is important to ensure the same row order with and withoutÂ LIMIT, include additional columns in theÂ ORDER BYÂ clause to make the order deterministic. For example, ifÂ idÂ values are unique, you can make rows for a givenÂ categoryÂ value appear inÂ idÂ order by sorting like this:â€ åœ¨ORDER BYå­å¥ä¸­åŒ…æ‹¬å…¶ä»–åˆ—ä»¥ä½¿é¡ºåºç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨ä¸»é”®idç­‰ã€‚ä¸Šé¢çš„SQLå¯ä»¥ä¿®æ”¹ä¸‹ï¼š select * from table_a order by create_time desc,id é—®é¢˜è§£å†³ã€‚\nletf join ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ« æ•°æ®åº“åœ¨è¿æ¥å¤šå¼ è¡¨è¿”å›è®°å½•æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€å¼ ä¸´æ—¶è¡¨ï¼Œç„¶åå°†è¿™å¼ è¡¨è¿”å›ç»™ç”¨æˆ·ã€‚ åœ¨ä½¿ç”¨left join æ—¶ï¼Œonå’Œwhereæ¡ä»¶çš„åŒºåˆ«å¦‚ä¸‹ï¼š\nonæ¡ä»¶æ˜¯åœ¨ç”Ÿæˆä¸´æ—¶è¡¨æ—¶ä½¿ç”¨çš„æ¡ä»¶ï¼Œæ— è®ºonä¸­çš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸï¼Œéƒ½ä¼šè¿”å›å·¦è¡¨ä¸­çš„è®°å½•ã€‚ whereæ¡ä»¶æ˜¯åœ¨ä¸´æ—¶è¡¨ç”Ÿæˆå¥½åï¼Œå†å¯¹ä¸´æ—¶è¡¨è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶ï¼Œæ¡ä»¶ä¸ä¸ºçœŸçš„å…¨éƒ¨è¿‡æ»¤æ‰ã€‚ å‡è®¾ä¸¤å¼ è¡¨ï¼š è¡¨1ï¼štable_1\nid size 1 10 2 20 3 30 è¡¨2ï¼štable_2\nsize name 10 A 20 B 30 C ä¸¤æ¡sqlï¼š select * form tab1 left join table_2 on (table_1.size = table_2.size) where table_2.name=â€™Aâ€™ select * form tab1 left join table_2 on (table_1.size = table_2.size and table_2.name=â€™Aâ€™)\nsql_1çš„æ‰§è¡Œè¿‡ç¨‹ï¼š ä¸­é—´è¡¨ onæ¡ä»¶: table_1.size = table_2.size\ntable_1.id table_1.size table_2.size table_2.name 1 10 10 A 2 20 20 B 2 20 20 C 3 30 (null) (null) whereå†å¯¹ä¸­é—´è¡¨æ•°æ®è¿‡æ»¤ï¼štable_2.name = A\ntable_1.id table_1.size table_2.size table_2.name 1 10 10 A sql_2çš„æ‰§è¡Œè¿‡ç¨‹ï¼š ä¸­é—´è¡¨ onæ¡ä»¶: table_1.size = table_2.size and table_2.name=â€™Aâ€™ (æ¡ä»¶ä¸ä¸ºçœŸä¹Ÿä¼šè¿”å›å·¦è¡¨ä¸­çš„è®°å½•)\ntable_1.id table_1.size table_2.size table_2.name 1 10 10 A 2 20 (null) (null) 3 30 (null) (null) ç”±äºleft join ã€right join ã€full join çš„ç‰¹æ€§ï¼Œä¸ç®¡onä¸Šçš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸéƒ½ä¼šè¿”å›leftæˆ–rightè¡¨ä¸­çš„è®°å½•ï¼Œfull join å…·æœ‰left join å’Œright join ç‰¹æ€§çš„å¹¶é›†ã€‚è€Œinner join æ²¡æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œè¿”å›çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚\næ€»ç»“ï¼š\nonåœ¨ç”Ÿæˆè¿æ¥è¡¨æ—¶èµ·ä½œç”¨ï¼Œwhereåœ¨ç”Ÿæˆè¿æ¥è¡¨åå¯¹è¿æ¥è¡¨å†è¿›è¡Œè¿‡æ»¤ã€‚ ä½¿ç”¨left joinæ—¶ï¼Œæ— è®ºonçš„æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œéƒ½ä¼šè¿”å›å·¦è¡¨çš„æ‰€æœ‰è®°å½•ï¼Œå¯¹äºæ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œä¸¤ä¸ªè¡¨å¯¹åº”çš„è®°å½•ä¼šè¿æ¥èµ·æ¥ï¼Œå¯¹äºä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå³è¡¨å­—æ®µå…¨éƒ¨æ˜¯nullã€‚ ä½¿ç”¨right joinæ—¶ï¼Œæ— è®ºonçš„æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œéƒ½ä¼šè¿”å›å³è¡¨çš„æ‰€æœ‰è®°å½•ï¼Œå¯¹äºæ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œä¸¤ä¸ªè¡¨å¯¹åº”çš„è®°å½•ä¼šè¿æ¥èµ·æ¥ï¼Œå¯¹äºä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå·¦è¡¨å­—æ®µå…¨éƒ¨æ˜¯nullã€‚ ä½¿ç”¨inner joinæ—¶ï¼Œonçš„æ¡ä»¶å’Œwhereå®Œå…¨ç›¸åŒã€‚ å‚è€ƒ mysql è·å–æ’åˆ—åºå· åœ¨è¿›å…¥æ­£é¢˜ä¹‹å‰å…ˆæ¥äº†è§£ä¸€ä¸ªmysqlä¸­çš„å°çŸ¥è¯†ç‚¹ï¼š := ä¸ = çš„åŒºåˆ« := èµ‹å€¼çš„æ„æ€ã€‚åœ¨set update select ä¸­è¡¨ç¤ºèµ‹å€¼çš„æ„æ€ï¼Œç”¨çš„æ¯”è¾ƒå°‘ä¸€èˆ¬éƒ½ç”¨=ï¼Œä½†æ˜¯åœ¨ç”¨å˜é‡å®ç°è¡Œå·æ—¶ï¼ˆæ¯”å¦‚æœ¬æ–‡æ ‡é¢˜è·å–æ’åˆ—åºå·ï¼‰ï¼Œä¸€å®šè¦ç”¨:=ã€‚\n= ç­‰äºçš„æ„æ€ï¼Œåªæœ‰å½“set å’Œ updateæ—¶ï¼Œå’Œ:=çš„æ„æ€æ˜¯ä¸€æ ·çš„ï¼Œè¡¨ç¤ºèµ‹å€¼ï¼Œå…¶ä½™æƒ…å†µéƒ½æ˜¯ç­‰äºçš„æ„æ€ã€‚\nç”¨æˆ·å˜é‡ @ @rank æ˜¯å¯¹ä¸€ä¸ªå«rankçš„å‚æ•°è¿›è¡Œèµ‹å€¼ã€‚å¯¹ç”¨æˆ·å˜é‡èµ‹å€¼æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§ç›´æ¥ç”¨\"=â€œå¦ä¸€ç§ç”¨â€:=\"ã€‚ å…¶åŒºåˆ«åœ¨äºä½¿ç”¨setå‘½ä»¤å¯¹ç”¨æˆ·å˜é‡èµ‹å€¼æ—¶ï¼Œä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨ï¼›å½“ä½¿ç”¨selectè¯­å¥å¯¹ç”¨æˆ·å˜é‡è¿›è¡Œèµ‹å€¼æ—¶ï¼Œåªèƒ½ä½¿ç”¨â€œ:=â€æ–¹å¼ï¼Œå› ä¸ºåœ¨selectè¯­å¥ä¸­ï¼Œâ€œ=â€è¢«çœ‹åšæ˜¯æ¯”è¾ƒæ“ä½œç¬¦ã€‚\næ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå· 1 2 3 4 5 6 7 8 9 SELECT a.*, @rank:=@rank + 1 AS rank_no FROM ( SELECT * FROM `logs` WHERE log_created \u003e \"2017-09-01\" ORDER BY count DESC ) a, (SELECT @rank:= 0) b 2017.09.01ä¹‹å‰çš„æ—¥å¿—æŒ‰è®¿é—®é‡è¿›è¡Œå€’åºæ’åºï¼Œå¹¶è¿”å›åºå·ã€‚\nselect @rank:= 0 set @rank=0; è¿™å¥è¯å…¶å®å°±æ˜¯å°†rankèµ‹å€¼0ï¼Œä»é›¶å¼€å§‹åŠ 1ç¼–å·ï¼Œä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ã€‚\nç”¨setçš„å†™æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 set @rank= 0; SELECT a.log_id, a.log_created, a.count, @rank:=@rank + 1 AS rank_no FROM ( SELECT * FROM `logs` WHERE log_update \u003e \"2017-09-01\" ORDER BY count DESC ) a; æ‰€ä»¥ï¼Œè·å–æ’åºåºå·è¿˜æ˜¯å¾ˆç®€å•çš„ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å›ºå®šçš„æ–¹å¼ï¼Œé‡Œé¢ä¸€å±‚selectæ˜¯æ­£å¸¸çš„sqlæ’åºçš„è¯­å¥ï¼Œå¤–é¢ä¸€å±‚æ˜¯å¯¹æŸ¥åˆ°çš„å·²æ’å¥½åºçš„æ•°æ®åˆ—è¿›è¡Œrankè‡ªå¢çš„æ“ä½œï¼Œæ‰€ä»¥ä¸€å¼€å§‹@rank:=0ã€‚\næ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 SET @rank = 0 ,@rowtotal := NULL; SELECT a.log_id, a.log_created, a.count, CASE WHEN @rowtotal = a.count THEN @rank WHEN @rowtotal := a.count THEN @rank := @rank + 1 END AS rank_no FROM ( SELECT * FROM `logs` WHERE log_update \u003e \"2017-09-01\" ORDER BY count DESC ) a ä»ä¸Šé¢çš„sqlè¯­å¥å¯ä»¥çœ‹å‡ºå¤šäº†ä¸€å¥caseå‡½æ•°ï¼Œï¼ˆrowtotalè¡¨ç¤ºcountï¼‰æ ¹æ®æƒ…å†µå¯¹rankè¿›è¡Œèµ‹å€¼ï¼Œ å½“rowtotalç­‰äºcountæ—¶ï¼Œåºå·å°±æ˜¯rankï¼Œå½“rowtotalæ­£å¸¸èµ‹å€¼æ—¶ï¼Œè¨€ä¸‹ä¹‹æ„å°±æ˜¯ä¸ç­‰äºï¼Œä½†æ˜¯ åˆä¸èƒ½ç”¨!= ï¼Œï¼ˆå…¶å®è¿™æ ·è¯´ä¹Ÿä¸å‡†ç¡®ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆè¡¨è¾¾ï¼Œæœ‰çŸ¥é“çš„äººåšå‹å¯ä»¥å¸®å¿™è¡¥å……ä¸€ä¸‹~~~ï¼‰ï¼Œ è¿™æ ·å°±å®ç°äº†ç›¸åŒè®°å½•ç¼–å·ç›¸åŒçš„ç›®çš„ï¼ŒåŒæ—¶å…¶ä½™è®°å½•ç»§ç»­ç¼–å·ã€‚\næ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒï¼Œå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°+ä¸Šä¸€ä¸ªæ’åºå· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 SET @rank = 0 ,@rowtotal := NULL ,@rowtotal1 = NULL ,@sart := 0; SELECT a.log_id, a.log_created, a.count, CASE WHEN @rowtotal = a.count THEN @rank WHEN @rowtotal := a.count THEN @rank := @rank + 1 + @sart END AS rank_no, CASE WHEN @rowtotal1 = a.count THEN @sart := @sart + 1 WHEN @rowtotal1 := a.count THEN @sart := 0 END AS sart FROM ( SELECT * FROM `logs` WHERE log_update \u003e \"2017-09-01\" ORDER BY count DESC ) a ä¸Šé¢çš„sqlé‡Œåˆå¢åŠ äº†ä¸€ä¸ªå‚æ•°sartï¼Œè¡¨ç¤ºå½“å‰æ¯æ¬¡ç›¸åŒçš„ä¸ªæ•°ï¼Œï¼ˆåŒæ—¶è¿˜å¢åŠ äº†rowtotal1ï¼Œ ç”¨äºåŒºåˆ«ä¹‹å‰çš„roetotalï¼Œå› ä¸ºåœ¨è¿™æ®µsqlä¸­rowtotalåœ¨è¿è¡ŒæœŸé—´å·²è¢«å¤šæ¬¡èµ‹å€¼ï¼Œä¸é€‚åˆåšsartçš„æ¯”è¾ƒå‚æ•°ï¼‰ä¸‹ä¸€ç»„è®°å½•ï¼Œå°†åœ¨ä¹‹å‰çš„æ’åä¸ŠåŠ ä¸Šæ­¤å‚æ•°å°±è¡¨ç¤ºï¼Œä¸‹ä¸€ç»„è®°å½•çš„æ’åºç¼–ç ã€‚ä¸ºäº†å†æ¬¡éªŒè¯sqlå‡†ç¡®æ€§ï¼Œå†çœ‹ä¸€ç»„è¿è¡Œç»“æœï¼Œï¼ˆè°ƒæ•´æ—¥å¿—åˆ›å»ºæ—¶é—´ä¸ºlog_update \u003e â€œ2016-06-20â€ and log_update \u003c â€œ2017-03-01â€ï¼‰\nä¸Šé¢çš„sqlæœ‰ä¸ªé—®é¢˜å°±æ˜¯å½“æ•°æ®æ˜¯0çš„æ—¶å€™ï¼Œæ²¡æœ‰è¿›è¡Œç‰¹æ®Šå¤„ç†è¿™ä¸ªæ—¶å€™å¾—åˆ°çš„rank_noæ˜¯ä¸€ä¸ªnullå€¼ï¼Œæ’åºå°±ä¼šå‡ºé—®é¢˜ï¼Œä¸‹é¢é’ˆå¯¹ç¬¬ä¸‰ç§æƒ…å†µåšä¸€ä¸‹çº æ­£å…¶ä½™çš„ç±»ä¼¼ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 SET @rank = 0 ,@rowtotal := NULL ,@rowtotal1 = NULL ,@sart := 0; SELECT a.log_id, a.log_created, a.count, CASE WHEN @rowtotal = a.count THEN @rank WHEN @rowtotal := a.count THEN @rank := @rank + 1 + @sart WHEN @rowtotal = 0 THEN @rank := @rank +1 +@sart END AS rank_no, CASE WHEN @rowtotal1 = a.count THEN @sart := @sart + 1 WHEN @rowtotal1 := a.count THEN @sart := 0 WHEN @rowtotal1 =0 THEN @sart := 0 END AS sart FROM ( SELECT * FROM `logs` WHERE log_update \u003e \"2017-09-01\" ORDER BY count DESC ) a å‚è€ƒ\næŠ€å·§ mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ® åº“é‡Œçš„å­˜çš„æ—¶é—´æˆ³ï¼Œæ¯æ¡æ•°æ®çš„æ—¶é—´æˆ³éƒ½ä¸ä¸€æ ·ã€‚ æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼ŒæŒ‰å¤©ç»Ÿè®¡æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 SELECT FROM_UNIXTIME( create_time,'%Y-%m-%d') days, count( id ) countId FROM user_behavior where user_id = #{_parameter} GROUP BY days; mysqlè·å–å¥‡æ•°å¶æ•° å¥‡æ•°\n1 2 3 select * from table WHERE id \u0026 1; å¶æ•°ï¼šidå…ˆé™¤ä»¥2ç„¶åä¹˜2ï¼Œå¦‚æœä¸åŸæ¥çš„ç›¸ç­‰å°±æ˜¯å¶æ•°\n1 2 3 select * from table WHERE id = (id \u003e\u003e 1) \u003c\u003c 1; ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug ä¸»è¡¨ä¸€å¯¹å¤šå­è¡¨ï¼Œå­è¡¨å­˜äº†ä¸»è¡¨çš„idã€‚ä¸»è¡¨æ•°æ®æ¸…äº†ï¼ŒAUTO_INCREMENTä»1å¼€å§‹ï¼Œä½†æ˜¯å­è¡¨æ•°æ²¡æ¸…ç©ºã€‚ å¯¼è‡´çš„é—®é¢˜æ˜¯ï¼šå†æ¬¡æ–°å¢ä¸»è¡¨æ•°æ®æ—¶ï¼Œå‡å¦‚ä¸»è¡¨æ•°æ®idæ˜¯1ï¼Œé‚£ä¹ˆå­˜å…¥å­è¡¨çš„ä¸»è¡¨idæ˜¯1ï¼Œä½†æ˜¯å› ä¸ºå­è¡¨çš„æ•°æ®æ²¡æœ‰æ¸…ç©ºï¼Œä¹‹å‰ç•™åœ¨å­è¡¨çš„ä¸»è¡¨idä¸º1çš„æ•°æ®è¿˜åœ¨ã€‚é‚£ä¹ˆå†æ ¹æ®ä¸»è¡¨id=1æ—¶æŸ¥è¯¢ï¼Œå°±ä¼šå‡ºç°å¤šçš„æ•°æ®ï¼Œå®é™…æ˜¯å› ä¸ºæ—§æ•°æ®æ²¡åˆ é™¤å¯¼è‡´çš„ã€‚ä»¥åè¿˜å¾—æ³¨æ„è¿™ä¸ªé—®é¢˜ï¼Œåˆ é™¤æ®æ—¶å€™ï¼Œä¸»å­è¡¨ï¼ˆæœ‰å…³è”çš„ï¼‰æ•°æ®è¦ä¸€åŒåˆ é™¤ã€‚\nç»Ÿè®¡è¿ç»­å¤©æ•° å·²çŸ¥æœ‰ä¸€äº›ç”¨æˆ·æ•°æ®ï¼Œæ¯æ¡æ•°æ®éƒ½æœ‰æ—¶é—´ï¼Œæ—¶é—´æ ¼å¼æ˜¯Dateï¼š2021-05-23ã€‚å¦‚æœæ˜¯æ—¶é—´æˆ³ç±»å‹ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°FROM_UNIXTIME( create_time, '%Y-%m-%d' )æ ¼å¼åŒ–æˆè‡ªå·±æƒ³è¦çš„æ—¶é—´æ ¼å¼ã€‚ç°åœ¨æƒ³ï¼Œæ‰¾å‡ºè¿ç»­çš„å¤©æ•°çš„æ•°æ®ã€‚\né¦–å…ˆå°†æ•°æ®åˆ†ç»„\n1 2 3 4 5 6 7 8 select user_id, create_time from table_a group by user_id, create_time ç„¶åæŠŠè¿ç»­çš„å¤©æ•°è¿›è¡Œåˆ†ç»„\n1 2 3 4 5 6 7 8 9 10 11 12 SELECT *,(( SELECT count( 1 ) FROM ( SELECT user_id, create_time FROM table_a GROUP BY user_id, create_time ) dr2 WHERE dr1.user_id = dr2.user_id AND dr2.create_time \u003c= dr1.create_time ) - DAY ( dr1.create_time )) AS 'rownum' FROM ( SELECT user_id, create_time FROM table_a GROUP BY user_id, create_time ) dr1 ç„¶åæŒ‰ç”¨æˆ· ã€å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ å’Œ è¿ç»­å¤©æ•°åˆ†ç»„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 SELECT user_id, min( create_time ), max( create_time ),( datediff( max( create_time ), min( create_time ))+ 1 ) AS 'rn' FROM ( SELECT *,(( SELECT count( 1 ) FROM ( SELECT user_id, create_time FROM table_a GROUP BY user_id, create_time ) dr2 WHERE dr1.user_id = dr2.user_id AND dr2.create_time \u003c= dr1.create_time ) - DAY ( dr1.create_time )) AS 'rownum' FROM ( SELECT user_id, create_time FROM table_a GROUP BY user_id, create_time ) dr1 ) z GROUP BY user_id, rownum å‚è€ƒ\nç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå· è¡¨aï¼Œæ•°æ®ï¼š\nid name 5 å¼ ä¸‰ 6 æå›› 7 ç‹äº” é€šè¿‡ä¸€æ¡sqlè·å–è¿™ä¸‰æ¡è®°å½•ï¼Œå¹¶ä¸”ç»™æ¯è¡Œå‰é¢åŠ ä¸Šä»1å¼€å§‹çš„åºå·\nåºå· id name 1 5 å¼ ä¸‰ 2 6 æå›› 3 7 ç‹äº” 1 2 3 4 5 6 SELECT @rownum := @rownum + 1 AS rownum, a.* FROM ( SELECT @rownum := 0 ) r, table a; å†™æ³•2ï¼š\n1 2 3 4 5 6 SELECT @rowno := @rowno + 1 AS rowno, a.* FROM table a, ( SELECT @rowno := 0 ) t å¦‚æœæœ‰æŒ‰ç…§æŸä¸ªå­—æ®µæ’åºï¼Œè¡Œå·ä¼šä¸è§„åˆ™æ’åˆ—ï¼Œæ¢æˆå…ˆæ’åºï¼Œå¤–å±‚åŠ ä¸Šè¡Œå·ä¼šæ›´åŠ åˆé€‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 SELECT @ROWNO := @ROWNO + 1 AS ROWNO, T.* FROM ( SELECT a.* FROM table_name a LEFT JOIN ... WHERE ... ORDER BY ... desc ) T,( SELECT @ROWNO := 0 ) T3 ORDER BY ROWNO group_concat å®Œæ•´è¯­æ³•å¦‚ä¸‹ï¼š group_concat([DISTINCT] è¦è¿æ¥çš„å­—æ®µ [Order BY ASC/DESC æ’åºå­—æ®µ] [Separator 'åˆ†éš”ç¬¦'])\næ³¨æ„ï¼šä½¿ç”¨ GROUP_CONCATï¼ˆï¼‰å‡½æ•°å¿…é¡»å¯¹æºæ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¦åˆ™æ‰€æœ‰æ•°æ®ä¼šè¢«åˆå¹¶æˆä¸€è¡Œã€‚\nå‚è€ƒ å‚è€ƒ\nnullå€¼æ’åº ç°åœ¨éœ€è¦æŒ‰ç…§æäº¤æ—¶é—´create_timeæ­£åºæ’åºæ•°æ®ï¼Œ å‡è®¾create_timeå­—æ®µä¸­æœ‰nullå€¼ï¼Œå¦‚æœç›´æ¥ï¼Œorder by create_timeï¼Œä¼šå‘ç°create_timeä¸ºnullçš„æ•°æ®æ’åœ¨çš„å‰é¢ã€‚\nè§£å†³åŠæ³•ï¼š order by create_time is null,create_time\nmysql datetimeç±»å‹æ—¶é—´é”™è¯¯ åˆæ­¥åˆ¤æ–­æ˜¯mysqlæ—¶åŒºçš„é—®é¢˜ï¼Œå› ä¸ºmysqlæ—¶åŒºè®¾ç½®é»˜è®¤æ˜¯æ“ä½œç³»ç»Ÿæ—¶åŒºï¼ŒæŸ¥çœ‹äº†ä¸‹centosæ—¶åŒºï¼Œä¸œ8åŒºæ²¡æœ‰é”™ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤å®šæ˜¯ä»£ç é‡Œé¢è®¾ç½®äº†ä¸€ä¸ªé”™è¯¯çš„æ—¶åŒºã€‚\nè§£å†³æ–¹å¼ä¸€ æŸ¥çœ‹å½“å‰æ—¶åŒº show variables like â€˜%time_zone%â€™; å‘ç°æœç„¶æ˜¯CST,åŒ—ç¾çš„Central Standard Time\nè®¾ç½®æ—¶åŒº set global time_zone = â€˜+8:00â€™; set time_zone = â€˜+8:00â€™; flush PRIVILEGES;\nè§£å†³æ–¹å¼äºŒ åœ¨mysqlçš„è¿æ¥ååŠ ä¸Š serverTimezone=GMT%2B8\ngroup by è·å–æœ€æ–°çš„æ•°æ® å› ä¸ºgroup by æ˜¯è·å–çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è·å–æœ€åä¸€æ¡æ•°æ®ã€‚\n1 2 3 select * from chapter_user_dub where id in( select MAX(id) from chapter_user_dub where user_id = 106175 group by user_id ) å­æŸ¥è¯¢order byå’Œå¤–å±‚group by ç°åœ¨æƒ³å¯¹order byçš„ç»“æœé›†è¿›è¡Œgroup byï¼Œsqlå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 select id, name from table_a ta left join table_b tb on tb.id = ta.tb_id where ... order by tb.create_time group by ta.id å·²çŸ¥group byå–çš„æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œè€Œä¸”group byæ˜¯åœ¨order byä¹‹å‰æ‰§è¡Œï¼Œæ‰€æœ‰è·å–ä¸åˆ°æƒ³è¦çš„order byçš„ç»“æœé›†ï¼Œäºæ˜¯æƒ³ç”¨å­æŸ¥è¯¢ï¼š\n1 2 3 4 5 6 7 8 9 10 select * from ( select id, name from table_a ta left join table_b tb on tb.id = ta.tb_id where ... order by tb.create_time ) t GROUP BY ta.id è™½ç„¶åœ¨å¤–å±‚æ‰§è¡Œgroup byï¼Œä½†æ˜¯ç»“æœè¿˜æ˜¯ä¸å¯¹(å–çš„è¿˜æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œå­æŸ¥è¯¢æ²¡ç”¨)ã€‚ äºæ˜¯åœ¨å­æŸ¥è¯¢é‡Œè¾¹åŠ ä¸Šlimt\n1 2 3 4 5 6 7 8 9 10 11 select * from ( select id, name from table_a ta left join table_b tb on tb.id = ta.tb_id where ... order by tb.create_time limit 999 ) t GROUP BY ta.id å¥½äº†ã€‚åŸå› æ˜¯ä»€ä¹ˆæˆ‘ä¸çŸ¥é“ã€‚\ncase-whençš„å‡ ç§å½¢å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 CASE b.check_type when '1' then b.real_name when '2' then b.association_name else u2.name(æœ‰else) end AS \"user.name\", --------- CASE a.exh_type when '1' then a.is_art when '2' then c.is_art end AS \"isArt\" --------- case (caseåè¾¹æ²¡ä¸œè¥¿) when a.end_time \u003e now() then '1' when a.end_time \u0026lt; now() then '2' end AS \"isPass\" --------- where a.is_home = '1' and a.publish_status = '1' and ( case a.exh_type when '1' then a.audit_status = '2' else 1 = 1 end ) find_in_set find_in_set(str,strlist)\nstrï¼šè¦æŸ¥è¯¢çš„å­—ç¬¦ä¸² strlistï¼šå­—æ®µåï¼Œå­˜å‚¨å†…å®¹é€—å·åˆ†éš”ï¼Œå¦‚(1,2,6,8) æŸ¥è¯¢å­—æ®µ(strlist)ä¸­åŒ…å«(str)çš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºnullæˆ–è®°å½•ã€‚\nSELECT FIND_IN_SET('b', 'a,b,c,d'); è¿”å›2ï¼Œå› ä¸ºb åœ¨strlisté›†åˆä¸­æ”¾åœ¨2çš„ä½ç½®ã€‚\nfind_in_setå¾ˆé€‚åˆæŸ¥è¯¢è¡¨ä¸­æ•°æ®ä¸ºæ ‘å½¢çš„ç»“æ„ï¼Œæ¯”å¦‚éƒ¨é—¨ï¼Œä¸€èˆ¬æ˜¯è¿™ç§ç»“æ„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 1:æŠ€æœ¯éƒ¨ +-- 2:JAVAéƒ¨é—¨ |Â +-- 4:å½±é­” |Â +-- 5:ç™½ç‰› +-- 3:Pythonéƒ¨é—¨ +-- 6:ç«å¥³ +-- 7:å†°å¥³ 8:æ€»å…¬å¸ +-- 9:ä¼—æœ›æ•™è‚² |Â +-- 12:å¸‚åœºéƒ¨ |Â |Â +--14:å°é»‘ |Â |Â +--15:ç¾æœè |Â +-- 13:äººåŠ›éƒ¨ +-- 10:xxx +-- 11:xxx è¿™æ—¶å¦‚æœæƒ³æŸ¥è¯¢æŠ€æœ¯éƒ¨æˆ–æ€»å…¬å¸ä¸‹æ‰€æœ‰çš„äººï¼Œç”¨find_in_setå°±å¾ˆç®€å•ï¼š\n1 2 3 select * from find_in_set where find_in_set(2,path) find_in_set()å’Œinçš„åŒºåˆ« 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 create table find_in_set ( id int auto_increment, dep_name varchar(100) null comment 'éƒ¨é—¨å', parent_id int null comment 'çˆ¶çº§id', path varchar(100) null comment 'éƒ¨é—¨è·¯å¾„', constraint find_in_set_id_uindex unique (id) ); insert into find_in_set(dep_name, parent_id, path) values ('æ€»å…¬å¸',0,1), ('æŠ€æœ¯éƒ¨','1','1,2'), ('äººåŠ›éƒ¨','1','1,3'), ('æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨','2','1,2,4') æƒ³æŸ¥è¯¢æŠ€æœ¯éƒ¨ï¼š\n1 2 3 select * from find_in_set where 2 in (path) æ˜¯æ²¡æœ‰æ•°æ®çš„ï¼Œå› ä¸ºinçš„æ¡ä»¶ï¼Œå¿…é¡»æ˜¯å®Œå…¨åŒ¹é…ã€‚æ‰€ä»¥ä½¿ç”¨find_in_set\n1 2 3 select * from find_in_set where find_in_set(2,path) æŸ¥è¯¢ç»“æœï¼š\n1 2 2,æŠ€æœ¯éƒ¨,1,\"1,2\" 4,æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨,2,\"1,2,4\" æ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚\nå’Œlikeçš„åŒºåˆ« likeå¯èƒ½æŸ¥åˆ°æˆ‘ä»¬ä¸æƒ³è¦çš„è®°å½•ï¼Œfind_in_set æ¯”likeæ›´ç²¾å‡†ã€‚\nMySQLåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ å¦‚å›¾ï¼Œ4ç§é‡åˆæƒ…å†µå’Œ2ç§ä¸é‡åˆæƒ…å†µã€‚ å†™æ³•ä¸€ï¼š\n1 2 3 4 5 6 -- æ—¶é—´æ®µ a,b SELECT * FROM table WHERE (start_time \u003e= a and end_time \u003c= b) -- è¢«åŒ…å«äº† or (end_time \u003e= a and end_time \u003c=b) or (start_time \u003e= a and start_time \u003c=b) or (start_time \u003c= a and end_time \u003e=b) è§£æï¼šwhereåçš„4ä¸ªæ¡ä»¶åˆ†åˆ«ä»£è¡¨äº†å›¾ä¸­4ç§é‡åˆçš„æƒ…å†µã€‚ ä½†æ˜¯ç¬¬ä¸€ç§æƒ…å†µè¢«2å’Œ3åŒ…å«äº†ï¼Œæ‰€ä»¥ç®€åŒ–ä¸€ä¸‹å†™æ³•ï¼šã€€1 2 3 4 SELECT * FROM table WHERE (end_time \u003e= a and end_time \u003c=b) or (start_time \u003e= a and start_time \u003c=b) or (start_time \u003c= a and end_time \u003e=b); å†™æ³•äºŒï¼š SELECT * FROM table WHERE not (start_time \u003e b or end_time \u003c a);\nå…¶ä»– mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹ æ˜¨å¤©æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ”»å‡»ï¼Œå¯¼è‡´æœåŠ¡å™¨æ— æ³•è®¿é—®ï¼Œæ•°æ®åº“æ— æ³•è¿æ¥ã€‚ è§£å†³è¿‡ç¨‹ï¼š\nåœ¨é˜¿é‡Œäº‘æ§åˆ¶å°å¤‡ä»½æœåŠ¡å™¨ç¡¬ç›˜å¿«ç…§ é‡è£…æ“ä½œç³»ç»Ÿ å°†å¿«ç…§æŒ‚è½½åˆ°æ–°ç³»ç»Ÿä¸Šï¼Œæˆ‘æŒ‚è½½åˆ°äº†/mntç›®å½•ä¸‹ è¿›å…¥/mntç›®å½•ï¼ŒæŸ¥çœ‹my.cnfvim etc/my.cnfï¼Œå‘ç°dataæ–‡ä»¶åœ¨var/lib/mysql è¿›å…¥ç›®å½•cd var/lib/mysqlï¼Œå°†è¯¥ç›®å½•æ•´ä½“æ‰“åŒ…ã€‚ é‡æ–°å®‰è£…mysqlï¼Œå°†æ–°è£…mysqlçš„var/lib/mysqlåˆ é™¤ï¼Œå°†åˆšæ‰æ‰“åŒ…çš„dataç›®å½•å¤åˆ¶åˆ°/var/lib è§£å‹ï¼Œç„¶åå¯åŠ¨mysql è¿œç¨‹è¿æ¥å‘ç°mysqlæ— æ³•è®¿é—®ï¼Œæç¤ºtable xxxxx doesn't exist åœ¨æœåŠ¡å™¨ä»»æ„ä½ç½®è¾“å…¥mysql_upgrade -uroot -p --forceï¼Œç„¶åæç¤ºï¼š 1 2 Upgrade process completed successfully. Checking if update is needed. å†æ¬¡å°è¯•è¿œç¨‹è¿æ¥ï¼ŒæˆåŠŸï¼Œæ•°æ®éƒ½åœ¨ï¼ å¯¼å…¥.frmå’Œ.ibdæ–‡ä»¶ .frmå’Œ.ibdåˆ†åˆ«å¯¹åº”æ•°æ®åº“ä¸­çš„è¡¨åå’Œè¡¨ä¸­çš„æ•°æ®ã€‚ æˆ‘ä»¬è¿›å…¥åˆ°mysqlçš„dataæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°ä¸€ä¸ªåº“è¿›å»ï¼Œå¯ä»¥è¯å®æˆ‘çš„æƒ³æ³•ã€‚\nä¼˜åŒ–æ¡ˆä¾‹ åŸå§‹sqlï¼š\n1 2 3 4 5 6 7 8 9 10 11 select t1.xx, t1.xx, t2.xx, t3.xx from table_1 t1 left join table_2 t2 on t1.user_id = t2.id left join table_3 t3 on t2.id = t3.user_id where æ¡ä»¶ group by t1.user_id order by æ¡ä»¶ sqlè§£é‡Šï¼šç®€å•çš„left joinï¼Œæœ‰é—®é¢˜çš„åœ°æ–¹åœ¨äºgroup by t1.user_idï¼Œæ ¹æ® select çš„æ‰§è¡Œé¡ºåºï¼Œgroup by è‚¯å®šæ˜¯åœ¨left join ä¹‹åæ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡Œå› ä¸º join äº§ç”Ÿäº†å¾ˆå¤šæ²¡ç”¨çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼˜åŒ–æ€è·¯æ˜¯å…ˆ group by ï¼Œå† joinã€‚\nä¼˜åŒ–åï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 select t1.xx, t2.xx, t3.xx from ( select user_id, xx from table_1 where del_flag = 0 group by user_id -- åœ¨è¿™é‡Œå…ˆæ‰§è¡Œgroup by ) as t1 left join table_2 t2 on t1.user_id = t2.id left join table_3 t3 on t2.id = t3.user_id where æ¡ä»¶ order by æ¡ä»¶ æ€è·¯å°±æ˜¯å…ˆ group by ç„¶å joinï¼Œè¿™æ ·å°‘äº†å¾ˆå¤šå› ä¸º join äº§ç”Ÿçš„ç¬›å¡å°”ç§¯ã€‚\n",
  "wordCount" : "11229",
  "inLanguage": "en",
  "datePublished": "2019-12-02T18:13:55Z",
  "dateModified": "2019-12-02T18:13:55Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/en/posts/mysql/mysql%E6%8A%80%E5%B7%A7/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/en/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/en/links" title="ğŸ¤å‹é“¾">
                    <span>ğŸ¤å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/en/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/en/posts/">Posts</a></div>
    <h1 class="post-title">
      mysqlæŠ€å·§
    </h1>
    <div class="post-meta"><span title='2019-12-02 18:13:55 +0000 UTC'>2019-12-02</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#select%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f" aria-label="selectæ‰§è¡Œé¡ºåº">selectæ‰§è¡Œé¡ºåº</a></li>
                <li>
                    <a href="#%e6%97%b6%e9%97%b4%e7%9b%b8%e5%85%b3" aria-label="æ—¶é—´ç›¸å…³">æ—¶é—´ç›¸å…³</a></li>
                <li>
                    <a href="#rand" aria-label="rand()">rand()</a></li>
                <li>
                    <a href="#%e5%b9%b6%e5%8f%91%e6%8f%92%e5%85%a5%e5%ad%98%e5%9c%a8%e4%b8%8d%e6%8f%92%e5%85%a5%e5%ad%98%e5%9c%a8%e6%9b%b4%e6%96%b0%e6%93%8d%e4%bd%9c" aria-label="å¹¶å‘æ’å…¥ã€å­˜åœ¨ä¸æ’å…¥ã€å­˜åœ¨æ›´æ–°æ“ä½œ">å¹¶å‘æ’å…¥ã€å­˜åœ¨ä¸æ’å…¥ã€å­˜åœ¨æ›´æ–°æ“ä½œ</a></li>
                <li>
                    <a href="#union-all%e5%92%8corder-by" aria-label="union allå’Œorder by">union allå’Œorder by</a></li>
                <li>
                    <a href="#mysql%e5%8d%95%e8%a1%a8%e5%a4%9a%e6%ac%a1%e6%9f%a5%e8%af%a2%e5%92%8c%e5%a4%9a%e8%a1%a8%e8%81%94%e5%90%88%e6%9f%a5%e8%af%a2%e5%93%aa%e4%b8%aa%e6%95%88%e7%8e%87%e9%ab%98" aria-label="MySQLå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜ï¼Ÿ">MySQLå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜ï¼Ÿ</a></li>
                <li>
                    <a href="#mysql%e5%ad%98%e5%82%a8%e8%a1%a8%e6%83%85" aria-label="mysqlå­˜å‚¨è¡¨æƒ…">mysqlå­˜å‚¨è¡¨æƒ…</a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%a0%91%e7%9a%84%e6%89%80%e6%9c%89%e5%ad%90%e8%8a%82%e7%82%b9" aria-label="æŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹">æŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹</a><ul>
                        
                <li>
                    <a href="#%e6%96%b0%e7%9a%84%e6%80%9d%e8%b7%af" aria-label="æ–°çš„æ€è·¯">æ–°çš„æ€è·¯</a></li>
                <li>
                    <a href="#%e6%a0%b7%e4%be%8b%e6%95%b0%e6%8d%ae" aria-label="æ ·ä¾‹æ•°æ®">æ ·ä¾‹æ•°æ®</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%b8%80%e5%88%a9%e7%94%a8%e5%87%bd%e6%95%b0%e6%9d%a5%e5%be%97%e5%88%b0%e6%89%80%e6%9c%89%e5%ad%90%e8%8a%82%e7%82%b9%e5%8f%b7" aria-label="æ–¹æ³•ä¸€ï¼šåˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å·">æ–¹æ³•ä¸€ï¼šåˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å·</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%ba%8c%e5%88%a9%e7%94%a8%e4%b8%b4%e6%97%b6%e8%a1%a8%e5%92%8c%e8%bf%87%e7%a8%8b%e9%80%92%e5%bd%92" aria-label="æ–¹æ³•äºŒï¼šåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’">æ–¹æ³•äºŒï¼šåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’</a></li>
                <li>
                    <a href="#%e6%96%b9%e6%b3%95%e4%b8%89%e5%88%a9%e7%94%a8%e4%b8%ad%e9%97%b4%e8%a1%a8%e5%92%8c%e8%bf%87%e7%a8%8b" aria-label="æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹">æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%b8%80%e4%ba%9b%e7%89%b9%e6%ae%8a%e7%9a%84sql" aria-label="ä¸€äº›ç‰¹æ®Šçš„sql">ä¸€äº›ç‰¹æ®Šçš„sql</a><ul>
                        
                <li>
                    <a href="#%e5%87%ba%e8%87%aaarchive%e6%a1%a3%e6%a1%88%e7%ae%a1%e7%90%86%e7%b3%bb%e7%bb%9farchivemapperxml" aria-label="å‡ºè‡ªï¼šarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿï¼ŒArchiveMapper.xml">å‡ºè‡ªï¼šarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿï¼Œ<code>ArchiveMapper.xml</code></a></li>
                <li>
                    <a href="#2" aria-label="2">2</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4parents%e8%a1%a8%e4%b8%ad%e6%89%8b%e6%9c%ba%e5%8f%b7%e9%87%8d%e5%a4%8d%e7%9a%84%e6%95%b0%e6%8d%ae" aria-label="åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ®">åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ®</a></li>
                <li>
                    <a href="#%e7%bb%9f%e8%ae%a1status%e5%88%86%e5%88%ab%e4%b8%ba1%e5%92%8c0%e7%9a%84%e6%95%b0%e6%8d%ae" aria-label="ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ®">ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ®</a></li>
                <li>
                    <a href="#%e6%9b%b4%e6%96%b0%e6%95%b0%e6%8d%ae" aria-label="æ›´æ–°æ•°æ®">æ›´æ–°æ•°æ®</a></li></ul>
                </li>
                <li>
                    <a href="#mysql-order-by-%e5%ad%97%e6%ae%b5%e6%9c%89%e7%9b%b8%e5%90%8c%e5%80%bc%e6%8e%92%e5%ba%8f%e5%87%ba%e6%9d%a5%e7%9a%84%e5%ad%97%e6%ae%b5%e4%bc%9a%e9%9a%8f%e6%9c%ba" aria-label="mysql order by å­—æ®µæœ‰ç›¸åŒå€¼ï¼Œæ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº">mysql order by å­—æ®µæœ‰ç›¸åŒå€¼ï¼Œæ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº</a></li>
                <li>
                    <a href="#letf-join-%e4%b9%8b%e5%90%8e%e7%9a%84%e6%9d%a1%e4%bb%b6%e5%92%8c%e6%94%be%e5%88%b0where%e4%b9%8b%e5%90%8e%e7%9a%84%e6%9d%a1%e4%bb%b6%e6%9c%89%e4%bb%80%e4%b9%88%e5%8c%ba%e5%88%ab" aria-label="letf join ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«">letf join ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«</a></li>
                <li>
                    <a href="#mysql-%e8%8e%b7%e5%8f%96%e6%8e%92%e5%88%97%e5%ba%8f%e5%8f%b7" aria-label="mysql è·å–æ’åˆ—åºå·">mysql è·å–æ’åˆ—åºå·</a><ul>
                        
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e6%9f%90%e5%ad%97%e6%ae%b5%e6%8c%89%e5%ba%8f%e6%8e%92%e5%88%97%e5%b9%b6%e8%8e%b7%e5%8f%96%e6%8e%92%e5%ba%8f%e5%8f%b7" aria-label="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå·">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå·</a></li>
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e6%9f%90%e5%ad%97%e6%ae%b5%e6%8c%89%e5%ba%8f%e6%8e%92%e5%88%97%e8%8e%b7%e5%8f%96%e6%8e%92%e5%ba%8f%e5%8f%b7%e4%b8%94%e5%bd%93%e8%af%a5%e5%ad%97%e6%ae%b5%e7%9a%84%e5%80%bc%e5%ad%98%e5%9c%a8%e5%a4%9a%e4%b8%aa%e7%9b%b8%e5%90%8c%e7%9a%84%e8%ae%b0%e5%bd%95%e6%97%b6%e5%88%99%e7%9b%b8%e5%90%8c%e5%80%bc%e6%8e%92%e5%ba%8f%e5%8f%b7%e7%9b%b8%e5%90%8c" aria-label="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ</a></li>
                <li>
                    <a href="#%e6%a0%b9%e6%8d%ae%e6%9f%90%e5%ad%97%e6%ae%b5%e6%8c%89%e5%ba%8f%e6%8e%92%e5%88%97%e8%8e%b7%e5%8f%96%e6%8e%92%e5%ba%8f%e5%8f%b7%e4%b8%94%e5%bd%93%e8%af%a5%e5%ad%97%e6%ae%b5%e7%9a%84%e5%80%bc%e5%ad%98%e5%9c%a8%e5%a4%9a%e4%b8%aa%e7%9b%b8%e5%90%8c%e7%9a%84%e8%ae%b0%e5%bd%95%e6%97%b6%e5%88%99%e7%9b%b8%e5%90%8c%e5%80%bc%e7%9a%84%e8%ae%b0%e5%bd%95%e7%9a%84%e6%8e%92%e5%ba%8f%e5%8f%b7%e7%9b%b8%e5%90%8c%e5%b9%b6%e4%b8%94%e4%b8%8b%e4%b8%80%e7%bb%84%e5%80%bc%e7%9a%84%e6%8e%92%e5%ba%8f%e5%8f%b7%e4%b8%ba%e4%b8%8a%e4%b8%80%e7%bb%84%e5%86%85%e8%ae%b0%e5%bd%95%e6%95%b0%e4%b8%8a%e4%b8%80%e4%b8%aa%e6%8e%92%e5%ba%8f%e5%8f%b7" aria-label="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒï¼Œå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°&#43;ä¸Šä¸€ä¸ªæ’åºå·">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒï¼Œå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°+ä¸Šä¸€ä¸ªæ’åºå·</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8a%80%e5%b7%a7" aria-label="æŠ€å·§">æŠ€å·§</a><ul>
                        
                <li>
                    <a href="#mysql%e6%8c%89%e5%a4%a9%e7%bb%9f%e8%ae%a1%e6%95%b0%e6%8d%ae" aria-label="mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ®">mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ®</a></li>
                <li>
                    <a href="#mysql%e8%8e%b7%e5%8f%96%e5%a5%87%e6%95%b0%e5%81%b6%e6%95%b0" aria-label="mysqlè·å–å¥‡æ•°å¶æ•°">mysqlè·å–å¥‡æ•°å¶æ•°</a></li>
                <li>
                    <a href="#%e4%bb%8a%e5%a4%a9%e9%81%87%e5%88%b0%e7%9a%84%e5%a5%87%e6%80%aabug" aria-label="ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug">ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug</a></li>
                <li>
                    <a href="#%e7%bb%9f%e8%ae%a1%e8%bf%9e%e7%bb%ad%e5%a4%a9%e6%95%b0" aria-label="ç»Ÿè®¡è¿ç»­å¤©æ•°">ç»Ÿè®¡è¿ç»­å¤©æ•°</a></li>
                <li>
                    <a href="#%e7%bb%99%e6%9f%a5%e8%af%a2%e8%ae%b0%e5%bd%95%e6%b7%bb%e5%8a%a0%e8%87%aa%e7%84%b6%e5%ba%8f%e5%8f%b7" aria-label="ç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå·">ç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå·</a></li>
                <li>
                    <a href="#group_concat" aria-label="group_concat">group_concat</a></li>
                <li>
                    <a href="#null%e5%80%bc%e6%8e%92%e5%ba%8f" aria-label="nullå€¼æ’åº">nullå€¼æ’åº</a></li>
                <li>
                    <a href="#mysql-datetime%e7%b1%bb%e5%9e%8b%e6%97%b6%e9%97%b4%e9%94%99%e8%af%af" aria-label="mysql datetimeç±»å‹æ—¶é—´é”™è¯¯">mysql datetimeç±»å‹æ—¶é—´é”™è¯¯</a><ul>
                        
                <li>
                    <a href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e5%bc%8f%e4%b8%80" aria-label="è§£å†³æ–¹å¼ä¸€">è§£å†³æ–¹å¼ä¸€</a></li>
                <li>
                    <a href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e5%bc%8f%e4%ba%8c" aria-label="è§£å†³æ–¹å¼äºŒ">è§£å†³æ–¹å¼äºŒ</a></li></ul>
                </li>
                <li>
                    <a href="#group-by-%e8%8e%b7%e5%8f%96%e6%9c%80%e6%96%b0%e7%9a%84%e6%95%b0%e6%8d%ae" aria-label="group by è·å–æœ€æ–°çš„æ•°æ®">group by è·å–æœ€æ–°çš„æ•°æ®</a></li>
                <li>
                    <a href="#%e5%ad%90%e6%9f%a5%e8%af%a2order-by%e5%92%8c%e5%a4%96%e5%b1%82group-by" aria-label="å­æŸ¥è¯¢order byå’Œå¤–å±‚group by">å­æŸ¥è¯¢order byå’Œå¤–å±‚group by</a></li>
                <li>
                    <a href="#case-when%e7%9a%84%e5%87%a0%e7%a7%8d%e5%bd%a2%e5%bc%8f" aria-label="case-whençš„å‡ ç§å½¢å¼">case-whençš„å‡ ç§å½¢å¼</a></li>
                <li>
                    <a href="#find_in_set" aria-label="find_in_set">find_in_set</a><ul>
                        
                <li>
                    <a href="#find_in_set%e5%92%8cin%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="find_in_set()å’Œinçš„åŒºåˆ«">find_in_set()å’Œinçš„åŒºåˆ«</a></li>
                <li>
                    <a href="#%e5%92%8clike%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="å’Œlikeçš„åŒºåˆ«">å’Œlikeçš„åŒºåˆ«</a></li></ul>
                </li>
                <li>
                    <a href="#mysql%e5%88%a4%e6%96%ad%e6%97%b6%e9%97%b4%e6%ae%b5%e6%98%af%e5%90%a6%e9%87%8d%e5%90%88" aria-label="MySQLåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ">MySQLåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%85%b6%e4%bb%96" aria-label="å…¶ä»–">å…¶ä»–</a><ul>
                        
                <li>
                    <a href="#mysql%e5%af%bc%e5%85%a5data%e6%96%87%e4%bb%b6%e5%a4%b9" aria-label="mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹">mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹</a></li>
                <li>
                    <a href="#%e5%af%bc%e5%85%a5frm%e5%92%8cibd%e6%96%87%e4%bb%b6" aria-label="å¯¼å…¥.frmå’Œ.ibdæ–‡ä»¶">å¯¼å…¥<code>.frmå’Œ.ibd</code>æ–‡ä»¶</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bc%98%e5%8c%96%e6%a1%88%e4%be%8b" aria-label="ä¼˜åŒ–æ¡ˆä¾‹">ä¼˜åŒ–æ¡ˆä¾‹</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="selectæ‰§è¡Œé¡ºåº">selectæ‰§è¡Œé¡ºåº<a hidden class="anchor" aria-hidden="true" href="#selectæ‰§è¡Œé¡ºåº">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>(7) SELECT
</span></span><span style="display:flex;"><span>(8) DISTINCT &lt;select_list&gt;
</span></span><span style="display:flex;"><span>(1) FROM &lt;left_table&gt;
</span></span><span style="display:flex;"><span>(3) &lt;join_type&gt; JOIN &lt;right_table&gt;
</span></span><span style="display:flex;"><span>(2) ON &lt;join_condition&gt;
</span></span><span style="display:flex;"><span>(4) WHERE &lt;where_condition&gt;
</span></span><span style="display:flex;"><span>(5) GROUP BY &lt;group_by_list&gt;
</span></span><span style="display:flex;"><span>(6) HAVING &lt;having_condition&gt;
</span></span><span style="display:flex;"><span>(9) ORDER BY &lt;order_by_condition&gt;
</span></span><span style="display:flex;"><span>(10) LIMIT &lt;limit_number&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>select æ‰§è¡Œé¡ºåºä¸€å…±åˆ†ä¸º10æ­¥ã€‚å…¶ä¸­æ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šäº§ç”Ÿä¸€å¼ è™šæ‹Ÿçš„è¡¨ï¼Œåªæ˜¯è¿™äº›è™šæ‹Ÿçš„è¡¨å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä½†æ˜¯åªæœ‰æœ€åä¸€ä¸ªè™šæ‹Ÿçš„è¡¨æ‰ä¼šè¢«ä½œä¸ºç»“æœè¿”å›ã€‚å¦‚æœæ²¡æœ‰åœ¨è¯­å¥ä¸­æŒ‡å®šæŸä¸€ä¸ªå­å¥ï¼Œé‚£ä¹ˆå°†ä¼šè·³è¿‡ç›¸åº”çš„æ­¥éª¤ã€‚</p>
<ol>
<li>fromï¼šå¯¹ from å·¦è¾¹çš„è¡¨å’Œå³è¾¹çš„è¡¨è®¡ç®—ç¬›å¡å°”ç§¯ï¼Œäº§ç”Ÿè™šè¡¨VT1ã€‚</li>
<li>onï¼šå¯¹è™šè¡¨VT1è¿›è¡ŒONè¿‡æ»¤ï¼Œåªæœ‰é‚£äº›ç¬¦åˆ join çš„è¡Œæ‰ä¼šè¢«è®°å½•åœ¨è™šè¡¨VT2ä¸­ã€‚</li>
<li>joinï¼š å¦‚æœæŒ‡å®šäº†OUTER JOINï¼ˆæ¯”å¦‚left joinã€ right joinï¼‰ï¼Œé‚£ä¹ˆä¿ç•™è¡¨ä¸­æœªåŒ¹é…çš„è¡Œå°±ä¼šä½œä¸ºå¤–éƒ¨è¡Œæ·»åŠ åˆ°è™šæ‹Ÿè¡¨VT2ä¸­ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT3ã€‚</li>
<li>whereï¼š å¯¹è™šæ‹Ÿè¡¨VT3è¿›è¡ŒWHEREæ¡ä»¶è¿‡æ»¤ã€‚åªæœ‰ç¬¦åˆ where çš„è®°å½•æ‰ä¼šè¢«æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT4ä¸­ã€‚</li>
<li>group by ï¼šæ ¹æ®group byå­å¥ä¸­çš„åˆ—ï¼Œå¯¹VT4ä¸­çš„è®°å½•è¿›è¡Œåˆ†ç»„æ“ä½œï¼Œäº§ç”ŸVT5ã€‚</li>
<li>havingï¼š å¯¹è™šæ‹Ÿè¡¨VT5åº”ç”¨havingè¿‡æ»¤ï¼Œåªæœ‰ç¬¦åˆ having çš„è®°å½•æ‰ä¼šè¢« æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT6ä¸­ã€‚</li>
<li>selectï¼šæ‰§è¡Œselectæ“ä½œï¼Œé€‰æ‹©æŒ‡å®šçš„åˆ—ï¼Œæ’å…¥åˆ°è™šæ‹Ÿè¡¨VT7ä¸­ã€‚</li>
<li>distinctï¼šå¯¹VT7ä¸­çš„è®°å½•è¿›è¡Œå»é‡ã€‚äº§ç”Ÿè™šæ‹Ÿè¡¨VT8ã€‚</li>
<li>order by ï¼šå°†è™šæ‹Ÿè¡¨VT8ä¸­çš„è®°å½•æŒ‰ç…§ order by è¿›è¡Œæ’åºæ“ä½œï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT9ã€‚</li>
<li>limitï¼šå–å‡ºæŒ‡å®šè¡Œçš„è®°å½•ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT10ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚</li>
</ol>
<h1 id="æ—¶é—´ç›¸å…³">æ—¶é—´ç›¸å…³<a hidden class="anchor" aria-hidden="true" href="#æ—¶é—´ç›¸å…³">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">84
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f00">è·å–ä»Šå¤©åˆ°æ˜å¤©çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> date_format(create_date,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>) 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">BETWEEN</span> date_format(curdate(),<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>) 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">and</span> DATE_SUB(curdate(),<span style="color:#fff;font-weight:bold">INTERVAL</span> -<span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">DAY</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">å½“å¤©æ•°æ®</span><span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> date_format(create_date,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>) = date_format(curdate(),<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">å½“å¤©æ•°æ®</span><span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> to_days(<span style="color:#f00">æ—¶é—´å­—æ®µå</span>) = to_days(now());
</span></span><span style="display:flex;"><span><span style="color:#f00">æ³¨ï¼š</span>to_days <span style="color:#f00">æ˜¯</span>mysql<span style="color:#f00">çš„å‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æ˜¨å¤©æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> TO_DAYS( NOW( ) ) - TO_DAYS( <span style="color:#f00">æ—¶é—´å­—æ®µå</span>) &lt;= <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">è¿‘</span><span style="color:#ff0;font-weight:bold">7</span><span style="color:#f00">å¤©</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> DATE_SUB(CURDATE(), <span style="color:#fff;font-weight:bold">INTERVAL</span> <span style="color:#ff0;font-weight:bold">7</span> <span style="color:#fff;font-weight:bold">DAY</span>) &lt;= <span style="color:#fff;font-weight:bold">date</span>(<span style="color:#f00">æ—¶é—´å­—æ®µå</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">è¿‘</span><span style="color:#ff0;font-weight:bold">30</span><span style="color:#f00">å¤©</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> DATE_SUB(CURDATE(), <span style="color:#fff;font-weight:bold">INTERVAL</span> <span style="color:#ff0;font-weight:bold">30</span> <span style="color:#fff;font-weight:bold">DAY</span>) &lt;= <span style="color:#fff;font-weight:bold">date</span>(<span style="color:#f00">æ—¶é—´å­—æ®µå</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æœ¬æœˆ</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> DATE_FORMAT( <span style="color:#f00">æ—¶é—´å­—æ®µå</span>, <span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span> ) = DATE_FORMAT( CURDATE( ) , <span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">ä¸Šä¸€æœˆ</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#f00">è¡¨å</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> PERIOD_DIFF( date_format( now( ) , <span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span> ) , date_format( <span style="color:#f00">æ—¶é—´å­—æ®µå</span>, <span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span> ) ) =<span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢æœ¬å­£åº¦æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> `ht_invoice_information`
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> QUARTER(create_date)=QUARTER(now());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢ä¸Šå­£åº¦æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> `ht_invoice_information`
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> QUARTER(create_date)=QUARTER(DATE_SUB(now(),<span style="color:#fff;font-weight:bold">interval</span> <span style="color:#ff0;font-weight:bold">1</span> QUARTER));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢æœ¬å¹´æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> `ht_invoice_information`
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#fff;font-weight:bold">YEAR</span>(create_date)=<span style="color:#fff;font-weight:bold">YEAR</span>(NOW());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢ä¸Šå¹´æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> `ht_invoice_information` 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#fff;font-weight:bold">year</span>(create_date)=<span style="color:#fff;font-weight:bold">year</span>(date_sub(now(),<span style="color:#fff;font-weight:bold">interval</span> <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">year</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢å½“å‰è¿™å‘¨çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> name,create_time <span style="color:#fff;font-weight:bold">FROM</span> enterprise
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> YEARWEEK(date_format(create_time,<span style="color:#0ff;font-weight:bold">&#39;%Y-%m-%d&#39;</span>)) = YEARWEEK(now());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢ä¸Šå‘¨çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> name,submittime <span style="color:#fff;font-weight:bold">FROM</span> enterprise 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> YEARWEEK(date_format(submittime,<span style="color:#0ff;font-weight:bold">&#39;%Y-%m-%d&#39;</span>)) = YEARWEEK(now())-<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢ä¸Šä¸ªæœˆçš„æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> name,submittime <span style="color:#fff;font-weight:bold">from</span> enterprise 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> date_format(submittime,<span style="color:#0ff;font-weight:bold">&#39;%Y-%m&#39;</span>) = date_format(DATE_SUB(curdate(), <span style="color:#fff;font-weight:bold">INTERVAL</span> <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">MONTH</span>),<span style="color:#0ff;font-weight:bold">&#39;%Y-%m&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">user</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> DATE_FORMAT(pudate,<span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span>) = DATE_FORMAT(CURDATE(),<span style="color:#0ff;font-weight:bold">&#39;%Y%m&#39;</span>) ; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">user</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> WEEKOFYEAR(FROM_UNIXTIME(pudate,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>)) = WEEKOFYEAR(now()) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">user</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#fff;font-weight:bold">MONTH</span>(FROM_UNIXTIME(pudate,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>)) = <span style="color:#fff;font-weight:bold">MONTH</span>(now()) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">user</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#fff;font-weight:bold">YEAR</span>(FROM_UNIXTIME(pudate,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>)) = <span style="color:#fff;font-weight:bold">YEAR</span>(now()) 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">and</span> <span style="color:#fff;font-weight:bold">MONTH</span>(FROM_UNIXTIME(pudate,<span style="color:#0ff;font-weight:bold">&#39;%y-%m-%d&#39;</span>)) = <span style="color:#fff;font-weight:bold">MONTH</span>(now()) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">user</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> pudate <span style="color:#fff;font-weight:bold">between</span>  <span style="color:#f00">ä¸Šæœˆæœ€åä¸€å¤©</span>  <span style="color:#fff;font-weight:bold">and</span> <span style="color:#f00">ä¸‹æœˆç¬¬ä¸€å¤©</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢å½“å‰æœˆä»½çš„æ•°æ®</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> name,submittime <span style="color:#fff;font-weight:bold">from</span> enterprise 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> date_format(submittime,<span style="color:#0ff;font-weight:bold">&#39;%Y-%m&#39;</span>)=date_format(now(),<span style="color:#0ff;font-weight:bold">&#39;%Y-%m&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f00">æŸ¥è¯¢è·ç¦»å½“å‰ç°åœ¨</span><span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">ä¸ªæœˆçš„æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> name,submittime <span style="color:#fff;font-weight:bold">from</span> enterprise 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> submittime <span style="color:#fff;font-weight:bold">between</span> date_sub(now(),<span style="color:#fff;font-weight:bold">interval</span> <span style="color:#ff0;font-weight:bold">6</span> <span style="color:#fff;font-weight:bold">month</span>) <span style="color:#fff;font-weight:bold">and</span> now();
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="rand">rand()<a hidden class="anchor" aria-hidden="true" href="#rand">#</a></h1>
<p>order by RAND()ï¼šéšæœºè¿”å›ç»“æœï¼Œéšæœºå‡½æ•°æ•ˆç‡å¾ˆä½ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ï¼Œå› ä¸ºå®ƒçš„æ•ˆç‡ä¼šéšç€æ•°æ®é‡çš„å¢å¤§ï¼Œæ•ˆç‡è¶Šæ¥è¶Šä½ã€‚</p>
<p>æ¨èä¸€ç§ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	* 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	`question` <span style="color:#fff;font-weight:bold">AS</span> t1
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">JOIN</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>		ROUND(
</span></span><span style="display:flex;"><span>			RAND( ) * ( ( <span style="color:#fff;font-weight:bold">SELECT</span> <span style="color:#fff;font-weight:bold">MAX</span>( id ) <span style="color:#fff;font-weight:bold">FROM</span> `question` ) 
</span></span><span style="display:flex;"><span>			- ( <span style="color:#fff;font-weight:bold">SELECT</span> <span style="color:#fff;font-weight:bold">MIN</span>( id ) <span style="color:#fff;font-weight:bold">FROM</span> `question` ) ) 
</span></span><span style="display:flex;"><span>			+ ( <span style="color:#fff;font-weight:bold">SELECT</span> <span style="color:#fff;font-weight:bold">MIN</span>( id ) <span style="color:#fff;font-weight:bold">FROM</span> `question` ) 
</span></span><span style="display:flex;"><span>		) <span style="color:#fff;font-weight:bold">AS</span> id 
</span></span><span style="display:flex;"><span>	) <span style="color:#fff;font-weight:bold">AS</span> t2 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>	t1.id &gt;= t2.id 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>	t1.id 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">LIMIT</span> <span style="color:#ff0;font-weight:bold">5</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŠ ä¸ŠMIN(id)çš„åˆ¤æ–­ï¼Œæ˜¯å› ä¸ºæœ€å¼€å§‹æµ‹è¯•çš„æ—¶å€™ï¼Œå› ä¸ºæ²¡æœ‰åŠ ä¸ŠMIN(id)çš„åˆ¤æ–­ï¼Œç»“æœæœ‰ä¸€åŠçš„æ—¶é—´æ€»æ˜¯æŸ¥è¯¢åˆ°è¡¨ä¸­çš„å‰é¢å‡ è¡Œã€‚è¿™ç§æ–¹æ³•ç¼ºç‚¹æ˜¯ä¼šäº§ç”Ÿidè¿ç»­çš„æ•°æ®ã€‚</p>
<h1 id="å¹¶å‘æ’å…¥å­˜åœ¨ä¸æ’å…¥å­˜åœ¨æ›´æ–°æ“ä½œ">å¹¶å‘æ’å…¥ã€å­˜åœ¨ä¸æ’å…¥ã€å­˜åœ¨æ›´æ–°æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#å¹¶å‘æ’å…¥å­˜åœ¨ä¸æ’å…¥å­˜åœ¨æ›´æ–°æ“ä½œ">#</a></h1>
<ol>
<li>
<p>é€šå¸¸ä¼šï¼Œå…ˆæŸ¥è¯¢ï¼Œä¸å­˜åœ¨å†æ’å…¥ï¼Œä½†æ˜¯è¿™æ ·æ— æ³•é¿å…å¹¶å‘é—®é¢˜ï¼Œä¸ç”¨è€ƒè™‘äº†ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨<code>replace into</code>ï¼Œå­˜åœ¨å³æ›´æ–°ï¼Œä¸å­˜åœ¨å³æ’å…¥
<code>replace into table (id,name) values(1,&quot;å°æ˜&quot;)</code>
å¦‚æœå‘ç°è¡¨ä¸­å·²ç»æœ‰æ­¤è¡Œæ•°æ®ï¼ˆæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•åˆ¤æ–­ï¼‰ï¼Œåˆ™å…ˆåˆ é™¤æ­¤è¡Œæ•°æ®ï¼Œç„¶åæ’å…¥æ–°çš„æ•°æ®ï¼Œå¦åˆ™ï¼Œç›´æ¥æ’å…¥æ–°æ•°æ®ã€‚æ‰€ä»¥ï¼Œæ’å…¥æ—¶å¦‚æœä¸æ’å…¥ä¸»é”®(é€æ¸é»˜è®¤é€’å¢)ï¼Œå°±éœ€è¦ä¿è¯ä¸€åˆ—æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä¿è¯å”¯ä¸€ï¼Œæ‰å¯ä»¥ã€‚</p>
</li>
<li>
<p>å­˜åœ¨ä¸æ’å…¥ï¼Œä¸å­˜åœ¨å†æ’å…¥(æ„Ÿè§‰è¿™ç§æ–¹æ³•æ˜¯æœ€å¥½çš„)
mysql ä¸èƒ½åœ¨æ’å…¥æ—¶å¸¦whereæ¡ä»¶ï¼Œæ•…ç”¨ä¸´æ—¶è¡¨å¤„ç†</p>
</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>INSERT INTO demo_in(a,b,c) 
</span></span><span style="display:flex;"><span>SELECT 123, 2, 4 FROM DUAL 
</span></span><span style="display:flex;"><span>WHERE NOT EXISTS(SELECT c FROM demo_in WHERE c = 4);
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨ä¸´æ—¶è¡¨DUALæ¥æ ‡è®°æ•°æ®ï¼Œç„¶åæ’å…¥åˆ°demo_inè¡¨ä¸­ã€‚
æ¡ä»¶æ˜¯c=4ï¼Œå¹¶ä¸”not existsï¼Œä¹Ÿå°±æ˜¯å½“c=4æ¡ä»¶æ»¡è¶³ï¼Œåˆ™ä¸æ’å…¥ã€‚</p>
<h1 id="union-allå’Œorder-by">union allå’Œorder by<a hidden class="anchor" aria-hidden="true" href="#union-allå’Œorder-by">#</a></h1>
<p>å¤šä¸ªselect è¯­å¥ union æ—¶ä¸æ˜¯ç®€å•çš„å°†æŸ¥è¯¢ç»“æœæ‹¼æ¥èµ·æ¥ è€Œæ˜¯å°†sqlæ‹¼æ¥èµ·æ¥ç¼–è¯‘ï¼ˆåšä¸ºä¸€ä¸ªsqlè¯­å¥ï¼‰ï¼Œç„¶åå»æ‰§è¡Œã€‚æ‰€ä»¥union è¿æ¥çš„è¯­å¥ä¸­åªä¼šå‡ºç°ä¸€ä¸ªorder by ï¼ˆä¸åŒ…å«å­æŸ¥è¯¢ä¸­çš„ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥ sqlæœªæ­£ç¡®ç»“æŸçš„é”™è¯¯ã€‚è§£å†³æ–¹æ³•ï¼šå°†order by è¯­å¥æ”¾åˆ°å­æŸ¥è¯¢ä¸­ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f00">å°†æ’åºåçš„æŸ¥è¯¢ç»“æœæ‹¼æ¥èµ·æ¥</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span>(<span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">table</span> <span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> a)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">union</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> (<span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> table1 <span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> b)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">union</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> (<span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> table2 <span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> <span style="color:#fff;font-weight:bold">c</span>);//<span style="color:#f00">æ³¨æ„ï¼Œè¿™é‡Œçš„</span><span style="color:#fff;font-weight:bold">order</span> by<span style="color:#f00">ä¼šå¤±æ•ˆ</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> d
</span></span><span style="display:flex;"><span><span style="color:#f00">æ­¤å¤„çš„</span><span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> <span style="color:#f00">æ˜¯å°†æœ€åçš„æ‹¼æ¥ç»“æœé›†æ’åºï¼Œæ‰“ä¹±äº†ä¹‹å‰é€šè¿‡</span> a<span style="color:#f00">ã€</span>b<span style="color:#f00">ã€</span>c<span style="color:#f00">çš„æ’åºã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="mysqlå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢å“ªä¸ªæ•ˆç‡é«˜">MySQLå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜ï¼Ÿ<a hidden class="anchor" aria-hidden="true" href="#mysqlå•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢å“ªä¸ªæ•ˆç‡é«˜">#</a></h1>
<p>å¾ˆå¤šé«˜æ€§èƒ½çš„åº”ç”¨éƒ½ä¼šå¯¹å…³è”æŸ¥è¯¢è¿›è¡Œåˆ†è§£ã€‚
ç®€å•åœ°ï¼Œå¯ä»¥å¯¹æ¯ä¸ªè¡¨è¿›è¡Œä¸€æ¬¡å•è¡¨æŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœåœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œå…³è”ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>select * from tableA a
</span></span><span style="display:flex;"><span>join tableB b on b.tableA_id = a.id
</span></span><span style="display:flex;"><span>join tableC c on c.tableB_id = b.id
</span></span><span style="display:flex;"><span>where a.name = &#39;123&#39;;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥åˆ†è§£æˆä¸‹é¢è¿™äº›æŸ¥è¯¢æ¥ä»£æ›¿ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>select id from tableA where name = &#39;123&#39;; -- ç»“æœA
</span></span><span style="display:flex;"><span>select * from tableB where tableA_id = id(ç»“æœA) -- ç»“æœB
</span></span><span style="display:flex;"><span>select * from tableC where id in (ç»“æœB)
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ°åº•ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ
èµ·åˆæ„Ÿè§‰ï¼Œè¿™æ ·åšå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼ŒåŸæœ¬ä¸€æ¡æŸ¥è¯¢ï¼Œè¿™é‡Œå´å˜æˆäº†å¤šæ¡æŸ¥è¯¢ï¼Œè¿”å›ç»“æœåˆæ˜¯ä¸€æ¨¡ä¸€æ ·ã€‚
äº‹å®ä¸Šï¼Œç”¨åˆ†è§£å…³è”æŸ¥è¯¢çš„æ–¹å¼é‡æ„æŸ¥è¯¢å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li>è®©ç¼“å­˜æ•ˆç‡æ›´é«˜
å¯¹äºMySQLçš„æŸ¥è¯¢ç¼“å­˜æ¥è¯´ï¼Œå¦‚æœå…³è”ä¸­çš„æŸä¸ªè¡¨å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜äº†ï¼Œè€Œæ‹†åˆ†åï¼Œå¦‚æœæŸä¸ªè¡¨å¾ˆå°‘æ”¹å˜ï¼Œé‚£ä¹ˆåŸºäºè¯¥è¡¨çš„æŸ¥è¯¢å°±å¯ä»¥é‡å¤åˆ©ç”¨æŸ¥è¯¢ç¼“å­˜ç»“æœäº†ã€‚</li>
<li>å¯ä»¥å‡å°‘å†—ä½™è®°å½•çš„æŸ¥è¯¢ã€‚</li>
<li>æŸ¥è¯¢æœ¬èº«æ•ˆç‡ä¹Ÿå¯èƒ½ä¼šæœ‰æ‰€æå‡</li>
<li>å°†æŸ¥è¯¢åˆ†è§£åï¼Œæ‰§è¡Œå•ä¸ªæŸ¥è¯¢å¯ä»¥å‡å°‘é”çš„ç«äº‰ã€‚</li>
<li>åœ¨åº”ç”¨å±‚åšå…³è”ï¼Œå¯ä»¥æ›´å®¹æ˜“å¯¹æ•°æ®åº“è¿›è¡Œæ‹†åˆ†ï¼Œæ›´å®¹æ˜“åšåˆ°é«˜æ€§èƒ½å’Œå¯æ‰©å±•ã€‚</li>
<li>è¿™æ ·åšç›¸å½“äºåœ¨åº”ç”¨ä¸­å®ç°äº†å“ˆå¸Œå…³è”ï¼Œè€Œä¸æ˜¯ä½¿ç”¨MySQLçš„åµŒå¥—ç¯å…³è”ï¼ŒæŸäº›åœºæ™¯å“ˆå¸Œå…³è”çš„æ•ˆç‡æ›´é«˜å¾ˆå¤šã€‚</li>
</ul>
<h1 id="mysqlå­˜å‚¨è¡¨æƒ…">mysqlå­˜å‚¨è¡¨æƒ…<a hidden class="anchor" aria-hidden="true" href="#mysqlå­˜å‚¨è¡¨æƒ…">#</a></h1>
<p>å­˜å‚¨è¡¨æƒ…æ—¶æŠ¥é”™ï¼š
<code>java.sql.SQLException: Incorrect string value: '\xF0\x9F\x92\x94' for colum n 'name' at row 1 </code>
ä½¿ç”¨mysqlæ•°æ®åº“çš„æ—¶å€™ï¼Œå¦‚æœå­—ç¬¦é›†æ˜¯UTF-8ï¼Œå½“å­˜å‚¨emojiè¡¨æƒ…çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºä»¥ä¸Šå¼‚å¸¸ã€‚
è¿™æ˜¯ç”±äºå­—ç¬¦é›†ä¸æ”¯æŒçš„å¼‚å¸¸ï¼Œå› ä¸ºutf-8ç¼–ç æœ‰å¯èƒ½æ˜¯ä¸¤ä¸ªï¼Œä¸‰ä¸ªï¼Œå››ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­Emojiè¡¨æƒ…æ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œmysqlçš„utf-8ç¼–ç æœ€å¤šä¸‰ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´æ•°æ®æ’ä¸è¿›å»ã€‚
è§£å†³ï¼š</p>
<ol>
<li>ä¿®æ”¹databaseã€tableã€columnå­—ç¬¦é›†</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ALTER DATABASE database_name CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;
</span></span><span style="display:flex;"><span>ALTER TABLE table_name CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
</span></span><span style="display:flex;"><span>ALTER TABLE table_name CHANGE column_name VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
</span></span></code></pre></td></tr></table>
</div>
</div><p>é™¤äº†columnçš„å­—ç¬¦é›†ï¼Œåº“å’Œè¡¨çš„å­—ç¬¦é›†ä¸æ˜¯å¿…é¡»ä¿®æ”¹ã€‚</p>
<ol start="2">
<li>ä¿®æ”¹mysqlé…ç½®æ–‡ä»¶</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[client]
</span></span><span style="display:flex;"><span>default-character-set = utf8mb4
</span></span><span style="display:flex;"><span>[mysql]
</span></span><span style="display:flex;"><span>default-character-set = utf8mb4
</span></span><span style="display:flex;"><span>[mysqld]
</span></span><span style="display:flex;"><span>character-set-client-handshake = FALSE
</span></span><span style="display:flex;"><span>character-set-server = utf8mb4
</span></span><span style="display:flex;"><span>collation-server = utf8mb4_unicode_ci
</span></span><span style="display:flex;"><span>init_connect=&#39;SET NAMES utf8mb4&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>æ£€æŸ¥<code>mysql-connector-java</code>ç‰ˆæœ¬ï¼Œå¿…é¡»é«˜äº5.1.13å¦åˆ™ä»ç„¶ä¸èƒ½è¯•ç”¨utf8mb4</li>
<li>ä¿®æ”¹é“¾æ¥æ•°æ®åº“åœ°å€</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>jdbc:mysql://localhost:3306/test?
</span></span><span style="display:flex;"><span>&#34;useUnicode=true&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;characterEncoding=UTF-8&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;zeroDateTimeBehavior=convertToNull&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;useSSL=false&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;allowMultiQueries=true&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;autoReconnect=true&#34; +
</span></span><span style="display:flex;"><span>&#34;&amp;rewriteBatchedStatements=TRUE&#34;);
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœå‡çº§äº†mysql-connectorï¼Œå…¶ä¸­çš„characterEncoding=utf8å¯ä»¥è‡ªåŠ¨è¢«è¯†åˆ«ä¸ºutf8mb4ï¼ˆå…¼å®¹åŸæ¥çš„utf8ï¼‰ï¼Œè€ŒautoReconnectionï¼ˆå½“æ•°æ®åº“è¿æ¥å¼‚å¸¸ä¸­æ–­æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨é‡æ–°è¿æ¥ï¼Ÿé»˜è®¤ä¸ºfalseï¼‰å¼ºçƒˆå»ºè®®é…ä¸Šï¼Œå¿½ç•¥è¿™ä¸ªå±æ€§ï¼Œå¯èƒ½å¯¼è‡´ç¼“å­˜ç¼˜æ•… ï¼Œæ²¡æœ‰è¯»å–åˆ°DBæœ€æ–°çš„é…ç½®ï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•è¯•ç”¨utf8mb4å­—ç¬¦é›†ã€‚</p>
<h1 id="æŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹">æŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹<a hidden class="anchor" aria-hidden="true" href="#æŸ¥æ ‘çš„æ‰€æœ‰å­èŠ‚ç‚¹">#</a></h1>
<p>åœ¨Oracle ä¸­æˆ‘ä»¬çŸ¥é“æœ‰ä¸€ä¸ª Hierarchical Queries é€šè¿‡CONNECT BY æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„æŸ¥äº†æ‰€æœ‰å½“å‰èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ä½†å¾ˆé—æ†¾ï¼Œåœ¨MySQLçš„ç›®å‰ç‰ˆæœ¬ä¸­è¿˜æ²¡æœ‰å¯¹åº”çš„åŠŸèƒ½ã€‚
åœ¨MySQLä¸­å¦‚æœæ˜¯æœ‰é™çš„å±‚æ¬¡ï¼Œæ¯”å¦‚æˆ‘ä»¬äº‹å…ˆå¦‚æœå¯ä»¥ç¡®å®šè¿™ä¸ªæ ‘çš„æœ€å¤§æ·±åº¦æ˜¯4, é‚£ä¹ˆæ‰€æœ‰èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘çš„æ·±åº¦å‡ä¸ä¼šè¶…è¿‡4ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡left join æ¥å®ç°ã€‚
ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ— æ³•æ§åˆ¶æ ‘çš„æ·±åº¦ã€‚è¿™æ—¶å°±éœ€è¦åœ¨MySQLä¸­ç”¨å­˜å‚¨è¿‡ç¨‹æ¥å®ç°æˆ–åœ¨ä½ çš„ç¨‹åºä¸­æ¥å®ç°è¿™ä¸ªé€’å½’ã€‚æœ¬æ–‡è®¨è®ºä¸€ä¸‹å‡ ç§å®ç°çš„æ–¹æ³•ã€‚</p>
<h2 id="æ–°çš„æ€è·¯">æ–°çš„æ€è·¯<a hidden class="anchor" aria-hidden="true" href="#æ–°çš„æ€è·¯">#</a></h2>
<p>è§£å†³è¿™ç§æ ‘çŠ¶ç»“æ„é—®é¢˜ï¼Œå¯ä»¥åœ¨è¡¨ä¸­åŠ ä¸€ä¸ªå­—æ®µ<code>path</code>ï¼Œæ ‡è¯†è¿™æ¡æ•°æ®çš„è·¯å¾„ï¼Œå³çˆ¶å­çº§ç»“æ„è·¯å¾„ã€‚</p>
<table>
<thead>
<tr>
<th>id</th>
<th>å…¬å¸å</th>
<th>parent_id</th>
<th>path</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>æ€»å…¬å¸</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>æŠ€æœ¯éƒ¨</td>
<td>1</td>
<td>1,2</td>
</tr>
<tr>
<td>3</td>
<td>äººåŠ›éƒ¨</td>
<td>1</td>
<td>1,3</td>
</tr>
<tr>
<td>4</td>
<td>æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨</td>
<td>2</td>
<td>1,2,4</td>
</tr>
</tbody>
</table>
<p>è¿™æ ·å¦‚æœæˆ‘æƒ³æŸ¥æ€»å…¬å¸ä¸‹æœ‰å“ªäº›éƒ¨é—¨ï¼Œéœ€è¦ä½¿ç”¨mysql å‡½æ•°<code>FIND_IN_SET(str,strlist)</code>ï¼Œlikeæ˜¯ä¸è¡Œçš„ã€‚</p>
<h2 id="æ ·ä¾‹æ•°æ®">æ ·ä¾‹æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#æ ·ä¾‹æ•°æ®">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>create table treeNodes
</span></span><span style="display:flex;"><span>	(
</span></span><span style="display:flex;"><span>	id int primary key,
</span></span><span style="display:flex;"><span>	nodename varchar(20),
</span></span><span style="display:flex;"><span>	pid int
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>select * from treenodes;
</span></span><span style="display:flex;"><span>+----+----------+------+
</span></span><span style="display:flex;"><span>| id | nodename | pidÂ  |
</span></span><span style="display:flex;"><span>+----+----------+------+
</span></span><span style="display:flex;"><span>|Â  1 | AÂ Â Â Â Â Â Â  |Â Â Â  0 |
</span></span><span style="display:flex;"><span>|Â  2 | BÂ Â Â Â Â Â Â  |Â Â Â  1 |
</span></span><span style="display:flex;"><span>|Â  3 | CÂ Â Â Â Â Â Â  |Â Â Â  1 |
</span></span><span style="display:flex;"><span>|Â  4 | DÂ Â Â Â Â Â Â  |Â Â Â  2 |
</span></span><span style="display:flex;"><span>|Â  5 | EÂ Â Â Â Â Â Â  |Â Â Â  2 |
</span></span><span style="display:flex;"><span>|Â  6 | FÂ Â Â Â Â Â Â  |Â Â Â  3 |
</span></span><span style="display:flex;"><span>|Â  7 | GÂ Â Â Â Â Â Â  |Â Â Â  6 |
</span></span><span style="display:flex;"><span>|Â  8 | HÂ Â Â Â Â Â Â  |Â Â Â  0 |
</span></span><span style="display:flex;"><span>|Â  9 | IÂ Â Â Â Â Â Â  |Â Â Â  8 |
</span></span><span style="display:flex;"><span>| 10 | JÂ Â Â Â Â Â Â  |Â Â Â  8 |
</span></span><span style="display:flex;"><span>| 11 | KÂ Â Â Â Â Â Â  |Â Â Â  8 |
</span></span><span style="display:flex;"><span>| 12 | LÂ Â Â Â Â Â Â  |Â Â Â  9 |
</span></span><span style="display:flex;"><span>| 13 | MÂ Â Â Â Â Â Â  |Â Â Â  9 |
</span></span><span style="display:flex;"><span>| 14 | NÂ Â Â Â Â Â Â  |Â Â  12 |
</span></span><span style="display:flex;"><span>| 15 | OÂ Â Â Â Â Â Â  |Â Â  12 |
</span></span><span style="display:flex;"><span>| 16 | PÂ Â Â Â Â Â Â  |Â Â  15 |
</span></span><span style="display:flex;"><span>| 17 | QÂ Â Â Â Â Â Â  |Â Â  15 |
</span></span><span style="display:flex;"><span>+----+----------+------+	
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ‘å½¢å›¾å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1:A
</span></span><span style="display:flex;"><span>Â  +-- 2:B
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 4:D
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 5:E
</span></span><span style="display:flex;"><span>Â  +-- 3:C
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â  +-- 6:F
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â Â  +-- 7:G
</span></span><span style="display:flex;"><span>Â 8:H
</span></span><span style="display:flex;"><span>Â  +-- 9:I
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 12:L
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â  +--14:N
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â  +--15:O
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â Â Â Â Â  +--16:P
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â Â Â Â Â  +--17:Q
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 13:M
</span></span><span style="display:flex;"><span>Â  +-- 10:J
</span></span><span style="display:flex;"><span>Â  +-- 11:K
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ–¹æ³•ä¸€åˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å·">æ–¹æ³•ä¸€ï¼šåˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å·<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•ä¸€åˆ©ç”¨å‡½æ•°æ¥å¾—åˆ°æ‰€æœ‰å­èŠ‚ç‚¹å·">#</a></h2>
<p>åˆ›å»ºä¸€ä¸ªfunction getChildLst, å¾—åˆ°ä¸€ä¸ªç”±æ‰€æœ‰å­èŠ‚ç‚¹å·ç»„æˆçš„å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">FUNCTION</span> `getChildLst` ( rootId <span style="color:#fff;font-weight:bold">INT</span> ) <span style="color:#fff;font-weight:bold">RETURNS</span> <span style="color:#fff;font-weight:bold">VARCHAR</span>(<span style="color:#ff0;font-weight:bold">1000</span>) <span style="color:#fff;font-weight:bold">BEGIN</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">DECLARE</span> sTemp <span style="color:#fff;font-weight:bold">VARCHAR</span> ( <span style="color:#ff0;font-weight:bold">1000</span> );
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">DECLARE</span> sTempChd <span style="color:#fff;font-weight:bold">VARCHAR</span> ( <span style="color:#ff0;font-weight:bold">1000</span> );<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SET</span> sTemp = <span style="color:#0ff;font-weight:bold">&#39;$&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SET</span> sTempChd = <span style="color:#fff;font-weight:bold">cast</span>( rootId <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#fff;font-weight:bold">CHAR</span> );	<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span>
</span></span><span style="display:flex;"><span>WHILE
</span></span><span style="display:flex;"><span>	sTempChd <span style="color:#fff;font-weight:bold">IS</span> <span style="color:#fff;font-weight:bold">NOT</span> <span style="color:#fff;font-weight:bold">NULL</span> <span style="color:#fff;font-weight:bold">DO</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SET</span> sTemp = concat( sTemp, <span style="color:#0ff;font-weight:bold">&#39;,&#39;</span>, sTempChd );
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	group_concat( id ) <span style="color:#fff;font-weight:bold">INTO</span> sTempChd 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	treeNodes 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>	FIND_IN_SET( pid, sTempChd ) &gt; <span style="color:#ff0;font-weight:bold">0</span>;<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#f00">Â </span> 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">END</span> WHILE;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">RETURN</span> sTemp;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">END</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨æˆ‘ä»¬ç›´æ¥åˆ©ç”¨find_in_setå‡½æ•°é…åˆè¿™ä¸ªgetChildlstæ¥æŸ¥æ‰¾</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> getChildLst(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">-----------------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>| getChildLst(<span style="color:#ff0;font-weight:bold">1</span>)<span style="color:#f00">Â Â </span>|
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">-----------------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>| <span style="color:#f00">$</span>,<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>,<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>,<span style="color:#ff0;font-weight:bold">6</span>,<span style="color:#ff0;font-weight:bold">7</span> |
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">-----------------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> treeNodes <span style="color:#fff;font-weight:bold">where</span> FIND_IN_SET(id, getChildLst(<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>| id | nodename | pid<span style="color:#f00">Â Â </span>|
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">1</span> | A<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">0</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">2</span> | B<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">1</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">3</span> | <span style="color:#fff;font-weight:bold">C</span><span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">1</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">4</span> | D<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">2</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">5</span> | E<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">2</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">6</span> | F<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">3</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">7</span> | <span style="color:#fff;font-weight:bold">G</span><span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">6</span> |
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> treeNodes <span style="color:#fff;font-weight:bold">where</span> FIND_IN_SET(id, getChildLst(<span style="color:#ff0;font-weight:bold">3</span>));
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>| id | nodename | pid<span style="color:#f00">Â Â </span>|
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">3</span> | <span style="color:#fff;font-weight:bold">C</span><span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">1</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">6</span> | F<span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">3</span> |
</span></span><span style="display:flex;"><span>|<span style="color:#f00">Â Â </span><span style="color:#ff0;font-weight:bold">7</span> | <span style="color:#fff;font-weight:bold">G</span><span style="color:#f00">Â </span> <span style="color:#f00">Â Â </span> <span style="color:#f00">Â Â Â </span>|<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#ff0;font-weight:bold">6</span> |
</span></span><span style="display:flex;"><span>+<span style="color:#007f7f">----+----------+------+
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¼˜ç‚¹: ç®€å•ï¼Œæ–¹ä¾¿ï¼Œæ²¡æœ‰é€’å½’è°ƒç”¨å±‚æ¬¡æ·±åº¦çš„é™åˆ¶ (max_sp_recursion_depth,æœ€å¤§255) ï¼›
ç¼ºç‚¹ï¼šé•¿åº¦å—é™ï¼Œè™½ç„¶å¯ä»¥æ‰©å¤§ RETURNS varchar(1000)ï¼Œä½†æ€»æ˜¯æœ‰æœ€å¤§é™åˆ¶çš„ã€‚
MySQLç›®å‰ç‰ˆæœ¬( 5.1.33-community)ä¸­è¿˜ä¸æ”¯æŒfunction çš„é€’å½’è°ƒç”¨ã€‚</p>
<h2 id="æ–¹æ³•äºŒåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’">æ–¹æ³•äºŒï¼šåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•äºŒåˆ©ç”¨ä¸´æ—¶è¡¨å’Œè¿‡ç¨‹é€’å½’">#</a></h2>
<p>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹å¦‚ä¸‹ã€‚createChildLst ä¸ºé€’å½’è¿‡ç¨‹ï¼ŒshowChildLstä¸ºè°ƒç”¨å…¥å£è¿‡ç¨‹ï¼Œå‡†å¤‡ä¸´æ—¶è¡¨åŠåˆå§‹åŒ–ã€‚</p>
<p>å…¥å£è¿‡ç¨‹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">PROCEDURE</span> showChildLst ( <span style="color:#fff;font-weight:bold">IN</span> rootId <span style="color:#fff;font-weight:bold">INT</span> ) <span style="color:#fff;font-weight:bold">BEGIN</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">TEMPORARY</span> <span style="color:#fff;font-weight:bold">TABLE</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">IF</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">NOT</span> <span style="color:#fff;font-weight:bold">EXISTS</span> tmpLst ( sno <span style="color:#fff;font-weight:bold">INT</span> <span style="color:#fff;font-weight:bold">PRIMARY</span> <span style="color:#fff;font-weight:bold">KEY</span> auto_increment, id <span style="color:#fff;font-weight:bold">INT</span>, depth <span style="color:#fff;font-weight:bold">INT</span> );
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">DELETE</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>		tmpLst;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">CALL</span> createChildLst ( rootId, <span style="color:#ff0;font-weight:bold">0</span> );
</span></span><span style="display:flex;"><span>	<span style="color:#f00">Â </span> <span style="color:#f00">Â </span> <span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	tmpLst.*,
</span></span><span style="display:flex;"><span>	treeNodes.* 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>		tmpLst,
</span></span><span style="display:flex;"><span>		treeNodes 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>		tmpLst.id = treeNodes.id 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>	tmpLst.sno;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">END</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€’å½’è¿‡ç¨‹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">PROCEDURE</span> createChildLst ( <span style="color:#fff;font-weight:bold">IN</span> rootId <span style="color:#fff;font-weight:bold">INT</span>, <span style="color:#fff;font-weight:bold">IN</span> nDepth <span style="color:#fff;font-weight:bold">INT</span> ) <span style="color:#fff;font-weight:bold">BEGIN</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">DECLARE</span>
</span></span><span style="display:flex;"><span>		done <span style="color:#fff;font-weight:bold">INT</span> <span style="color:#fff;font-weight:bold">DEFAULT</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">DECLARE</span>
</span></span><span style="display:flex;"><span>		b <span style="color:#fff;font-weight:bold">INT</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">DECLARE</span>
</span></span><span style="display:flex;"><span>		cur1 <span style="color:#fff;font-weight:bold">CURSOR</span> <span style="color:#fff;font-weight:bold">FOR</span> <span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>		id 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>		treeNodes 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>		pid = rootId;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">DECLARE</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">CONTINUE</span> <span style="color:#fff;font-weight:bold">HANDLER</span> <span style="color:#fff;font-weight:bold">FOR</span> <span style="color:#fff;font-weight:bold">NOT</span> <span style="color:#fff;font-weight:bold">FOUND</span> 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">SET</span> done = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">INSERT</span> <span style="color:#fff;font-weight:bold">INTO</span> tmpLst
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">VALUES</span>
</span></span><span style="display:flex;"><span>		( <span style="color:#fff;font-weight:bold">NULL</span>, rootId, nDepth );
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">OPEN</span> cur1;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FETCH</span> cur1 <span style="color:#fff;font-weight:bold">INTO</span> b;
</span></span><span style="display:flex;"><span>	WHILE
</span></span><span style="display:flex;"><span>			done = <span style="color:#ff0;font-weight:bold">0</span> <span style="color:#fff;font-weight:bold">DO</span>
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">CALL</span> createChildLst ( b, nDepth + <span style="color:#ff0;font-weight:bold">1</span> );
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FETCH</span> cur1 <span style="color:#fff;font-weight:bold">INTO</span> b;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">END</span> WHILE;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CLOSE</span> cur1;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">END</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è°ƒç”¨æ—¶ä¼ å…¥ç»“ç‚¹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>call showChildLst(1);
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span><span style="display:flex;"><span>| sno | idÂ Â  | depth | id | nodename | pidÂ  |
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span><span style="display:flex;"><span>|Â Â  4 |Â Â Â  1 |Â Â Â Â  0 |Â  1 | AÂ Â Â Â Â Â Â  |Â Â Â  0 |
</span></span><span style="display:flex;"><span>|Â Â  5 |Â Â Â  2 |Â Â Â Â  1 |Â  2 | BÂ Â Â Â Â Â Â  |Â Â Â  1 |
</span></span><span style="display:flex;"><span>|Â Â  6 |Â Â Â  4 |Â Â Â Â  2 |Â  4 | DÂ Â Â Â Â Â Â  |Â Â Â  2 |
</span></span><span style="display:flex;"><span>|Â Â  7 |Â Â Â  5 |Â Â Â Â  2 |Â  5 | EÂ Â Â Â Â Â Â  |Â Â Â  2 |
</span></span><span style="display:flex;"><span>|Â Â  8 |Â Â Â  3 |Â Â Â Â  1 |Â  3 | CÂ Â Â Â Â Â Â  |Â Â Â  1 |
</span></span><span style="display:flex;"><span>|Â Â  9 |Â Â Â  6 |Â Â Â Â  2 |Â  6 | FÂ Â Â Â Â Â Â  |Â Â Â  3 |
</span></span><span style="display:flex;"><span>|Â  10 |Â Â Â  7 |Â Â Â Â  3 |Â  7 | GÂ Â Â Â Â Â Â  |Â Â Â  6 |
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>call showChildLst(3);
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span><span style="display:flex;"><span>| sno | idÂ Â  | depth | id | nodename | pidÂ  |
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span><span style="display:flex;"><span>|Â Â  1 |Â Â Â  3 |Â Â Â Â  0 |Â  3 | CÂ Â Â Â Â Â Â  |Â Â Â  1 |
</span></span><span style="display:flex;"><span>|Â Â  2 |Â Â Â  6 |Â Â Â Â  1 |Â  6 | FÂ Â Â Â Â Â Â  |Â Â Â  3 |
</span></span><span style="display:flex;"><span>|Â Â  3 |Â Â Â  7 |Â Â Â Â  2 |Â  7 | GÂ Â Â Â Â Â Â  |Â Â Â  6 |
</span></span><span style="display:flex;"><span>+-----+------+-------+----+----------+------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>depth ä¸ºæ·±åº¦ï¼Œè¿™æ ·å¯ä»¥åœ¨ç¨‹åºè¿›è¡Œä¸€äº›æ˜¾ç¤ºä¸Šçš„æ ¼å¼åŒ–å¤„ç†ã€‚ç±»ä¼¼äºoracleä¸­çš„Â level ä¼ªåˆ—ã€‚sno ä»…ä¾›æ’åºæ§åˆ¶ã€‚è¿™æ ·ä½ è¿˜å¯ä»¥é€šè¿‡ä¸´æ—¶è¡¨tmpLstä¸æ•°æ®åº“ä¸­å…¶å®ƒè¡¨è¿›è¡Œè”æ¥æŸ¥è¯¢ã€‚</p>
<p>MySQLä¸­ä½ å¯ä»¥åˆ©ç”¨ç³»ç»Ÿå‚æ•° max_sp_recursion_depth æ¥æ§åˆ¶é€’å½’è°ƒç”¨çš„å±‚æ•°ä¸Šé™ã€‚å¦‚ä¸‹ä¾‹è®¾ä¸º12
<code>set max_sp_recursion_depth=12;</code></p>
<p>ä¼˜ç‚¹ï¼šå¯ä»¥æ›´çµæ´»å¤„ç†ï¼ŒåŠå±‚æ•°çš„æ˜¾ç¤ºã€‚å¹¶ä¸”å¯ä»¥æŒ‰ç…§æ ‘çš„éå†é¡ºåºå¾—åˆ°ç»“æœã€‚
ç¼ºç‚¹ï¼šé€’å½’æœ‰255çš„é™åˆ¶</p>
<h2 id="æ–¹æ³•ä¸‰åˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹">æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹<a hidden class="anchor" aria-hidden="true" href="#æ–¹æ³•ä¸‰åˆ©ç”¨ä¸­é—´è¡¨å’Œè¿‡ç¨‹">#</a></h2>
<p>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹å¦‚ä¸‹ã€‚ç”±äºMySQLä¸­ä¸å…è®¸åœ¨åŒä¸€è¯­å¥ä¸­å¯¹ä¸´æ—¶è¡¨å¤šæ¬¡å¼•ç”¨ï¼Œåªä»¥ä½¿ç”¨æ™®é€šè¡¨tmpLstæ¥å®ç°äº†ã€‚å½“ç„¶ä½ çš„ç¨‹åºä¸­è´Ÿè´£åœ¨ç”¨å®Œåæ¸…é™¤è¿™ä¸ªè¡¨ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">drop</span> <span style="color:#fff;font-weight:bold">PROCEDURE</span> <span style="color:#fff;font-weight:bold">IF</span> <span style="color:#fff;font-weight:bold">EXISTS</span>  showTreeNodes;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">PROCEDURE</span> showTreeNodes (<span style="color:#fff;font-weight:bold">IN</span> rootid <span style="color:#fff;font-weight:bold">INT</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">BEGIN</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">DECLARE</span> <span style="color:#fff;font-weight:bold">Level</span> <span style="color:#fff;font-weight:bold">int</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">drop</span> <span style="color:#fff;font-weight:bold">TABLE</span> <span style="color:#fff;font-weight:bold">IF</span> <span style="color:#fff;font-weight:bold">EXISTS</span> tmpLst;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CREATE</span> <span style="color:#fff;font-weight:bold">TABLE</span> tmpLst (
</span></span><span style="display:flex;"><span> id <span style="color:#fff;font-weight:bold">int</span>,
</span></span><span style="display:flex;"><span> nLevel <span style="color:#fff;font-weight:bold">int</span>,
</span></span><span style="display:flex;"><span> sCort <span style="color:#fff;font-weight:bold">varchar</span>(<span style="color:#ff0;font-weight:bold">8000</span>)
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">Set</span> <span style="color:#fff;font-weight:bold">Level</span> = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">INSERT</span> <span style="color:#fff;font-weight:bold">into</span> tmpLst <span style="color:#fff;font-weight:bold">SELECT</span> id,<span style="color:#fff;font-weight:bold">Level</span>,ID <span style="color:#fff;font-weight:bold">FROM</span> category <span style="color:#fff;font-weight:bold">WHERE</span> parent_id = rootid;
</span></span><span style="display:flex;"><span>WHILE <span style="color:#fff;font-weight:bold">ROW_COUNT</span>() &gt; <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">DO</span> <span style="color:#fff;font-weight:bold">SET</span> <span style="color:#fff;font-weight:bold">Level</span> = <span style="color:#fff;font-weight:bold">Level</span> + <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span> <span style="color:#fff;font-weight:bold">INSERT</span> <span style="color:#fff;font-weight:bold">into</span> tmpLst
</span></span><span style="display:flex;"><span>  <span style="color:#fff;font-weight:bold">SELECT</span> A.ID,<span style="color:#fff;font-weight:bold">Level</span>,concat(B.sCort,A.ID) <span style="color:#fff;font-weight:bold">FROM</span> category A,tmpLst B
</span></span><span style="display:flex;"><span>   <span style="color:#fff;font-weight:bold">WHERE</span> A.parent_id = B.ID <span style="color:#fff;font-weight:bold">AND</span> B.nLevel = <span style="color:#fff;font-weight:bold">Level</span>-<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">END</span> WHILE;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">END</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CALL</span> showTreeNodes(<span style="color:#ff0;font-weight:bold">0</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰§è¡Œå®Œåä¼šäº§ç”Ÿä¸€ä¸ªtmpLstè¡¨ï¼ŒnLevel ä¸ºèŠ‚ç‚¹æ·±åº¦ï¼ŒsCort ä¸ºæ’åºå­—æ®µã€‚
ä½¿ç”¨æ–¹æ³•</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SELECT concat(SPACE(B.nLevel*2),&#39;+--&#39;,A.nodename) FROM treeNodes A,tmpLst B WHERE A.ID=B.ID ORDER BY B.sCort;
</span></span><span style="display:flex;"><span>+--------------------------------------------+
</span></span><span style="display:flex;"><span>| concat(SPACE(B.nLevel*2),&#39;+--&#39;,A.nodename) |
</span></span><span style="display:flex;"><span>+--------------------------------------------+
</span></span><span style="display:flex;"><span>| +--AÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â  +--BÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â  +--DÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â  +--EÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â  +--CÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â  +--FÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â Â Â  +--GÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>| +--HÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â  +--JÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â  +--KÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â  +--IÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â  +--LÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â Â Â  +--NÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â Â Â  +--OÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â Â Â Â Â  +--PÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â Â Â Â Â  +--QÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>|Â Â Â Â  +--MÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
</span></span><span style="display:flex;"><span>+--------------------------------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¼˜ç‚¹ï¼šå±‚æ•°çš„æ˜¾ç¤ºã€‚å¹¶ä¸”å¯ä»¥æŒ‰ç…§æ ‘çš„éå†é¡ºåºå¾—åˆ°ç»“æœã€‚æ²¡æœ‰é€’å½’é™åˆ¶ã€‚
ç¼ºç‚¹ï¼šMySQLä¸­å¯¹ä¸´æ—¶è¡¨çš„é™åˆ¶ï¼Œåªèƒ½ä½¿ç”¨æ™®é€šè¡¨ï¼Œéœ€åšäº‹åæ¸…ç†ã€‚</p>
<p><a href="https://blog.csdn.net/ACMAIN_CHM/article/details/4142971">å‚è€ƒåœ°å€</a></p>
<h1 id="ä¸€äº›ç‰¹æ®Šçš„sql">ä¸€äº›ç‰¹æ®Šçš„sql<a hidden class="anchor" aria-hidden="true" href="#ä¸€äº›ç‰¹æ®Šçš„sql">#</a></h1>
<h2 id="å‡ºè‡ªarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿarchivemapperxml">å‡ºè‡ªï¼šarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿï¼Œ<code>ArchiveMapper.xml</code><a hidden class="anchor" aria-hidden="true" href="#å‡ºè‡ªarchiveæ¡£æ¡ˆç®¡ç†ç³»ç»Ÿarchivemapperxml">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>&lt;!<span style="color:#007f7f">-- æ¡ˆä»¶åˆ—è¡¨ --&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>&lt;<span style="color:#fff;font-weight:bold">select</span> id=<span style="color:#0ff;font-weight:bold">&#34;caseList&#34;</span> resultType=<span style="color:#0ff;font-weight:bold">&#34;map&#34;</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>	id,
</span></span><span style="display:flex;"><span>	concat(
</span></span><span style="display:flex;"><span>	&lt;foreach collection=<span style="color:#0ff;font-weight:bold">&#34;list&#34;</span> separator=<span style="color:#0ff;font-weight:bold">&#34;,&#34;</span> item=<span style="color:#0ff;font-weight:bold">&#34;i&#34;</span>&gt;
</span></span><span style="display:flex;"><span>		<span style="color:#f00">${</span>i.columnEnglish<span style="color:#f00">}</span>
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#fff;font-weight:bold">if</span> test=<span style="color:#0ff;font-weight:bold">&#34;null != i.connector and &#39;&#39; != i.connector&#34;</span>&gt;
</span></span><span style="display:flex;"><span>		  ,<span style="color:#f00">${</span>i.connector<span style="color:#f00">}</span>
</span></span><span style="display:flex;"><span>		&lt;/<span style="color:#fff;font-weight:bold">if</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;/foreach&gt;
</span></span><span style="display:flex;"><span>	) dataName
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> `<span style="color:#f00">${</span>tableName<span style="color:#f00">}</span>`
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#fff;font-weight:bold">select</span>&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2">2<a hidden class="anchor" aria-hidden="true" href="#2">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> 
</span></span><span style="display:flex;"><span>	* 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">table_name</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> id <span style="color:#fff;font-weight:bold">in</span> (<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> field(id,<span style="color:#ff0;font-weight:bold">1</span>,<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">3</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®iné‡Œçš„å‚æ•°æ’åºã€‚
xmlå†™æ³•ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>order by field(q.id,
</span></span><span style="display:flex;"><span>&lt;foreach collection=&#34;questionIdList&#34; separator=&#34;,&#34; item=&#34;i&#34;&gt;
</span></span><span style="display:flex;"><span>  #{i}
</span></span><span style="display:flex;"><span>&lt;/foreach&gt;
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ®">åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#åˆ é™¤parentsè¡¨ä¸­æ‰‹æœºå·é‡å¤çš„æ•°æ®">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">DELETE</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span> parents
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span> mobile <span style="color:#fff;font-weight:bold">IN</span> ( <span style="color:#fff;font-weight:bold">SELECT</span> mobile <span style="color:#fff;font-weight:bold">FROM</span> ( <span style="color:#fff;font-weight:bold">SELECT</span> id, mobile, <span style="color:#fff;font-weight:bold">count</span>( id ) <span style="color:#fff;font-weight:bold">count</span> <span style="color:#fff;font-weight:bold">FROM</span> parents <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> mobile <span style="color:#fff;font-weight:bold">HAVING</span> <span style="color:#fff;font-weight:bold">count</span> &gt; <span style="color:#ff0;font-weight:bold">1</span> ) a )
</span></span><span style="display:flex;"><span> <span style="color:#fff;font-weight:bold">AND</span> id <span style="color:#fff;font-weight:bold">NOT</span> <span style="color:#fff;font-weight:bold">IN</span> ( <span style="color:#fff;font-weight:bold">SELECT</span> id <span style="color:#fff;font-weight:bold">FROM</span> ( <span style="color:#fff;font-weight:bold">SELECT</span> id, mobile, <span style="color:#fff;font-weight:bold">count</span>( id ) <span style="color:#fff;font-weight:bold">count</span> <span style="color:#fff;font-weight:bold">FROM</span> parents <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> mobile <span style="color:#fff;font-weight:bold">HAVING</span> <span style="color:#fff;font-weight:bold">count</span> &gt; <span style="color:#ff0;font-weight:bold">1</span> ) a )
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ®">ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#ç»Ÿè®¡statusåˆ†åˆ«ä¸º1å’Œ0çš„æ•°æ®">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>select
</span></span><span style="display:flex;"><span>	sum(if(status = 1,1,0)) finished_no,
</span></span><span style="display:flex;"><span>	sum(if(status = 0,1,0)) unfinished_no
</span></span><span style="display:flex;"><span>from message_task
</span></span><span style="display:flex;"><span>where message_id = #{_parameter}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ›´æ–°æ•°æ®">æ›´æ–°æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#æ›´æ–°æ•°æ®">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>update process_video_data t1
</span></span><span style="display:flex;"><span>left join process_video_data t2 on t1.album_name = t2.album_name
</span></span><span style="display:flex;"><span>set t1.album_id = t2.album_id
</span></span><span style="display:flex;"><span>where t1.album_id is null
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="mysql-order-by-å­—æ®µæœ‰ç›¸åŒå€¼æ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº">mysql order by å­—æ®µæœ‰ç›¸åŒå€¼ï¼Œæ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº<a hidden class="anchor" aria-hidden="true" href="#mysql-order-by-å­—æ®µæœ‰ç›¸åŒå€¼æ’åºå‡ºæ¥çš„å­—æ®µä¼šéšæœº">#</a></h1>
<p>ä¸€äº›æ•°æ®ï¼Œåˆ›å»ºæ—¶é—´ä¼šæœ‰ç›¸åŒçš„ã€‚ä½†æ˜¯æˆ‘éœ€è¦æŒ‰ç…§æ—¶é—´æ’åºï¼Œæ­¤æ—¶mysqlè¿”å›çš„æ•°æ®ä¼šå‡ºç°éšæœºã€‚
<code>select * from table_a order by create_time desc</code>
<a href="https://dev.mysql.com/doc/refman/5.7/en/limit-optimization.html">æŸ¥é˜…å®˜ç½‘å‘ç°</a>
â€œIf multiple rows have identical values in theÂ ORDER BYÂ columns, the server is free to return those rows in any order, and may do so differently depending on the overall execution plan. In other words, the sort order of those rows is nondeterministic with respect to the nonordered columns.â€
ç¿»è¯‘ï¼šå¦‚æœåœ¨ORDER BYåˆ—ä¸­æœ‰å¤šä¸ªè¡Œå…·æœ‰ç›¸åŒçš„å€¼ï¼Œåˆ™æœåŠ¡å™¨å¯ä»¥è‡ªç”±ä»¥ä»»ä½•é¡ºåºè¿”å›è¿™äº›è¡Œï¼Œå¹¶ä¸”æ ¹æ®æ•´ä½“æ‰§è¡Œè®¡åˆ’çš„ä¸åŒï¼Œè¿”å›å€¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ æ¢å¥è¯è¯´ï¼Œè¿™äº›è¡Œçš„æ’åºé¡ºåºç›¸å¯¹äºæ— åºåˆ—æ˜¯ä¸ç¡®å®šçš„ã€‚
MySQLå®˜ç½‘ä¸Šä¹Ÿç»™å‡ºäº†ä¸€ç§æ–¹æ¡ˆï¼š
â€œIf it is important to ensure the same row order with and withoutÂ LIMIT, include additional columns in theÂ ORDER BYÂ clause to make the order deterministic. For example, ifÂ idÂ values are unique, you can make rows for a givenÂ categoryÂ value appear inÂ idÂ order by sorting like this:â€
åœ¨ORDER BYå­å¥ä¸­åŒ…æ‹¬å…¶ä»–åˆ—ä»¥ä½¿é¡ºåºç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨ä¸»é”®idç­‰ã€‚ä¸Šé¢çš„SQLå¯ä»¥ä¿®æ”¹ä¸‹ï¼š
<code>select * from table_a order by create_time desc,id</code>
é—®é¢˜è§£å†³ã€‚</p>
<h1 id="letf-join-ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«">letf join ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#letf-join-ä¹‹åçš„æ¡ä»¶å’Œæ”¾åˆ°whereä¹‹åçš„æ¡ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«">#</a></h1>
<p>æ•°æ®åº“åœ¨è¿æ¥å¤šå¼ è¡¨è¿”å›è®°å½•æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€å¼ ä¸´æ—¶è¡¨ï¼Œç„¶åå°†è¿™å¼ è¡¨è¿”å›ç»™ç”¨æˆ·ã€‚
åœ¨ä½¿ç”¨left join æ—¶ï¼Œonå’Œwhereæ¡ä»¶çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>onæ¡ä»¶æ˜¯åœ¨ç”Ÿæˆä¸´æ—¶è¡¨æ—¶ä½¿ç”¨çš„æ¡ä»¶ï¼Œæ— è®ºonä¸­çš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸï¼Œéƒ½ä¼šè¿”å›å·¦è¡¨ä¸­çš„è®°å½•ã€‚</li>
<li>whereæ¡ä»¶æ˜¯åœ¨ä¸´æ—¶è¡¨ç”Ÿæˆå¥½åï¼Œå†å¯¹ä¸´æ—¶è¡¨è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶ï¼Œæ¡ä»¶ä¸ä¸ºçœŸçš„å…¨éƒ¨è¿‡æ»¤æ‰ã€‚</li>
</ul>
<p>å‡è®¾ä¸¤å¼ è¡¨ï¼š
è¡¨1ï¼štable_1</p>
<table>
<thead>
<tr>
<th>id</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
</tr>
<tr>
<td>3</td>
<td>30</td>
</tr>
</tbody>
</table>
<p>è¡¨2ï¼štable_2</p>
<table>
<thead>
<tr>
<th>size</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>A</td>
</tr>
<tr>
<td>20</td>
<td>B</td>
</tr>
<tr>
<td>30</td>
<td>C</td>
</tr>
</tbody>
</table>
<p>ä¸¤æ¡sqlï¼š
<code>select * form tab1 left join table_2 on (table_1.size = table_2.size) where table_2.name=â€™Aâ€™</code>
<code>select * form tab1 left join table_2 on (table_1.size = table_2.size and table_2.name=â€™Aâ€™)</code></p>
<p>sql_1çš„æ‰§è¡Œè¿‡ç¨‹ï¼š
ä¸­é—´è¡¨ onæ¡ä»¶: table_1.size = table_2.size</p>
<table>
<thead>
<tr>
<th>table_1.id</th>
<th>table_1.size</th>
<th>table_2.size</th>
<th>table_2.name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
<td>10</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
<td>20</td>
<td>B</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
<td>20</td>
<td>C</td>
</tr>
<tr>
<td>3</td>
<td>30</td>
<td>(null)</td>
<td>(null)</td>
</tr>
</tbody>
</table>
<p>whereå†å¯¹ä¸­é—´è¡¨æ•°æ®è¿‡æ»¤ï¼štable_2.name = A</p>
<table>
<thead>
<tr>
<th>table_1.id</th>
<th>table_1.size</th>
<th>table_2.size</th>
<th>table_2.name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
<td>10</td>
<td>A</td>
</tr>
</tbody>
</table>
<p>sql_2çš„æ‰§è¡Œè¿‡ç¨‹ï¼š
ä¸­é—´è¡¨ onæ¡ä»¶: table_1.size = table_2.size and table_2.name=â€™Aâ€™ (æ¡ä»¶ä¸ä¸ºçœŸä¹Ÿä¼šè¿”å›å·¦è¡¨ä¸­çš„è®°å½•)</p>
<table>
<thead>
<tr>
<th>table_1.id</th>
<th>table_1.size</th>
<th>table_2.size</th>
<th>table_2.name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
<td>10</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
<td>(null)</td>
<td>(null)</td>
</tr>
<tr>
<td>3</td>
<td>30</td>
<td>(null)</td>
<td>(null)</td>
</tr>
</tbody>
</table>
<p>ç”±äºleft join ã€right join ã€full join çš„ç‰¹æ€§ï¼Œä¸ç®¡onä¸Šçš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸéƒ½ä¼šè¿”å›leftæˆ–rightè¡¨ä¸­çš„è®°å½•ï¼Œfull join å…·æœ‰left join å’Œright join ç‰¹æ€§çš„å¹¶é›†ã€‚è€Œinner join æ²¡æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œè¿”å›çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>onåœ¨ç”Ÿæˆè¿æ¥è¡¨æ—¶èµ·ä½œç”¨ï¼Œwhereåœ¨ç”Ÿæˆè¿æ¥è¡¨åå¯¹è¿æ¥è¡¨å†è¿›è¡Œè¿‡æ»¤ã€‚</li>
<li>ä½¿ç”¨left joinæ—¶ï¼Œæ— è®ºonçš„æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œéƒ½ä¼šè¿”å›å·¦è¡¨çš„æ‰€æœ‰è®°å½•ï¼Œå¯¹äºæ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œä¸¤ä¸ªè¡¨å¯¹åº”çš„è®°å½•ä¼šè¿æ¥èµ·æ¥ï¼Œå¯¹äºä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå³è¡¨å­—æ®µå…¨éƒ¨æ˜¯nullã€‚</li>
<li>ä½¿ç”¨right joinæ—¶ï¼Œæ— è®ºonçš„æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œéƒ½ä¼šè¿”å›å³è¡¨çš„æ‰€æœ‰è®°å½•ï¼Œå¯¹äºæ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œä¸¤ä¸ªè¡¨å¯¹åº”çš„è®°å½•ä¼šè¿æ¥èµ·æ¥ï¼Œå¯¹äºä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå·¦è¡¨å­—æ®µå…¨éƒ¨æ˜¯nullã€‚</li>
<li>ä½¿ç”¨inner joinæ—¶ï¼Œonçš„æ¡ä»¶å’Œwhereå®Œå…¨ç›¸åŒã€‚
<a href="https://www.cnblogs.com/shamo89/p/11065172.html">å‚è€ƒ</a></li>
</ul>
<h1 id="mysql-è·å–æ’åˆ—åºå·">mysql è·å–æ’åˆ—åºå·<a hidden class="anchor" aria-hidden="true" href="#mysql-è·å–æ’åˆ—åºå·">#</a></h1>
<p>åœ¨è¿›å…¥æ­£é¢˜ä¹‹å‰å…ˆæ¥äº†è§£ä¸€ä¸ªmysqlä¸­çš„å°çŸ¥è¯†ç‚¹ï¼š
<code>:= ä¸ = çš„åŒºåˆ«</code>
<code>:=</code>
èµ‹å€¼çš„æ„æ€ã€‚åœ¨set update select ä¸­è¡¨ç¤ºèµ‹å€¼çš„æ„æ€ï¼Œç”¨çš„æ¯”è¾ƒå°‘ä¸€èˆ¬éƒ½ç”¨=ï¼Œä½†æ˜¯åœ¨ç”¨å˜é‡å®ç°è¡Œå·æ—¶ï¼ˆæ¯”å¦‚æœ¬æ–‡æ ‡é¢˜è·å–æ’åˆ—åºå·ï¼‰ï¼Œä¸€å®šè¦ç”¨:=ã€‚</p>
<p><code>=</code>
ç­‰äºçš„æ„æ€ï¼Œåªæœ‰å½“set å’Œ updateæ—¶ï¼Œå’Œ:=çš„æ„æ€æ˜¯ä¸€æ ·çš„ï¼Œè¡¨ç¤ºèµ‹å€¼ï¼Œå…¶ä½™æƒ…å†µéƒ½æ˜¯ç­‰äºçš„æ„æ€ã€‚</p>
<p>ç”¨æˆ·å˜é‡ @
@rank æ˜¯å¯¹ä¸€ä¸ªå«rankçš„å‚æ•°è¿›è¡Œèµ‹å€¼ã€‚å¯¹ç”¨æˆ·å˜é‡èµ‹å€¼æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§ç›´æ¥ç”¨&quot;=&ldquo;å¦ä¸€ç§ç”¨&rdquo;:=&quot;ã€‚
å…¶åŒºåˆ«åœ¨äºä½¿ç”¨setå‘½ä»¤å¯¹ç”¨æˆ·å˜é‡èµ‹å€¼æ—¶ï¼Œä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨ï¼›å½“ä½¿ç”¨selectè¯­å¥å¯¹ç”¨æˆ·å˜é‡è¿›è¡Œèµ‹å€¼æ—¶ï¼Œåªèƒ½ä½¿ç”¨â€œ:=â€æ–¹å¼ï¼Œå› ä¸ºåœ¨selectè¯­å¥ä¸­ï¼Œâ€œ=â€è¢«çœ‹åšæ˜¯æ¯”è¾ƒæ“ä½œç¬¦ã€‚</p>
<h2 id="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå·">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå·<a hidden class="anchor" aria-hidden="true" href="#æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—å¹¶è·å–æ’åºå·">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>a.*,
</span></span><span style="display:flex;"><span>@rank:=@rank + <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">AS</span> rank_no
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span> *
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span> `logs`
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHERE</span> log_created &gt; <span style="color:#0ff;font-weight:bold">&#34;2017-09-01&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span> count <span style="color:#fff;font-weight:bold">DESC</span>
</span></span><span style="display:flex;"><span>) a, (<span style="color:#fff;font-weight:bold">SELECT</span> @rank:= <span style="color:#ff0;font-weight:bold">0</span>) b
</span></span></code></pre></td></tr></table>
</div>
</div><p>2017.09.01ä¹‹å‰çš„æ—¥å¿—æŒ‰è®¿é—®é‡è¿›è¡Œå€’åºæ’åºï¼Œå¹¶è¿”å›åºå·ã€‚</p>
<p><code>select @rank:= 0</code>
<code>set @rank=0;</code>
è¿™å¥è¯å…¶å®å°±æ˜¯å°†rankèµ‹å€¼0ï¼Œä»é›¶å¼€å§‹åŠ 1ç¼–å·ï¼Œä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ã€‚</p>
<p>ç”¨setçš„å†™æ³•ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">set</span> @rank= <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>a.log_id,
</span></span><span style="display:flex;"><span>a.log_created,
</span></span><span style="display:flex;"><span>a.count,
</span></span><span style="display:flex;"><span>@rank:=@rank + <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">AS</span> rank_no
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span> *
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span> `logs`
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHERE</span> log_update &gt; <span style="color:#0ff;font-weight:bold">&#34;2017-09-01&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span> count <span style="color:#fff;font-weight:bold">DESC</span>
</span></span><span style="display:flex;"><span>) a;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥ï¼Œè·å–æ’åºåºå·è¿˜æ˜¯å¾ˆç®€å•çš„ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å›ºå®šçš„æ–¹å¼ï¼Œé‡Œé¢ä¸€å±‚selectæ˜¯æ­£å¸¸çš„sqlæ’åºçš„è¯­å¥ï¼Œå¤–é¢ä¸€å±‚æ˜¯å¯¹æŸ¥åˆ°çš„å·²æ’å¥½åºçš„æ•°æ®åˆ—è¿›è¡Œrankè‡ªå¢çš„æ“ä½œï¼Œæ‰€ä»¥ä¸€å¼€å§‹@rank:=0ã€‚</p>
<h2 id="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶åˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ<a hidden class="anchor" aria-hidden="true" href="#æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶åˆ™ç›¸åŒå€¼æ’åºå·ç›¸åŒ">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SET</span> @rank = <span style="color:#ff0;font-weight:bold">0</span> ,@rowtotal := NULL;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	a.log_id, a.log_created, a.count,
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">CASE</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal = a.count <span style="color:#fff;font-weight:bold">THEN</span>
</span></span><span style="display:flex;"><span>	@rank
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal := a.count <span style="color:#fff;font-weight:bold">THEN</span>
</span></span><span style="display:flex;"><span>	@rank := @rank + <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>END <span style="color:#fff;font-weight:bold">AS</span> rank_no
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	(
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">SELECT</span> * 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FROM</span> `logs`
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">WHERE</span> log_update &gt; <span style="color:#0ff;font-weight:bold">&#34;2017-09-01&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span> count <span style="color:#fff;font-weight:bold">DESC</span>
</span></span><span style="display:flex;"><span>	) a
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸Šé¢çš„sqlè¯­å¥å¯ä»¥çœ‹å‡ºå¤šäº†ä¸€å¥caseå‡½æ•°ï¼Œï¼ˆrowtotalè¡¨ç¤ºcountï¼‰æ ¹æ®æƒ…å†µå¯¹rankè¿›è¡Œèµ‹å€¼ï¼Œ
å½“rowtotalç­‰äºcountæ—¶ï¼Œåºå·å°±æ˜¯rankï¼Œå½“rowtotalæ­£å¸¸èµ‹å€¼æ—¶ï¼Œè¨€ä¸‹ä¹‹æ„å°±æ˜¯ä¸ç­‰äºï¼Œä½†æ˜¯
åˆä¸èƒ½ç”¨!= ï¼Œï¼ˆå…¶å®è¿™æ ·è¯´ä¹Ÿä¸å‡†ç¡®ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆè¡¨è¾¾ï¼Œæœ‰çŸ¥é“çš„äººåšå‹å¯ä»¥å¸®å¿™è¡¥å……ä¸€ä¸‹~~~ï¼‰ï¼Œ
è¿™æ ·å°±å®ç°äº†ç›¸åŒè®°å½•ç¼–å·ç›¸åŒçš„ç›®çš„ï¼ŒåŒæ—¶å…¶ä½™è®°å½•ç»§ç»­ç¼–å·ã€‚</p>
<h2 id="æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶åˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°ä¸Šä¸€ä¸ªæ’åºå·">æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ï¼Œä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶ï¼Œåˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒï¼Œå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°+ä¸Šä¸€ä¸ªæ’åºå·<a hidden class="anchor" aria-hidden="true" href="#æ ¹æ®æŸå­—æ®µæŒ‰åºæ’åˆ—è·å–æ’åºå·ä¸”å½“è¯¥å­—æ®µçš„å€¼å­˜åœ¨å¤šä¸ªç›¸åŒçš„è®°å½•æ—¶åˆ™ç›¸åŒå€¼çš„è®°å½•çš„æ’åºå·ç›¸åŒå¹¶ä¸”ä¸‹ä¸€ç»„å€¼çš„æ’åºå·ä¸ºä¸Šä¸€ç»„å†…è®°å½•æ•°ä¸Šä¸€ä¸ªæ’åºå·">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SET</span> @rank = <span style="color:#ff0;font-weight:bold">0</span> ,@rowtotal := NULL ,@rowtotal1 = NULL ,@sart := <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> a.log_id, a.log_created, a.count,
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">CASE</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal = a.count <span style="color:#fff;font-weight:bold">THEN</span> @rank
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal := a.count <span style="color:#fff;font-weight:bold">THEN</span> @rank := @rank + <span style="color:#ff0;font-weight:bold">1</span> + @sart
</span></span><span style="display:flex;"><span>        END <span style="color:#fff;font-weight:bold">AS</span> rank_no,
</span></span><span style="display:flex;"><span>         <span style="color:#fff;font-weight:bold">CASE</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal1 = a.count <span style="color:#fff;font-weight:bold">THEN</span> @sart := @sart + <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal1 := a.count <span style="color:#fff;font-weight:bold">THEN</span> @sart := <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        END <span style="color:#fff;font-weight:bold">AS</span> sart
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	    (
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">SELECT</span> *
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FROM</span> `logs`
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">WHERE</span> log_update &gt; <span style="color:#0ff;font-weight:bold">&#34;2017-09-01&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span> count <span style="color:#fff;font-weight:bold">DESC</span>
</span></span><span style="display:flex;"><span>	    ) a
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„sqlé‡Œåˆå¢åŠ äº†ä¸€ä¸ªå‚æ•°sartï¼Œè¡¨ç¤ºå½“å‰æ¯æ¬¡ç›¸åŒçš„ä¸ªæ•°ï¼Œï¼ˆåŒæ—¶è¿˜å¢åŠ äº†rowtotal1ï¼Œ
ç”¨äºåŒºåˆ«ä¹‹å‰çš„roetotalï¼Œå› ä¸ºåœ¨è¿™æ®µsqlä¸­rowtotalåœ¨è¿è¡ŒæœŸé—´å·²è¢«å¤šæ¬¡èµ‹å€¼ï¼Œä¸é€‚åˆåšsartçš„æ¯”è¾ƒå‚æ•°ï¼‰ä¸‹ä¸€ç»„è®°å½•ï¼Œå°†åœ¨ä¹‹å‰çš„æ’åä¸ŠåŠ ä¸Šæ­¤å‚æ•°å°±è¡¨ç¤ºï¼Œä¸‹ä¸€ç»„è®°å½•çš„æ’åºç¼–ç ã€‚ä¸ºäº†å†æ¬¡éªŒè¯sqlå‡†ç¡®æ€§ï¼Œå†çœ‹ä¸€ç»„è¿è¡Œç»“æœï¼Œï¼ˆè°ƒæ•´æ—¥å¿—åˆ›å»ºæ—¶é—´ä¸ºlog_update &gt; &ldquo;2016-06-20&rdquo; and log_update &lt; &ldquo;2017-03-01&rdquo;ï¼‰</p>
<p>ä¸Šé¢çš„sqlæœ‰ä¸ªé—®é¢˜å°±æ˜¯å½“æ•°æ®æ˜¯0çš„æ—¶å€™ï¼Œæ²¡æœ‰è¿›è¡Œç‰¹æ®Šå¤„ç†è¿™ä¸ªæ—¶å€™å¾—åˆ°çš„rank_noæ˜¯ä¸€ä¸ªnullå€¼ï¼Œæ’åºå°±ä¼šå‡ºé—®é¢˜ï¼Œä¸‹é¢é’ˆå¯¹ç¬¬ä¸‰ç§æƒ…å†µåšä¸€ä¸‹çº æ­£å…¶ä½™çš„ç±»ä¼¼ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SET</span> @rank = <span style="color:#ff0;font-weight:bold">0</span> ,@rowtotal := NULL ,@rowtotal1 = NULL ,@sart := <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span> a.log_id, a.log_created, a.count,
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">CASE</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal = a.count <span style="color:#fff;font-weight:bold">THEN</span> @rank
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal := a.count <span style="color:#fff;font-weight:bold">THEN</span> @rank := @rank + <span style="color:#ff0;font-weight:bold">1</span> + @sart
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal = <span style="color:#ff0;font-weight:bold">0</span> <span style="color:#fff;font-weight:bold">THEN</span> @rank := @rank +<span style="color:#ff0;font-weight:bold">1</span> +@sart
</span></span><span style="display:flex;"><span>        END <span style="color:#fff;font-weight:bold">AS</span> rank_no,
</span></span><span style="display:flex;"><span>         <span style="color:#fff;font-weight:bold">CASE</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal1 = a.count <span style="color:#fff;font-weight:bold">THEN</span> @sart := @sart + <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal1 := a.count <span style="color:#fff;font-weight:bold">THEN</span> @sart := <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHEN</span> @rowtotal1 =<span style="color:#ff0;font-weight:bold">0</span> <span style="color:#fff;font-weight:bold">THEN</span> @sart := <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>        END <span style="color:#fff;font-weight:bold">AS</span> sart
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	    (
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">SELECT</span> *
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FROM</span> `logs`
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">WHERE</span> log_update &gt; <span style="color:#0ff;font-weight:bold">&#34;2017-09-01&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span> count <span style="color:#fff;font-weight:bold">DESC</span>
</span></span><span style="display:flex;"><span>	    ) a
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://blog.csdn.net/gao763024185/article/details/79638052">å‚è€ƒ</a></p>
<h1 id="æŠ€å·§">æŠ€å·§<a hidden class="anchor" aria-hidden="true" href="#æŠ€å·§">#</a></h1>
<h2 id="mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ®">mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#mysqlæŒ‰å¤©ç»Ÿè®¡æ•°æ®">#</a></h2>
<p>åº“é‡Œçš„å­˜çš„æ—¶é—´æˆ³ï¼Œæ¯æ¡æ•°æ®çš„æ—¶é—´æˆ³éƒ½ä¸ä¸€æ ·ã€‚
æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼ŒæŒ‰å¤©ç»Ÿè®¡æ•°æ®ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	FROM_UNIXTIME( create_time,<span style="color:#0ff;font-weight:bold">&#39;%Y-%m-%d&#39;</span>) days,
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">count</span>( id ) countId
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	 user_behavior
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> user_id = #<span style="color:#f00">{</span>_parameter<span style="color:#f00">}</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>	days;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mysqlè·å–å¥‡æ•°å¶æ•°">mysqlè·å–å¥‡æ•°å¶æ•°<a hidden class="anchor" aria-hidden="true" href="#mysqlè·å–å¥‡æ•°å¶æ•°">#</a></h2>
<p>å¥‡æ•°</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> *
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">table</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> id &amp; <span style="color:#ff0;font-weight:bold">1</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¶æ•°ï¼šidå…ˆé™¤ä»¥2ç„¶åä¹˜2ï¼Œå¦‚æœä¸åŸæ¥çš„ç›¸ç­‰å°±æ˜¯å¶æ•°</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> *
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> <span style="color:#fff;font-weight:bold">table</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">WHERE</span> id = (id &gt;&gt; <span style="color:#ff0;font-weight:bold">1</span>) &lt;&lt; <span style="color:#ff0;font-weight:bold">1</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug">ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug<a hidden class="anchor" aria-hidden="true" href="#ä»Šå¤©é‡åˆ°çš„å¥‡æ€ªbug">#</a></h2>
<p>ä¸»è¡¨ä¸€å¯¹å¤šå­è¡¨ï¼Œå­è¡¨å­˜äº†ä¸»è¡¨çš„idã€‚ä¸»è¡¨æ•°æ®æ¸…äº†ï¼ŒAUTO_INCREMENTä»1å¼€å§‹ï¼Œä½†æ˜¯å­è¡¨æ•°æ²¡æ¸…ç©ºã€‚
å¯¼è‡´çš„é—®é¢˜æ˜¯ï¼šå†æ¬¡æ–°å¢ä¸»è¡¨æ•°æ®æ—¶ï¼Œå‡å¦‚ä¸»è¡¨æ•°æ®idæ˜¯1ï¼Œé‚£ä¹ˆå­˜å…¥å­è¡¨çš„ä¸»è¡¨idæ˜¯1ï¼Œä½†æ˜¯å› ä¸ºå­è¡¨çš„æ•°æ®æ²¡æœ‰æ¸…ç©ºï¼Œä¹‹å‰ç•™åœ¨å­è¡¨çš„ä¸»è¡¨idä¸º1çš„æ•°æ®è¿˜åœ¨ã€‚é‚£ä¹ˆå†æ ¹æ®ä¸»è¡¨id=1æ—¶æŸ¥è¯¢ï¼Œå°±ä¼šå‡ºç°å¤šçš„æ•°æ®ï¼Œå®é™…æ˜¯å› ä¸ºæ—§æ•°æ®æ²¡åˆ é™¤å¯¼è‡´çš„ã€‚ä»¥åè¿˜å¾—æ³¨æ„è¿™ä¸ªé—®é¢˜ï¼Œåˆ é™¤æ®æ—¶å€™ï¼Œä¸»å­è¡¨ï¼ˆæœ‰å…³è”çš„ï¼‰æ•°æ®è¦ä¸€åŒåˆ é™¤ã€‚</p>
<h2 id="ç»Ÿè®¡è¿ç»­å¤©æ•°">ç»Ÿè®¡è¿ç»­å¤©æ•°<a hidden class="anchor" aria-hidden="true" href="#ç»Ÿè®¡è¿ç»­å¤©æ•°">#</a></h2>
<p>å·²çŸ¥æœ‰ä¸€äº›ç”¨æˆ·æ•°æ®ï¼Œæ¯æ¡æ•°æ®éƒ½æœ‰æ—¶é—´ï¼Œæ—¶é—´æ ¼å¼æ˜¯Dateï¼š<code>2021-05-23</code>ã€‚å¦‚æœæ˜¯æ—¶é—´æˆ³ç±»å‹ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°<code>FROM_UNIXTIME( create_time, '%Y-%m-%d' )</code>æ ¼å¼åŒ–æˆè‡ªå·±æƒ³è¦çš„æ—¶é—´æ ¼å¼ã€‚ç°åœ¨æƒ³ï¼Œæ‰¾å‡ºè¿ç»­çš„å¤©æ•°çš„æ•°æ®ã€‚</p>
<p>é¦–å…ˆå°†æ•°æ®åˆ†ç»„</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>	user_id,
</span></span><span style="display:flex;"><span>	create_time
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span>
</span></span><span style="display:flex;"><span>	table_a
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">group</span> <span style="color:#fff;font-weight:bold">by</span>
</span></span><span style="display:flex;"><span>	user_id,
</span></span><span style="display:flex;"><span>	create_time
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæŠŠè¿ç»­çš„å¤©æ•°è¿›è¡Œåˆ†ç»„</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	*,((
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">count</span>( <span style="color:#ff0;font-weight:bold">1</span> ) 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>			( <span style="color:#fff;font-weight:bold">SELECT</span> user_id, create_time <span style="color:#fff;font-weight:bold">FROM</span> table_a <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> user_id, create_time ) dr2 
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>			dr1.user_id = dr2.user_id
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">AND</span> dr2.create_time &lt;= dr1.create_time 
</span></span><span style="display:flex;"><span>		) - <span style="color:#fff;font-weight:bold">DAY</span> ( dr1.create_time )) <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#39;rownum&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	( <span style="color:#fff;font-weight:bold">SELECT</span> user_id, create_time <span style="color:#fff;font-weight:bold">FROM</span> table_a <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> user_id, create_time ) dr1
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæŒ‰ç”¨æˆ· ã€å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ å’Œ è¿ç»­å¤©æ•°åˆ†ç»„</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	user_id,
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">min</span>( create_time ),
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">max</span>( create_time ),(
</span></span><span style="display:flex;"><span>		datediff(
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">max</span>( create_time ),
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">min</span>( create_time ))+ <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>	) <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#39;rn&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	(
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>		*,((
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>				<span style="color:#fff;font-weight:bold">count</span>( <span style="color:#ff0;font-weight:bold">1</span> )
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>				( <span style="color:#fff;font-weight:bold">SELECT</span> user_id, create_time <span style="color:#fff;font-weight:bold">FROM</span> table_a <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> user_id, create_time ) dr2
</span></span><span style="display:flex;"><span>			<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>				dr1.user_id = dr2.user_id 
</span></span><span style="display:flex;"><span>				<span style="color:#fff;font-weight:bold">AND</span> dr2.create_time &lt;= dr1.create_time 
</span></span><span style="display:flex;"><span>			) - <span style="color:#fff;font-weight:bold">DAY</span> ( dr1.create_time )) <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#39;rownum&#39;</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>		( <span style="color:#fff;font-weight:bold">SELECT</span> user_id, create_time <span style="color:#fff;font-weight:bold">FROM</span> table_a <span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> user_id, create_time ) dr1
</span></span><span style="display:flex;"><span>	) z 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>	user_id,
</span></span><span style="display:flex;"><span>	rownum
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://www.cnblogs.com/ylqs/p/9396229.html">å‚è€ƒ</a></p>
<h2 id="ç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå·">ç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå·<a hidden class="anchor" aria-hidden="true" href="#ç»™æŸ¥è¯¢è®°å½•æ·»åŠ è‡ªç„¶åºå·">#</a></h2>
<p>è¡¨aï¼Œæ•°æ®ï¼š</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>å¼ ä¸‰</td>
</tr>
<tr>
<td>6</td>
<td>æå››</td>
</tr>
<tr>
<td>7</td>
<td>ç‹äº”</td>
</tr>
</tbody>
</table>
<p>é€šè¿‡ä¸€æ¡sqlè·å–è¿™ä¸‰æ¡è®°å½•ï¼Œå¹¶ä¸”ç»™æ¯è¡Œå‰é¢åŠ ä¸Šä»1å¼€å§‹çš„åºå·</p>
<table>
<thead>
<tr>
<th>åºå·</th>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>5</td>
<td>å¼ ä¸‰</td>
</tr>
<tr>
<td>2</td>
<td>6</td>
<td>æå››</td>
</tr>
<tr>
<td>3</td>
<td>7</td>
<td>ç‹äº”</td>
</tr>
</tbody>
</table>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	@rownum := @rownum + <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">AS</span> rownum,
</span></span><span style="display:flex;"><span>	a.* 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>( <span style="color:#fff;font-weight:bold">SELECT</span> @rownum := <span style="color:#ff0;font-weight:bold">0</span> ) r,
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">table</span> a;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†™æ³•2ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	@rowno := @rowno + <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">AS</span> rowno,
</span></span><span style="display:flex;"><span>	a.* 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">table</span> a,
</span></span><span style="display:flex;"><span>	( <span style="color:#fff;font-weight:bold">SELECT</span> @rowno := <span style="color:#ff0;font-weight:bold">0</span> ) t
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæœ‰æŒ‰ç…§æŸä¸ªå­—æ®µæ’åºï¼Œè¡Œå·ä¼šä¸è§„åˆ™æ’åˆ—ï¼Œæ¢æˆå…ˆæ’åºï¼Œå¤–å±‚åŠ ä¸Šè¡Œå·ä¼šæ›´åŠ åˆé€‚ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>	@ROWNO := @ROWNO + <span style="color:#ff0;font-weight:bold">1</span> <span style="color:#fff;font-weight:bold">AS</span> ROWNO,
</span></span><span style="display:flex;"><span>	T.* 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>	(
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">SELECT</span>
</span></span><span style="display:flex;"><span>		a.*
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">FROM</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">table_name</span> a
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">LEFT</span> <span style="color:#fff;font-weight:bold">JOIN</span> ...
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>		...
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>		... <span style="color:#fff;font-weight:bold">desc</span>
</span></span><span style="display:flex;"><span>	) T,( <span style="color:#fff;font-weight:bold">SELECT</span> @ROWNO := <span style="color:#ff0;font-weight:bold">0</span> ) T3
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">ORDER</span> <span style="color:#fff;font-weight:bold">BY</span>
</span></span><span style="display:flex;"><span>	ROWNO
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="group_concat">group_concat<a hidden class="anchor" aria-hidden="true" href="#group_concat">#</a></h2>
<p>å®Œæ•´è¯­æ³•å¦‚ä¸‹ï¼š
<code>group_concat([DISTINCT] è¦è¿æ¥çš„å­—æ®µ [Order BY ASC/DESC æ’åºå­—æ®µ] [Separator 'åˆ†éš”ç¬¦'])</code></p>
<p>æ³¨æ„ï¼šä½¿ç”¨ GROUP_CONCATï¼ˆï¼‰å‡½æ•°å¿…é¡»å¯¹æºæ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¦åˆ™æ‰€æœ‰æ•°æ®ä¼šè¢«åˆå¹¶æˆä¸€è¡Œã€‚</p>
<p><a href="https://www.cnblogs.com/luxd/p/11302255.html">å‚è€ƒ</a>
<a href="https://blog.csdn.net/k0307x1990y/article/details/82905084">å‚è€ƒ</a></p>
<h2 id="nullå€¼æ’åº">nullå€¼æ’åº<a hidden class="anchor" aria-hidden="true" href="#nullå€¼æ’åº">#</a></h2>
<p>ç°åœ¨éœ€è¦æŒ‰ç…§æäº¤æ—¶é—´<code>create_time</code>æ­£åºæ’åºæ•°æ®ï¼Œ
å‡è®¾<code>create_time</code>å­—æ®µä¸­æœ‰nullå€¼ï¼Œå¦‚æœç›´æ¥ï¼Œ<code>order by create_time</code>ï¼Œä¼šå‘ç°<code>create_time</code>ä¸ºnullçš„æ•°æ®æ’åœ¨çš„å‰é¢ã€‚</p>
<p>è§£å†³åŠæ³•ï¼š
<code>order by create_time is null,create_time</code></p>
<h2 id="mysql-datetimeç±»å‹æ—¶é—´é”™è¯¯">mysql datetimeç±»å‹æ—¶é—´é”™è¯¯<a hidden class="anchor" aria-hidden="true" href="#mysql-datetimeç±»å‹æ—¶é—´é”™è¯¯">#</a></h2>
<p>åˆæ­¥åˆ¤æ–­æ˜¯mysqlæ—¶åŒºçš„é—®é¢˜ï¼Œå› ä¸ºmysqlæ—¶åŒºè®¾ç½®é»˜è®¤æ˜¯æ“ä½œç³»ç»Ÿæ—¶åŒºï¼ŒæŸ¥çœ‹äº†ä¸‹centosæ—¶åŒºï¼Œä¸œ8åŒºæ²¡æœ‰é”™ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤å®šæ˜¯ä»£ç é‡Œé¢è®¾ç½®äº†ä¸€ä¸ªé”™è¯¯çš„æ—¶åŒºã€‚</p>
<h3 id="è§£å†³æ–¹å¼ä¸€">è§£å†³æ–¹å¼ä¸€<a hidden class="anchor" aria-hidden="true" href="#è§£å†³æ–¹å¼ä¸€">#</a></h3>
<p>æŸ¥çœ‹å½“å‰æ—¶åŒº
show variables like &lsquo;%time_zone%&rsquo;;
å‘ç°æœç„¶æ˜¯<code>CST</code>,åŒ—ç¾çš„Central Standard Time</p>
<p>è®¾ç½®æ—¶åŒº
set global time_zone = &lsquo;+8:00&rsquo;;
set time_zone = &lsquo;+8:00&rsquo;;
flush PRIVILEGES;</p>
<h3 id="è§£å†³æ–¹å¼äºŒ">è§£å†³æ–¹å¼äºŒ<a hidden class="anchor" aria-hidden="true" href="#è§£å†³æ–¹å¼äºŒ">#</a></h3>
<p>åœ¨mysqlçš„è¿æ¥ååŠ ä¸Š
<code>serverTimezone=GMT%2B8</code></p>
<h2 id="group-by-è·å–æœ€æ–°çš„æ•°æ®">group by è·å–æœ€æ–°çš„æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#group-by-è·å–æœ€æ–°çš„æ•°æ®">#</a></h2>
<p>å› ä¸ºgroup by æ˜¯è·å–çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è·å–æœ€åä¸€æ¡æ•°æ®ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> chapter_user_dub <span style="color:#fff;font-weight:bold">where</span> id <span style="color:#fff;font-weight:bold">in</span>(
</span></span><span style="display:flex;"><span> <span style="color:#fff;font-weight:bold">select</span> <span style="color:#fff;font-weight:bold">MAX</span>(id) <span style="color:#fff;font-weight:bold">from</span> chapter_user_dub <span style="color:#fff;font-weight:bold">where</span> user_id = <span style="color:#ff0;font-weight:bold">106175</span> <span style="color:#fff;font-weight:bold">group</span> <span style="color:#fff;font-weight:bold">by</span> user_id
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å­æŸ¥è¯¢order-byå’Œå¤–å±‚group-by">å­æŸ¥è¯¢order byå’Œå¤–å±‚group by<a hidden class="anchor" aria-hidden="true" href="#å­æŸ¥è¯¢order-byå’Œå¤–å±‚group-by">#</a></h2>
<p>ç°åœ¨æƒ³å¯¹order byçš„ç»“æœé›†è¿›è¡Œgroup byï¼Œsqlå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>select
</span></span><span style="display:flex;"><span>		id,
</span></span><span style="display:flex;"><span>		name
</span></span><span style="display:flex;"><span>	from table_a ta
</span></span><span style="display:flex;"><span>	left join table_b tb on tb.id = ta.tb_id
</span></span><span style="display:flex;"><span>	where ...
</span></span><span style="display:flex;"><span>	order by tb.create_time
</span></span><span style="display:flex;"><span>	group by ta.id
</span></span></code></pre></td></tr></table>
</div>
</div><p>å·²çŸ¥group byå–çš„æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œè€Œä¸”group byæ˜¯åœ¨order byä¹‹å‰æ‰§è¡Œï¼Œæ‰€æœ‰è·å–ä¸åˆ°æƒ³è¦çš„order byçš„ç»“æœé›†ï¼Œäºæ˜¯æƒ³ç”¨å­æŸ¥è¯¢ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>		id,
</span></span><span style="display:flex;"><span>		name
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">from</span> table_a ta
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_b tb <span style="color:#fff;font-weight:bold">on</span> tb.id = ta.tb_id
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">where</span> ...
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> tb.create_time
</span></span><span style="display:flex;"><span>) t
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> ta.id
</span></span></code></pre></td></tr></table>
</div>
</div><p>è™½ç„¶åœ¨å¤–å±‚æ‰§è¡Œgroup byï¼Œä½†æ˜¯ç»“æœè¿˜æ˜¯ä¸å¯¹(å–çš„è¿˜æ˜¯ç¬¬ä¸€æ¡æ•°æ®ï¼Œå­æŸ¥è¯¢æ²¡ç”¨)ã€‚
äºæ˜¯åœ¨å­æŸ¥è¯¢é‡Œè¾¹åŠ ä¸Š<code>limt</code></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> * <span style="color:#fff;font-weight:bold">from</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>		id,
</span></span><span style="display:flex;"><span>		name
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">from</span> table_a ta
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_b tb <span style="color:#fff;font-weight:bold">on</span> tb.id = ta.tb_id
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">where</span> ...
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> tb.create_time
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">limit</span> <span style="color:#ff0;font-weight:bold">999</span>
</span></span><span style="display:flex;"><span>) t
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">GROUP</span> <span style="color:#fff;font-weight:bold">BY</span> ta.id
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¥½äº†ã€‚åŸå› æ˜¯ä»€ä¹ˆæˆ‘ä¸çŸ¥é“ã€‚</p>
<h2 id="case-whençš„å‡ ç§å½¢å¼">case-whençš„å‡ ç§å½¢å¼<a hidden class="anchor" aria-hidden="true" href="#case-whençš„å‡ ç§å½¢å¼">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CASE</span> b.check_type
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span> <span style="color:#fff;font-weight:bold">then</span> b.real_name
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> <span style="color:#0ff;font-weight:bold">&#39;2&#39;</span> <span style="color:#fff;font-weight:bold">then</span> b.association_name
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">else</span> u2.name(<span style="color:#f00">æœ‰</span><span style="color:#fff;font-weight:bold">else</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">end</span> <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#34;user.name&#34;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">---------
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">CASE</span> a.exh_type
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span> <span style="color:#fff;font-weight:bold">then</span> a.is_art
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> <span style="color:#0ff;font-weight:bold">&#39;2&#39;</span> <span style="color:#fff;font-weight:bold">then</span> <span style="color:#fff;font-weight:bold">c</span>.is_art
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">end</span> <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#34;isArt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">---------
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">case</span> (case<span style="color:#f00">åè¾¹æ²¡ä¸œè¥¿</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> a.end_time &gt; now() <span style="color:#fff;font-weight:bold">then</span> <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">when</span> a.end_time &amp;lt; now() <span style="color:#fff;font-weight:bold">then</span> <span style="color:#0ff;font-weight:bold">&#39;2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">end</span> <span style="color:#fff;font-weight:bold">AS</span> <span style="color:#0ff;font-weight:bold">&#34;isPass&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">---------
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> a.is_home = <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">and</span> a.publish_status = <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">and</span> (
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">case</span> a.exh_type
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">when</span> <span style="color:#0ff;font-weight:bold">&#39;1&#39;</span> <span style="color:#fff;font-weight:bold">then</span> a.audit_status = <span style="color:#0ff;font-weight:bold">&#39;2&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">else</span> <span style="color:#ff0;font-weight:bold">1</span> = <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">end</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="find_in_set">find_in_set<a hidden class="anchor" aria-hidden="true" href="#find_in_set">#</a></h2>
<p><code>find_in_set(str,strlist)</code></p>
<p>strï¼šè¦æŸ¥è¯¢çš„å­—ç¬¦ä¸²
strlistï¼šå­—æ®µåï¼Œå­˜å‚¨å†…å®¹é€—å·åˆ†éš”ï¼Œå¦‚<code>(1,2,6,8)</code>
æŸ¥è¯¢å­—æ®µ(strlist)ä¸­åŒ…å«(str)çš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºnullæˆ–è®°å½•ã€‚</p>
<p><code>SELECT FIND_IN_SET('b', 'a,b,c,d');</code>
è¿”å›2ï¼Œå› ä¸ºb åœ¨strlisté›†åˆä¸­æ”¾åœ¨2çš„ä½ç½®ã€‚</p>
<p><code>find_in_set</code>å¾ˆé€‚åˆæŸ¥è¯¢è¡¨ä¸­æ•°æ®ä¸ºæ ‘å½¢çš„ç»“æ„ï¼Œæ¯”å¦‚éƒ¨é—¨ï¼Œä¸€èˆ¬æ˜¯è¿™ç§ç»“æ„</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1:æŠ€æœ¯éƒ¨
</span></span><span style="display:flex;"><span>Â  +-- 2:JAVAéƒ¨é—¨
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 4:å½±é­”
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 5:ç™½ç‰›
</span></span><span style="display:flex;"><span>Â  +-- 3:Pythonéƒ¨é—¨
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â        +-- 6:ç«å¥³
</span></span><span style="display:flex;"><span>Â Â Â Â Â Â Â Â Â Â Â   +-- 7:å†°å¥³
</span></span><span style="display:flex;"><span>Â 8:æ€»å…¬å¸
</span></span><span style="display:flex;"><span>Â  +-- 9:ä¼—æœ›æ•™è‚²
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 12:å¸‚åœºéƒ¨
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â  +--14:å°é»‘
</span></span><span style="display:flex;"><span>Â  |Â Â Â  |Â Â Â  +--15:ç¾æœè
</span></span><span style="display:flex;"><span>Â  |Â Â Â  +-- 13:äººåŠ›éƒ¨
</span></span><span style="display:flex;"><span>Â  +-- 10:xxx
</span></span><span style="display:flex;"><span>Â  +-- 11:xxx
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ—¶å¦‚æœæƒ³æŸ¥è¯¢æŠ€æœ¯éƒ¨æˆ–æ€»å…¬å¸ä¸‹æ‰€æœ‰çš„äººï¼Œç”¨find_in_setå°±å¾ˆç®€å•ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>select *
</span></span><span style="display:flex;"><span>from find_in_set
</span></span><span style="display:flex;"><span>where find_in_set(2,path)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="find_in_setå’Œinçš„åŒºåˆ«">find_in_set()å’Œinçš„åŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#find_in_setå’Œinçš„åŒºåˆ«">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">create</span> <span style="color:#fff;font-weight:bold">table</span> find_in_set
</span></span><span style="display:flex;"><span>(
</span></span><span style="display:flex;"><span>    id        <span style="color:#fff;font-weight:bold">int</span> auto_increment,
</span></span><span style="display:flex;"><span>    dep_name  <span style="color:#fff;font-weight:bold">varchar</span>(<span style="color:#ff0;font-weight:bold">100</span>) <span style="color:#fff;font-weight:bold">null</span> <span style="color:#fff;font-weight:bold">comment</span> <span style="color:#0ff;font-weight:bold">&#39;éƒ¨é—¨å&#39;</span>,
</span></span><span style="display:flex;"><span>    parent_id <span style="color:#fff;font-weight:bold">int</span>          <span style="color:#fff;font-weight:bold">null</span> <span style="color:#fff;font-weight:bold">comment</span> <span style="color:#0ff;font-weight:bold">&#39;çˆ¶çº§id&#39;</span>,
</span></span><span style="display:flex;"><span>    path      <span style="color:#fff;font-weight:bold">varchar</span>(<span style="color:#ff0;font-weight:bold">100</span>) <span style="color:#fff;font-weight:bold">null</span> <span style="color:#fff;font-weight:bold">comment</span> <span style="color:#0ff;font-weight:bold">&#39;éƒ¨é—¨è·¯å¾„&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">constraint</span> find_in_set_id_uindex
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">unique</span> (id)
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">insert</span> <span style="color:#fff;font-weight:bold">into</span> find_in_set(dep_name, parent_id, path)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">values</span>
</span></span><span style="display:flex;"><span>(<span style="color:#0ff;font-weight:bold">&#39;æ€»å…¬å¸&#39;</span>,<span style="color:#ff0;font-weight:bold">0</span>,<span style="color:#ff0;font-weight:bold">1</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#0ff;font-weight:bold">&#39;æŠ€æœ¯éƒ¨&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;1,2&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#0ff;font-weight:bold">&#39;äººåŠ›éƒ¨&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;1&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;1,3&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#0ff;font-weight:bold">&#39;æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;2&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;1,2,4&#39;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æƒ³æŸ¥è¯¢æŠ€æœ¯éƒ¨ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> *
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> find_in_set
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#ff0;font-weight:bold">2</span> <span style="color:#fff;font-weight:bold">in</span> (path)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯æ²¡æœ‰æ•°æ®çš„ï¼Œå› ä¸ºinçš„æ¡ä»¶ï¼Œå¿…é¡»æ˜¯å®Œå…¨åŒ¹é…ã€‚æ‰€ä»¥ä½¿ç”¨find_in_set</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span> *
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> find_in_set
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> find_in_set(<span style="color:#ff0;font-weight:bold">2</span>,path)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥è¯¢ç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>2,æŠ€æœ¯éƒ¨,1,&#34;1,2&#34;
</span></span><span style="display:flex;"><span>4,æŠ€æœ¯éƒ¨ä¸‹-javaéƒ¨é—¨,2,&#34;1,2,4&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚</p>
<h3 id="å’Œlikeçš„åŒºåˆ«">å’Œlikeçš„åŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#å’Œlikeçš„åŒºåˆ«">#</a></h3>
<p>likeå¯èƒ½æŸ¥åˆ°æˆ‘ä»¬ä¸æƒ³è¦çš„è®°å½•ï¼Œfind_in_set æ¯”likeæ›´ç²¾å‡†ã€‚</p>
<h2 id="mysqlåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ">MySQLåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ<a hidden class="anchor" aria-hidden="true" href="#mysqlåˆ¤æ–­æ—¶é—´æ®µæ˜¯å¦é‡åˆ">#</a></h2>
<p>å¦‚å›¾ï¼Œ4ç§é‡åˆæƒ…å†µå’Œ2ç§ä¸é‡åˆæƒ…å†µã€‚
<img loading="lazy" src="1.png" alt=""  />
</p>
<p>å†™æ³•ä¸€ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#007f7f">-- æ—¶é—´æ®µ a,b  
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">SELECT</span> * <span style="color:#fff;font-weight:bold">FROM</span> <span style="color:#fff;font-weight:bold">table</span> <span style="color:#fff;font-weight:bold">WHERE</span>
</span></span><span style="display:flex;"><span>       (start_time &gt;= a <span style="color:#fff;font-weight:bold">and</span> end_time &lt;= b) <span style="color:#007f7f">-- è¢«åŒ…å«äº†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">or</span> (end_time &gt;= a <span style="color:#fff;font-weight:bold">and</span> end_time &lt;=b)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">or</span> (start_time &gt;= a <span style="color:#fff;font-weight:bold">and</span> start_time &lt;=b)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">or</span> (start_time &lt;= a <span style="color:#fff;font-weight:bold">and</span> end_time &gt;=b)
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£æï¼šwhereåçš„4ä¸ªæ¡ä»¶åˆ†åˆ«ä»£è¡¨äº†å›¾ä¸­4ç§é‡åˆçš„æƒ…å†µã€‚
ä½†æ˜¯ç¬¬ä¸€ç§æƒ…å†µè¢«2å’Œ3åŒ…å«äº†ï¼Œæ‰€ä»¥ç®€åŒ–ä¸€ä¸‹å†™æ³•ï¼šã€€</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SELECT * FROM table WHERE
</span></span><span style="display:flex;"><span>    (end_time &gt;= a and end_time &lt;=b)
</span></span><span style="display:flex;"><span>    or (start_time &gt;= a and start_time &lt;=b)
</span></span><span style="display:flex;"><span>    or (start_time &lt;= a and end_time &gt;=b);
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†™æ³•äºŒï¼š
<code>SELECT * FROM table WHERE not (start_time &gt; b or end_time &lt; a);</code></p>
<h1 id="å…¶ä»–">å…¶ä»–<a hidden class="anchor" aria-hidden="true" href="#å…¶ä»–">#</a></h1>
<h2 id="mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹">mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹<a hidden class="anchor" aria-hidden="true" href="#mysqlå¯¼å…¥dataæ–‡ä»¶å¤¹">#</a></h2>
<p>æ˜¨å¤©æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ”»å‡»ï¼Œå¯¼è‡´æœåŠ¡å™¨æ— æ³•è®¿é—®ï¼Œæ•°æ®åº“æ— æ³•è¿æ¥ã€‚
è§£å†³è¿‡ç¨‹ï¼š</p>
<ul>
<li>åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°å¤‡ä»½æœåŠ¡å™¨ç¡¬ç›˜å¿«ç…§</li>
<li>é‡è£…æ“ä½œç³»ç»Ÿ</li>
<li>å°†å¿«ç…§æŒ‚è½½åˆ°æ–°ç³»ç»Ÿä¸Šï¼Œæˆ‘æŒ‚è½½åˆ°äº†<code>/mnt</code>ç›®å½•ä¸‹</li>
<li>è¿›å…¥/mntç›®å½•ï¼ŒæŸ¥çœ‹my.cnf<code>vim etc/my.cnf</code>ï¼Œå‘ç°dataæ–‡ä»¶åœ¨<code>var/lib/mysql</code></li>
<li>è¿›å…¥ç›®å½•<code>cd var/lib/mysql</code>ï¼Œå°†è¯¥ç›®å½•æ•´ä½“æ‰“åŒ…ã€‚</li>
<li>é‡æ–°å®‰è£…mysqlï¼Œå°†æ–°è£…mysqlçš„<code>var/lib/mysql</code>åˆ é™¤ï¼Œå°†åˆšæ‰æ‰“åŒ…çš„dataç›®å½•å¤åˆ¶åˆ°<code>/var/lib</code></li>
<li>è§£å‹ï¼Œç„¶åå¯åŠ¨mysql</li>
<li>è¿œç¨‹è¿æ¥å‘ç°mysqlæ— æ³•è®¿é—®ï¼Œæç¤º<code>table xxxxx doesn't exist</code></li>
<li>åœ¨æœåŠ¡å™¨ä»»æ„ä½ç½®è¾“å…¥<code>mysql_upgrade -uroot -p --force</code>ï¼Œç„¶åæç¤ºï¼š</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Upgrade process completed successfully.
</span></span><span style="display:flex;"><span>Checking if update is needed.
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å†æ¬¡å°è¯•è¿œç¨‹è¿æ¥ï¼ŒæˆåŠŸï¼Œæ•°æ®éƒ½åœ¨ï¼</li>
</ul>
<h2 id="å¯¼å…¥frmå’Œibdæ–‡ä»¶">å¯¼å…¥<code>.frmå’Œ.ibd</code>æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#å¯¼å…¥frmå’Œibdæ–‡ä»¶">#</a></h2>
<p><code>.frm</code>å’Œ<code>.ibd</code>åˆ†åˆ«å¯¹åº”æ•°æ®åº“ä¸­çš„è¡¨åå’Œè¡¨ä¸­çš„æ•°æ®ã€‚
æˆ‘ä»¬è¿›å…¥åˆ°mysqlçš„dataæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°ä¸€ä¸ªåº“è¿›å»ï¼Œå¯ä»¥è¯å®æˆ‘çš„æƒ³æ³•ã€‚</p>
<h1 id="ä¼˜åŒ–æ¡ˆä¾‹">ä¼˜åŒ–æ¡ˆä¾‹<a hidden class="anchor" aria-hidden="true" href="#ä¼˜åŒ–æ¡ˆä¾‹">#</a></h1>
<p>åŸå§‹sqlï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>      t1.xx,
</span></span><span style="display:flex;"><span>      t1.xx,
</span></span><span style="display:flex;"><span>      t2.xx,
</span></span><span style="display:flex;"><span>      t3.xx
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> table_1 t1
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_2 t2 <span style="color:#fff;font-weight:bold">on</span> t1.user_id = t2.id
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_3 t3 <span style="color:#fff;font-weight:bold">on</span> t2.id = t3.user_id
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#f00">æ¡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">group</span> <span style="color:#fff;font-weight:bold">by</span> t1.user_id
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> <span style="color:#f00">æ¡ä»¶</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>sqlè§£é‡Šï¼šç®€å•çš„<code>left join</code>ï¼Œæœ‰é—®é¢˜çš„åœ°æ–¹åœ¨äº<code>group by t1.user_id</code>ï¼Œæ ¹æ® select çš„æ‰§è¡Œé¡ºåºï¼Œgroup by è‚¯å®šæ˜¯åœ¨left join ä¹‹åæ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡Œå› ä¸º join äº§ç”Ÿäº†å¾ˆå¤šæ²¡ç”¨çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼˜åŒ–æ€è·¯æ˜¯å…ˆ group by ï¼Œå† joinã€‚</p>
<p>ä¼˜åŒ–åï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>    t1.xx,
</span></span><span style="display:flex;"><span>    t2.xx,
</span></span><span style="display:flex;"><span>    t3.xx
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">from</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">select</span>
</span></span><span style="display:flex;"><span>        user_id,
</span></span><span style="display:flex;"><span>        xx
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">from</span> table_1
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">where</span> del_flag = <span style="color:#ff0;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">group</span> <span style="color:#fff;font-weight:bold">by</span> user_id  <span style="color:#007f7f">-- åœ¨è¿™é‡Œå…ˆæ‰§è¡Œgroup by
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>) <span style="color:#fff;font-weight:bold">as</span> t1
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_2 t2 <span style="color:#fff;font-weight:bold">on</span> t1.user_id = t2.id
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">left</span> <span style="color:#fff;font-weight:bold">join</span> table_3 t3 <span style="color:#fff;font-weight:bold">on</span> t2.id = t3.user_id
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">where</span> <span style="color:#f00">æ¡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">order</span> <span style="color:#fff;font-weight:bold">by</span> <span style="color:#f00">æ¡ä»¶</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ€è·¯å°±æ˜¯å…ˆ <code>group by ç„¶å join</code>ï¼Œè¿™æ ·å°‘äº†å¾ˆå¤šå› ä¸º join äº§ç”Ÿçš„ç¬›å¡å°”ç§¯ã€‚</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/en/tags/mysql/">mysql</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://funny-toffee-4aa7c3.netlify.app/en/">Wjy&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
