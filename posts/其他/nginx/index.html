<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>nginx | Wjy&#39;s Blog</title>
<meta name="keywords" content="å…¶ä»–">
<meta name="description" content="nginx.conf è®²è§£ é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://wjy6.netlify.app/posts/%E5%85%B6%E4%BB%96/nginx/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://wjy6.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://wjy6.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://wjy6.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://wjy6.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://wjy6.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://wjy6.netlify.app/posts/%E5%85%B6%E4%BB%96/nginx/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:url" content="https://wjy6.netlify.app/posts/%E5%85%B6%E4%BB%96/nginx/">
  <meta property="og:site_name" content="Wjy&#39;s Blog">
  <meta property="og:title" content="nginx">
  <meta property="og:description" content="nginx.conf è®²è§£ é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-10-06T18:06:29+00:00">
    <meta property="article:modified_time" content="2018-10-06T18:06:29+00:00">
    <meta property="article:tag" content="å…¶ä»–">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="nginx">
<meta name="twitter:description" content="nginx.conf è®²è§£ é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://wjy6.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "nginx",
      "item": "https://wjy6.netlify.app/posts/%E5%85%B6%E4%BB%96/nginx/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "nginx",
  "name": "nginx",
  "description": "nginx.conf è®²è§£ é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60",
  "keywords": [
    "å…¶ä»–"
  ],
  "articleBody": "nginx.conf è®²è§£ é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 #user nobody; worker_processes 1; #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #pid logs/nginx.pid; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; #log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' # '$status $body_bytes_sent \"$http_referer\" ' # '\"$http_user_agent\" \"$http_x_forwarded_for\"'; #access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; server { listen 80; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / { root html; index index.html index.htm; } #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ { # proxy_pass http://127.0.0.1; #} # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ { # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #} # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\\.ht { # deny all; #} } # another virtual host using mix of IP-, name-, and port-based configuration # #server { # listen 8000; # listen somename:8080; # server_name somename alias another.alias; # location / { # root html; # index index.html index.htm; # } #} # HTTPS server # #server { # listen 443 ssl; # server_name localhost; # ssl_certificate cert.pem; # ssl_certificate_key cert.key; # ssl_session_cache shared:SSL:1m; # ssl_session_timeout 5m; # ssl_ciphers HIGH:!aNULL:!MD5; # ssl_prefer_server_ciphers on; # location / { # root html; # index index.html index.htm; # } #} } æˆ‘ä»¬æŠŠå…¶ä¸­çš„æ³¨é‡Šéƒ½åˆ æ‰ï¼Œé™¤æ‰äº†æ³¨é‡Šä¹‹åçš„nginxä»£ç ï¼Œç°åœ¨åªæœ‰22è¡Œäº†ã€‚æ„Ÿè§‰å¥½å¤šäº†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; server { listen 80; server_name localhost; location / { root html; index index.html index.htm; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } } åŠ ä¸Šæ³¨é‡Šï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚ worker_processes 1; # äº‹ä»¶åŒºå—å¼€å§‹ events { #å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰ #æ ¹æ®ç¡¬ä»¶è°ƒæ•´ï¼Œå’Œå‰é¢å·¥ä½œè¿›ç¨‹é…åˆèµ·æ¥ç”¨ï¼Œå°½é‡å¤§ï¼Œä½†æ˜¯åˆ«æŠŠcpuè·‘åˆ°100%å°±è¡Œã€‚æ¯ä¸ªè¿›ç¨‹å…è®¸çš„æœ€å¤šè¿æ¥æ•°ï¼Œç†è®ºä¸Šæ¯å°nginxæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°ä¸ºã€‚ worker_connections 1024; } #è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ http { #includeï¼šå¯¼å…¥å¤–éƒ¨æ–‡ä»¶mime.typesï¼Œå°†æ‰€æœ‰typesæå–ä¸ºæ–‡ä»¶ï¼Œç„¶åå¯¼å…¥åˆ°nginxé…ç½®æ–‡ä»¶ä¸­ include mime.types; #é»˜è®¤æ–‡ä»¶ç±»å‹ default_type application/octet-stream; #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚ #sendfileæŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œå¿…é¡»è®¾ä¸ºonã€‚å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œIOå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿuptimeã€‚ sendfile on; #é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ keepalive_timeout 65; # ç¬¬ä¸€ä¸ªServeråŒºå—å¼€å§‹ï¼Œè¡¨ç¤ºä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿä¸»æœºç«™ç‚¹ server { # æä¾›æœåŠ¡çš„ç«¯å£ï¼Œé»˜è®¤80 listen 80; # æä¾›æœåŠ¡çš„åŸŸåä¸»æœºå server_name localhost; #å¯¹ \"/\" å¯ç”¨åå‘ä»£ç†,ç¬¬ä¸€ä¸ªlocationåŒºå—å¼€å§‹ location / { root html; #æœåŠ¡é»˜è®¤å¯åŠ¨ç›®å½• index index.html index.htm; # é»˜è®¤çš„é¦–é¡µæ–‡ä»¶ï¼Œå¤šä¸ªç”¨ç©ºæ ¼åˆ†å¼€ } # é”™è¯¯é¡µé¢è·¯ç”± error_page 500 502 503 504 /50x.html; # å‡ºç°å¯¹åº”çš„httpçŠ¶æ€ç æ—¶ï¼Œä½¿ç”¨50x.htmlå›åº”å®¢æˆ· location = /50x.html { # locationåŒºå—å¼€å§‹ï¼Œè®¿é—®50x.html root html; # æŒ‡å®šå¯¹åº”çš„ç«™ç‚¹ç›®å½•ä¸ºhtml } } } nginx.conf åˆ†æ¨¡å—è§£è¯» è™½ç„¶ä¸Šé¢æœ‰äº†æ³¨è§£ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆè¿·ç³Šã€‚æ¥ç€è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŠŠnginx.confåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†è¿›è¡Œç†è§£ï¼š\nç¬¬ä¸€éƒ¨åˆ†ï¼šå…¨å±€å— ç¬¬äºŒéƒ¨åˆ†ï¼ševentså— ç¬¬ä¸‰éƒ¨åˆ†ï¼šhttpå— å›¾è§£ï¼š\nå…¨å±€å—ï¼š ä½œç”¨ï¼šä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ° events å—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginx æœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œä¸»è¦åŒ…æ‹¬é… ç½®è¿è¡Œ Nginx æœåŠ¡å™¨çš„ç”¨æˆ·ï¼ˆç»„ï¼‰ã€å…è®¸ç”Ÿæˆçš„ worker process æ•°ï¼Œè¿›ç¨‹ PID å­˜æ”¾è·¯å¾„ã€æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ä»¥ åŠé…ç½®æ–‡ä»¶çš„å¼•å…¥ç­‰ã€‚\næ¯”å¦‚ä¸Šé¢ç¬¬ä¸€è¡Œé…ç½®çš„\n1 worker_processes 1; è¿™æ˜¯ Nginx æœåŠ¡å™¨å¹¶å‘å¤„ç†æœåŠ¡çš„å…³é”®é…ç½®ï¼Œworker_processes å€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šï¼Œä½†æ˜¯ ä¼šå—åˆ°ç¡¬ä»¶ã€è½¯ä»¶ç­‰è®¾å¤‡çš„åˆ¶çº¦ã€‚\neventså—ï¼š ä½œç”¨ï¼ševents å—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“ Nginx æœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œå¸¸ç”¨çš„è®¾ç½®åŒ…æ‹¬æ˜¯å¦å¼€å¯å¯¹å¤š work process ä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ–ï¼Œæ˜¯å¦ å…è®¸åŒæ—¶æ¥æ”¶å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œé€‰å–å“ªç§äº‹ä»¶é©±åŠ¨æ¨¡å‹æ¥å¤„ç†è¿æ¥è¯·æ±‚ï¼Œæ¯ä¸ª word process å¯ä»¥åŒæ—¶æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰ã€‚\n1 worker_connections 1024; ä¸Šè¿°ä¾‹å­å°±è¡¨ç¤ºæ¯ä¸ª work process æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ä¸º 1024ã€‚è¿™éƒ¨åˆ†çš„é…ç½®å¯¹ Nginx çš„æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåœ¨å®é™…ä¸­åº”è¯¥çµæ´»é…ç½®ã€‚\nhttpå—ï¼š ä½œç”¨ï¼šè¿™ç®—æ˜¯ Nginx æœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œä»£ç†ã€ç¼“å­˜å’Œæ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®éƒ½åœ¨è¿™é‡Œã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼šhttp å—ä¹Ÿå¯ä»¥åŒ…æ‹¬ httpå…¨å±€å—ã€server å—ã€‚\nhttpå…¨å±€å— httpå…¨å±€å—é…ç½®çš„æŒ‡ä»¤åŒ…æ‹¬æ–‡ä»¶å¼•å…¥ã€MIME-TYPE å®šä¹‰ã€æ—¥å¿—è‡ªå®šä¹‰ã€è¿æ¥è¶…æ—¶æ—¶é—´ã€å•é“¾æ¥è¯·æ±‚æ•°ä¸Šé™ç­‰ã€‚\nserver å— è¿™å—å’Œè™šæ‹Ÿä¸»æœºæœ‰å¯†åˆ‡å…³ç³»ï¼Œè™šæ‹Ÿä¸»æœºä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œå’Œä¸€å°ç‹¬ç«‹çš„ç¡¬ä»¶ä¸»æœºæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¯¥æŠ€æœ¯çš„äº§ç”Ÿæ˜¯ä¸ºäº† èŠ‚çœäº’è”ç½‘æœåŠ¡å™¨ç¡¬ä»¶æˆæœ¬ã€‚\næ¯ä¸ª http å—å¯ä»¥åŒ…æ‹¬å¤šä¸ª server å—ï¼Œè€Œæ¯ä¸ª server å—å°±ç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚ è€Œæ¯ä¸ª server å—ä¹Ÿåˆ†ä¸ºå…¨å±€ server å—ï¼Œä»¥åŠå¯ä»¥åŒæ—¶åŒ…å«å¤šä¸ª locaton å—ã€‚ å…¨å±€ server å— æœ€å¸¸è§çš„é…ç½®æ˜¯æœ¬è™šæ‹Ÿæœºä¸»æœºçš„ç›‘å¬é…ç½®å’Œæœ¬è™šæ‹Ÿä¸»æœºçš„åç§°æˆ–IPé…ç½®ã€‚\nlocation å— ä¸€ä¸ª server å—å¯ä»¥é…ç½®å¤šä¸ª location å—ã€‚\nè¿™å—çš„ä¸»è¦ä½œç”¨æ˜¯åŸºäº Nginx æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ server_name/uri-stringï¼‰ï¼Œå¯¹è™šæ‹Ÿä¸»æœºåç§° ï¼ˆä¹Ÿå¯ä»¥æ˜¯IP åˆ«åï¼‰ä¹‹å¤–çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ å‰é¢çš„ /uri-stringï¼‰è¿›è¡ŒåŒ¹é…ï¼Œå¯¹ç‰¹å®šçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚åœ°å€å®šå‘ã€æ•°æ®ç¼“ å­˜å’Œåº”ç­”æ§åˆ¶ç­‰åŠŸèƒ½ï¼Œè¿˜æœ‰è®¸å¤šç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ä¹Ÿåœ¨è¿™é‡Œè¿›è¡Œã€‚\nnginxæœ€ç®€å•çš„ä¸Šçº¿ ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†nginxæ•´ä½“å¤§è‡´çš„ç»“æ„ï¼Œä»¥åŠæ¯éƒ¨åˆ†çš„ç»“æ„æ˜¯ç”¨äºåšä»€ä¹ˆçš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¿®æ”¹nginxå…³é”®ä½ç½®æ¥å®ç°æˆ‘ä»¬ç½‘ç«™çš„ä»£ç†åŠŸèƒ½ã€‚çœ‹ç€nginxé…ç½®å¾ˆç¹çï¼Œä½†æ˜¯å¦‚æœä½ åªæ˜¯éœ€è¦ä¸Šçº¿ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆä½ åªéœ€è¦å»ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹å³å¯ï¼š\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨é»˜è®¤ç®€å•çš„é…ç½®ï¼Œç„¶åæŒ‡å®šserver_nameå’Œrootï¼Œä¸»è¦æ˜¯å‘Šè¯‰nginxä»£ç†çš„ipæ˜¯xxxï¼Œç„¶åæˆ‘æ”¾åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶åœ¨bbbæ–‡ä»¶å¤¹å³å¯ã€‚nginxä¾¿ä¼šåœ¨ç”¨æˆ·è®¿é—®è¿™ä¸ªipæ—¶ï¼Œè‡ªåŠ¨çš„å°†bbbæ–‡ä»¶å¤¹ä¸­çš„index.htmlè¿”å›åˆ°æµè§ˆå™¨æ¥å±•ç¤ºé¡µé¢ã€‚\nnginxä¼˜åŒ– å‰ç«¯historyæ¨¡å¼404é—®é¢˜ 1 2 3 location / { try_files $uri$uri/ /index.html; } è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼Œå½“ç”¨æˆ·åˆ·æ–°é¡µé¢æ—¶ï¼ŒNginxä¼šå…ˆæ£€æŸ¥å½“å‰URLæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šå°è¯•è®¿é—®index.htmlï¼Œä»è€Œå¯ä»¥æ­£å¸¸æ˜¾ç¤ºé¡µé¢ã€‚\nåå‘ä»£ç† å‰ç«¯çš„ä¸»æµè§£å†³è·¨åŸŸçš„æ–¹å¼å°±æ˜¯\nå¼€å‘ç”Ÿäº§corsè§£å†³ å¼€å‘proxyï¼Œç”Ÿäº§nginxè§£å†³ã€‚ 1 2 3 4 5 6 7 8 9 #æ¥å£ç«¯ location /police/ { proxy_pass http://192.168.1.182:8852/police/; proxy_redirect default; proxy_http_version 1.1; proxy_connect_timeout 60; proxy_send_timeout 60; proxy_read_timeout 90; } å…·ä½“ä½ç½®ï¼š\nè¿™æ®µä»£ç çš„æ„æ€ï¼šå¤§è‡´å°±æ˜¯å¦‚æœé‡åˆ°ä»¥/policeè¯·æ±‚å¼€å¤´çš„æ¥å£ï¼Œé‚£ä¹ˆå°±å»è®¿é—®è¿™ä¸ªipåœ°å€(http://192.168.1.182:8852/police/)çš„åå°ç«¯å£ã€‚\nä¾‹å¦‚æˆ‘ä»¬é€šè¿‡axioså»è®¿é—®/police/getListè¿™ä¸ªåå°æ¥å£æ—¶ï¼Œnginxä¼šå°†è¿™ä¸ªè¯·æ±‚è½¬å‘åˆ°ipç«¯å£ä¸ºhttp://192.168.1.182:8852çš„åå°ä¸­ï¼Œåå°å°†ç»“æœè¿”å›ç»™nginxï¼Œnginxå†æŠŠç»“æœç»™åˆ°æµè§ˆå™¨ï¼Œå®ç°åå‘ä»£ç†ã€‚\nå®šä¹‰å¤šä¸ªç«¯å£çš„åå‘ä»£ç†ï¼š\ncopyä¸Šé¢çš„ï¼Œç›´æ¥ä¿®æ”¹ä»£ç†å¤´å’Œproxy_passå³å¯ã€‚\nå¼€å¯gzip å¼€å¯gzipå¯¹äºå‰ç«¯æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œæµè§ˆå™¨åŠ è½½çš„åŒ…å¤§æ¦‚èƒ½èŠ‚çº¦ä¸€åŠçš„ç©ºé—´ã€‚ä¾‹å¦‚é¦–é¡µéœ€è¦åŠ è½½a.jsæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸º900kbï¼Œåœ¨å¼€å¯gzipä¹‹åï¼Œæµè§ˆå™¨ä¼šå»åŠ è½½a.jsç»è¿‡gzipä¹‹åçš„æ–‡ä»¶a.js.gzï¼Œå¤§æ¦‚åªæœ‰450kbï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„æå‡æµè§ˆé€Ÿåº¦ã€‚\n1 2 3 4 5 6 7 8 9 10 gzip on; # é»˜è®¤offï¼Œæ˜¯å¦å¼€å¯gzip gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript; # ä¸Šé¢ä¸¤ä¸ªå¼€å¯åŸºæœ¬å°±èƒ½è·‘èµ·äº†ï¼Œä¸‹é¢çš„æ„¿æ„æŠ˜è…¾å°±äº†è§£ä¸€ä¸‹ gzip_static on; gzip_proxied any; gzip_vary on; gzip_comp_level 6; gzip_buffers 16 8k; # gzip_min_length 1k; gzip_http_version 1.1; å…·ä½“ä½ç½®ï¼š\nç»´æŠ¤é¡µé¢ åœ¨ç³»ç»Ÿè¿›è¡Œç»´æŠ¤å‡çº§æ—¶ï¼Œç”¨æˆ·æ‰“å¼€æˆ‘ä»¬çš„ç½‘ç«™çœ‹åˆ°çš„ç»´æŠ¤é¡µé¢ã€‚\n1 2 # ç³»ç»Ÿä¸´æ—¶ç»´æŠ¤è¯·æ‰“å¼€ä¸‹é¢è¿™è¡Œæ³¨é‡Šï¼Œå¹¶é‡å¯nginx,ç»´æŠ¤å®Œæ¯•åè¯·æ³¨é‡Šä¸‹å¹´è¿™è¡Œ,å¹¶é‡å¯nginx # rewrite ^(.*)$ /maintainace.html break; å…·ä½“ä½ç½®ï¼š\nä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™ åªæœ‰ä¸€ä¸ªipã€‚åˆ©ç”¨nginxä¸Šçº¿å¤šä¸ªç½‘ç«™ã€‚ä¾‹å¦‚è®¿é—®192.168.1.154:8080è®¿é—®æˆ‘ä»¬çš„ä¸ªäººåšå®¢ç½‘ç«™ï¼Œè®¿é—®192.168.1.154:8081è®¿é—®æˆ‘ä»¬çš„ç›´æ’­ç½‘ç«™ã€‚\nå¦‚ä½•é…ç½®ï¼š\nç›´æ¥å¤åˆ¶serverå—å³å¯ï¼Œä¸€ä¸ªserverå—å°±ä»£è¡¨äº†ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦æ”¹ç«¯å£å’Œæ–‡ä»¶çš„è·¯å¾„ç­‰å†…å®¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # ç¬¬ä¸€ä¸ªç½‘ç«™ï¼šä¸ªäººåšå®¢é¡¹ç›®é…ç½® server { listen 8080; root /data/www/hexo; index index.html; location / { try_files $uri$uri/ /index.html; # è·¯ç”±æ¨¡å¼historyçš„ä¿®æ”¹ } } # ç¬¬äºŒä¸ªç½‘ç«™ï¼šç›´æ’­ç½‘ç«™é¡¹ç›®é…ç½® server { listen 8081; root /data/www/geov; index index.html; location / {} } å…·ä½“ä½ç½®ï¼š\næ³¨æ„ç‚¹ï¼š\nè¿™é‡Œçš„8081ä¸€å®šè¦ä½ çš„æœåŠ¡å™¨å¼€æ”¾äº†è¿™ä¸ªç«¯å£æ‰å¯ä»¥ä½¿ç”¨ï¼Œå¦åˆ™ä½ æŒ‰ç…§è¿™ä¸ªé…ç½®äº†ä¹Ÿä¼šè®¿é—®ä¸åˆ°ï¼ˆè®©åç«¯å»é…ï¼‰ã€‚ å¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼ˆæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘ï¼‰ï¼Œåˆ™éœ€è¦å¼€æ”¾ç›¸åº”çš„å…¥å£ä¸º8081,å¦åˆ™ç”¨æˆ·è®¿é—®ä¸åˆ°ã€‚ åŠ¨é™åˆ†ç¦» åœ¨Webå¼€å‘ä¸­ï¼Œé€šå¸¸æ¥è¯´ï¼ŒåŠ¨æ€èµ„æºå…¶å®å°±æ˜¯æŒ‡é‚£äº›åå°èµ„æºï¼Œè€Œé™æ€èµ„æºå°±æ˜¯æŒ‡HTMLï¼ŒJavaScriptï¼ŒCSSï¼Œimgç­‰æ–‡ä»¶ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œéƒ½éœ€è¦å°†åŠ¨æ€èµ„æºå’Œé™æ€èµ„æºåˆ†å¼€ï¼Œå°†é™æ€èµ„æºéƒ¨ç½²åœ¨Nginxä¸Šï¼Œå½“ä¸€ä¸ªè¯·æ±‚æ¥çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯é™æ€èµ„æºçš„è¯·æ±‚ï¼Œå°±ç›´æ¥åˆ°nginxé…ç½®çš„é™æ€èµ„æºç›®å½•ä¸‹é¢è·å–èµ„æºï¼Œå¦‚æœæ˜¯åŠ¨æ€èµ„æºçš„è¯·æ±‚ï¼Œnginxåˆ©ç”¨åå‘ä»£ç†çš„åŸç†ï¼ŒæŠŠè¯·æ±‚è½¬å‘ç»™åå°åº”ç”¨å»å¤„ç†ï¼Œä»è€Œå®ç°åŠ¨é™åˆ†ç¦»ã€‚\nåœ¨ä½¿ç”¨å‰åç«¯åˆ†ç¦»ä¹‹åï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦çš„æå‡é™æ€èµ„æºçš„è®¿é—®é€Ÿåº¦ï¼ŒåŒæ—¶åœ¨å¼€è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥è®©å‰åç«¯å¼€å‘å¹¶è¡Œå¯ä»¥æœ‰æ•ˆçš„æé«˜å¼€å‘æ—¶é—´ï¼Œä¹Ÿå¯ä»¥æœ‰äº›çš„å‡å°‘è”è°ƒæ—¶é—´ ã€‚\nè§£æï¼š\nå®é™…ä¸Šæˆ‘ä»¬åœ¨ä»£ç†å‰ç«¯çš„htmlå’Œæ¥å£æ—¶å°±å·²ç»åšåˆ°äº†åŠ¨é™åˆ†ç¦»ã€‚æˆ‘ä»¬æ‰“åŒ…åçš„diståŒ…å®é™…ä¸Šå°±æ˜¯çº¯é™æ€çš„èµ„æºï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®nginxé™æ€èµ„æºæœåŠ¡å™¨ï¼Œå°±ä¸éœ€è¦ç»è¿‡åå°çš„tomcatã€‚è®¿é—®æ¥å£æ—¶ï¼Œå°±éœ€è¦nginxå…ˆå»è®¿é—®åå°æœåŠ¡å™¨ï¼Œæ‹¿åˆ°ç»“æœå†ç»™åˆ°æµè§ˆå™¨ã€‚\nå›¾è§£ï¼š\nå¦‚ä½•é…ç½®ï¼ˆå…¶å®æ˜¯ä¼˜åŒ–ï¼Œå› ä¸ºä¸€èˆ¬é…ç½®ä¼šæœ‰åŠ¨é™åˆ†ç¦»ï¼‰ï¼š\nå‡è®¾æœ‰æ¯”è¾ƒå¤§çš„å›¾ç‰‡ç­‰éœ€è¦æ”¾ç½®åˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åé€šè¿‡nginxæ¥è½¬å‘ã€‚æˆ–è€…æ˜¯æœ‰ä¸€ä¸ªçº¯å‰ç«¯çš„å¼€æºé¡¹ç›®ï¼ˆå¦‚pdf.jsï¼‰ï¼Œä¹Ÿéœ€è¦æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚å¦‚æœæ”¾åœ¨æœ¬åœ°ä»£ç åŒ…ï¼Œæ‰“åŒ…å‡ºæ¥ä½“ç§¯ä¼šå¾ˆå¤§ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 location /image/ { root /var/filecenter/; } location /static/ { root /var/filecenter/; } location /car/ { root /var/filecenter/; } location ~ .*\\.(html|htm|gif|jpg|jpeg|bmp|png|ico|js|css)$ { root /Users/dalaoyang/Downloads/static; } å…·ä½“ä½ç½®ï¼š\n",
  "wordCount" : "4023",
  "inLanguage": "en",
  "datePublished": "2018-10-06T18:06:29Z",
  "dateModified": "2018-10-06T18:06:29Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://wjy6.netlify.app/posts/%E5%85%B6%E4%BB%96/nginx/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wjy6.netlify.app/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.min.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://wjy6.netlify.app/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://wjy6.netlify.app/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://wjy6.netlify.app/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://wjy6.netlify.app/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://wjy6.netlify.app/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://wjy6.netlify.app/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://wjy6.netlify.app/">Home</a>&nbsp;Â»&nbsp;<a href="https://wjy6.netlify.app/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      nginx
    </h1>
    <div class="post-meta"><span title='2018-10-06 18:06:29 +0000 UTC'>2018-10-06</span>&nbsp;Â·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#nginxconf-%e8%ae%b2%e8%a7%a3" aria-label="nginx.conf è®²è§£">nginx.conf è®²è§£</a></li>
                <li>
                    <a href="#nginxconf-%e5%88%86%e6%a8%a1%e5%9d%97%e8%a7%a3%e8%af%bb" aria-label="nginx.conf åˆ†æ¨¡å—è§£è¯»">nginx.conf åˆ†æ¨¡å—è§£è¯»</a><ul>
                        <ul>
                        <ul>
                        <ul>
                        
                <li>
                    <a href="#%e5%85%a8%e5%b1%80%e5%9d%97" aria-label="å…¨å±€å—ï¼š">å…¨å±€å—ï¼š</a></li>
                <li>
                    <a href="#events%e5%9d%97" aria-label="eventså—ï¼š">eventså—ï¼š</a></li>
                <li>
                    <a href="#http%e5%9d%97" aria-label="httpå—ï¼š">httpå—ï¼š</a></li></ul>
                    </ul>
                    </ul>
                    </ul>
                </li>
                <li>
                    <a href="#nginx%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e4%b8%8a%e7%ba%bf" aria-label="nginxæœ€ç®€å•çš„ä¸Šçº¿">nginxæœ€ç®€å•çš„ä¸Šçº¿</a></li>
                <li>
                    <a href="#nginx%e4%bc%98%e5%8c%96" aria-label="nginxä¼˜åŒ–">nginxä¼˜åŒ–</a><ul>
                        
                <li>
                    <a href="#%e5%89%8d%e7%ab%afhistory%e6%a8%a1%e5%bc%8f404%e9%97%ae%e9%a2%98" aria-label="å‰ç«¯historyæ¨¡å¼404é—®é¢˜">å‰ç«¯historyæ¨¡å¼404é—®é¢˜</a></li>
                <li>
                    <a href="#%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86" aria-label="åå‘ä»£ç†">åå‘ä»£ç†</a></li>
                <li>
                    <a href="#%e5%bc%80%e5%90%afgzip" aria-label="å¼€å¯gzip">å¼€å¯gzip</a></li>
                <li>
                    <a href="#%e7%bb%b4%e6%8a%a4%e9%a1%b5%e9%9d%a2" aria-label="ç»´æŠ¤é¡µé¢">ç»´æŠ¤é¡µé¢</a></li>
                <li>
                    <a href="#%e4%b8%80%e4%b8%aaip%e4%b8%8a%e7%ba%bf%e5%a4%9a%e4%b8%aa%e7%bd%91%e7%ab%99" aria-label="ä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™">ä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™</a></li>
                <li>
                    <a href="#%e5%8a%a8%e9%9d%99%e5%88%86%e7%a6%bb" aria-label="åŠ¨é™åˆ†ç¦»">åŠ¨é™åˆ†ç¦»</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="nginxconf-è®²è§£">nginx.conf è®²è§£<a hidden class="anchor" aria-hidden="true" href="#nginxconf-è®²è§£">#</a></h1>
<p>é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">86
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f">#user  nobody;</span>
</span></span><span style="display:flex;"><span>worker_processes  1;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#error_log  logs/error.log;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#error_log  logs/error.log  notice;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#error_log  logs/error.log  info;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#pid        logs/nginx.pid;</span>
</span></span><span style="display:flex;"><span>events {
</span></span><span style="display:flex;"><span>    worker_connections  1024;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>http {
</span></span><span style="display:flex;"><span>    include       mime.types;
</span></span><span style="display:flex;"><span>    default_type  application/octet-stream;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#log_format  main  &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                  &#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#                  &#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#access_log  logs/access.log  main;</span>
</span></span><span style="display:flex;"><span>    sendfile        on;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#tcp_nopush     on;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#keepalive_timeout  0;</span>
</span></span><span style="display:flex;"><span>    keepalive_timeout  65;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#gzip  on;</span>
</span></span><span style="display:flex;"><span>    server {
</span></span><span style="display:flex;"><span>        listen       80;
</span></span><span style="display:flex;"><span>        server_name  localhost;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#charset koi8-r;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#access_log  logs/host.access.log  main;</span>
</span></span><span style="display:flex;"><span>        location / {
</span></span><span style="display:flex;"><span>            root   html;
</span></span><span style="display:flex;"><span>            index  index.html index.htm;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#error_page  404              /404.html;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># redirect server error pages to the static page /50x.html</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span>        error_page   <span style="color:#ff0;font-weight:bold">500</span> <span style="color:#ff0;font-weight:bold">502</span> <span style="color:#ff0;font-weight:bold">503</span> <span style="color:#ff0;font-weight:bold">504</span>  /50x.html;
</span></span><span style="display:flex;"><span>        location = /50x.html {
</span></span><span style="display:flex;"><span>            root   html;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#location ~ \.php$ {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    proxy_pass   http://127.0.0.1;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#}</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#location ~ \.php$ {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    root           html;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    fastcgi_pass   127.0.0.1:9000;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    fastcgi_index  index.php;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    include        fastcgi_params;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#}</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># deny access to .htaccess files, if Apache&#39;s document root</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># concurs with nginx&#39;s one</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#location ~ /\.ht {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    deny  all;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#}</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># another virtual host using mix of IP-, name-, and port-based configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#server {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    listen       8000;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    listen       somename:8080;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    server_name  somename  alias  another.alias;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    location / {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        root   html;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        index  index.html index.htm;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    }</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#}</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># HTTPS server</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#server {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    listen       443 ssl;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    server_name  localhost;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_certificate      cert.pem;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_certificate_key  cert.key;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_session_cache    shared:SSL:1m;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_session_timeout  5m;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    ssl_prefer_server_ciphers  on;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    location / {</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        root   html;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#        index  index.html index.htm;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#    }</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#}</span>
</span></span><span style="display:flex;"><span>}  
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬æŠŠå…¶ä¸­çš„æ³¨é‡Šéƒ½åˆ æ‰ï¼Œé™¤æ‰äº†æ³¨é‡Šä¹‹åçš„nginxä»£ç ï¼Œç°åœ¨åªæœ‰22è¡Œäº†ã€‚æ„Ÿè§‰å¥½å¤šäº†</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>worker_processes  1;
</span></span><span style="display:flex;"><span>events {
</span></span><span style="display:flex;"><span>worker_connections  1024;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>http {
</span></span><span style="display:flex;"><span>include       mime.types;
</span></span><span style="display:flex;"><span>default_type  application/octet-stream;
</span></span><span style="display:flex;"><span>sendfile        on;
</span></span><span style="display:flex;"><span>keepalive_timeout  65;
</span></span><span style="display:flex;"><span>server {
</span></span><span style="display:flex;"><span>    listen       80;
</span></span><span style="display:flex;"><span>    server_name  localhost;
</span></span><span style="display:flex;"><span>    location / {
</span></span><span style="display:flex;"><span>        root   html;
</span></span><span style="display:flex;"><span>        index  index.html index.htm;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    error_page   <span style="color:#ff0;font-weight:bold">500</span> <span style="color:#ff0;font-weight:bold">502</span> <span style="color:#ff0;font-weight:bold">503</span> <span style="color:#ff0;font-weight:bold">504</span>  /50x.html;
</span></span><span style="display:flex;"><span>    location = /50x.html {
</span></span><span style="display:flex;"><span>        root   html;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}  
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŠ ä¸Šæ³¨é‡Šï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f">#nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚</span>
</span></span><span style="display:flex;"><span>worker_processes  1;
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># äº‹ä»¶åŒºå—å¼€å§‹</span>
</span></span><span style="display:flex;"><span>events {
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#æ ¹æ®ç¡¬ä»¶è°ƒæ•´ï¼Œå’Œå‰é¢å·¥ä½œè¿›ç¨‹é…åˆèµ·æ¥ç”¨ï¼Œå°½é‡å¤§ï¼Œä½†æ˜¯åˆ«æŠŠcpuè·‘åˆ°100%å°±è¡Œã€‚æ¯ä¸ªè¿›ç¨‹å…è®¸çš„æœ€å¤šè¿æ¥æ•°ï¼Œç†è®ºä¸Šæ¯å°nginxæœåŠ¡å™¨çš„æœ€å¤§è¿æ¥æ•°ä¸ºã€‚</span>
</span></span><span style="display:flex;"><span>    worker_connections  1024;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ</span>
</span></span><span style="display:flex;"><span>http {
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#includeï¼šå¯¼å…¥å¤–éƒ¨æ–‡ä»¶mime.typesï¼Œå°†æ‰€æœ‰typesæå–ä¸ºæ–‡ä»¶ï¼Œç„¶åå¯¼å…¥åˆ°nginxé…ç½®æ–‡ä»¶ä¸­</span>
</span></span><span style="display:flex;"><span>    include       mime.types;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#é»˜è®¤æ–‡ä»¶ç±»å‹</span>
</span></span><span style="display:flex;"><span>    default_type  application/octet-stream;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#sendfileæŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œå¿…é¡»è®¾ä¸ºonã€‚å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œIOå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿuptimeã€‚</span>
</span></span><span style="display:flex;"><span>    sendfile        on;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</span>
</span></span><span style="display:flex;"><span>    keepalive_timeout  65;
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ç¬¬ä¸€ä¸ªServeråŒºå—å¼€å§‹ï¼Œè¡¨ç¤ºä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿä¸»æœºç«™ç‚¹</span>
</span></span><span style="display:flex;"><span>    server {
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># æä¾›æœåŠ¡çš„ç«¯å£ï¼Œé»˜è®¤80</span>
</span></span><span style="display:flex;"><span>        listen       80;
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># æä¾›æœåŠ¡çš„åŸŸåä¸»æœºå</span>
</span></span><span style="display:flex;"><span>        server_name  localhost;
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#å¯¹ &#34;/&#34; å¯ç”¨åå‘ä»£ç†,ç¬¬ä¸€ä¸ªlocationåŒºå—å¼€å§‹</span>
</span></span><span style="display:flex;"><span>        location / {
</span></span><span style="display:flex;"><span>            root   html;  <span style="color:#007f7f">#æœåŠ¡é»˜è®¤å¯åŠ¨ç›®å½•</span>
</span></span><span style="display:flex;"><span>            index  index.html index.htm; <span style="color:#007f7f"># é»˜è®¤çš„é¦–é¡µæ–‡ä»¶ï¼Œå¤šä¸ªç”¨ç©ºæ ¼åˆ†å¼€</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># é”™è¯¯é¡µé¢è·¯ç”±</span>
</span></span><span style="display:flex;"><span>        error_page   <span style="color:#ff0;font-weight:bold">500</span> <span style="color:#ff0;font-weight:bold">502</span> <span style="color:#ff0;font-weight:bold">503</span> <span style="color:#ff0;font-weight:bold">504</span>  /50x.html; <span style="color:#007f7f"># å‡ºç°å¯¹åº”çš„httpçŠ¶æ€ç æ—¶ï¼Œä½¿ç”¨50x.htmlå›åº”å®¢æˆ·</span>
</span></span><span style="display:flex;"><span>        location = /50x.html { <span style="color:#007f7f"># locationåŒºå—å¼€å§‹ï¼Œè®¿é—®50x.html</span>
</span></span><span style="display:flex;"><span>            root   html;  <span style="color:#007f7f"># æŒ‡å®šå¯¹åº”çš„ç«™ç‚¹ç›®å½•ä¸ºhtml</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}  
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="nginxconf-åˆ†æ¨¡å—è§£è¯»">nginx.conf åˆ†æ¨¡å—è§£è¯»<a hidden class="anchor" aria-hidden="true" href="#nginxconf-åˆ†æ¨¡å—è§£è¯»">#</a></h1>
<p>è™½ç„¶ä¸Šé¢æœ‰äº†æ³¨è§£ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆè¿·ç³Šã€‚æ¥ç€è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŠŠnginx.confåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†è¿›è¡Œç†è§£ï¼š</p>
<ul>
<li>ç¬¬ä¸€éƒ¨åˆ†ï¼šå…¨å±€å—</li>
<li>ç¬¬äºŒéƒ¨åˆ†ï¼ševentså—</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†ï¼šhttpå—</li>
</ul>
<p>å›¾è§£ï¼š<img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/1.png"></p>
<h5 id="å…¨å±€å—"><strong>å…¨å±€å—ï¼š</strong><a hidden class="anchor" aria-hidden="true" href="#å…¨å±€å—">#</a></h5>
<p>ä½œç”¨ï¼šä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ° events å—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginx æœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œä¸»è¦åŒ…æ‹¬é… ç½®è¿è¡Œ Nginx æœåŠ¡å™¨çš„ç”¨æˆ·ï¼ˆç»„ï¼‰ã€å…è®¸ç”Ÿæˆçš„ worker process æ•°ï¼Œè¿›ç¨‹ PID å­˜æ”¾è·¯å¾„ã€æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ä»¥ åŠé…ç½®æ–‡ä»¶çš„å¼•å…¥ç­‰ã€‚</p>
<p>æ¯”å¦‚ä¸Šé¢ç¬¬ä¸€è¡Œé…ç½®çš„</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>worker_processes  1;  
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ Nginx æœåŠ¡å™¨å¹¶å‘å¤„ç†æœåŠ¡çš„å…³é”®é…ç½®ï¼Œworker_processes å€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šï¼Œä½†æ˜¯ ä¼šå—åˆ°ç¡¬ä»¶ã€è½¯ä»¶ç­‰è®¾å¤‡çš„åˆ¶çº¦ã€‚</p>
<h5 id="eventså—"><strong>eventså—ï¼š</strong><a hidden class="anchor" aria-hidden="true" href="#eventså—">#</a></h5>
<p>ä½œç”¨ï¼ševents å—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“ Nginx æœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œå¸¸ç”¨çš„è®¾ç½®åŒ…æ‹¬æ˜¯å¦å¼€å¯å¯¹å¤š work process ä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ–ï¼Œæ˜¯å¦ å…è®¸åŒæ—¶æ¥æ”¶å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œé€‰å–å“ªç§äº‹ä»¶é©±åŠ¨æ¨¡å‹æ¥å¤„ç†è¿æ¥è¯·æ±‚ï¼Œæ¯ä¸ª word process å¯ä»¥åŒæ—¶æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>worker_connections  1024;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°ä¾‹å­å°±è¡¨ç¤ºæ¯ä¸ª work process æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ä¸º 1024ã€‚è¿™éƒ¨åˆ†çš„é…ç½®å¯¹ Nginx çš„æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåœ¨å®é™…ä¸­åº”è¯¥çµæ´»é…ç½®ã€‚</p>
<h5 id="httpå—"><strong>httpå—ï¼š</strong><a hidden class="anchor" aria-hidden="true" href="#httpå—">#</a></h5>
<p>ä½œç”¨ï¼šè¿™ç®—æ˜¯ Nginx æœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œä»£ç†ã€ç¼“å­˜å’Œæ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®éƒ½åœ¨è¿™é‡Œã€‚</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šhttp å—ä¹Ÿå¯ä»¥åŒ…æ‹¬ httpå…¨å±€å—ã€server å—ã€‚</p>
</blockquote>
<ul>
<li><strong>httpå…¨å±€å—</strong></li>
</ul>
<p>httpå…¨å±€å—é…ç½®çš„æŒ‡ä»¤åŒ…æ‹¬æ–‡ä»¶å¼•å…¥ã€MIME-TYPE å®šä¹‰ã€æ—¥å¿—è‡ªå®šä¹‰ã€è¿æ¥è¶…æ—¶æ—¶é—´ã€å•é“¾æ¥è¯·æ±‚æ•°ä¸Šé™ç­‰ã€‚</p>
<ul>
<li><strong>server å—</strong></li>
</ul>
<p>è¿™å—å’Œ<a href="https://cloud.tencent.com/product/lighthouse?from_column=20065&from=20065">è™šæ‹Ÿä¸»æœº</a>æœ‰å¯†åˆ‡å…³ç³»ï¼Œè™šæ‹Ÿä¸»æœºä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œå’Œä¸€å°ç‹¬ç«‹çš„ç¡¬ä»¶ä¸»æœºæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¯¥æŠ€æœ¯çš„äº§ç”Ÿæ˜¯ä¸ºäº† èŠ‚çœäº’è”ç½‘æœåŠ¡å™¨ç¡¬ä»¶æˆæœ¬ã€‚</p>
<ul>
<li>æ¯ä¸ª http å—å¯ä»¥åŒ…æ‹¬å¤šä¸ª server å—ï¼Œè€Œæ¯ä¸ª server å—å°±ç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚</li>
<li>è€Œæ¯ä¸ª server å—ä¹Ÿåˆ†ä¸ºå…¨å±€ server å—ï¼Œä»¥åŠå¯ä»¥åŒæ—¶åŒ…å«å¤šä¸ª locaton å—ã€‚</li>
<li><strong>å…¨å±€ server å—</strong></li>
</ul>
<p>æœ€å¸¸è§çš„é…ç½®æ˜¯æœ¬è™šæ‹Ÿæœºä¸»æœºçš„ç›‘å¬é…ç½®å’Œæœ¬è™šæ‹Ÿä¸»æœºçš„åç§°æˆ–IPé…ç½®ã€‚</p>
<ul>
<li><strong>location å—</strong></li>
</ul>
<p>ä¸€ä¸ª server å—å¯ä»¥é…ç½®å¤šä¸ª location å—ã€‚</p>
<p>è¿™å—çš„ä¸»è¦ä½œç”¨æ˜¯åŸºäº Nginx æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ server_name/uri-stringï¼‰ï¼Œå¯¹è™šæ‹Ÿä¸»æœºåç§° ï¼ˆä¹Ÿå¯ä»¥æ˜¯IP åˆ«åï¼‰ä¹‹å¤–çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ å‰é¢çš„ /uri-stringï¼‰è¿›è¡ŒåŒ¹é…ï¼Œå¯¹ç‰¹å®šçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚åœ°å€å®šå‘ã€æ•°æ®ç¼“ å­˜å’Œåº”ç­”æ§åˆ¶ç­‰åŠŸèƒ½ï¼Œè¿˜æœ‰è®¸å¤šç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ä¹Ÿåœ¨è¿™é‡Œè¿›è¡Œã€‚</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/2.png"></p>
<h1 id="nginxæœ€ç®€å•çš„ä¸Šçº¿">nginxæœ€ç®€å•çš„ä¸Šçº¿<a hidden class="anchor" aria-hidden="true" href="#nginxæœ€ç®€å•çš„ä¸Šçº¿">#</a></h1>
<p>ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†nginxæ•´ä½“å¤§è‡´çš„ç»“æ„ï¼Œä»¥åŠæ¯éƒ¨åˆ†çš„ç»“æ„æ˜¯ç”¨äºåšä»€ä¹ˆçš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¿®æ”¹nginxå…³é”®ä½ç½®æ¥å®ç°æˆ‘ä»¬ç½‘ç«™çš„ä»£ç†åŠŸèƒ½ã€‚çœ‹ç€nginxé…ç½®å¾ˆç¹çï¼Œä½†æ˜¯å¦‚æœä½ åªæ˜¯éœ€è¦ä¸Šçº¿ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆä½ åªéœ€è¦å»ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹å³å¯ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/3.png"></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é»˜è®¤ç®€å•çš„é…ç½®ï¼Œç„¶åæŒ‡å®šserver_nameå’Œrootï¼Œä¸»è¦æ˜¯å‘Šè¯‰nginxä»£ç†çš„ipæ˜¯xxxï¼Œç„¶åæˆ‘æ”¾åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶åœ¨bbbæ–‡ä»¶å¤¹å³å¯ã€‚nginxä¾¿ä¼šåœ¨ç”¨æˆ·è®¿é—®è¿™ä¸ªipæ—¶ï¼Œè‡ªåŠ¨çš„å°†bbbæ–‡ä»¶å¤¹ä¸­çš„index.htmlè¿”å›åˆ°æµè§ˆå™¨æ¥å±•ç¤ºé¡µé¢ã€‚</p>
<h1 id="nginxä¼˜åŒ–">nginxä¼˜åŒ–<a hidden class="anchor" aria-hidden="true" href="#nginxä¼˜åŒ–">#</a></h1>
<h2 id="å‰ç«¯historyæ¨¡å¼404é—®é¢˜"><strong>å‰ç«¯historyæ¨¡å¼404é—®é¢˜</strong><a hidden class="anchor" aria-hidden="true" href="#å‰ç«¯historyæ¨¡å¼404é—®é¢˜">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>location / {
</span></span><span style="display:flex;"><span>    try_files $uri$uri/ /index.html;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼Œå½“ç”¨æˆ·åˆ·æ–°é¡µé¢æ—¶ï¼ŒNginxä¼šå…ˆæ£€æŸ¥å½“å‰URLæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šå°è¯•è®¿é—®index.htmlï¼Œä»è€Œå¯ä»¥æ­£å¸¸æ˜¾ç¤ºé¡µé¢ã€‚</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/4.png"></p>
<h2 id="åå‘ä»£ç†">åå‘ä»£ç†<a hidden class="anchor" aria-hidden="true" href="#åå‘ä»£ç†">#</a></h2>
<p>å‰ç«¯çš„ä¸»æµè§£å†³è·¨åŸŸçš„æ–¹å¼å°±æ˜¯</p>
<ol>
<li>å¼€å‘ç”Ÿäº§corsè§£å†³</li>
<li>å¼€å‘proxyï¼Œç”Ÿäº§nginxè§£å†³ã€‚</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f">#æ¥å£ç«¯</span>
</span></span><span style="display:flex;"><span>location /police/ {
</span></span><span style="display:flex;"><span>    proxy_pass   http://192.168.1.182:8852/police/;
</span></span><span style="display:flex;"><span>    proxy_redirect default;
</span></span><span style="display:flex;"><span>    proxy_http_version 1.1;
</span></span><span style="display:flex;"><span>    proxy_connect_timeout   60;
</span></span><span style="display:flex;"><span>    proxy_send_timeout      60;
</span></span><span style="display:flex;"><span>    proxy_read_timeout      90;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“ä½ç½®ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/5.png"></p>
<p>è¿™æ®µä»£ç çš„æ„æ€ï¼šå¤§è‡´å°±æ˜¯å¦‚æœé‡åˆ°ä»¥/policeè¯·æ±‚å¼€å¤´çš„æ¥å£ï¼Œé‚£ä¹ˆå°±å»è®¿é—®è¿™ä¸ªipåœ°å€(http://192.168.1.182:8852/police/)çš„åå°ç«¯å£ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬é€šè¿‡axioså»è®¿é—®/police/getListè¿™ä¸ªåå°æ¥å£æ—¶ï¼Œnginxä¼šå°†è¿™ä¸ªè¯·æ±‚è½¬å‘åˆ°ipç«¯å£ä¸ºhttp://192.168.1.182:8852çš„åå°ä¸­ï¼Œåå°å°†ç»“æœè¿”å›ç»™nginxï¼Œnginxå†æŠŠç»“æœç»™åˆ°æµè§ˆå™¨ï¼Œå®ç°åå‘ä»£ç†ã€‚</p>
<p><strong>å®šä¹‰å¤šä¸ªç«¯å£çš„åå‘ä»£ç†ï¼š</strong></p>
<p>copyä¸Šé¢çš„ï¼Œç›´æ¥ä¿®æ”¹ä»£ç†å¤´å’Œproxy_passå³å¯ã€‚</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/6.png"></p>
<h2 id="å¼€å¯gzip"><strong>å¼€å¯gzip</strong><a hidden class="anchor" aria-hidden="true" href="#å¼€å¯gzip">#</a></h2>
<p>å¼€å¯gzipå¯¹äºå‰ç«¯æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œæµè§ˆå™¨åŠ è½½çš„åŒ…å¤§æ¦‚èƒ½èŠ‚çº¦ä¸€åŠçš„ç©ºé—´ã€‚ä¾‹å¦‚é¦–é¡µéœ€è¦åŠ è½½a.jsæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸º900kbï¼Œåœ¨å¼€å¯gzipä¹‹åï¼Œæµè§ˆå™¨ä¼šå»åŠ è½½a.jsç»è¿‡gzipä¹‹åçš„æ–‡ä»¶a.js.gzï¼Œå¤§æ¦‚åªæœ‰450kbï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„æå‡æµè§ˆé€Ÿåº¦ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gzip on; <span style="color:#007f7f"># é»˜è®¤offï¼Œæ˜¯å¦å¼€å¯gzip</span>
</span></span><span style="display:flex;"><span>gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ä¸Šé¢ä¸¤ä¸ªå¼€å¯åŸºæœ¬å°±èƒ½è·‘èµ·äº†ï¼Œä¸‹é¢çš„æ„¿æ„æŠ˜è…¾å°±äº†è§£ä¸€ä¸‹</span>
</span></span><span style="display:flex;"><span>gzip_static on;
</span></span><span style="display:flex;"><span>gzip_proxied any;
</span></span><span style="display:flex;"><span>gzip_vary on;
</span></span><span style="display:flex;"><span>gzip_comp_level 6;
</span></span><span style="display:flex;"><span>gzip_buffers <span style="color:#ff0;font-weight:bold">16</span> 8k;
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># gzip_min_length 1k;</span>
</span></span><span style="display:flex;"><span>gzip_http_version 1.1;
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“ä½ç½®ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/7.png"></p>
<h2 id="ç»´æŠ¤é¡µé¢">ç»´æŠ¤é¡µé¢<a hidden class="anchor" aria-hidden="true" href="#ç»´æŠ¤é¡µé¢">#</a></h2>
<p>åœ¨ç³»ç»Ÿè¿›è¡Œç»´æŠ¤å‡çº§æ—¶ï¼Œç”¨æˆ·æ‰“å¼€æˆ‘ä»¬çš„ç½‘ç«™çœ‹åˆ°çš„ç»´æŠ¤é¡µé¢ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f"># ç³»ç»Ÿä¸´æ—¶ç»´æŠ¤è¯·æ‰“å¼€ä¸‹é¢è¿™è¡Œæ³¨é‡Šï¼Œå¹¶é‡å¯nginx,ç»´æŠ¤å®Œæ¯•åè¯·æ³¨é‡Šä¸‹å¹´è¿™è¡Œ,å¹¶é‡å¯nginx</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># rewrite ^(.*)$ /maintainace.html break;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“ä½ç½®ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/8.png"></p>
<h2 id="ä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™"><strong>ä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™</strong><a hidden class="anchor" aria-hidden="true" href="#ä¸€ä¸ªipä¸Šçº¿å¤šä¸ªç½‘ç«™">#</a></h2>
<p>åªæœ‰ä¸€ä¸ªipã€‚åˆ©ç”¨nginxä¸Šçº¿å¤šä¸ªç½‘ç«™ã€‚ä¾‹å¦‚è®¿é—®192.168.1.154:8080è®¿é—®æˆ‘ä»¬çš„ä¸ªäººåšå®¢ç½‘ç«™ï¼Œè®¿é—®192.168.1.154:8081è®¿é—®æˆ‘ä»¬çš„ç›´æ’­ç½‘ç«™ã€‚</p>
<p><strong>å¦‚ä½•é…ç½®ï¼š</strong></p>
<p>ç›´æ¥å¤åˆ¶serverå—å³å¯ï¼Œä¸€ä¸ªserverå—å°±ä»£è¡¨äº†ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦æ”¹ç«¯å£å’Œæ–‡ä»¶çš„è·¯å¾„ç­‰å†…å®¹ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f"># ç¬¬ä¸€ä¸ªç½‘ç«™ï¼šä¸ªäººåšå®¢é¡¹ç›®é…ç½®</span>
</span></span><span style="display:flex;"><span>  server {
</span></span><span style="display:flex;"><span>   listen       8080;
</span></span><span style="display:flex;"><span>   root         /data/www/hexo;
</span></span><span style="display:flex;"><span>   index        index.html;
</span></span><span style="display:flex;"><span>   location / {
</span></span><span style="display:flex;"><span>    try_files $uri$uri/ /index.html; <span style="color:#007f7f"># è·¯ç”±æ¨¡å¼historyçš„ä¿®æ”¹</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ç¬¬äºŒä¸ªç½‘ç«™ï¼šç›´æ’­ç½‘ç«™é¡¹ç›®é…ç½®</span>
</span></span><span style="display:flex;"><span> server {
</span></span><span style="display:flex;"><span>  listen       8081;
</span></span><span style="display:flex;"><span>  root         /data/www/geov;
</span></span><span style="display:flex;"><span>  index        index.html;
</span></span><span style="display:flex;"><span>  location / {}
</span></span><span style="display:flex;"><span> }
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“ä½ç½®ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/9.png"></p>
<p><strong>æ³¨æ„ç‚¹ï¼š</strong></p>
<ol>
<li>è¿™é‡Œçš„8081ä¸€å®šè¦ä½ çš„æœåŠ¡å™¨å¼€æ”¾äº†è¿™ä¸ªç«¯å£æ‰å¯ä»¥ä½¿ç”¨ï¼Œå¦åˆ™ä½ æŒ‰ç…§è¿™ä¸ªé…ç½®äº†ä¹Ÿä¼šè®¿é—®ä¸åˆ°ï¼ˆè®©åç«¯å»é…ï¼‰ã€‚</li>
<li>å¦‚æœæ˜¯<a href="https://cloud.tencent.com/product/cvm?from_column=20065&from=20065">äº‘æœåŠ¡å™¨</a>ï¼ˆæ¯”å¦‚é˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘ï¼‰ï¼Œåˆ™éœ€è¦å¼€æ”¾ç›¸åº”çš„å…¥å£ä¸º8081,å¦åˆ™ç”¨æˆ·è®¿é—®ä¸åˆ°ã€‚</li>
</ol>
<h2 id="åŠ¨é™åˆ†ç¦»"><strong>åŠ¨é™åˆ†ç¦»</strong><a hidden class="anchor" aria-hidden="true" href="#åŠ¨é™åˆ†ç¦»">#</a></h2>
<p>åœ¨Webå¼€å‘ä¸­ï¼Œé€šå¸¸æ¥è¯´ï¼ŒåŠ¨æ€èµ„æºå…¶å®å°±æ˜¯æŒ‡é‚£äº›åå°èµ„æºï¼Œè€Œé™æ€èµ„æºå°±æ˜¯æŒ‡HTMLï¼ŒJavaScriptï¼ŒCSSï¼Œimgç­‰æ–‡ä»¶ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½éœ€è¦å°†åŠ¨æ€èµ„æºå’Œé™æ€èµ„æºåˆ†å¼€ï¼Œå°†é™æ€èµ„æºéƒ¨ç½²åœ¨Nginxä¸Šï¼Œå½“ä¸€ä¸ªè¯·æ±‚æ¥çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯é™æ€èµ„æºçš„è¯·æ±‚ï¼Œå°±ç›´æ¥åˆ°nginxé…ç½®çš„é™æ€èµ„æºç›®å½•ä¸‹é¢è·å–èµ„æºï¼Œå¦‚æœæ˜¯åŠ¨æ€èµ„æºçš„è¯·æ±‚ï¼Œnginxåˆ©ç”¨åå‘ä»£ç†çš„åŸç†ï¼ŒæŠŠè¯·æ±‚è½¬å‘ç»™åå°åº”ç”¨å»å¤„ç†ï¼Œä»è€Œå®ç°åŠ¨é™åˆ†ç¦»ã€‚</p>
<p>åœ¨ä½¿ç”¨å‰åç«¯åˆ†ç¦»ä¹‹åï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦çš„æå‡é™æ€èµ„æºçš„è®¿é—®é€Ÿåº¦ï¼ŒåŒæ—¶åœ¨å¼€è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥è®©å‰åç«¯å¼€å‘å¹¶è¡Œå¯ä»¥æœ‰æ•ˆçš„æé«˜å¼€å‘æ—¶é—´ï¼Œä¹Ÿå¯ä»¥æœ‰äº›çš„å‡å°‘è”è°ƒæ—¶é—´ ã€‚</p>
<p><strong>è§£æï¼š</strong></p>
<p>å®é™…ä¸Šæˆ‘ä»¬åœ¨ä»£ç†å‰ç«¯çš„htmlå’Œæ¥å£æ—¶å°±å·²ç»åšåˆ°äº†åŠ¨é™åˆ†ç¦»ã€‚æˆ‘ä»¬æ‰“åŒ…åçš„diståŒ…å®é™…ä¸Šå°±æ˜¯çº¯é™æ€çš„èµ„æºï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®nginxé™æ€èµ„æºæœåŠ¡å™¨ï¼Œå°±ä¸éœ€è¦ç»è¿‡åå°çš„tomcatã€‚è®¿é—®æ¥å£æ—¶ï¼Œå°±éœ€è¦nginxå…ˆå»è®¿é—®åå°æœåŠ¡å™¨ï¼Œæ‹¿åˆ°ç»“æœå†ç»™åˆ°æµè§ˆå™¨ã€‚</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/10.png"></p>
<p>å›¾è§£ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/11.png"></p>
<p><strong>å¦‚ä½•é…ç½®ï¼ˆå…¶å®æ˜¯ä¼˜åŒ–ï¼Œå› ä¸ºä¸€èˆ¬é…ç½®ä¼šæœ‰åŠ¨é™åˆ†ç¦»ï¼‰ï¼š</strong></p>
<p>å‡è®¾æœ‰æ¯”è¾ƒå¤§çš„å›¾ç‰‡ç­‰éœ€è¦æ”¾ç½®åˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åé€šè¿‡nginxæ¥è½¬å‘ã€‚æˆ–è€…æ˜¯æœ‰ä¸€ä¸ªçº¯å‰ç«¯çš„å¼€æºé¡¹ç›®ï¼ˆå¦‚pdf.jsï¼‰ï¼Œä¹Ÿéœ€è¦æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚å¦‚æœæ”¾åœ¨æœ¬åœ°ä»£ç åŒ…ï¼Œæ‰“åŒ…å‡ºæ¥ä½“ç§¯ä¼šå¾ˆå¤§ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>location /image/ {
</span></span><span style="display:flex;"><span>  root   /var/filecenter/;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>location /static/ {
</span></span><span style="display:flex;"><span>  root   /var/filecenter/;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>location /car/ {
</span></span><span style="display:flex;"><span>  root   /var/filecenter/;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>location ~ .*<span style="color:#0ff;font-weight:bold">\.</span>(html|htm|gif|jpg|jpeg|bmp|png|ico|js|css)$ {
</span></span><span style="display:flex;"><span>  root /Users/dalaoyang/Downloads/static;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“ä½ç½®ï¼š</p>
<p><img loading="lazy" src="/posts/%E5%85%B6%E4%BB%96/nginx/12.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://wjy6.netlify.app/tags/%E5%85%B6%E4%BB%96/">å…¶ä»–</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://wjy6.netlify.app/">Wjy&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>