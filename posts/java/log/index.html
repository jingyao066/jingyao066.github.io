<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>log | Wjy&#39;s Blog</title>
<meta name="keywords" content="java">
<meta name="description" content="概述 门面接口： 1 2 3 4 5 6 commons-logging： apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/posts/java/log/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="log" />
<meta property="og:description" content="概述 门面接口： 1 2 3 4 5 6 commons-logging： apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/posts/java/log/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-07T15:02:26+00:00" />
<meta property="article:modified_time" content="2018-04-07T15:02:26+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="log"/>
<meta name="twitter:description" content="概述 门面接口： 1 2 3 4 5 6 commons-logging： apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "log",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/java/log/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "log",
  "name": "log",
  "description": "概述 门面接口： 1 2 3 4 5 6 commons-logging： apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不",
  "keywords": [
    "java"
  ],
  "articleBody": "概述 门面接口：\n1 2 3 4 5 6 commons-logging： apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不必改动日志定义。 slf4j： simple logging facade for java,也是日志门面接口框架，和 Apache 的 commons-logging 是一样的概念，它们都不是具体的日志框架， 你可以指定其他主流的日志实现框架。使用 Slf4j 可以很灵活的使用占位符进行参数占位，简化代码，拥有更好的可读性。 日志实现：\n1 2 3 4 5 6 7 8 9 Logging： jdk1.5自带日志工具类，位于java.util.logging; Log4j： 市场占有率最高的一个日志框架，注意2015/08/05这一天，Apache宣布停止维护了，用户需要切到Log4j 2(包括log4j-api 和log4j-core组成)上面去； 2021-12-10号，爆发了log4j漏洞，jndi-rmi.危险等级很高 Logback： 是 Slf4j 的原生实现框架，同样也是出自 Log4j 一个人之手，但拥有比 log4j 更多的优点、特性和更做强的性能，现在基本都用来代替 log4j 成为主流。 简单地说，Logback 是一个 Java 领域的日志框架。 Logback 主要由三个模块组成：\nlogback-core：核心代码 logback-classic：log4j的一个改良版本，同时实现了slf4j的接口 logback-access：访问模块与Servlet容器集成提供通过Http来访问日志的功能 Logback 与 Log4J 实际上，这两个日志框架都出自同一个开发者之手，Logback 相对于 Log4J 有更多的优点\n同样的代码路径，Logback 执行更快 更充分的测试 原生实现了 SLF4J API（Log4J 还需要有一个中间转换层） 内容更丰富的文档 支持 XML 或者 Groovy 方式配置 配置文件自动热加载 从 IO 错误中优雅恢复 自动删除日志归档 自动压缩日志成为归档文件 支持 Prudent 模式，使多个 JVM 进程能记录同一个日志文件 支持配置文件中加入条件判断来适应不同的环境 更强大的过滤器 支持 SiftingAppender（可筛选 Appender） 异常栈信息带有包信息 快速开始 想在 Java 程序中使用 Logback，需要依赖三个 jar 包，分别是 slf4j-api，logback-core，logback-classic。其中 slf4j-api 并不是 Logback 的一部分，是另外一个项目，但是强烈建议将 slf4j 与 Logback 结合使用。要引用这些 jar 包，在 maven 项目中引入以下3个 dependencies\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 org.slf4j slf4j-api 1.7.5 ch.qos.logback logback-core 1.0.11 ch.qos.logback logback-classic 1.0.11 1 2 3 4 5 6 7 8 9 10 import org.slf4j.Logger; import org.slf4j.LoggerFactory; public class SimpleDemo { private static final Logger logger = LoggerFactory.getLogger(SimpleDemo.class); public static void main(String[] args) { logger.info(\"Hello, this is a line of log message logged by Logback\"); } } 以上代码的运行结果是：\n1 23:19:41.131 [main] INFO i.b.l.demo.universal.SimpleDemo - Hello, this is a line of log message logged by Logback 注意到这里，代码里并没有引用任何一个跟 Logback 相关的类，而是引用了 SLF4J 相关的类，这边是使用 SLF4J 的好处，在需要将日志框架切换为其它日志框架时，无需改动已有的代码。\nLoggerFactory 的 getLogger() 方法接收一个参数，以这个参数决定 logger 的名字，这里传入了 SimpleDemo 这个类的 Class 实例，那么 logger 的名字便是 SimpleDemo 这个类的全限定类名：io.beansoft.logback.demo.universal.SimpleDemo\nLogger，Appenders 与 Layouts 在 logback 里，最重要的三个类分别是\nLogger Appender Layout Logger 类位于 logback-classic 模块中， 而 Appender 和 Layout 位于 logback-core 中，这意味着， Appender 和 Layout 并不关心 Logger 的存在，不依赖于 Logger，同时也能看出， Logger 会依赖于 Appender 和 Layout 的协助，日志信息才能被正常打印出来。\n分层命名规则 为了可以控制哪些信息需要输出，哪些信息不需要输出，logback 中引进了一个概念：分层。每个 logger 都有一个 name，这个 name 的格式与 Java 语言中的包名格式相同。这也是前面的例子中直接把一个 class 对象传进LoggerFactory.getLogger()方法作为参数的原因。\nlogger 的 name 格式决定了多个 logger 能够组成一个树状的结构，为了维护这个分层的树状结构，每个 logger 都被绑定到一个 logger 上下文中，这个上下文负责理清各个 logger 之间的关系。\n例如， 命名为 io.beansoft 的 logger，是命名为 io.beansoft.logback 的 logger 的父亲，是命名为 io.beansoft.logback.demo 的 logger 的祖先。\n在 logger 上下文中，有一个 root logger，作为所有 logger 的祖先，这是 logback 内部维护的一个 logger，并非开发者自定义的 logger。\n可通过以下方式获得这个 logger：\n1 Logger rootLogger = LoggerFactory.getLogger(org.slf4j.Logger.ROOT_LOGGER_NAME); 同样，通过 logger 的 name，就能获得对应的其它 logger 实例。\nLogger 这个接口主要定义的方法有：\n1 2 3 4 5 6 7 8 9 10 package org.slf4j; public interface Logger { // Printing methods: public void trace(String message); public void debug(String message); public void info(String message); public void warn(String message); public void error(String message); } 日志打印级别 logger 有日志打印级别，如果不为一个 logger 指定打印级别，那么它将继承离他最近的一个有指定打印级别的祖先的打印级别。这里有一个容易混淆想不清楚的地方，如果 logger 先找它的父亲，而它的父亲没有指定打印级别，那么它会立即忽略它的父亲，往上继续寻找它爷爷，直到它找到 root logger。因此，也能看出来，要使用 logback， 必须为 root logger 指定日志打印级别。\n日志打印级别从低级到高级排序的顺序是： TRACE \u003c DEBUG \u003c INFO \u003c WARN \u003c ERROR\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 import org.slf4j.Logger; import org.slf4j.LoggerFactory; import ch.qos.logback.classic.Level; public class LogLevelDemo { public static void main(String[] args) { //这里强制类型转换时为了能设置 logger 的 Level ch.qos.logback.classic.Logger logger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(\"com.foo\"); logger.setLevel(Level.INFO); Logger barlogger = LoggerFactory.getLogger(\"com.foo.Bar\"); // 这个语句能打印，因为 WARN \u003e INFO logger.warn(\"can be printed because WARN \u003e INFO\"); // 这个语句不能打印，因为 DEBUG \u003c INFO. logger.debug(\"can not be printed because DEBUG \u003c INFO\"); // barlogger 是 logger 的一个子 logger // 它继承了 logger 的级别 INFO // 以下语句能打印，因为 INFO \u003e= INFO barlogger.info(\"can be printed because INFO \u003e= INFO\"); // 以下语句不能打印，因为 DEBUG \u003c INFO barlogger.debug(\"can not be printed because DEBUG \u003c INFO\"); } } 打印结果是：\n1 2 00:27:19.251 [main] WARN com.foo - can be printed because WARN \u003e INFO 00:27:19.255 [main] INFO com.foo.Bar - can be printed because INFO \u003e= INFO 获取 logger 在 logback 中，每个 logger 都是一个单例，调用 LoggerFactory.getLogger 方法时，如果传入的 logger name 相同，获取到的 logger 都是同一个实例。\n在为 logger 命名时，用类的全限定类名作为 logger name 是最好的策略，这样能够追踪到每一条日志消息的来源。\nAppender 和 Layout 在 logback 的世界中，日志信息不仅仅可以打印至 console，也可以打印至文件，甚至输出到网络流中，日志打印的目的地由 Appender 来决定，不同的 Appender 能将日志信息打印到不同的目的地去。\nAppender 是绑定在 logger 上的，同时，一个 logger 可以绑定多个 Appender，意味着一条信息可以同时打印到不同的目的地去。例如，常见的做法是，日志信息既输出到控制台，同时也记录到日志文件中，这就需要为 logger 绑定两个不同的 logger。\nAppender 是绑定在 logger 上的，而 logger 又有继承关系，因此一个 logger 打印信息时的目的地 Appender 需要参考它的父亲和祖先。在 logback 中，默认情况下，如果一个 logger 打印一条信息，那么这条信息首先会打印至它自己的 Appender，然后打印至它的父亲和父亲以上的祖先的 Appender，但如果它的父亲设置了 additivity = false，那么这个 logger 除了打印至它自己的 Appender 外，只会打印至其父亲的 Appender，因为它的父亲的 additivity 属性置为了 false，开始变得忘祖忘宗了，所以这个 logger 只认它父亲的 Appender；此外，对于这个 logger 的父亲来说，如果父亲的 logger 打印一条信息，那么它只会打印至自己的 Appender中（如果有的话），因为父亲已经忘记了爷爷及爷爷以上的那些父辈了。\n打印的日志除了有打印的目的地外，还有日志信息的展示格式。在 logback 中，用 Layout 来代表日志打印格式。比如说，PatternLayout 能够识别以下这条格式： %-4relative [%thread] %-5level %logger{32} - %msg%n 然后打印出来的格式效果是： 176 [main] DEBUG manual.architecture.HelloWorld2 - Hello world.\n上面这个格式的第一个字段代表从程序启动开始后经过的毫秒数，第二个字段代表打印出这条日志的线程名字，第三个字段代表日志信息的日志打印级别，第四个字段代表 logger name，第五个字段是日志信息，第六个字段仅仅是代表一个换行符。\n参数化打印日志 经常能看到打印日志的时候，使用以下这种方式打印日志：\n1 logger.debug(\"the message is \" + msg + \" from \" + somebody); 这种打印日志的方式有个缺点，就是无论日志级别是什么，程序总要先执行 \"the message is \" + msg + \" from \" + somebody 这段字符串的拼接操作。当 logger 设置的日志级别为比 DEBUG 级别更高级别时，DEBUG 级别的信息不回被打印出来的，显然，字符串拼接的操作是不必要的，当要拼接的字符串很大时，这无疑会带来很大的性能白白损耗。\n于是，一种改进的打印日志方式被人们发现了：\n1 2 3 if(logger.isDebugEnabled()) { logger.debug(\"the message is \" + msg + \" from \" + somebody); } 这样的方式确实能避免字符串拼接的不必要损耗，但这也不是最好的方法，当日志级别为 DEBUG 时，那么打印这行消息，需要判断两次日志级别。一次是logger.isDebugEnabled()，另一次是 logger.debug() 方法内部也会做的判断。这样也会带来一点点效率问题，如果能找到更好的方法，谁愿意无视白白消耗的效率。\n有一种更好的方法，那就是提供占位符的方式，以参数化的方式打印日志，例如上述的语句，可以是这样的写法：\n1 logger.debug(\"the message {} is from {}\", msg, somebody); 这样的方式，避免了字符串拼接，也避免了多一次日志级别的判断。\nlogback 内部运行流程 当应用程序发起一个记录日志的请求，例如 info() 时，logback 的内部运行流程如下所示\n获得过滤器链条 检查日志级别以决定是否继续打印 创建一个 LoggingEvent 对象 调用 Appenders 进行日志信息格式化 发送 LoggingEvent 到对应的目的地 有关性能问题 关于日志系统，人们讨论得最多的是性能问题，即使是小型的应用程序，也有可能输出大量的日志。打印日志中的不当处理，会引发各种性能问题，例如太多的日志记录请求可能使磁盘 IO 成为性能瓶颈，从而影响到应用程序的正常运行。在合适的时候记录日志、以更好的方式发起日志请求、以及合理设置日志级别方面，都有可能造成性能问题。 关于性能问题，以下几个方面需要了解\n建议使用占位符的方式参数化记录日志 logback 内部机制保证 logger 在记录日志时，不必每一次都去遍历它的父辈以获得关于日志级别、Appender 的信息 在 logback 中，将日志信息格式化，以及输出到目的地，是最损耗性能的操作 logback 配置须知 配置方式 logback 提供的配置方式有以下几种：\n编程式配置 xml 格式 groovy 格式 logback 在启动时，根据以下步骤寻找配置文件：\n在 classpath 中寻找 logback-test.xml文件 如果找不到 logback-test.xml，则在 classpath 中寻找 logback.groovy 文件 如果找不到 logback.groovy，则在 classpath 中寻找 logback.xml文件 如果上述的文件都找不到，则 logback 会使用 JDK 的 SPI 机制查找 META-INF/services/ch.qos.logback.classic.spi.Configurator 中的 logback 配置实现类，这个实现类必须实现 Configuration 接口，使用它的实现来进行配置 如果上述操作都不成功，logback 就会使用它自带的 BasicConfigurator 来配置，并将日志输出到 console logback-test.xml 一般用来在测试代码中打日志，如果是 maven 项目，一般把 logback-test.xml 放在 src/test/resources 目录下。maven 打包的时候也不会把这个文件打进 jar 包里。 logback 启动的时候解析配置文件大概需要 100 毫秒的时间，如果希望更快启动，可以采用 SPI 的方式。\n默认的配置 前面有提到默认的配置，由 BasicConfiguator 类配置而成，这个类的配置可以用如下的配置文件来表示：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 ",
  "wordCount" : "19114",
  "inLanguage": "en",
  "datePublished": "2018-04-07T15:02:26Z",
  "dateModified": "2018-04-07T15:02:26Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/posts/java/log/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/archives/" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/">Home</a>&nbsp;»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      log
    </h1>
    <div class="post-meta"><span title='2018-04-07 15:02:26 +0000 UTC'>2018-04-07</span>&nbsp;·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e6%a6%82%e8%bf%b0" aria-label="概述">概述</a></li>
                <li>
                    <a href="#logback-%e4%b8%8e-log4j" aria-label="Logback 与 Log4J">Logback 与 Log4J</a></li>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%bc%80%e5%a7%8b" aria-label="快速开始">快速开始</a></li>
                <li>
                    <a href="#loggerappenders-%e4%b8%8e-layouts" aria-label="Logger，Appenders 与 Layouts">Logger，Appenders 与 Layouts</a><ul>
                        
                <li>
                    <a href="#%e5%88%86%e5%b1%82%e5%91%bd%e5%90%8d%e8%a7%84%e5%88%99" aria-label="分层命名规则">分层命名规则</a></li>
                <li>
                    <a href="#%e6%97%a5%e5%bf%97%e6%89%93%e5%8d%b0%e7%ba%a7%e5%88%ab" aria-label="日志打印级别">日志打印级别</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96-logger" aria-label="获取 logger">获取 logger</a></li>
                <li>
                    <a href="#appender-%e5%92%8c-layout" aria-label="Appender 和 Layout">Appender 和 Layout</a></li>
                <li>
                    <a href="#%e5%8f%82%e6%95%b0%e5%8c%96%e6%89%93%e5%8d%b0%e6%97%a5%e5%bf%97" aria-label="参数化打印日志">参数化打印日志</a></li>
                <li>
                    <a href="#logback-%e5%86%85%e9%83%a8%e8%bf%90%e8%a1%8c%e6%b5%81%e7%a8%8b" aria-label="logback 内部运行流程">logback 内部运行流程</a></li>
                <li>
                    <a href="#%e6%9c%89%e5%85%b3%e6%80%a7%e8%83%bd%e9%97%ae%e9%a2%98" aria-label="有关性能问题">有关性能问题</a></li></ul>
                </li>
                <li>
                    <a href="#logback-%e9%85%8d%e7%bd%ae%e9%a1%bb%e7%9f%a5" aria-label="logback 配置须知">logback 配置须知</a><ul>
                        
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e6%96%b9%e5%bc%8f" aria-label="配置方式">配置方式</a></li>
                <li>
                    <a href="#%e9%bb%98%e8%ae%a4%e7%9a%84%e9%85%8d%e7%bd%ae" aria-label="默认的配置">默认的配置</a></li>
                <li>
                    <a href="#%e5%90%af%e5%8a%a8%e6%97%b6%e6%89%93%e5%8d%b0%e7%8a%b6%e6%80%81%e4%bf%a1%e6%81%af" aria-label="启动时打印状态信息">启动时打印状态信息</a></li>
                <li>
                    <a href="#%e9%87%8d%e7%bd%ae%e9%bb%98%e8%ae%a4%e7%9a%84%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e4%bd%8d%e7%bd%ae" aria-label="重置默认的配置文件位置">重置默认的配置文件位置</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e8%87%aa%e5%8a%a8%e7%83%ad%e5%8a%a0%e8%bd%bd" aria-label="配置文件自动热加载">配置文件自动热加载</a></li>
                <li>
                    <a href="#%e8%be%93%e5%87%ba%e5%bc%82%e5%b8%b8%e6%a0%88%e6%97%b6%e4%b9%9f%e6%89%93%e5%8d%b0%e5%87%ba-jar-%e5%8c%85%e7%9a%84%e4%bf%a1%e6%81%af" aria-label="输出异常栈时也打印出 jar 包的信息">输出异常栈时也打印出 jar 包的信息</a></li>
                <li>
                    <a href="#%e7%9b%b4%e6%8e%a5%e8%b0%83%e7%94%a8-joranconfigurator" aria-label="直接调用 JoranConfigurator">直接调用 JoranConfigurator</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="配置文件">配置文件</a><ul>
                        
                <li>
                    <a href="#%e6%a0%b9%e8%8a%82%e7%82%b9configuration" aria-label="根节点&lt;configuration&gt;">根节点&lt;configuration&gt;</a></li>
                <li>
                    <a href="#logger-%e8%8a%82%e7%82%b9" aria-label="logger 节点">logger 节点</a></li>
                <li>
                    <a href="#root-%e8%8a%82%e7%82%b9" aria-label="root 节点">root 节点</a></li>
                <li>
                    <a href="#appender-%e8%8a%82%e7%82%b9" aria-label="appender 节点">appender 节点</a><ul>
                        
                <li>
                    <a href="#consoleappender" aria-label="ConsoleAppender">ConsoleAppender</a></li>
                <li>
                    <a href="#fileappender" aria-label="FileAppender">FileAppender</a></li>
                <li>
                    <a href="#rollingfileappender" aria-label="RollingFileAppender">RollingFileAppender</a><ul>
                        
                <li>
                    <a href="#timebasedrollingpolicy" aria-label="TimeBasedRollingPolicy">TimeBasedRollingPolicy</a></li>
                <li>
                    <a href="#sizebasedtriggeringpolicy" aria-label="SizeBasedTriggeringPolicy">SizeBasedTriggeringPolicy</a></li>
                <li>
                    <a href="#fixedwindowrollingpolicy" aria-label="FixedWindowRollingPolicy">FixedWindowRollingPolicy</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#context-name-%e8%8a%82%e7%82%b9" aria-label="Context Name 节点">Context Name 节点</a></li>
                <li>
                    <a href="#property%e4%bd%bf%e7%94%a8%e5%8f%98%e9%87%8f" aria-label="&lt;property&gt;使用变量">&lt;property&gt;使用变量</a><ul>
                        
                <li>
                    <a href="#%e5%ae%9a%e4%b9%89%e5%8f%98%e9%87%8f" aria-label="定义变量">定义变量</a></li>
                <li>
                    <a href="#%e5%8f%98%e9%87%8f%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f" aria-label="变量的作用域">变量的作用域</a></li>
                <li>
                    <a href="#%e5%8f%98%e9%87%8f%e7%9a%84%e9%bb%98%e8%ae%a4%e5%80%bc" aria-label="变量的默认值">变量的默认值</a></li>
                <li>
                    <a href="#%e8%bf%90%e8%a1%8c%e6%97%b6%e5%ae%9a%e4%b9%89%e5%8f%98%e9%87%8f" aria-label="运行时定义变量">运行时定义变量</a></li>
                <li>
                    <a href="#%e6%9d%a1%e4%bb%b6%e5%8c%96%e5%a4%84%e7%90%86%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="条件化处理配置文件">条件化处理配置文件</a></li>
                <li>
                    <a href="#%e4%bb%8ejndi-%e8%8e%b7%e5%8f%96%e5%8f%98%e9%87%8f" aria-label="从JNDI 获取变量">从JNDI 获取变量</a></li>
                <li>
                    <a href="#%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab" aria-label="文件包含">文件包含</a></li></ul>
                </li>
                <li>
                    <a href="#context-listener" aria-label="Context Listener">Context Listener</a></li></ul>
                </li>
                <li>
                    <a href="#appender" aria-label="Appender">Appender</a><ul>
                        
                <li>
                    <a href="#appender-%e6%a6%82%e5%bf%b5" aria-label="Appender 概念">Appender 概念</a></li>
                <li>
                    <a href="#appenderbase-%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90" aria-label="AppenderBase 源码分析">AppenderBase 源码分析</a></li>
                <li>
                    <a href="#logback-core-%e6%a8%a1%e5%9d%97" aria-label="logback-core 模块">logback-core 模块</a><ul>
                        
                <li>
                    <a href="#outputstreamappender" aria-label="OutputStreamAppender">OutputStreamAppender</a></li>
                <li>
                    <a href="#consoleappender-1" aria-label="ConsoleAppender">ConsoleAppender</a></li>
                <li>
                    <a href="#fileappender-1" aria-label="FileAppender">FileAppender</a></li>
                <li>
                    <a href="#rollingfileappender-1" aria-label="RollingFileAppender">RollingFileAppender</a><ul>
                        
                <li>
                    <a href="#%e6%bb%9a%e5%8a%a8%e7%ad%96%e7%95%a5" aria-label="滚动策略">滚动策略</a></li>
                <li>
                    <a href="#timebasedrollingpolicy-1" aria-label="TimeBasedRollingPolicy">TimeBasedRollingPolicy</a></li>
                <li>
                    <a href="#sizeandtimebasedrollingpolicy" aria-label="SizeAndTimeBasedRollingPolicy">SizeAndTimeBasedRollingPolicy</a></li>
                <li>
                    <a href="#fixedwindowrollingpolicy-1" aria-label="FixedWindowRollingPolicy">FixedWindowRollingPolicy</a></li>
                <li>
                    <a href="#sizebasedtriggeringpolicy-1" aria-label="SizeBasedTriggeringPolicy">SizeBasedTriggeringPolicy</a></li></ul>
                </li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae%e7%a4%ba%e4%be%8b" aria-label="常用配置示例">常用配置示例</a><ul>
                        
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e4%b8%80" aria-label="配置一">配置一</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e4%ba%8c" aria-label="配置二">配置二</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e4%b8%89" aria-label="配置三">配置三</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e6%89%93%e5%a5%bd%e6%97%a5%e5%bf%97" aria-label="如何打好日志">如何打好日志</a><ul>
                        
                <li>
                    <a href="#%e5%bc%ba%e5%88%b6" aria-label="强制">强制</a><ul>
                        
                <li>
                    <a href="#%e6%ad%a3%e7%a1%ae%e5%a3%b0%e6%98%8e%e6%97%a5%e5%bf%97%e5%af%b9%e8%b1%a1logger" aria-label="正确声明日志对象logger">正确声明日志对象logger</a></li>
                <li>
                    <a href="#%e4%bb%a3%e7%a0%81%e4%b8%ad%e6%97%a5%e5%bf%97%e7%ba%a7%e5%88%ab%e4%bd%bf%e7%94%a8" aria-label="代码中日志级别使用">代码中日志级别使用</a></li>
                <li>
                    <a href="#%e6%ad%a3%e7%a1%ae%e7%9a%84%e6%89%93%e5%8d%b0%e5%8f%98%e9%87%8f" aria-label="正确的打印变量">正确的打印变量</a></li>
                <li>
                    <a href="#%e6%ad%a3%e7%a1%ae%e7%9a%84%e6%89%93%e5%8d%b0%e5%bc%82%e5%b8%b8" aria-label="正确的打印异常">正确的打印异常</a></li>
                <li>
                    <a href="#%e5%af%b9%e4%ba%8e-tracedebuginfo-%e7%ba%a7%e5%88%ab%e7%9a%84%e6%97%a5%e5%bf%97%e8%be%93%e5%87%ba%e5%bf%85%e9%a1%bb%e8%bf%9b%e8%a1%8c%e6%97%a5%e5%bf%97%e7%ba%a7%e5%88%ab%e7%9a%84%e5%bc%80%e5%85%b3%e5%88%a4%e6%96%ad" aria-label="对于 trace/debug/info 级别的日志输出，必须进行日志级别的开关判断">对于 trace/debug/info 级别的日志输出，必须进行日志级别的开关判断</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%a6%81%e6%ad%a2" aria-label="禁止">禁止</a><ul>
                        
                <li>
                    <a href="#%e7%a6%81%e6%ad%a2%e6%8b%bc%e6%8e%a5%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%89%93%e5%8d%b0%e6%97%a5%e5%bf%97" aria-label="禁止拼接字符串打印日志">禁止拼接字符串打印日志</a></li>
                <li>
                    <a href="#%e7%a6%81%e6%ad%a2eprintstacktrace" aria-label="禁止e.printStackTrace()">禁止e.printStackTrace()</a></li>
                <li>
                    <a href="#%e7%a6%81%e6%ad%a2%e4%bd%bf%e7%94%a8system-printsystemoutprintlnsystemerrorprintln" aria-label="禁止使用System print、System.out.println、System.error.println">禁止使用System print、System.out.println、System.error.println</a></li>
                <li>
                    <a href="#%e7%a6%81%e6%ad%a2%e8%ae%b0%e5%bd%95%e6%97%a5%e5%bf%97%e5%90%8e%e5%8f%88%e6%8a%9b%e5%87%ba%e5%bc%82%e5%b8%b8" aria-label="禁止记录日志后又抛出异常">禁止记录日志后又抛出异常</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#spring-boot%e6%97%a5%e5%bf%97" aria-label="spring boot日志">spring boot日志</a><ul>
                        
                <li>
                    <a href="#spring-boot%e9%bb%98%e8%ae%a4%e6%97%a5%e5%bf%97%e7%b3%bb%e7%bb%9f" aria-label="Spring Boot默认日志系统">Spring Boot默认日志系统</a></li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e5%9c%a8%e9%a1%b9%e7%9b%ae%e4%b8%ad%e6%89%93%e5%8d%b0%e6%97%a5%e5%bf%97" aria-label="如何在项目中打印日志">如何在项目中打印日志</a></li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e5%b0%86%e6%97%a5%e5%bf%97%e4%bf%a1%e6%81%af%e5%ad%98%e5%82%a8%e5%88%b0%e6%96%87%e4%bb%b6" aria-label="如何将日志信息存储到文件">如何将日志信息存储到文件</a></li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e8%ae%be%e7%bd%ae%e6%97%a5%e5%bf%97%e7%ba%a7%e5%88%ab" aria-label="如何设置日志级别">如何设置日志级别</a></li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e5%ae%9a%e5%88%b6%e8%87%aa%e5%b7%b1%e7%9a%84%e6%97%a5%e5%bf%97%e6%a0%bc%e5%bc%8f" aria-label="如何定制自己的日志格式">如何定制自己的日志格式</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="概述">概述<a hidden class="anchor" aria-hidden="true" href="#概述">#</a></h1>
<p>门面接口：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>commons-logging：
</span></span><span style="display:flex;"><span>apache最早提供的日志门面接口，用户可以根据自己喜欢选择不同日志实现框架，而不必改动日志定义。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>slf4j：
</span></span><span style="display:flex;"><span>simple logging facade for java,也是日志门面接口框架，和 Apache 的 commons-logging 是一样的概念，它们都不是具体的日志框架，
</span></span><span style="display:flex;"><span>你可以指定其他主流的日志实现框架。使用 Slf4j 可以很灵活的使用占位符进行参数占位，简化代码，拥有更好的可读性。
</span></span></code></pre></td></tr></table>
</div>
</div><p>日志实现：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Logging：
</span></span><span style="display:flex;"><span>jdk1.5自带日志工具类，位于java.util.logging;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Log4j：
</span></span><span style="display:flex;"><span>市场占有率最高的一个日志框架，注意2015/08/05这一天，Apache宣布停止维护了，用户需要切到Log4j 2(包括log4j-api 和log4j-core组成)上面去；
</span></span><span style="display:flex;"><span>2021-12-10号，爆发了log4j漏洞，jndi-rmi.危险等级很高
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logback：
</span></span><span style="display:flex;"><span>是 Slf4j 的原生实现框架，同样也是出自 Log4j 一个人之手，但拥有比 log4j 更多的优点、特性和更做强的性能，现在基本都用来代替 log4j 成为主流。
</span></span></code></pre></td></tr></table>
</div>
</div><p>简单地说，Logback 是一个 Java 领域的日志框架。
Logback 主要由三个模块组成：</p>
<ul>
<li>logback-core：核心代码</li>
<li>logback-classic：log4j的一个改良版本，同时实现了<code>slf4j</code>的接口</li>
<li>logback-access：访问模块与Servlet容器集成提供通过Http来访问日志的功能</li>
</ul>
<h1 id="logback-与-log4j">Logback 与 Log4J<a hidden class="anchor" aria-hidden="true" href="#logback-与-log4j">#</a></h1>
<p>实际上，这两个日志框架都出自同一个开发者之手，Logback 相对于 Log4J 有更多的优点</p>
<ul>
<li>同样的代码路径，Logback 执行更快</li>
<li>更充分的测试</li>
<li>原生实现了 SLF4J API（Log4J 还需要有一个中间转换层）</li>
<li>内容更丰富的文档</li>
<li>支持 XML 或者 Groovy 方式配置</li>
<li>配置文件自动热加载</li>
<li>从 IO 错误中优雅恢复</li>
<li>自动删除日志归档</li>
<li>自动压缩日志成为归档文件</li>
<li>支持 Prudent 模式，使多个 JVM 进程能记录同一个日志文件</li>
<li>支持配置文件中加入条件判断来适应不同的环境</li>
<li>更强大的过滤器</li>
<li>支持 SiftingAppender（可筛选 Appender）</li>
<li>异常栈信息带有包信息</li>
</ul>
<h1 id="快速开始">快速开始<a hidden class="anchor" aria-hidden="true" href="#快速开始">#</a></h1>
<p>想在 Java 程序中使用 Logback，需要依赖三个 jar 包，分别是 slf4j-api，logback-core，logback-classic。其中 slf4j-api 并不是 Logback 的一部分，是另外一个项目，但是强烈建议将 slf4j 与 Logback 结合使用。要引用这些 jar 包，在 maven 项目中引入以下3个 dependencies</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;groupId&gt;</span>org.slf4j<span style="font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;artifactId&gt;</span>slf4j-api<span style="font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;version&gt;</span>1.7.5<span style="font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;groupId&gt;</span>ch.qos.logback<span style="font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;artifactId&gt;</span>logback-core<span style="font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;version&gt;</span>1.0.11<span style="font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;groupId&gt;</span>ch.qos.logback<span style="font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;artifactId&gt;</span>logback-classic<span style="font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;version&gt;</span>1.0.11<span style="font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.Logger;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.LoggerFactory;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> SimpleDemo {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> Logger logger = LoggerFactory.<span style="color:#007f7f">getLogger</span>(SimpleDemo.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        logger.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;Hello, this is a line of log message logged by Logback&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>以上代码的运行结果是：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>23:19:41.131 [main] INFO  i.b.l.demo.universal.SimpleDemo - Hello, this is a line of log message logged by Logback
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意到这里，代码里并没有引用任何一个跟 Logback 相关的类，而是引用了 SLF4J 相关的类，这边是使用 SLF4J 的好处，在需要将日志框架切换为其它日志框架时，无需改动已有的代码。</p>
<p><code>LoggerFactory</code> 的 <code>getLogger()</code> 方法接收一个参数，以这个参数决定 logger 的名字，这里传入了 <code>SimpleDemo</code> 这个类的 Class 实例，那么 logger 的名字便是 <code>SimpleDemo</code> 这个类的全限定类名：<code>io.beansoft.logback.demo.universal.SimpleDemo</code></p>
<h1 id="loggerappenders-与-layouts">Logger，Appenders 与 Layouts<a hidden class="anchor" aria-hidden="true" href="#loggerappenders-与-layouts">#</a></h1>
<p>在 logback 里，最重要的三个类分别是</p>
<ul>
<li>Logger</li>
<li>Appender</li>
<li>Layout</li>
</ul>
<p>Logger 类位于 logback-classic 模块中， 而 Appender 和 Layout 位于 logback-core 中，这意味着， Appender 和 Layout 并不关心 Logger 的存在，不依赖于 Logger，同时也能看出， Logger 会依赖于 Appender 和 Layout 的协助，日志信息才能被正常打印出来。</p>
<h2 id="分层命名规则">分层命名规则<a hidden class="anchor" aria-hidden="true" href="#分层命名规则">#</a></h2>
<p>为了可以控制哪些信息需要输出，哪些信息不需要输出，logback 中引进了一个概念：分层。每个 logger 都有一个 name，这个 name 的格式与 Java 语言中的包名格式相同。这也是前面的例子中直接把一个 class 对象传进<code>LoggerFactory.getLogger()</code>方法作为参数的原因。</p>
<p>logger 的 name 格式决定了多个 logger 能够组成一个树状的结构，为了维护这个分层的树状结构，每个 logger 都被绑定到一个 logger 上下文中，这个上下文负责理清各个 logger 之间的关系。</p>
<p>例如， 命名为 <code>io.beansoft</code> 的 logger，是命名为 <code>io.beansoft.logback</code> 的 logger 的父亲，是命名为 <code>io.beansoft.logback.demo</code> 的 logger 的祖先。</p>
<p>在 logger 上下文中，有一个 root logger，作为所有 logger 的祖先，这是 logback 内部维护的一个 logger，并非开发者自定义的 logger。</p>
<p>可通过以下方式获得这个 logger：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Logger rootLogger = LoggerFactory.getLogger(org.slf4j.Logger.ROOT_LOGGER_NAME);
</span></span></code></pre></td></tr></table>
</div>
</div><p>同样，通过 logger 的 name，就能获得对应的其它 logger 实例。</p>
<p><code>Logger</code> 这个接口主要定义的方法有：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> org.slf4j; 
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">interface</span> Logger {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#007f7f">// Printing methods: 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> trace(String message);
</span></span><span style="display:flex;"><span>  <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> debug(String message);
</span></span><span style="display:flex;"><span>  <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> info(String message); 
</span></span><span style="display:flex;"><span>  <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> warn(String message); 
</span></span><span style="display:flex;"><span>  <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> error(String message); 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="日志打印级别">日志打印级别<a hidden class="anchor" aria-hidden="true" href="#日志打印级别">#</a></h2>
<p>logger 有日志打印级别，如果不为一个 logger 指定打印级别，那么它将继承离他最近的一个有指定打印级别的祖先的打印级别。这里有一个容易混淆想不清楚的地方，如果 logger 先找它的父亲，而它的父亲没有指定打印级别，那么它会立即忽略它的父亲，往上继续寻找它爷爷，直到它找到 root logger。因此，也能看出来，要使用 logback， 必须为 root logger 指定日志打印级别。</p>
<p>日志打印级别从低级到高级排序的顺序是：
<code>TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR</code></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.Logger;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.LoggerFactory;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.classic.Level;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> LogLevelDemo {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//这里强制类型转换时为了能设置 logger 的 Level
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        ch.<span style="color:#007f7f">qos</span>.<span style="color:#007f7f">logback</span>.<span style="color:#007f7f">classic</span>.<span style="color:#007f7f">Logger</span> logger = 
</span></span><span style="display:flex;"><span>                (ch.<span style="color:#007f7f">qos</span>.<span style="color:#007f7f">logback</span>.<span style="color:#007f7f">classic</span>.<span style="color:#007f7f">Logger</span>) LoggerFactory.<span style="color:#007f7f">getLogger</span>(<span style="color:#0ff;font-weight:bold">&#34;com.foo&#34;</span>);
</span></span><span style="display:flex;"><span>        logger.<span style="color:#007f7f">setLevel</span>(Level.<span style="color:#007f7f">INFO</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        Logger barlogger = LoggerFactory.<span style="color:#007f7f">getLogger</span>(<span style="color:#0ff;font-weight:bold">&#34;com.foo.Bar&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 这个语句能打印，因为 WARN &gt; INFO
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        logger.<span style="color:#007f7f">warn</span>(<span style="color:#0ff;font-weight:bold">&#34;can be printed because WARN &gt; INFO&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 这个语句不能打印，因为 DEBUG &lt; INFO.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;can not be printed because DEBUG &lt; INFO&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// barlogger 是 logger 的一个子 logger
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">// 它继承了 logger 的级别 INFO
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">// 以下语句能打印，因为 INFO &gt;= INFO
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        barlogger.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;can be printed because INFO &gt;= INFO&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 以下语句不能打印，因为 DEBUG &lt; INFO
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        barlogger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;can not be printed because DEBUG &lt; INFO&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>打印结果是：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>00:27:19.251 [main] WARN  com.foo - can be printed because WARN &gt; INFO
</span></span><span style="display:flex;"><span>00:27:19.255 [main] INFO  com.foo.Bar - can be printed because INFO &gt;= INFO
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取-logger">获取 logger<a hidden class="anchor" aria-hidden="true" href="#获取-logger">#</a></h2>
<p>在 logback 中，每个 logger 都是一个单例，调用 <code>LoggerFactory.getLogger</code> 方法时，如果传入的 logger name 相同，获取到的 logger 都是同一个实例。</p>
<p>在为 logger 命名时，用类的全限定类名作为 logger name 是最好的策略，这样能够追踪到每一条日志消息的来源。</p>
<h2 id="appender-和-layout">Appender 和 Layout<a hidden class="anchor" aria-hidden="true" href="#appender-和-layout">#</a></h2>
<p>在 logback 的世界中，日志信息不仅仅可以打印至 console，也可以打印至文件，甚至输出到网络流中，日志打印的目的地由 Appender 来决定，不同的 Appender 能将日志信息打印到不同的目的地去。</p>
<p>Appender 是绑定在 logger 上的，同时，一个 logger 可以绑定多个 Appender，意味着一条信息可以同时打印到不同的目的地去。例如，常见的做法是，日志信息既输出到控制台，同时也记录到日志文件中，这就需要为 logger 绑定两个不同的 logger。</p>
<p>Appender 是绑定在 logger 上的，而 logger 又有继承关系，因此一个 logger 打印信息时的目的地 Appender 需要参考它的父亲和祖先。在 logback 中，默认情况下，如果一个 logger 打印一条信息，那么这条信息首先会打印至它自己的 Appender，然后打印至它的父亲和父亲以上的祖先的 Appender，但如果它的父亲设置了 <code>additivity = false</code>，那么这个 logger 除了打印至它自己的 Appender 外，只会打印至其父亲的 Appender，因为它的父亲的 <code>additivity</code> 属性置为了 false，开始变得忘祖忘宗了，所以这个 logger 只认它父亲的 Appender；此外，对于这个 logger 的父亲来说，如果父亲的 logger 打印一条信息，那么它只会打印至自己的 Appender中（如果有的话），因为父亲已经忘记了爷爷及爷爷以上的那些父辈了。</p>
<p>打印的日志除了有打印的目的地外，还有日志信息的展示格式。在 logback 中，用 Layout 来代表日志打印格式。比如说，PatternLayout 能够识别以下这条格式：
<code>%-4relative [%thread] %-5level %logger{32} - %msg%n</code>
然后打印出来的格式效果是：
<code>176 [main] DEBUG manual.architecture.HelloWorld2 - Hello world.</code></p>
<p>上面这个格式的第一个字段代表从程序启动开始后经过的毫秒数，第二个字段代表打印出这条日志的线程名字，第三个字段代表日志信息的日志打印级别，第四个字段代表 logger name，第五个字段是日志信息，第六个字段仅仅是代表一个换行符。</p>
<h2 id="参数化打印日志">参数化打印日志<a hidden class="anchor" aria-hidden="true" href="#参数化打印日志">#</a></h2>
<p>经常能看到打印日志的时候，使用以下这种方式打印日志：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;the message is &#34;</span> + msg + <span style="color:#0ff;font-weight:bold">&#34; from &#34;</span> + somebody);
</span></span></code></pre></td></tr></table>
</div>
</div><p>这种打印日志的方式有个缺点，就是无论日志级别是什么，程序总要先执行 <code>&quot;the message is &quot; + msg + &quot; from &quot; + somebody</code> 这段字符串的拼接操作。当 logger 设置的日志级别为比 DEBUG 级别更高级别时，DEBUG 级别的信息不回被打印出来的，显然，字符串拼接的操作是不必要的，当要拼接的字符串很大时，这无疑会带来很大的性能白白损耗。</p>
<p>于是，一种改进的打印日志方式被人们发现了：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">if</span>(logger.<span style="color:#007f7f">isDebugEnabled</span>()) { 
</span></span><span style="display:flex;"><span>    logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;the message is &#34;</span> + msg + <span style="color:#0ff;font-weight:bold">&#34; from &#34;</span> + somebody);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>这样的方式确实能避免字符串拼接的不必要损耗，但这也不是最好的方法，当日志级别为 DEBUG 时，那么打印这行消息，需要判断两次日志级别。一次是<code>logger.isDebugEnabled()</code>，另一次是 <code>logger.debug()</code> 方法内部也会做的判断。这样也会带来一点点效率问题，如果能找到更好的方法，谁愿意无视白白消耗的效率。</p>
<p>有一种更好的方法，那就是提供占位符的方式，以参数化的方式打印日志，例如上述的语句，可以是这样的写法：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;the message {} is from {}&#34;</span>, msg, somebody);
</span></span></code></pre></td></tr></table>
</div>
</div><p>这样的方式，避免了字符串拼接，也避免了多一次日志级别的判断。</p>
<h2 id="logback-内部运行流程">logback 内部运行流程<a hidden class="anchor" aria-hidden="true" href="#logback-内部运行流程">#</a></h2>
<p>当应用程序发起一个记录日志的请求，例如 info() 时，logback 的内部运行流程如下所示</p>
<ol>
<li>获得过滤器链条</li>
<li>检查日志级别以决定是否继续打印</li>
<li>创建一个 <code>LoggingEvent</code> 对象</li>
<li>调用 Appenders</li>
<li>进行日志信息格式化</li>
<li>发送 <code>LoggingEvent</code> 到对应的目的地</li>
</ol>
<h2 id="有关性能问题">有关性能问题<a hidden class="anchor" aria-hidden="true" href="#有关性能问题">#</a></h2>
<p>关于日志系统，人们讨论得最多的是性能问题，即使是小型的应用程序，也有可能输出大量的日志。打印日志中的不当处理，会引发各种性能问题，例如太多的日志记录请求可能使磁盘 IO 成为性能瓶颈，从而影响到应用程序的正常运行。在合适的时候记录日志、以更好的方式发起日志请求、以及合理设置日志级别方面，都有可能造成性能问题。
关于性能问题，以下几个方面需要了解</p>
<ul>
<li>建议使用占位符的方式参数化记录日志</li>
<li>logback 内部机制保证 logger 在记录日志时，不必每一次都去遍历它的父辈以获得关于日志级别、Appender 的信息</li>
<li>在 logback 中，将日志信息格式化，以及输出到目的地，是最损耗性能的操作</li>
</ul>
<h1 id="logback-配置须知">logback 配置须知<a hidden class="anchor" aria-hidden="true" href="#logback-配置须知">#</a></h1>
<h2 id="配置方式">配置方式<a hidden class="anchor" aria-hidden="true" href="#配置方式">#</a></h2>
<p>logback 提供的配置方式有以下几种：</p>
<ul>
<li>编程式配置</li>
<li>xml 格式</li>
<li>groovy 格式</li>
</ul>
<p>logback 在启动时，根据以下步骤寻找配置文件：</p>
<ol>
<li>在 classpath 中寻找 logback-test.xml文件</li>
<li>如果找不到 logback-test.xml，则在 classpath 中寻找 logback.groovy 文件</li>
<li>如果找不到 logback.groovy，则在 classpath 中寻找 logback.xml文件</li>
<li>如果上述的文件都找不到，则 logback 会使用 JDK 的 SPI 机制查找 META-INF/services/ch.qos.logback.classic.spi.Configurator 中的 logback 配置实现类，这个实现类必须实现 <code>Configuration</code> 接口，使用它的实现来进行配置</li>
<li>如果上述操作都不成功，logback 就会使用它自带的 <code>BasicConfigurator</code> 来配置，并将日志输出到 console</li>
</ol>
<p>logback-test.xml 一般用来在测试代码中打日志，如果是 maven 项目，一般把 logback-test.xml 放在 src/test/resources 目录下。maven 打包的时候也不会把这个文件打进 jar 包里。
logback 启动的时候解析配置文件大概需要 100 毫秒的时间，如果希望更快启动，可以采用 SPI 的方式。</p>
<h2 id="默认的配置">默认的配置<a hidden class="anchor" aria-hidden="true" href="#默认的配置">#</a></h2>
<p>前面有提到默认的配置，由 <code>BasicConfiguator</code> 类配置而成，这个类的配置可以用如下的配置文件来表示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- encoders are assigned the type
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="启动时打印状态信息">启动时打印状态信息<a hidden class="anchor" aria-hidden="true" href="#启动时打印状态信息">#</a></h2>
<p>如果 logback 在启动时，解析配置文件时，出现了需要警告的信息或者错误信息，那 logback 会自动先打印出自身的状态信息。</p>
<p>如果希望正常情况下也打印出状态信息，则可以使用之前提到的方式，在代码里显式地调用使其输出：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// assume SLF4J is bound to logback in the current environment
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    LoggerContext lc = (LoggerContext) LoggerFactory.<span style="color:#007f7f">getILoggerFactory</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// print logback&#39;s internal status
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    StatusPrinter.<span style="color:#007f7f">print</span>(lc);
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>也可以在配置文件中，指定 configuration 的 debug 属性为 true</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- encoders are assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">   by default --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>还可以指定一个 Listener：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;statusListener</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.status.OnConsoleStatusListener&#34;</span> <span style="font-weight:bold">/&gt;</span>  
</span></span><span style="display:flex;"><span>  ... the rest of the configuration file
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="重置默认的配置文件位置">重置默认的配置文件位置<a hidden class="anchor" aria-hidden="true" href="#重置默认的配置文件位置">#</a></h2>
<p>设置 <strong>logback.configurationFile</strong> 系统变量，可以通过 -D 参数设置，所指定的文件名必须以 .xml 或者 .groovy 作为文件后缀，否则 logback 会忽略这些文件。</p>
<h2 id="配置文件自动热加载">配置文件自动热加载<a hidden class="anchor" aria-hidden="true" href="#配置文件自动热加载">#</a></h2>
<p>要使配置文件自动重载，需要把 scan 属性设置为 true，默认情况下每分钟才会扫描一次，可以指定扫描间隔：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">scan=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span> <span style="color:#007f7f">scanPeriod=</span><span style="color:#0ff;font-weight:bold">&#34;30 seconds&#34;</span> <span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意扫描间隔要加上单位，可用的单位是 milliseconds，seconds，minutes 和 hours。如果只指定了数字，但没有指定单位，这默认单位为 milliseconds。</p>
<p>在 logback 内部，当设置 scan 属性为 true 后，一个叫做 <code>ReconfigureOnChangeFilter</code> 的过滤器就会被牵扯进来，它负责判断是否到了该扫描的时候，以及是否该重新加载配置。Logger 的任何一个打印日志的方法被调用时，都会触发这个过滤器，所以关于这个过滤器的自身的性能问题，变得十分重要。logback 目前采用这样一种机制，当 logger 的调用次数到达一定次数后，才真正让过滤器去做它要做的事情，这个次数默认是 16，而 logback 会在运行时根据调用的频繁度来动态调整这个数目。</p>
<h2 id="输出异常栈时也打印出-jar-包的信息">输出异常栈时也打印出 jar 包的信息<a hidden class="anchor" aria-hidden="true" href="#输出异常栈时也打印出-jar-包的信息">#</a></h2>
<p>这个属性默认是关闭，可通过以下方式开启：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">packagingData=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>也可以通过 LoggerContext 的 setPackagingDataEnabled(boolean) 方法来开启</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>LoggerContext lc = (LoggerContext) LoggerFactory.<span style="color:#007f7f">getILoggerFactory</span>();
</span></span><span style="display:flex;"><span>lc.<span style="color:#007f7f">setPackagingDataEnabled</span>(<span style="color:#fff;font-weight:bold">true</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="直接调用-joranconfigurator">直接调用 JoranConfigurator<a hidden class="anchor" aria-hidden="true" href="#直接调用-joranconfigurator">#</a></h2>
<p><strong>Joran</strong> 是 logback 使用的一个配置加载库，如果想要重新实现 logback 的配置机制，可以直接调用这个类 <code>JoranConfigurator</code> 来实现：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> chapters.configuration;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.Logger;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.LoggerFactory;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.classic.LoggerContext;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.classic.joran.JoranConfigurator;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.joran.spi.JoranException;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.util.StatusPrinter;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MyApp3 {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">static</span> Logger logger = LoggerFactory.<span style="color:#007f7f">getLogger</span>(MyApp3.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// assume SLF4J is bound to logback in the current environment
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        LoggerContext context = (LoggerContext) LoggerFactory.<span style="color:#007f7f">getILoggerFactory</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            JoranConfigurator configurator = <span style="color:#fff;font-weight:bold">new</span> JoranConfigurator();
</span></span><span style="display:flex;"><span>            configurator.<span style="color:#007f7f">setContext</span>(context);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// Call context.reset() to clear any previous configuration, e.g. default 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// configuration. For multi-step configuration, omit calling context.reset().
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            context.<span style="color:#007f7f">reset</span>(); 
</span></span><span style="display:flex;"><span>            configurator.<span style="color:#007f7f">doConfigure</span>(args[<span style="color:#ff0;font-weight:bold">0</span>]);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (JoranException je) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// StatusPrinter will handle this
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        }
</span></span><span style="display:flex;"><span>        StatusPrinter.<span style="color:#007f7f">printInCaseOfErrorsOrWarnings</span>(context);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        logger.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;Entering application.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Foo foo = <span style="color:#fff;font-weight:bold">new</span> Foo();
</span></span><span style="display:flex;"><span>        foo.<span style="color:#007f7f">doIt</span>();
</span></span><span style="display:flex;"><span>        logger.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;Exiting application.&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="配置文件">配置文件<a hidden class="anchor" aria-hidden="true" href="#配置文件">#</a></h1>
<p>根节点是 configuration</p>
<ul>
<li><code>&lt;appender&gt;</code> 可包含多个</li>
<li><code>&lt;logger&gt;</code>可包含多个</li>
<li><code>&lt;root&gt;</code>可包含一个</li>
</ul>
<h2 id="根节点configuration">根节点<code>&lt;configuration&gt;</code><a hidden class="anchor" aria-hidden="true" href="#根节点configuration">#</a></h2>
<p>scan：当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。
scanPeriod：设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。
debug：当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。</p>
<p>示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">scan=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span> <span style="color:#007f7f">scanPeriod=</span><span style="color:#0ff;font-weight:bold">&#34;60 seconds&#34;</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--其他配置省略--&gt;</span> 
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="logger-节点">logger 节点<a hidden class="anchor" aria-hidden="true" href="#logger-节点">#</a></h2>
<p>用来设置某一个包或具体的某一个类的日志打印级别，以及指定<code>&lt;appender&gt;</code>。
<code>&lt;logger&gt;</code>仅有一个name属性，一个可选的level和一个可选的addtivity属性。
可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素，标识这个appender将会添加到这个logger。</p>
<p>name：用来指定受此logger约束的某一个包或者具体的某一个类。
level：用来设置打印级别：TRACE、DEBUG、INFO、WARN、ERROR、ALL和OFF，还有一个特殊值INHERITED或者同义词NULL，代表强制执行上级的级别。 如果未设置此属性，那么当前logger将会继承上级的级别。
addtivity：是否向上级logger传递打印信息。默认是true。可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素，标识这个appender将会添加到这个logger。</p>
<p>示例：myibatis 日志配置</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.apache.ibatis&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;TRACE&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;java.sql.Connection&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;java.sql.Statement&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;java.sql.PreparedStatement&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="root-节点">root 节点<a hidden class="anchor" aria-hidden="true" href="#root-节点">#</a></h2>
<p>是所有<code>&lt;logger&gt;</code>的上级。只有一个level属性，因为name已经被命名为 root，且已经是最上级了。同<code>&lt;logger&gt;</code>一样，可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素，标识这个appender将会添加到这个logger。</p>
<p>示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#007f7f">&lt;!-- 日志输出级别 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/root&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="appender-节点">appender 节点<a hidden class="anchor" aria-hidden="true" href="#appender-节点">#</a></h2>
<p><code>&lt;appender&gt;</code>负责写日志的组件，它有两个必要属性name和class。name指定appender名称，class指定appender的全限定名，即具体的实现类。
如果想要往一个 logger 上绑定 appender，则使用以下方式：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;HELLO&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/logger&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="consoleappender">ConsoleAppender<a hidden class="anchor" aria-hidden="true" href="#consoleappender">#</a></h3>
<p>把日志输出到控制台，有以下子节点：
<code>&lt;encoder&gt;</code>：对日志进行格式化。
<code>&lt;target&gt;</code>：字符串System.out(默认)或者System.err
示例：把&gt;=DEBUG级别的日志都输出到控制台</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span> 
</span></span><span style="display:flex;"><span>　　　<span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>　　　　　 <span style="font-weight:bold">&lt;encoder&gt;</span> 
</span></span><span style="display:flex;"><span>　　　　　　　　　<span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg %n<span style="font-weight:bold">&lt;/pattern&gt;</span> 
</span></span><span style="display:flex;"><span>　　　　　 <span style="font-weight:bold">&lt;/encoder&gt;</span> 
</span></span><span style="display:flex;"><span>　　　<span style="font-weight:bold">&lt;/appender&gt;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>　　　<span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>　　　　　　<span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span> 
</span></span><span style="display:flex;"><span>　　　<span style="font-weight:bold">&lt;/root&gt;</span> 
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fileappender">FileAppender<a hidden class="anchor" aria-hidden="true" href="#fileappender">#</a></h3>
<p>把日志添加到文件，有以下子节点
<code>&lt;file&gt;</code>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。
<code>&lt;append&gt;</code>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。
<code>&lt;encoder&gt;</code>：对记录事件进行格式化。（具体参数稍后讲解 ）
<code>&lt;prudent&gt;</code>：如果是 true，日志会被安全的写入文件，即使其他的FileAppender也在向此文件做写入操作，效率低，默认是 false。
示例：把&gt;=DEBUG级别的日志都输出到testFile.log</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>testFile.log<span style="font-weight:bold">&lt;/file&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;append&gt;</span>true<span style="font-weight:bold">&lt;/append&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span> 
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span> 
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="rollingfileappender">RollingFileAppender<a hidden class="anchor" aria-hidden="true" href="#rollingfileappender">#</a></h3>
<p>滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。有以下子节点：
<code>&lt;file&gt;</code>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。
<code>&lt;append&gt;</code>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。
<code>&lt;rollingPolicy&gt;</code>：当发生滚动时，决定RollingFileAppender的行为，涉及文件移动和重命名。属性class定义具体的滚动策略类。</p>
<p>示例：每天生成一个日志文件，保存30天的日志文件。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>logFile.%d{yyyy-MM-dd}.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span> 
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>30<span style="font-weight:bold">&lt;/maxHistory&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span> 
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span> 
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span> 
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="timebasedrollingpolicy">TimeBasedRollingPolicy<a hidden class="anchor" aria-hidden="true" href="#timebasedrollingpolicy">#</a></h4>
<p><code>class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</code>
最常用的滚动策略，它根据时间来制定滚动策略，既负责滚动也负责出发滚动。有以下子节点：</p>
<p><code>&lt;fileNamePattern&gt;</code>：必要节点，包含文件名及“%d”转换符，“%d”可以包含一个java.text.SimpleDateFormat指定的时间格式，如：%d{yyyy-MM}。
如果直接使用 %d，默认格式是 yyyy-MM-dd。RollingFileAppender的file字节点可有可无，通过设置file，可以为活动文件和归档文件指定不同位置，当前日志总是记录到file指定的文件（活动文件），活动文件的名字不会改变；
如果没设置file，活动文件的名字会根据fileNamePattern 的值，每隔一段时间改变一次。“/”或者“\”会被当做目录分隔符。</p>
<p><code>&lt;maxHistory&gt;</code>：可选节点，控制保留的归档文件的最大数量，超出数量就删除旧文件。假设设置每个月滚动，且<code>&lt;maxHistory&gt;</code>是6，则只保存最近6个月的文件，删除之前的旧文件。注意，删除旧文件是，那些为了归档而创建的目录也会被删除。</p>
<h4 id="sizebasedtriggeringpolicy">SizeBasedTriggeringPolicy<a hidden class="anchor" aria-hidden="true" href="#sizebasedtriggeringpolicy">#</a></h4>
<p><code>class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;</code>
查看当前活动文件的大小，如果超过指定大小会告知RollingFileAppender 触发当前活动文件滚动。只有一个节点：</p>
<p><code>&lt;maxFileSize&gt;</code>：这是活动文件的大小，默认值是10MB。
<code>&lt;prudent&gt;</code>：当为true时，不支持FixedWindowRollingPolicy。支持TimeBasedRollingPolicy，但是有两个限制，1不支持也不允许文件压缩，2不能设置file属性，必须留空。
<code>&lt;triggeringPolicy &gt;</code>：告知 RollingFileAppender 合适激活滚动。</p>
<h4 id="fixedwindowrollingpolicy">FixedWindowRollingPolicy<a hidden class="anchor" aria-hidden="true" href="#fixedwindowrollingpolicy">#</a></h4>
<p><code>class=&quot;ch.qos.logback.core.rolling.FixedWindowRollingPolicy&quot;</code>
根据固定窗口算法重命名文件的滚动策略。有以下子节点：
<code>&lt;minIndex&gt;</code>：窗口索引最小值
<code>&lt;maxIndex&gt;</code>：窗口索引最大值，当用户指定的窗口过大时，会自动将窗口设置为12。
<code>&lt;fileNamePattern&gt;</code>：必须包含“%i”例如，假设最小值和最大值分别为1和2，命名模式为 mylog%i.log,会产生归档文件mylog1.log和mylog2.log。还可以指定文件压缩选项，例如，mylog%i.log.gz 或者 没有log%i.log.zip</p>
<h2 id="context-name-节点">Context Name 节点<a hidden class="anchor" aria-hidden="true" href="#context-name-节点">#</a></h2>
<p>用来设置上下文名称，每个logger都关联到logger上下文，默认上下文名称为default。但可以使用<code>&lt;contextName&gt;</code>设置成其他名字，用于区分不同应用程序的记录。</p>
<p>示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;contextName&gt;</span>myAppName<span style="font-weight:bold">&lt;/contextName&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;pattern&gt;</span>%d %contextName [%t] %level %logger{36} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="property使用变量"><code>&lt;property&gt;</code>使用变量<a hidden class="anchor" aria-hidden="true" href="#property使用变量">#</a></h2>
<p>用来定义变量值，它有两个属性name和value，通过<code>&lt;property&gt;</code>定义的值会被插入到logger上下文中，可以使<code>${}</code>来使用变量。</p>
<h3 id="定义变量">定义变量<a hidden class="anchor" aria-hidden="true" href="#定义变量">#</a></h3>
<p>可以直接在 logback.xml 中定义变量</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;USER_HOME&#34;</span> <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;/home/sebastien&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${USER_HOME}/myApp.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>也可以通过大D参数来定义</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>java -DUSER_HOME=&#34;/home/sebastien&#34; MyApp2
</span></span></code></pre></td></tr></table>
</div>
</div><p>也可以通过外部文件来定义</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">file=</span><span style="color:#0ff;font-weight:bold">&#34;src/main/java/chapters/configuration/variables1.properties&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${USER_HOME}/myApp.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>外部文件也支持 classpath 中的文件</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">resource=</span><span style="color:#0ff;font-weight:bold">&#34;resource1.properties&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${USER_HOME}/myApp.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>外部文件的格式是 key-value 型。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>USER_HOME=/home/sebastien
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="变量的作用域">变量的作用域<a hidden class="anchor" aria-hidden="true" href="#变量的作用域">#</a></h3>
<p>变量有三个作用域</p>
<ul>
<li>local</li>
<li>context</li>
<li>system</li>
</ul>
<p>local 作用域在配置文件内有效，context 作用域的有效范围延伸至 logger context，system 作用域的范围最广，整个 JVM 内都有效。</p>
<p>logback 在替换变量时，首先搜索 local 变量，然后搜索 context，然后搜索 system。</p>
<p>通过 scope 属性来指定作用域。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">scope=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;nodeId&#34;</span> <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;firstNode&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>/opt/${nodeId}/myApp.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="变量的默认值">变量的默认值<a hidden class="anchor" aria-hidden="true" href="#变量的默认值">#</a></h3>
<p>在引用一个变量时，如果该变量未定义，那么可以为其指定默认值，做法是：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>${aName:-golden}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="运行时定义变量">运行时定义变量<a hidden class="anchor" aria-hidden="true" href="#运行时定义变量">#</a></h3>
<p>需要使用<code>&lt;define&gt;</code>标签，指定接口 <code>PropertyDfiner</code> 为对应的实现类。如下所示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;define</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;rootLevel&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;a.class.implementing.PropertyDefiner&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;shape&gt;</span>round<span style="font-weight:bold">&lt;/shape&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;color&gt;</span>brown<span style="font-weight:bold">&lt;/color&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;size&gt;</span>24<span style="font-weight:bold">&lt;/size&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/define&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;${rootLevel}&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="条件化处理配置文件">条件化处理配置文件<a hidden class="anchor" aria-hidden="true" href="#条件化处理配置文件">#</a></h3>
<p>logback 允许在配置文件中定义条件语句，以决定配置的不同行为，具体语法格式如下：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#007f7f">&lt;!-- if-then form --&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;if</span> <span style="color:#007f7f">condition=</span><span style="color:#0ff;font-weight:bold">&#34;some conditional expression&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;then&gt;</span>
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/then&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!-- if-then-else form --&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;if</span> <span style="color:#007f7f">condition=</span><span style="color:#0ff;font-weight:bold">&#34;some conditional expression&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;then&gt;</span>
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/then&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;else&gt;</span>
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/else&gt;</span>    
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/if&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;if</span> <span style="color:#007f7f">condition=</span><span style="color:#0ff;font-weight:bold">&#39;property(&#34;HOSTNAME&#34;).contains(&#34;torino&#34;)&#39;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;then&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;CON&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;pattern&gt;</span>%d %-5level %logger{35} - %msg %n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;root&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;CON&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/then&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${randomOutputDir}/conditional.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d %-5level %logger{35} - %msg %n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;ERROR&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="从jndi-获取变量">从JNDI 获取变量<a hidden class="anchor" aria-hidden="true" href="#从jndi-获取变量">#</a></h3>
<p>使用<code>&lt;insertFromJNDI&gt;</code>可以从 JNDI 加载变量，如下所示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;insertFromJNDI</span> <span style="color:#007f7f">env-entry-name=</span><span style="color:#0ff;font-weight:bold">&#34;java:comp/env/appName&#34;</span> <span style="color:#007f7f">as=</span><span style="color:#0ff;font-weight:bold">&#34;appName&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;contextName&gt;</span>${appName}<span style="font-weight:bold">&lt;/contextName&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d ${CONTEXT_NAME} %level %msg %logger{50}%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="文件包含">文件包含<a hidden class="anchor" aria-hidden="true" href="#文件包含">#</a></h3>
<p>可以使用<code>&lt;include&gt;</code>标签在一个配置文件中包含另外一个配置文件，如下图所示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">file=</span><span style="color:#0ff;font-weight:bold">&#34;src/main/java/chapters/configuration/includedConfig.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;includedConsole&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>被包含的文件必须有以下格式：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;included&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;includedConsole&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>&#34;%d - %m%n&#34;<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/included&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>支持从多种源头包含，从文件中包含</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">file=</span><span style="color:#0ff;font-weight:bold">&#34;src/main/java/chapters/configuration/includedConfig.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>从 classpath 中包含</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">resource=</span><span style="color:#0ff;font-weight:bold">&#34;includedConfig.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>从 URL 中包含</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">url=</span><span style="color:#0ff;font-weight:bold">&#34;http://some.host.com/includedConfig.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果包含不成功，那么 logback 会打印出一条警告信息，如果不希望 logback 警告，只需这样做：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">optional=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span> <span style="color:#f00">....</span><span style="font-weight:bold">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="context-listener">Context Listener<a hidden class="anchor" aria-hidden="true" href="#context-listener">#</a></h2>
<p><code>LoggerContextListener</code> 接口的实例能监听 logger context 上发生的事件，比如说日志级别的变化，添加的方式如下所示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;contextListener</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.jul.LevelChangePropagator&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  .... 
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="appender">Appender<a hidden class="anchor" aria-hidden="true" href="#appender">#</a></h1>
<h2 id="appender-概念">Appender 概念<a hidden class="anchor" aria-hidden="true" href="#appender-概念">#</a></h2>
<p>当一个记录日志的事件被发起时，logback 会将这个事件发送给 appender。appender 必须实现 <code>ch.qos.logback.core.Appender</code> 接口。这个接口的最重要的方法如下所示：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> ch.qos.logback.core;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.spi.ContextAware;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.spi.FilterAttachable;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.spi.LifeCycle;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">interface</span> Appender&lt;E&gt; <span style="color:#fff;font-weight:bold">extends</span> LifeCycle, ContextAware, FilterAttachable {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getName();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setName(String name);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">void</span> doAppend(E event);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个接口的大多数方法都是 setter 和 getter，doAppend 方式是最重要的一个。这个类接收了一个泛型类型 E，在 logback-classic 模块里， E 的类型是 ILoggingEvent，在 logback-access 模块里，E 的类型是 AccessEvent。这个接口也继承了 FilterAttachable 接口，意味着可以为这个 appender 关联一个或者多个过滤器。appender 最终会根据 layout 或者 encoder 将日志信息格式化，并且只能关联一个 layout 或者 encoder，不过有一些 appender 已经有了内嵌的 layout 或者 encoder，比如说 SocketAppender。</p>
<h2 id="appenderbase-源码分析">AppenderBase 源码分析<a hidden class="anchor" aria-hidden="true" href="#appenderbase-源码分析">#</a></h2>
<p><code>ch.qos.logback.core.AppenderBase</code> 这个类是一个抽象类，是其它具体 appender 的父类。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">synchronized</span> <span style="color:#fff;font-weight:bold">void</span> doAppend(E eventObject) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// prevent re-entry.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span> (guard) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        guard = <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (!<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">started</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (statusRepeatCount++ &lt; ALLOWED_REPEATS) {
</span></span><span style="display:flex;"><span>                addStatus(<span style="color:#fff;font-weight:bold">new</span> WarnStatus(
</span></span><span style="display:flex;"><span>                    <span style="color:#0ff;font-weight:bold">&#34;Attempted to append to non started appender [&#34;</span> + name + <span style="color:#0ff;font-weight:bold">&#34;].&#34;</span>,<span style="color:#fff;font-weight:bold">this</span>));
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (getFilterChainDecision(eventObject) == FilterReply.<span style="color:#007f7f">DENY</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ok, we now invoke the derived class&#39;s implementation of append
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">append</span>(eventObject);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        guard = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先 doAppend 方法是 synchronized，保证了多线程访问这个 appender 时能起到互斥的作用，logback 也有非互斥的实现，<code> ch.qos.logback.core.UnsynchronizedAppenderBase</code>。
guard 变量的作用是防止同一个线程内递归调用 doAppend 方法，造成死循环从而导致栈溢出。</p>
<h2 id="logback-core-模块">logback-core 模块<a hidden class="anchor" aria-hidden="true" href="#logback-core-模块">#</a></h2>
<p>logback-core 模块是其它模块的基础设施，以下将讨论几个 logback 自带的 appender。</p>
<h3 id="outputstreamappender">OutputStreamAppender<a hidden class="anchor" aria-hidden="true" href="#outputstreamappender">#</a></h3>
<p><code>OutputStreamAppender</code> 将日志记录到一个 <code>java.io.OutputStream</code> 里，这个 appender 是其它 appender 的基础，不能直接在 logback 配置文件里面把它进行配置然后拉出来用。但这并不意味着它没有可配置的属性。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>encoder</td>
<td>Encoder</td>
<td>日志格式</td>
</tr>
<tr>
<td>immediateFlush</td>
<td>boolean</td>
<td>默认值是 true，意味着日志信息直接刷到目的地，不会做缓存。如果该值设置为 false，并且没有关闭 appender，那么一部分日志信息将会丢失</td>
</tr>
</tbody>
</table>
<p><code>OutputStreamAppender</code> 的类继承体系如下图所示：</p>
<h3 id="consoleappender-1">ConsoleAppender<a hidden class="anchor" aria-hidden="true" href="#consoleappender-1">#</a></h3>
<p><code>ConsoleAppender</code> 将日志信息输出到控制台，既可以是 System.out，也可以是 System.err。默认是前者。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>encoder</td>
<td>Encoder</td>
<td>日志格式</td>
</tr>
<tr>
<td>target</td>
<td>String</td>
<td>要么填System.out，要么填System.err，默认是前者。</td>
</tr>
<tr>
<td>withJansi</td>
<td>boolean</td>
<td>默认值是 false，主要作用是为代码着色，如果是 windows 平台，设置为 true 的同时还要在 classpath 中加入 “org.fusesource.jansi:jansi:1.9”，Unix 类系统本身支持因此不用。如果想在 Eclipse 里面用，还要使用这个插件：ANSI in Eclipse Console</td>
</tr>
</tbody>
</table>
<p>配置示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- encoders are assigned the type
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg %n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;STDOUT&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="fileappender-1">FileAppender<a hidden class="anchor" aria-hidden="true" href="#fileappender-1">#</a></h3>
<p>把日志信息记录到文件里。</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>append</td>
<td>boolean</td>
<td>如果目标文件已存在，要么追加到文件尾部，要么直接清空文件，默认是 true</td>
</tr>
<tr>
<td>encoder</td>
<td>Encoder</td>
<td>日志格式</td>
</tr>
<tr>
<td>file</td>
<td>String</td>
<td>文件名，如果文件不存在，则重新创建，如果父目录不存在，也会重新创建，注意在 windows 下，这种写法 c:\temp\test.log 会有问题，因为 \t 会被转义，正确的写法是：c:/temp/test.log 或者 c:\temp\test.log</td>
</tr>
<tr>
<td>prudent</td>
<td>boolean</td>
<td>允许多个进程向同一个日志文件里写日志，但由于锁竞争，性能消耗大概是普通日志记录的三倍左右</td>
</tr>
</tbody>
</table>
<p>默认情况下，<strong>Immediate Flush</strong> 为true，为了不丢失日志。但是也可以将其设置为 false。
配置示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>testFile.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;append&gt;</span>true<span style="font-weight:bold">&lt;/append&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- set immediateFlush to false for much higher logging throughput --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;immediateFlush&gt;</span>true<span style="font-weight:bold">&lt;/immediateFlush&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- encoders are assigned the type
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果希望为日志加一个时间戳，则可以通过下面的方式来配置：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- Insert the current time formatted as &#34;yyyyMMdd&#39;T&#39;HHmmss&#34; under
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">       the key &#34;bySecond&#34; into the logger context. This value will be
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">       available to all subsequent configuration elements. --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;timestamp</span> <span style="color:#007f7f">key=</span><span style="color:#0ff;font-weight:bold">&#34;bySecond&#34;</span> <span style="color:#007f7f">datePattern=</span><span style="color:#0ff;font-weight:bold">&#34;yyyyMMdd&#39;T&#39;HHmmss&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.FileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- use the previously created timestamp to create a uniquely
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">         named log file --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>log-${bySecond}.txt<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>标签有两个必要的属性，分别是 name 和 datePattern，还有一个可选的属性 timeReference，name 所指定的可以用来作为变量使用，dataPattern 的格式与 SimpleDateFormat 的格式一样，而 timeReference 默认是配置文件被解析的时间，也可以显式指定为 contextBirth，这样时间就是上下文被创建的时间。
如下例子：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;timestamp</span> <span style="color:#007f7f">key=</span><span style="color:#0ff;font-weight:bold">&#34;bySecond&#34;</span> <span style="color:#007f7f">datePattern=</span><span style="color:#0ff;font-weight:bold">&#34;yyyyMMdd&#39;T&#39;HHmmss&#34;</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#007f7f">timeReference=</span><span style="color:#0ff;font-weight:bold">&#34;contextBirth&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="rollingfileappender-1">RollingFileAppender<a hidden class="anchor" aria-hidden="true" href="#rollingfileappender-1">#</a></h3>
<p><code>RollingFileAppender</code> 既可以记录日志到文件，也可以在某个条件到达后，转移到另外一个文件。有两个子组件，分别是 RollingPolicy 和 TriggeringPolicy，分别描述了如何滚动，以及何时滚动。
属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>String</td>
<td>见 FileAppender</td>
</tr>
<tr>
<td>append</td>
<td>boolean</td>
<td>见 FileAppender</td>
</tr>
<tr>
<td>encoder</td>
<td>Encoder</td>
<td>日志格式</td>
</tr>
<tr>
<td>rollingPolicy</td>
<td>RollingPolicy</td>
<td>如何滚动</td>
</tr>
<tr>
<td>triggeringPolicy</td>
<td>TriggeringPolicy</td>
<td>何时滚动</td>
</tr>
<tr>
<td>prudent</td>
<td>boolean</td>
<td>FixedWindowRollingPolicy 不支持 prudent 模式。TimeBasedRollingPolicy 支持 prudent 模式，不过有两个限制。在 prudent 模式下，无法进行文件压缩，file 属性必须留白，不能填写。</td>
</tr>
</tbody>
</table>
<h4 id="滚动策略">滚动策略<a hidden class="anchor" aria-hidden="true" href="#滚动策略">#</a></h4>
<p>RollingPolicy 主要负责文件的移动和重命名</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> ch.qos.logback.core.rolling;  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.FileAppender;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> ch.qos.logback.core.spi.LifeCycle;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">interface</span> RollingPolicy <span style="color:#fff;font-weight:bold">extends</span> LifeCycle {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> rollover() <span style="color:#fff;font-weight:bold">throws</span> RolloverFailure;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getActiveFileName();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> CompressionMode getCompressionMode();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setParent(FileAppender appender);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="timebasedrollingpolicy-1">TimeBasedRollingPolicy<a hidden class="anchor" aria-hidden="true" href="#timebasedrollingpolicy-1">#</a></h4>
<p>这个策略基于时间，比如说基于 day 或者 month 的滚动，<strong>同时实现了 RollingPolicy 接口和 TriggeringPolicy 接口</strong>，既定义了如何滚动，也定义了何时滚动。
<code>TimeBasedRollingPolicy</code> 只有一个必须的属性 fileNamePattern 和几个可选的属性。</p>
<p>fileNamePattern 包含实际的文件名，以及一个 %d 标识，这个标识的用法是 %d{}，其中大括号里面是遵循 <code>java.text.SimpleDataFormat</code> 格式的日期模式，logback 会根据这个日期模式的最小单位来推断出是根据天、月、年还是分钟、小时来进行滚动的。
RollingFileAppender 有一个 file 属性，在配合 TimeBasedRollingPolicy 使用的时候，这个 file 的属性是否被设置，有着不同的区别。如果 file 属性设置了，那么每次新记录的日志将会记录到这个文件，当滚动时需要重命名的时候，则将这个文件名以 fileNamePattern 指定的模式进行重命名和归档。如果 file 属性没有进行设置，那么每次新纪录的日志会记录到根据 fileNamePattern 指定的当前日志文件里。
如果有多个 %d 标识，那么必须有一个是 primary 的，其它的为 auxiliary 的。例如 <code>/var/log/%d{yyyy/MM, aux}/myapplication.%d{yyyy-MM-dd}.log</code> 。同时，fileNamePattern 支持填写 Time Zone，例如 <code>aFolder/test.%d{yyyy-MM-dd-HH, UTC}.log</code>。</p>
<p>maxHistory 属性指定要保留多长时间的日志，依据从 fileNamePattern 中推断出来的单位。
totalSizeGap 属性限制了日志文件的大小总共不能超过的大小。
cleanHistoryOnStart 指定了是否重启应用的时候删除之前的归档日志。</p>
<p>配置示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>logFile.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- daily rollover --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>logFile.%d{yyyy-MM-dd}.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- keep 30 days&#39; worth of history capped at 3GB total size --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>30<span style="font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;totalSizeCap&gt;</span>3GB<span style="font-weight:bold">&lt;/totalSizeCap&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="sizeandtimebasedrollingpolicy">SizeAndTimeBasedRollingPolicy<a hidden class="anchor" aria-hidden="true" href="#sizeandtimebasedrollingpolicy">#</a></h4>
<p>这个策略除了具有 TimeBasedRollingPolicy 的功能外，还能限制单个日志文件的大小，当单个日志到达指定的大小时，触发日志滚动。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;ROLLING&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>mylog.txt<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- rollover daily --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>mylog-%d{yyyy-MM-dd}.%i.txt<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- each file should be at most 100MB, keep 60 days worth of history, but at most 20GB --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>100MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>    
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>60<span style="font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;totalSizeCap&gt;</span>20GB<span style="font-weight:bold">&lt;/totalSizeCap&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;ROLLING&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过 maxFileSize 来设置单个日志文件的大小限制。注意到这里，有一个新的标识出现 %i，这是当发生滚动时，可以为同一天的日志加上不同的后缀 index。</p>
<h4 id="fixedwindowrollingpolicy-1">FixedWindowRollingPolicy<a hidden class="anchor" aria-hidden="true" href="#fixedwindowrollingpolicy-1">#</a></h4>
<p>配置示例：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;file&gt;</span>test.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.FixedWindowRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>foo%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;minIndex&gt;</span>1<span style="font-weight:bold">&lt;/minIndex&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;maxIndex&gt;</span>3<span style="font-weight:bold">&lt;/maxIndex&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;triggeringPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;maxFileSize&gt;</span>5MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/triggeringPolicy&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="sizebasedtriggeringpolicy-1">SizeBasedTriggeringPolicy<a hidden class="anchor" aria-hidden="true" href="#sizebasedtriggeringpolicy-1">#</a></h4>
<p>配置示例，一般配合 FixedWindowRollingPolicy：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>test.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.FixedWindowRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>test.%i.log.zip<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;minIndex&gt;</span>1<span style="font-weight:bold">&lt;/minIndex&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxIndex&gt;</span>3<span style="font-weight:bold">&lt;/maxIndex&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;triggeringPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>5MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/triggeringPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE&#34;</span> <span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="常用配置示例">常用配置示例<a hidden class="anchor" aria-hidden="true" href="#常用配置示例">#</a></h1>
<h2 id="配置一">配置一<a hidden class="anchor" aria-hidden="true" href="#配置一">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">83
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--debug:当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">scan=</span><span style="color:#0ff;font-weight:bold">&#34;true&#34;</span> <span style="color:#007f7f">scanPeriod=</span><span style="color:#0ff;font-weight:bold">&#34;60 seconds&#34;</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 全局变量 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--日志文件保存路径--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProperty</span> <span style="color:#007f7f">scope=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;logPath&#34;</span> <span style="color:#007f7f">source=</span><span style="color:#0ff;font-weight:bold">&#34;logging.file.path&#34;</span> <span style="color:#007f7f">defaultValue=</span><span style="color:#0ff;font-weight:bold">&#34;logs&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--应用名称--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProperty</span> <span style="color:#007f7f">scope=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;appName&#34;</span> <span style="color:#007f7f">source=</span><span style="color:#0ff;font-weight:bold">&#34;spring.application.name&#34;</span> <span style="color:#007f7f">defaultValue=</span><span style="color:#0ff;font-weight:bold">&#34;springBoot&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 通用日志文件输出appender --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;COMMON_FILE_LOG&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--日志名称，如果没有File 属性，那么只会使用FileNamePattern的文件路径规则
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">            如果同时有&lt;File&gt;和&lt;FileNamePattern&gt;，那么当天日志是&lt;File&gt;，明天会自动把今天
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">            的日志改名为今天的日期。即，&lt;File&gt; 的日志都是当天的。
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">        --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;File&gt;</span>${logPath}/${appName}.log<span style="font-weight:bold">&lt;/File&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--滚动策略，按照时间滚动 TimeBasedRollingPolicy--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--文件路径,定义了日志的切分方式——把每一天的日志归档到一个文件中,以防止日志填满整个磁盘空间--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;FileNamePattern&gt;</span>${logPath}/${appName}.%d{yyyy-MM-dd}.log<span style="font-weight:bold">&lt;/FileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--只保留最近30天的日志--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>30<span style="font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--用来指定日志文件的上限大小，那么到了这个值，就会删除旧的日志--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;totalSizeCap&gt;</span>1GB<span style="font-weight:bold">&lt;/totalSizeCap&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--日志输出编码格式化--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--&lt;pattern&gt;%d{HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d [%thread] %-5level %logger{36} %line - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 开发环境,多个使用逗号隔开,本地开发环境只输出控制台日志--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;dev&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- 本地开发控制栏彩色日志 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- 彩色日志依赖的渲染类 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;clr&#34;</span> <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.ColorConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;wex&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;wEx&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- 彩色日志格式 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE_LOG_PATTERN&#34;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- Console 输出设置 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;layout&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;pattern&gt;</span>${CONSOLE_LOG_PATTERN}<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/layout&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!-- 控制台不打印tomcat启动过程中的JAR包扫描警告 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;o.a.tomcat.util.scan.StandardJarScanner&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;ERROR&#34;</span> <span style="color:#007f7f">additivity=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/logger&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--指定最基础的日志输出级别--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 测试环境,多个使用逗号隔开,测试环境输出INFO级别日志,只以文件形式输出--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;test&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.xf&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span> <span style="color:#007f7f">additivity=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;COMMON_FILE_LOG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/logger&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;COMMON_FILE_LOG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 生产环境,多个使用逗号隔开,生产环境输出ERROR级别日志,只以文件形式输出--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;prod&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;ERROR&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;COMMON_FILE_LOG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="配置二">配置二<a hidden class="anchor" aria-hidden="true" href="#配置二">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--debug:当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">&lt;!--scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。--&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration</span> <span style="color:#007f7f">debug=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span> <span style="color:#007f7f">scan=</span><span style="color:#0ff;font-weight:bold">&#34;false&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProperty</span> <span style="color:#007f7f">scop=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;spring.application.name&#34;</span> <span style="color:#007f7f">source=</span><span style="color:#0ff;font-weight:bold">&#34;spring.application.name&#34;</span> <span style="color:#007f7f">defaultValue=</span><span style="color:#0ff;font-weight:bold">&#34;springboot&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_HOME&#34;</span> <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;logs/${spring.application.name}&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 日志格式和颜色渲染 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 彩色日志依赖的渲染类 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;clr&#34;</span> <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.ColorConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;wex&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;conversionRule</span> <span style="color:#007f7f">conversionWord=</span><span style="color:#0ff;font-weight:bold">&#34;wEx&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#007f7f">converterClass=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 彩色日志格式 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE_LOG_PATTERN&#34;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 把日志输出到控制台--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;console&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--此日志appender是为开发使用，只配置最底级别，控制台输出的日志级别是大于或等于此级别的日志信息--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>debug<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>${CONSOLE_LOG_PATTERN}<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--把debug日志输出--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${LOG_HOME}/debug.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>DEBUG<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件输出的文件名--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>${LOG_HOME}/debug-%d{yyyy-MM-dd}.%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- 日志文件最大尺寸 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>100MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件保留天数--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;MaxHistory&gt;</span>30<span style="font-weight:bold">&lt;/MaxHistory&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 记录错误日志到单独文件 error.log --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;error&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${LOG_HOME}/error.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>ERROR<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件输出的文件名--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>${LOG_HOME}/error-%d{yyyy-MM-dd}.%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- 日志文件最大尺寸 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>100MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件保留天数--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;MaxHistory&gt;</span>30<span style="font-weight:bold">&lt;/MaxHistory&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 记录错误日志到单独文件 info.log --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;info&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;file&gt;</span>${LOG_HOME}/info.log<span style="font-weight:bold">&lt;/file&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>INFO<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件输出的文件名--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>${LOG_HOME}/info-%d{yyyy-MM-dd}.%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!-- 日志文件最大尺寸 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>100MB<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件保留天数--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;MaxHistory&gt;</span>30<span style="font-weight:bold">&lt;/MaxHistory&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- 下面配置一些第三方包的日志过滤级别，用于避免刷屏 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework.web&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!-- Log日志级别从高到低排序
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">    ERROR：用户程序报错，必须解决的时候使用此级别打印日志
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">    WARN：警告，不会影响程序的运行，但是值得注意。
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">    INFO：一般处理业务逻辑的时候使用，就跟 system.err打印一样
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">    DEBUG：一般放于程序的某个关键点的地方，用于打印一个变量值或者一个方法返回的信息之类的信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">    TRACE：一般不会使用，在日志里边也不会打印出来，好像是很低的一个日志级别。
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--  定义本地环境日志级别  --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;local&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.xf&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span><span style="color:#007f7f">&lt;!-- 定义将com.xf包下的最低级别日志信息 --&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">&gt;</span><span style="color:#007f7f">&lt;!-- 系统全局日志输出最低级别，但不包括com.xf包 --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;console&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--  定义测试环境日志级别  --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;dev&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.xf&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;console&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;debug&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--  定义线上环境日志级别  --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProfile</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;online&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;root</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;error&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/springProfile&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="配置三">配置三<a hidden class="anchor" aria-hidden="true" href="#配置三">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">195
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">&lt;!DOCTYPE configuration&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--引用默认日志配置--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">resource=</span><span style="color:#0ff;font-weight:bold">&#34;org/springframework/boot/logging/logback/defaults.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--使用默认的控制台日志输出实现--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;include</span> <span style="color:#007f7f">resource=</span><span style="color:#0ff;font-weight:bold">&#34;org/springframework/boot/logging/logback/console-appender.xml&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--应用名称--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProperty</span> <span style="color:#007f7f">scope=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;APP_NAME&#34;</span> <span style="color:#007f7f">source=</span><span style="color:#0ff;font-weight:bold">&#34;spring.application.name&#34;</span> <span style="color:#007f7f">defaultValue=</span><span style="color:#0ff;font-weight:bold">&#34;springBoot&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--日志文件保存路径--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;property</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_FILE_PATH&#34;</span> <span style="color:#007f7f">value=</span><span style="color:#0ff;font-weight:bold">&#34;${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}/logs}&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--LogStash访问host--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;springProperty</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_HOST&#34;</span> <span style="color:#007f7f">scope=</span><span style="color:#0ff;font-weight:bold">&#34;context&#34;</span> <span style="color:#007f7f">source=</span><span style="color:#0ff;font-weight:bold">&#34;logstash.host&#34;</span> <span style="color:#007f7f">defaultValue=</span><span style="color:#0ff;font-weight:bold">&#34;localhost&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--DEBUG日志输出到文件--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE_DEBUG&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--输出DEBUG以上级别日志--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>DEBUG<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置为默认的文件日志格式--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>${FILE_LOG_PATTERN}<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置文件命名格式--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>${LOG_FILE_PATH}/debug/${APP_NAME}-%d{yyyy-MM-dd}-%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置日志文件大小，超过就重新生成文件，默认10M--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>${LOG_FILE_MAX_SIZE:-10MB}<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件保留天数，默认30天--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>${LOG_FILE_MAX_HISTORY:-30}<span style="font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--ERROR日志输出到文件--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;FILE_ERROR&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">&lt;!--只输出ERROR级别的日志--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.LevelFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>ERROR<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;onMatch&gt;</span>ACCEPT<span style="font-weight:bold">&lt;/onMatch&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;onMismatch&gt;</span>DENY<span style="font-weight:bold">&lt;/onMismatch&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置为默认的文件日志格式--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;pattern&gt;</span>${FILE_LOG_PATTERN}<span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;charset&gt;</span>UTF-8<span style="font-weight:bold">&lt;/charset&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;rollingPolicy</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置文件命名格式--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;fileNamePattern&gt;</span>${LOG_FILE_PATH}/error/${APP_NAME}-%d{yyyy-MM-dd}-%i.log<span style="font-weight:bold">&lt;/fileNamePattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--设置日志文件大小，超过就重新生成文件，默认10M--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxFileSize&gt;</span>${LOG_FILE_MAX_SIZE:-10MB}<span style="font-weight:bold">&lt;/maxFileSize&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">&lt;!--日志文件保留天数，默认30天--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;maxHistory&gt;</span>${LOG_FILE_MAX_HISTORY:-30}<span style="font-weight:bold">&lt;/maxHistory&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/rollingPolicy&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--DEBUG日志输出到LogStash--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_DEBUG&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.appender.LogstashTcpSocketAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>DEBUG<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;destination&gt;</span>${LOG_STASH_HOST}:4560<span style="font-weight:bold">&lt;/destination&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder</span> <span style="color:#007f7f">charset=</span><span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;providers&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;timeZone&gt;</span>Asia/Shanghai<span style="font-weight:bold">&lt;/timeZone&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">&lt;!--自定义日志输出格式--&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                        {
</span></span><span style="display:flex;"><span>                        &#34;project&#34;: &#34;mall&#34;,
</span></span><span style="display:flex;"><span>                        &#34;level&#34;: &#34;%level&#34;,
</span></span><span style="display:flex;"><span>                        &#34;service&#34;: &#34;${APP_NAME:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;pid&#34;: &#34;${PID:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;thread&#34;: &#34;%thread&#34;,
</span></span><span style="display:flex;"><span>                        &#34;class&#34;: &#34;%logger&#34;,
</span></span><span style="display:flex;"><span>                        &#34;message&#34;: &#34;%message&#34;,
</span></span><span style="display:flex;"><span>                        &#34;stack_trace&#34;: &#34;%exception{20}&#34;
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/providers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--ERROR日志输出到LogStash--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_ERROR&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.appender.LogstashTcpSocketAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;filter</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;ch.qos.logback.classic.filter.LevelFilter&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;level&gt;</span>ERROR<span style="font-weight:bold">&lt;/level&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;onMatch&gt;</span>ACCEPT<span style="font-weight:bold">&lt;/onMatch&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;onMismatch&gt;</span>DENY<span style="font-weight:bold">&lt;/onMismatch&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;destination&gt;</span>${LOG_STASH_HOST}:4561<span style="font-weight:bold">&lt;/destination&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder</span> <span style="color:#007f7f">charset=</span><span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;providers&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;timeZone&gt;</span>Asia/Shanghai<span style="font-weight:bold">&lt;/timeZone&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">&lt;!--自定义日志输出格式--&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                        {
</span></span><span style="display:flex;"><span>                        &#34;project&#34;: &#34;mall&#34;,
</span></span><span style="display:flex;"><span>                        &#34;level&#34;: &#34;%level&#34;,
</span></span><span style="display:flex;"><span>                        &#34;service&#34;: &#34;${APP_NAME:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;pid&#34;: &#34;${PID:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;thread&#34;: &#34;%thread&#34;,
</span></span><span style="display:flex;"><span>                        &#34;class&#34;: &#34;%logger&#34;,
</span></span><span style="display:flex;"><span>                        &#34;message&#34;: &#34;%message&#34;,
</span></span><span style="display:flex;"><span>                        &#34;stack_trace&#34;: &#34;%exception{20}&#34;
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/providers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--业务日志输出到LogStash--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_BUSINESS&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.appender.LogstashTcpSocketAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;destination&gt;</span>${LOG_STASH_HOST}:4562<span style="font-weight:bold">&lt;/destination&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder</span> <span style="color:#007f7f">charset=</span><span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;providers&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;timeZone&gt;</span>Asia/Shanghai<span style="font-weight:bold">&lt;/timeZone&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">&lt;!--自定义日志输出格式--&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                        {
</span></span><span style="display:flex;"><span>                        &#34;project&#34;: &#34;xxx&#34;,
</span></span><span style="display:flex;"><span>                        &#34;level&#34;: &#34;%level&#34;,
</span></span><span style="display:flex;"><span>                        &#34;service&#34;: &#34;${APP_NAME:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;pid&#34;: &#34;${PID:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;thread&#34;: &#34;%thread&#34;,
</span></span><span style="display:flex;"><span>                        &#34;class&#34;: &#34;%logger&#34;,
</span></span><span style="display:flex;"><span>                        &#34;message&#34;: &#34;%message&#34;,
</span></span><span style="display:flex;"><span>                        &#34;stack_trace&#34;: &#34;%exception{20}&#34;
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/providers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--接口访问记录日志输出到LogStash--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;appender</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_RECORD&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.appender.LogstashTcpSocketAppender&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;destination&gt;</span>${LOG_STASH_HOST}:4563<span style="font-weight:bold">&lt;/destination&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;encoder</span> <span style="color:#007f7f">charset=</span><span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span> <span style="color:#007f7f">class=</span><span style="color:#0ff;font-weight:bold">&#34;net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;providers&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;timeZone&gt;</span>Asia/Shanghai<span style="font-weight:bold">&lt;/timeZone&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/timestamp&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">&lt;!--自定义日志输出格式--&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;pattern&gt;</span>
</span></span><span style="display:flex;"><span>                        {
</span></span><span style="display:flex;"><span>                        &#34;project&#34;: &#34;xxx&#34;,
</span></span><span style="display:flex;"><span>                        &#34;level&#34;: &#34;%level&#34;,
</span></span><span style="display:flex;"><span>                        &#34;service&#34;: &#34;${APP_NAME:-}&#34;,
</span></span><span style="display:flex;"><span>                        &#34;class&#34;: &#34;%logger&#34;,
</span></span><span style="display:flex;"><span>                        &#34;message&#34;: &#34;%message&#34;
</span></span><span style="display:flex;"><span>                        }
</span></span><span style="display:flex;"><span>                    <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="font-weight:bold">&lt;/pattern&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="font-weight:bold">&lt;/providers&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;/encoder&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/appender&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">&lt;!--控制框架输出日志--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;org.slf4j&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;springfox&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;io.swagger&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;org.springframework&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;org.hibernate.validator&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;INFO&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.xf.common.log.WebLogAspect&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_RECORD&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/logger&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;logger</span> <span style="color:#007f7f">name=</span><span style="color:#0ff;font-weight:bold">&#34;com.xf&#34;</span> <span style="color:#007f7f">level=</span><span style="color:#0ff;font-weight:bold">&#34;DEBUG&#34;</span><span style="font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_BUSINESS&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/logger&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;root&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;CONSOLE&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE_DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;FILE_ERROR&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_DEBUG&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="font-weight:bold">&lt;appender-ref</span> <span style="color:#007f7f">ref=</span><span style="color:#0ff;font-weight:bold">&#34;LOG_STASH_ERROR&#34;</span><span style="font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;/root&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="如何打好日志">如何打好日志<a hidden class="anchor" aria-hidden="true" href="#如何打好日志">#</a></h1>
<p><a href="https://www.slf4j.org/faq.html#logging_performance">最佳实践</a></p>
<h2 id="强制">强制<a hidden class="anchor" aria-hidden="true" href="#强制">#</a></h2>
<h3 id="正确声明日志对象logger">正确声明日志对象logger<a hidden class="anchor" aria-hidden="true" href="#正确声明日志对象logger">#</a></h3>
<ul>
<li>变量类型Log是门面接口框架中的类，实现类可以是Log4j、Logback，不要把实现类定义为变量类型，否则日志切换不方便，也不符合抽象编程思想。</li>
<li>建议日志对象logger声明为<code>private static final</code>，声明为private可防止logger对象被其他类非法使用。声明为static可防止重复new出logger对象，造成资源浪费；还可以防止logger被序列化，造成安全风险。声明为final是因为在类的生命周期内无需变更logger。</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> Logger LOG = LoggerFactory.<span style="color:#007f7f">getLogger</span>(ClassName.<span style="color:#007f7f">getClass</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="代码中日志级别使用">代码中日志级别使用<a hidden class="anchor" aria-hidden="true" href="#代码中日志级别使用">#</a></h3>
<p>项目中常用日志级别<code>ERROR、WARN、INFO、DEBUG</code>四种。
ERROR，捕获异常的时候使用（catch时使用），这个没有异议
WARN，一般用来记录一些用户输入错误。
INFO，用来记录程序的一些有用信息，输入输出参数、耗时、开始结束等。
DEBUG，程序运行过程中的中间参数，只希望开发环境出现，线上不需要的信息。</p>
<h3 id="正确的打印变量">正确的打印变量<a hidden class="anchor" aria-hidden="true" href="#正确的打印变量">#</a></h3>
<p>使用slf4j日志组件打印变量时，建议使用<code>{}</code>占位符风格，而不是<code>+</code>拼接符。例如：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;Country: {}, Province: {}, City: {}&#34;</span>, ctry, prov, city); <span style="color:#007f7f">//占位符
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span> logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;Country: &#34;</span>+ctry+<span style="color:#0ff;font-weight:bold">&#34;, Province:&#34;</span> +prov +<span style="color:#0ff;font-weight:bold">&#34;, City: &#34;</span>+city);   <span style="color:#007f7f">//拼接符
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>显然，占位符风格更直观，而且不容易出现笔误——上面的拼接符语句有问题，谁能发现？</p>
<p>但最常见的变量打印问题，是打印时未使用占位符或拼接符：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;print cannotBePrinted: &#34;</span>, cannotBePrinted);  <span style="color:#007f7f">//Wrong
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span> logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;print canBePrinted: &#34;</span> + canBePrinted);  <span style="color:#007f7f">//Good
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span> logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;print canBePrinted: {}&#34;</span>, canBePrinted); <span style="color:#007f7f">//Better
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>注意，cannotBePrinted或canBePrinted为非Throwable的变量。亦即，异常变量e不适用上述规则，但e.getMessage()适用。</p>
<p>可使用如下正则表达式排查Java代码里不规范的变量打印：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>^<span style="color:#f00">\</span>s*[Ll][Oo][Gg](ger|GER)*<span style="color:#f00">\</span>.[a-zA-Z]{<span style="color:#ff0;font-weight:bold">4</span>,<span style="color:#ff0;font-weight:bold">5</span>}<span style="color:#f00">\</span>(<span style="color:#0ff;font-weight:bold">&#34;([^({})]+?)&#34;</span><span style="color:#f00">\</span>s*<span style="color:#f00">\</span>,<span style="color:#f00">\</span>s*([^e<span style="color:#f00">\</span>s]|<span style="color:#f00">\</span>w{<span style="color:#ff0;font-weight:bold">2</span>,})<span style="color:#f00">\</span>s*<span style="color:#f00">\</span>);.*
</span></span></code></pre></td></tr></table>
</div>
</div><p>考虑到实际代码书写风格的差异，该正则表达式会存在漏判和误判。例如，&ldquo;logger.error(&ldquo;Best print: &ldquo;, ex);&ldquo;会被误判。</p>
<h3 id="正确的打印异常">正确的打印异常<a hidden class="anchor" aria-hidden="true" href="#正确的打印异常">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> a = <span style="color:#ff0;font-weight:bold">1</span> / <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//正确，如果只打印e，不需要占位符{}
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>, e);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//正确，注意logger.error()时，这里使用了两个占位符{}，最后的参数e（Throwable类型）不需要占位符
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;inputParams:{} and errorMessage:{}&#34;</span>, <span style="color:#f00">各类参数或者对象</span> toString(), e.<span style="color:#007f7f">getMessage</span>(), e);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//错误，会丢失堆栈信息
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>, e.<span style="color:#007f7f">getMessage</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//错误，不应该用+拼接
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span> + e);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>可使用如下正则表达式排查Java代码里不规范的异常打印：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>^<span style="color:#f00">\</span>s*[Ll][Oo][Gg](ger|GER)*<span style="color:#f00">\</span>.(error|warn)<span style="color:#f00">\</span>(<span style="color:#0ff;font-weight:bold">&#34;(.+?)&#34;</span><span style="color:#f00">\</span>s*<span style="color:#f00">\</span>+<span style="color:#f00">\</span>s*(e|ex|e.<span style="color:#007f7f">getMessage</span><span style="color:#f00">\</span>(<span style="color:#f00">\</span>))<span style="color:#f00">\</span>s*<span style="color:#f00">\</span>);.*
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="对于-tracedebuginfo-级别的日志输出必须进行日志级别的开关判断">对于 <code>trace/debug/info</code> 级别的日志输出，必须进行日志级别的开关判断<a hidden class="anchor" aria-hidden="true" href="#对于-tracedebuginfo-级别的日志输出必须进行日志级别的开关判断">#</a></h3>
<p>说明：虽然在 debug(参数)的方法体内第一行代码 <code>isDisabled(Level.DEBUG_INT)</code>为真时（Slf4j 的常见实现Log4j 和 Logback），就直接 return，但是参数可能会进行字符串拼接运算。此外，如果 <code>debug(getName())</code>这种参数内有 getName()方法调用，无谓浪费方法调用的开销。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// 正例：如果判断为真，那么可以输出 trace 和 debug 级别的日志
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">if</span>(logger.<span style="color:#007f7f">isDebugEnabled</span>()){
</span></span><span style="display:flex;"><span>    logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;handleChanges end:{}:{}(ms) &#34;</span>, <span style="color:#fff;font-weight:bold">new</span> Object[] {changes, useTime});
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="禁止">禁止<a hidden class="anchor" aria-hidden="true" href="#禁止">#</a></h2>
<h3 id="禁止拼接字符串打印日志">禁止拼接字符串打印日志<a hidden class="anchor" aria-hidden="true" href="#禁止拼接字符串打印日志">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;The new entry is &#34;</span> + entry + <span style="color:#0ff;font-weight:bold">&#34;.&#34;</span>); <span style="color:#007f7f">// 错误
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>logger.<span style="color:#007f7f">debug</span>(<span style="color:#0ff;font-weight:bold">&#34;The new entry is {}.&#34;</span>, entry); <span style="color:#007f7f">// 正确
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="禁止eprintstacktrace">禁止<code>e.printStackTrace()</code><a hidden class="anchor" aria-hidden="true" href="#禁止eprintstacktrace">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> a = <span style="color:#ff0;font-weight:bold">1</span>/<span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#007f7f">printStackTrace</span>(); <span style="color:#007f7f">// 错误
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>,e); <span style="color:#007f7f">//正确
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>e.printStackTrace()</code>该方法本质是调用System.err输出到tomcat的控制台，不会记录到日志文件中。</p>
<h3 id="禁止使用system-printsystemoutprintlnsystemerrorprintln">禁止使用<code>System print、System.out.println、System.error.println</code><a hidden class="anchor" aria-hidden="true" href="#禁止使用system-printsystemoutprintlnsystemerrorprintln">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> a = <span style="color:#ff0;font-weight:bold">1</span>/<span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(e); <span style="color:#007f7f">// 错误
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        System.<span style="color:#007f7f">err</span>.<span style="color:#007f7f">println</span>(e); <span style="color:#007f7f">// 错误
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>,e); <span style="color:#007f7f">//正确
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="禁止记录日志后又抛出异常">禁止记录日志后又抛出异常<a hidden class="anchor" aria-hidden="true" href="#禁止记录日志后又抛出异常">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> a = <span style="color:#ff0;font-weight:bold">1</span> / <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>, e); <span style="color:#007f7f">//正确
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> BizException(<span style="color:#0ff;font-weight:bold">&#34;程序错误&#34;</span>,e); <span style="color:#007f7f">// 错误
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>因为这样会多次记录日志。</p>
<h1 id="spring-boot日志">spring boot日志<a hidden class="anchor" aria-hidden="true" href="#spring-boot日志">#</a></h1>
<p><a href="https://www.cnblogs.com/bigdataZJ/p/springboot-log.html">参考</a>
<a href="https://blog.csdn.net/mu_wind/article/details/99830829">参考</a>
日志，通常不会在需求阶段作为一个功能单独提出来，也不会在产品方案中看到它的细节。但是，这丝毫不影响它在任何一个系统中的重要的地位。
为了保证服务的高可用，发现问题一定要及时，解决问题一定要迅速，所以生产环境一旦出现问题，预警系统就会通过邮件、短信甚至电话的方式实施多维轰炸模式，确保相关负责人不错过每一个可能的bug。
预警系统判断疑似bug大部分源于日志。比如某个微服务接口由于各种原因导致频繁调用出错，此时调用端会捕获这样的异常并打印ERROR级别的日志，当该错误日志达到一定次数出现的时候，就会触发报警。</p>
<h2 id="spring-boot默认日志系统">Spring Boot默认日志系统<a hidden class="anchor" aria-hidden="true" href="#spring-boot默认日志系统">#</a></h2>
<p>Spring Boot默认使用LogBack日志系统，如果不需要更改为其他日志系统如Log4j2等，则无需多余的配置，LogBack默认将日志打印到控制台上。
如果要使用LogBack，原则上是需要添加dependency依赖的</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
</span></span><span style="display:flex;"><span>&lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;&lt;/pre&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>但是因为新建的Spring Boot项目一般都会引用spring-boot-starter或者spring-boot-starter-web，而这两个起步依赖中都已经包含了对于spring-boot-starter-logging的依赖，所以，无需额外添加依赖。
我们基于《没做过大项目，但我会建大项目》中创建的项目，启动springboot-demo项目，可以看到打印的日志信息如下。
<img loading="lazy" src="1.gif" alt=""  />
</p>
<p>以上至默认配置启动下的日志显示情况，如果需要做一些定制的日志配置比如将日志存储到文件等应该如何配置，下面就通过几个小问题来看看Spring Boot下是如何解决这些问题的。</p>
<h2 id="如何在项目中打印日志">如何在项目中打印日志<a hidden class="anchor" aria-hidden="true" href="#如何在项目中打印日志">#</a></h2>
<p>新建一个配置类 LogConfig，注入一个Bean，并在方法中打印日志</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> com.jackie.springbootdemo.config;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> com.jackie.springbootdemo.model.Person;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.Logger;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.slf4j.LoggerFactory;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.context.annotation.Bean;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.context.annotation.Configuration;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@Configuration
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> LogConfig {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> Logger LOG = LoggerFactory.<span style="color:#007f7f">getLogger</span>(LogConfig.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Bean
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Person logMethod() {
</span></span><span style="display:flex;"><span>        LOG.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;==========print log==========&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> Person();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行SpringBootDemoApplication，可以看到控制台的日志
<img loading="lazy" src="2.png" alt=""  />

Spring Boot默认的日志级别为INFO，这里打印的是INFO级别的日志所以可以显示。
很多开发者在日常写
<code>private static final Logger LOG = LoggerFactory.getLogger(LogConfig.class);</code>
总觉得后面的<code>LogConfig.class</code>可有可无，因为随便写个其他类也不会报错，但是准确编写class信息能够提供快速定位日志的效率。我们看到打印的日志内容左侧就是对应的类名称，这个是通过
<code>private static final Logger LOG = LoggerFactory.getLogger(LogConfig.class);</code>实现的。
如果将LogConfig.class换成xxx.class，输出日志就会显示对应的xxx类名。这样声明的好处就是方便定位日志。</p>
<h2 id="如何将日志信息存储到文件">如何将日志信息存储到文件<a hidden class="anchor" aria-hidden="true" href="#如何将日志信息存储到文件">#</a></h2>
<p>在本机环境，我们习惯在控制台看日志，但是线上我们还是要通过将日志信息保存到日志文件中，查询日志文件即可。
那么应该如何配置才能将日志信息保存到文件呢？
在我们创建的springboot-demo项目中，resources目录下有个application.properties文件，添加如下配置</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>logging.file.path=/Users/jackie/workspace/rome/
</span></span><span style="display:flex;"><span>logging.file.name=springbootdemo.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>logging.path：该属性用来配置日志文件的路径
logging.file：该属性用来配置日志文件名，如果该属性不配置，默认文件名为spring.log
运行SpringBootDemoApplication
<img loading="lazy" src="3.gif" alt=""  />

可以看到在指定路径下生成了springbootdemo.log文件，该文件内容和控制台打印内容一致。
如果注释logging.file=springbootdemo.log则生成默认文件名spring.log
<img loading="lazy" src="4.gif" alt=""  />
</p>
<h2 id="如何设置日志级别">如何设置日志级别<a hidden class="anchor" aria-hidden="true" href="#如何设置日志级别">#</a></h2>
<p>日志级别总共有TARCE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL ，且级别是逐渐提供，如果日志级别设置为INFO，则意味TRACE和DEBUG级别的日志都看不到。
上例中我们打印了一个INFO级别的日志，因为Spring Boot默认级别就是INFO，如果我们改为WARN，是否还能看到这行日志信息。</p>
<p><strong>logging.level</strong>
该属性用于配置日志级别。在applicaition.properties中添加
<code>logging.level.root=warn</code>
这里是用的root级别，即项目的所有日志，我们也可以使用package级别，即指定包下使用相应的日志级别，下面再看。
启动SpringBootDemoApplication
<img loading="lazy" src="5.png" alt=""  />

你没看错，这个项目是成功启动了，但是几乎没有内容，这是因为之前打印的日志级别都是INFO，这里设置为WARN，所以INFO级别的日志都不显示。
这里我们可以改动root还是INFO级别，将指定包下的日志级别设置为WARN</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>logging.level.root=INFO
</span></span><span style="display:flex;"><span>logging.level.com.jackie.springbootdemo.config=WARN
</span></span></code></pre></td></tr></table>
</div>
</div><p>启动SpringBootDemoApplication
<img loading="lazy" src="6.png" alt=""  />

可以看到除了LogConfig类中的INFO级别的日志没有打印出来，其他的INFO级别的日志都正常输出了。</p>
<h2 id="如何定制自己的日志格式">如何定制自己的日志格式<a hidden class="anchor" aria-hidden="true" href="#如何定制自己的日志格式">#</a></h2>
<p>在application.properties中添加</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>logging.pattern.console=%d{yyyy/MM/dd-HH:mm:ss} [%thread] %-5level %logger- %msg%n 
</span></span><span style="display:flex;"><span>logging.pattern.file=%d{yyyy/MM/dd-HH:mm} [%thread] %-5level %logger- %msg%n
</span></span></code></pre></td></tr></table>
</div>
</div><p>logging.pattern.console：该属性用于定制日志输出格式。
上述配置的编码中，对应符号的含义如下</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>%d{HH:mm:ss.SSS}——日志输出时间
</span></span><span style="display:flex;"><span>%thread——输出日志的进程名字，这在Web应用以及异步任务处理中很有用
</span></span><span style="display:flex;"><span>%-5level——日志级别，并且使用5个字符靠左对齐
</span></span><span style="display:flex;"><span>%logger- ——日志输出者的名字
</span></span><span style="display:flex;"><span>%msg——日志消息
</span></span><span style="display:flex;"><span>%n——平台的换行符
</span></span></code></pre></td></tr></table>
</div>
</div><p>启动SpringBootDemoApplication
<img loading="lazy" src="7.png" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/tags/java/">java</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://funny-toffee-4aa7c3.netlify.app/">Wjy&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>