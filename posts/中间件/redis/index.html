<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>redis | Wjy&#39;s Blog</title>
<meta name="keywords" content="ä¸­é—´ä»¶">
<meta name="description" content="redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/posts/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="redis" />
<meta property="og:description" content="redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/posts/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-06T18:10:43+00:00" />
<meta property="article:modified_time" content="2018-10-06T18:10:43+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="redis"/>
<meta name="twitter:description" content="redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "redis",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "redis",
  "name": "redis",
  "description": "redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚\n",
  "keywords": [
    "ä¸­é—´ä»¶"
  ],
  "articleBody": "redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚\næ¦‚å¿µ ç¼“å­˜å¤„ç†æµç¨‹ å‰å°è¯·æ±‚ï¼Œåå°å…ˆä»ç¼“å­˜ä¸­å–æ•°æ®ï¼Œå–åˆ°ç›´æ¥è¿”å›ç»“æœï¼Œå–ä¸åˆ°æ—¶ä»æ•°æ®åº“ä¸­å–ï¼Œæ•°æ®åº“å–åˆ°æ›´æ–°ç¼“å­˜ï¼Œå¹¶è¿”å›ç»“æœï¼Œæ•°æ®åº“ä¹Ÿæ²¡å–åˆ°ï¼Œé‚£ç›´æ¥è¿”å›ç©ºç»“æœã€‚\nredisç¼“å­˜ç©¿é€ ç¼“å­˜ç©¿é€æ˜¯æŒ‡ï¼šç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ï¼Œå¦‚å‘èµ·ä¸ºidä¸ºâ€œ-1â€çš„æ•°æ®æˆ–idä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚ è§£å†³æ–¹æ¡ˆï¼š æ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¦‚ç”¨æˆ·é‰´æƒæ ¡éªŒï¼ŒidåšåŸºç¡€æ ¡éªŒï¼Œid\u003c=0çš„ç›´æ¥æ‹¦æˆªï¼› ä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°†key-valueå¯¹å†™ä¸ºkey-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚30ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ”»å‡»ç”¨æˆ·åå¤ç”¨åŒä¸€ä¸ªidæš´åŠ›æ”»å‡»ã€‚\nç¼“å­˜é›ªå´© ç¼“å­˜é›ªå´©æ˜¯æŒ‡ï¼šç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³å®•æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸åŒæ•°æ®éƒ½è¿‡æœŸäº†ï¼Œå¾ˆå¤šæ•°æ®éƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚ è§£å†³æ–¹æ¡ˆï¼š ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚ å¦‚æœç¼“å­˜æ•°æ®åº“æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œå°†çƒ­ç‚¹æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒæå¾—ç¼“å­˜æ•°æ®åº“ä¸­ã€‚ è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚\nç¼“å­˜å‡»ç©¿ ç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚ç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ã€‚ è§£å†³æ–¹æ¡ˆï¼š è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚ åŠ äº’æ–¥é”ï¼Œäº’æ–¥é”å‚è€ƒä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public static String getData(String key) throws InterruptedException{ //ä»ç¼“å­˜ä¸­è¯»å–æ•°æ® String result = getDataFromRedis(key); //ç¼“å­˜ä¸­ä¸å­˜åœ¨æ•°æ® if(null == result){ //è·å–é”ï¼Œè·å–æˆåŠŸï¼Œå–æ•°æ®åº“è·å–æ•°æ® if(reenLock.tryLock()){ //ä»æ•°æ®åº“è·å–æ•°æ® result = getDataFrom Mysql(key); //æ›´æ–°ç¼“å­˜æ•°æ® if(null != result){ setDataToCache(key,result); } //é‡Šæ”¾é” reenLock.unlock(); }else{//è·å–é”å¤±è´¥ //æš‚åœ100mså†é‡æ–°è·å–æ•°æ® Thread.sleep(100); result = getData(key); } } return result; } è¯´æ˜ï¼š\nç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥èµ°ä¸Šè¿°ä»£ç 13è¡Œåå°±è¿”å›ç»“æœäº† ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼Œç¬¬1ä¸ªè¿›å…¥çš„çº¿ç¨‹ï¼Œè·å–é”å¹¶ä»æ•°æ®åº“å»å–æ•°æ®ï¼Œæ²¡é‡Šæ”¾é”ä¹‹å‰ï¼Œå…¶ä»–å¹¶è¡Œè¿›å…¥çš„çº¿ç¨‹ä¼šç­‰å¾…100msï¼Œå†é‡æ–°å»ç¼“å­˜å–æ•°æ®ã€‚è¿™æ ·å°±é˜²æ­¢éƒ½å»æ•°æ®åº“é‡å¤å–æ•°æ®ï¼Œé‡å¤å¾€ç¼“å­˜ä¸­æ›´æ–°æ•°æ®æƒ…å†µå‡ºç°ã€‚ å½“ç„¶è¿™æ˜¯ç®€åŒ–å¤„ç†ï¼Œç†è®ºä¸Šå¦‚æœèƒ½æ ¹æ®keyå€¼åŠ é”å°±æ›´å¥½äº†ï¼Œå°±æ˜¯çº¿ç¨‹Aä»æ•°æ®åº“å–key1çš„æ•°æ®å¹¶ä¸å¦¨ç¢çº¿ç¨‹Bå–key2çš„æ•°æ®ï¼Œä¸Šé¢ä»£ç æ˜æ˜¾åšä¸åˆ°è¿™ç‚¹ã€‚ å®‰è£…redis linuxå®‰è£…redis è¿æ¥redis ./redis-cli 127.0.0.1:6379\u003e\né…ç½®redis redisçš„é…ç½®æ–‡ä»¶ä½äºRediså®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.confï¼Œå¯ä»¥é€šè¿‡CONFIGå‘½ä»¤æŸ¥çœ‹æˆ–è€…è®¾ç½®é…ç½®é¡¹ã€‚\n1 2 3 127.0.0.1:6379\u003e config get loglevel 1) \"loglevel\" 2) \"notice\" ä½¿ç”¨*è·å–æ‰€æœ‰é…ç½®é¡¹ config get * å¾ˆå¤šé…ç½®ï¼Œè¿™é‡Œå°±ä¸è´´äº†ã€‚å‚è€ƒè¿™é‡Œ å¯ä»¥é€šè¿‡ä¿®æ”¹redis.confæ–‡ä»¶æˆ–è€…ä½¿ç”¨config set å‘½ä»¤æ¥ä¿®æ”¹é…ç½®\n1 2 127.0.0.1:6379\u003e config set loglevel 'notice' OK å¦‚ä½•åœæ­¢/å¯åŠ¨/é‡å¯redisæœåŠ¡ å¦‚æœæ˜¯ç”¨apt-getæˆ–è€…yum installå®‰è£…çš„redisï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤åœæ­¢/å¯åŠ¨/é‡å¯redis\n1 2 3 /etc/init.d/redis-server stop /etc/init.d/redis-server start /etc/init.d/redis-server restart å¦‚æœæ˜¯é€šè¿‡æºç å®‰è£…çš„redisï¼Œå¯ä»¥é€šè¿‡redisçš„å®¢æˆ·ç«¯ç¨‹åºredis-cliçš„shutdownå‘½ä»¤æ¥åœæ­¢redis\nredis-cli -h 127.0.0.1 -p 6379 shutdown æˆ– ./redis-cli shutdown æ²¡é”™ï¼Œè™½ç„¶å¯åŠ¨çš„æ˜¯serverï¼Œä½†æ˜¯è¿™é‡Œåœæ­¢çš„æ˜¯redis-cli å¦‚æœä¸Šè¿°æ–¹å¼éƒ½æ²¡æœ‰æˆåŠŸåœæ­¢redisï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç»ˆææ­¦å™¨ kill -9\nå¯åŠ¨redisï¼š cd src ./redis-server ä¸Šé¢è¿™ç§å¯åŠ¨redisä½¿ç”¨çš„æ˜¯é»˜è®¤é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°å‘Šè¯‰redisä½¿ç”¨æŒ‡å®šé…ç½® ./redis-server ../redis.conf\nè®©redisåå°è¿è¡Œ ./redis-server \u0026 ç„¶åè¾“å…¥bg\nwindowså®‰è£…redis5.x å‚è€ƒ ä¸‹è½½åœ°å€ï¼šhttps://github.com/tporadowski/redis/releases è¿™é‡Œä¸‹è½½çš„æ˜¯ Redis-x64-5.0.10.msi ç›´æ¥å®‰è£…ï¼Œå®‰è£…è¿‡ç¨‹å‹¾é€‰æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå…¶ä»–éƒ½ nextã€‚ å®‰è£…ç›®å½•ä¸‹ï¼Œgit bushæ‰§è¡Œå‘½ä»¤ï¼š ./redis-server.exe redis.windows.conf\nå¦‚æœæ˜¾ç¤ºï¼š Redis is starting å°±æ˜¯rediså·²ç»åœ¨è¿è¡Œäº†ã€‚ä¸¤ç§è§£å†³åŠæ³•ï¼š\nè¿è¡Œrediså®‰è£…ç›®å½•çš„redis-cli.exeï¼Œshutdownï¼Œæ˜¾ç¤ºnot connected\u003eexitã€‚ æ‰¾åˆ°windowsæœåŠ¡ï¼Œæ‰¾åˆ°redisï¼Œåœæ­¢ï¼Œç¦ç”¨è‡ªå¯ã€‚ redisè®¾ç½®å¯†ç ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ redis.windows.confï¼š\n1 2 # requirepass foobared requirepass 123456 ä¹‹åå¯åŠ¨ redis éœ€è¦æŒ‡å®šé…ç½®æ–‡ä»¶ï¼š redis-server.exe redis.windows.conf\nrediså‘½ä»¤ å‚è€ƒredisä¸­æ–‡å®˜ç½‘\nkey del delç”¨äºåˆ é™¤å·²å­˜åœ¨çš„é”®ï¼Œä¸å­˜åœ¨çš„ key ä¼šè¢«å¿½ç•¥ del key_name è¿”å›è¢«åˆ é™¤keyçš„æ•°é‡\ndump DUMP å‘½ä»¤ç”¨äºåºåˆ—åŒ–ç»™å®š key ï¼Œå¹¶è¿”å›è¢«åºåˆ—åŒ–çš„å€¼ DUMP KEY_NAME å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å› nil ã€‚ å¦åˆ™ï¼Œè¿”å›åºåˆ—åŒ–ä¹‹åçš„å€¼ã€‚\nexist EXISTS å‘½ä»¤ç”¨äºæ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚ EXISTS KEY_NAME è‹¥ key å­˜åœ¨è¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚\nexpire Expire å‘½ä»¤ç”¨äºè®¾ç½® key çš„è¿‡æœŸæ—¶é—´ã€‚key è¿‡æœŸåå°†ä¸å†å¯ç”¨ã€‚ Expire KEY_NAME TIME_IN_SECONDS è®¾ç½®æˆåŠŸè¿”å›1ï¼Œ å½“keyä¸å­˜åœ¨æˆ–è€…ä¸èƒ½ä¸ºkeyè®¾ç½®è¿‡æœŸæ—¶é—´æ—¶è¿”å›0ã€‚\nexpireat Expireat å‘½ä»¤ç”¨äºä»¥ UNIX æ—¶é—´æˆ³(unix timestamp)æ ¼å¼è®¾ç½® key çš„è¿‡æœŸæ—¶é—´ã€‚key è¿‡æœŸåå°†ä¸å†å¯ç”¨ã€‚ Expireat KEY_NAME TIME_IN_UNIX_TIMESTAMP è®¾ç½®æˆåŠŸè¿”å›1ï¼Œä¸æˆåŠŸæˆ–ä¸å­˜åœ¨è¿”å›0ã€‚ ç¤ºä¾‹ï¼š EXPIREAT w3ckey 1293840000\nkeys Keys å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ key KEYS PATTERN è¿”å›ç¬¦åˆç»™å®šæ¨¡å¼çš„ key åˆ—è¡¨ (Array)ã€‚\næŸ¥æ‰¾ä»¥w3cå¼€å¤´çš„keyï¼š keys w3c* æŸ¥æ‰¾æ‰€æœ‰çš„key keys *\nmove moveå‘½ä»¤ç”¨äºå°†å½“å‰æ•°æ®åº“çš„keyç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“dbå½“ä¸­ã€‚ MOVE KEY_NAME DESTINATION_DATABASE ç§»åŠ¨æˆåŠŸè¿”å› 1 ï¼Œå¤±è´¥åˆ™è¿”å› 0 ã€‚\nç¤ºä¾‹ï¼š\n1 2 3 4 5 6 SELECT 0 # redisé»˜è®¤ä½¿ç”¨æ•°æ®åº“ 0ï¼Œä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè¿™é‡Œå†æ˜¾å¼æŒ‡å®šä¸€æ¬¡ã€‚ set w3c redis #è®¾ç½®ä¸€ä¸ªkey move w3c 1 #è½¬ç§»åˆ°1åº“ exist w3c #å‘ç°w3cå·²ç»æ²¡æœ‰äº† select 1 #é€‰æ‹©1åº“ exist w3c #å‘ç°w3cå·²ç»è½¬ç§»åˆ°1åº“ä¸­ ä¸å­˜åœ¨çš„keyæ— æ³•è½¬ç§» å½“æºæ•°æ®åº“å’Œç›®æ ‡æ•°æ®åº“æœ‰ç›¸åŒçš„ key æ—¶ï¼Œkeyæ— æ³•è½¬ç§»ã€‚ persist persistå‘½ä»¤ç”¨äºç§»é™¤ç»™å®š key çš„è¿‡æœŸæ—¶é—´ï¼Œä½¿å¾— key æ°¸ä¸è¿‡æœŸã€‚ PERSIST KEY_NAME å½“è¿‡æœŸæ—¶é—´ç§»é™¤æˆåŠŸæ—¶ï¼Œè¿”å› 1 ã€‚ å¦‚æœ key ä¸å­˜åœ¨æˆ– key æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿”å› 0 ã€‚\npttl Pttl å‘½ä»¤ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™è¿‡æœŸæ—¶é—´ã€‚ PTTL KEY_NAME å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› -2 ã€‚ å½“ key å­˜åœ¨ä½†æ²¡æœ‰è®¾ç½®å‰©ä½™ç”Ÿå­˜æ—¶é—´æ—¶ï¼Œè¿”å› -1 ã€‚ å¦åˆ™ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œè¿”å› key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚\nTTL TTL å‘½ä»¤ä»¥ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™è¿‡æœŸæ—¶é—´ã€‚ TTL KEY_NAME å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› -2 ã€‚ å½“ key å­˜åœ¨ä½†æ²¡æœ‰è®¾ç½®å‰©ä½™ç”Ÿå­˜æ—¶é—´æ—¶ï¼Œè¿”å› -1 ã€‚ å¦åˆ™ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å› key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚\nrandomkey RANDOMKEY å‘½ä»¤ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª key ã€‚ randomkey å½“æ•°æ®åº“ä¸ä¸ºç©ºæ—¶ï¼Œè¿”å›ä¸€ä¸ª key ã€‚ å½“æ•°æ®åº“ä¸ºç©ºæ—¶ï¼Œè¿”å› nil ã€‚\nrename Rename å‘½ä»¤ç”¨äºä¿®æ”¹ key çš„åç§° ã€‚ RENAME OLD_KEY_NAME NEW_KEY_NAME æ”¹åæˆåŠŸæ—¶æç¤º OK ï¼Œå¤±è´¥æ—¶å€™è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ å½“ OLD_KEY_NAME å’Œ NEW_KEY_NAME ç›¸åŒï¼Œæˆ–è€… OLD_KEY_NAME ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ å½“ NEW_KEY_NAME å·²ç»å­˜åœ¨æ—¶ï¼Œ RENAME å‘½ä»¤å°†è¦†ç›–æ—§å€¼ã€‚\nrenamenx Renamenx å‘½ä»¤ç”¨äºåœ¨æ–°çš„ key ä¸å­˜åœ¨æ—¶ä¿®æ”¹ key çš„åç§° ã€‚ RENAMENX OLD_KEY_NAME NEW_KEY_NAME ä¿®æ”¹æˆåŠŸæ—¶ï¼Œè¿”å› 1 ã€‚ å¦‚æœ NEW_KEY_NAME å·²ç»å­˜åœ¨ï¼Œè¿”å› 0 ã€‚\ntype Type å‘½ä»¤ç”¨äºè¿”å› key æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚ TYPE KEY_NAME è¿”å› key çš„æ•°æ®ç±»å‹ï¼Œæ•°æ®ç±»å‹æœ‰ï¼š\n1 2 3 4 5 6 none (keyä¸å­˜åœ¨) string (å­—ç¬¦ä¸²) list (åˆ—è¡¨) set (é›†åˆ) zset (æœ‰åºé›†) hash (å“ˆå¸Œè¡¨) string set SET å‘½ä»¤ç”¨äºè®¾ç½®ç»™å®š key çš„å€¼ã€‚å¦‚æœ key å·²ç»å­˜å‚¨å…¶ä»–å€¼ï¼Œ SET å°±è¦†å†™æ—§å€¼ï¼Œä¸”æ— è§†ç±»å‹ã€‚ SET KEY_NAME VALUE ä» Redis 2.6.12 ç‰ˆæœ¬å¼€å§‹ï¼Œ SET åœ¨è®¾ç½®æ“ä½œæˆåŠŸå®Œæˆæ—¶ï¼Œæ‰è¿”å› OK ã€‚\nget Get å‘½ä»¤ç”¨äºè·å–æŒ‡å®š key çš„å€¼ã€‚ GET KEY_NAME å¦‚æœ key ä¸å­˜åœ¨ï¼Œè¿”å› nil ã€‚å¦‚æœkey å‚¨å­˜çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚\ngetrange getrangeå‘½ä»¤ç”¨äºè·å–å­˜å‚¨åœ¨æŒ‡å®š key ä¸­å­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²çš„æˆªå–èŒƒå›´ç”± start å’Œ end ä¸¤ä¸ªåç§»é‡å†³å®š(åŒ…æ‹¬ start å’Œ end åœ¨å†…)ã€‚ getrange KEY_NAME start end\nç¤ºä¾‹ï¼šé¦–å…ˆï¼Œè®¾ç½® mykey çš„å€¼å¹¶æˆªå–å­—ç¬¦ä¸²ã€‚\n1 2 3 4 5 6 redis 127.0.0.1:6379\u003e SET mykey \"This is my test key\" OK redis 127.0.0.1:6379\u003e GETRANGE mykey 0 3 \"This\" redis 127.0.0.1:6379\u003e GETRANGE mykey 0 -1 \"This is my test key\" getset getset å‘½ä»¤ç”¨äºè®¾ç½®æŒ‡å®š key çš„å€¼ï¼Œå¹¶è¿”å› key æ—§çš„å€¼ã€‚ getset key_name value è¿”å›ç»™å®š key çš„æ—§å€¼ã€‚ å½“ key æ²¡æœ‰æ—§å€¼æ—¶ï¼Œå³ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil ã€‚ å½“ key å­˜åœ¨ä½†ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ ç¤ºä¾‹ï¼šé¦–å…ˆï¼Œè®¾ç½® mykey çš„å€¼å¹¶æˆªå–å­—ç¬¦ä¸²ã€‚\n1 2 3 4 redis 127.0.0.1:6379\u003e GETSET mynewkey \"This is my test key\" (nil) redis 127.0.0.1:6379\u003e GETSET mynewkey \"This is my new value to test getset\" \"This is my test key\" getbit getbit å‘½ä»¤ç”¨äºå¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè·å–æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚ getbit key_name offset è¿”å›å­—ç¬¦ä¸²å€¼æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚ å½“åç§»é‡ OFFSET æ¯”å­—ç¬¦ä¸²å€¼çš„é•¿åº¦å¤§ï¼Œæˆ–è€… key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0 ã€‚\nsetbit setbitå‘½ä»¤ç”¨äºå¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè®¾ç½®æˆ–æ¸…é™¤æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚ setbit key_name offset è¿”å›æŒ‡å®šåç§»é‡åŸæ¥å‚¨å­˜çš„ä½ã€‚\nmget mgetå‘½ä»¤è¿”å›æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š key çš„å€¼ã€‚ å¦‚æœç»™å®šçš„ key é‡Œé¢ï¼Œæœ‰æŸä¸ª key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ª key è¿”å›ç‰¹æ®Šå€¼ nil ã€‚ MGET KEY1 KEY2 .. KEYN\nsetex setex å‘½ä»¤ä¸ºæŒ‡å®šçš„ key è®¾ç½®å€¼åŠå…¶è¿‡æœŸæ—¶é—´ã€‚å¦‚æœ key å·²ç»å­˜åœ¨ï¼Œ SETEX å‘½ä»¤å°†ä¼šæ›¿æ¢æ—§çš„å€¼ã€‚ setex key_name timeout value è®¾ç½®æˆåŠŸæ—¶è¿”å› OK ã€‚ è¯´ç™½äº†å°±æ˜¯åœ¨è®¾ç½®ä¸€ä¸ªå€¼çš„æ—¶å€™ç›´æ¥å°±æŒ‡å®šäº†è¿‡æœŸæ—¶é—´ã€‚\nsetnx setnx(SET if Not eXists)å‘½ä»¤åœ¨æŒ‡å®šçš„ key ä¸å­˜åœ¨æ—¶ï¼Œä¸º key è®¾ç½®æŒ‡å®šçš„å€¼ã€‚ setnx key_name value è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ è®¾ç½®å¤±è´¥ï¼Œè¿”å› 0 ã€‚\n1 2 3 4 5 6 7 8 redis\u003e EXISTS job # job ä¸å­˜åœ¨ (integer) 0 redis\u003e SETNX job \"programmer\" # job è®¾ç½®æˆåŠŸ (integer) 1 redis\u003e SETNX job \"code-farmer\" # å°è¯•è¦†ç›– job ï¼Œå¤±è´¥ (integer) 0 redis\u003e GET job # æ²¡æœ‰è¢«è¦†ç›– \"programmer\" setrange setrange å‘½ä»¤ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¦†ç›–ç»™å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè¦†ç›–çš„ä½ç½®ä»åç§»é‡ offset å¼€å§‹ã€‚ SETRANGE KEY_NAME OFFSET VALUE è¿”å›è¢«ä¿®æ”¹åçš„å­—ç¬¦ä¸²é•¿åº¦ã€‚ å°±æ˜¯ä»æŒ‡å®šä½ç½®ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å®¹ã€‚\nstrlen strlen å‘½ä»¤ç”¨äºè·å–æŒ‡å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚å½“ key å‚¨å­˜çš„ä¸æ˜¯å­—ç¬¦ä¸²å€¼æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ strlen key_name è¿”å›å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0ã€‚\nmset mset å‘½ä»¤ç”¨äºåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚ MSET key1 value1 key2 value2 .. keyN valueN æ€»æ˜¯è¿”å›OK\nmsetnx msetnx å‘½ä»¤ç”¨äºæ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨æ—¶ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚ MSETNX key1 value1 key2 value2 .. keyN valueN å½“æ‰€æœ‰ key éƒ½æˆåŠŸè®¾ç½®ï¼Œè¿”å› 1 ã€‚ å¦‚æœæ‰€æœ‰ç»™å®š key éƒ½è®¾ç½®å¤±è´¥(è‡³å°‘æœ‰ä¸€ä¸ª key å·²ç»å­˜åœ¨)ï¼Œé‚£ä¹ˆè¿”å› 0 ã€‚\nmsetnxæ˜¯åŸå­æ€§æ“ä½œï¼Œåªè¦æœ‰ä¸€ä¸ªå€¼å¤±è´¥ï¼Œæ‰€æœ‰çš„å€¼éƒ½ä¸ä¼šè¢«è®¾ç½®ã€‚\npsetex psetex å‘½ä»¤ä»¥æ¯«ç§’ä¸ºå•ä½è®¾ç½® key çš„ç”Ÿå­˜æ—¶é—´ã€‚ PSETEX key1 EXPIRY_IN_MILLISECONDS value1 è®¾ç½®æˆåŠŸæ—¶è¿”å› OK ã€‚\nincr incr å‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ INCR æ“ä½œã€‚ å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚ incr key_name è¿”å›æ‰§è¡Œincrå‘½ä»¤ä¹‹å key çš„å€¼ã€‚\nincrby incrbyå‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—åŠ ä¸ŠæŒ‡å®šçš„å¢é‡å€¼ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ INCRBY å‘½ä»¤ã€‚ å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚ incr key_name incr_amount è¿”å›åŠ ä¸ŠæŒ‡å®šçš„å¢é‡å€¼ä¹‹åï¼Œ key çš„å€¼ã€‚\nincrbyfloat incrbyfloatå‘½ä»¤ä¸º key ä¸­æ‰€å‚¨å­˜çš„å€¼åŠ ä¸ŠæŒ‡å®šçš„æµ®ç‚¹æ•°å¢é‡å€¼ã€‚ incrbyfloat key_name incr_amount è¿”å›æ‰§è¡Œå‘½ä»¤ä¹‹å key çš„å€¼ã€‚\nç”¨ SET è®¾ç½®çš„å€¼å¯ä»¥æ˜¯æŒ‡æ•°ç¬¦å·314e-2ï¼Œä½†æ‰§è¡Œ INCRBYFLOAT ä¹‹åæ ¼å¼ä¼šè¢«æ”¹æˆéæŒ‡æ•°ç¬¦å·3.14 SET è®¾ç½®çš„å€¼å°æ•°éƒ¨åˆ†å¯ä»¥æ˜¯ 03.0ï¼Œä½† INCRBYFLOAT ä¼šå°†æ— ç”¨çš„ 0 å¿½ç•¥æ‰ï¼Œæœ‰éœ€è¦çš„è¯ï¼Œå°†æµ®ç‚¹å˜ä¸ºæ•´æ•°4\ndecr decr å‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ DECR æ“ä½œã€‚ å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚ decr key_name è¿”å›æ‰§è¡Œå‘½ä»¤ä¹‹å key çš„å€¼ã€‚\ndecrby decrby å‘½ä»¤å°† key æ‰€å‚¨å­˜çš„å€¼å‡å»æŒ‡å®šçš„å‡é‡å€¼ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ DECRBY æ“ä½œã€‚ å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚ decrby key_name decrement_amount è¿”å›å‡å»æŒ‡å®šå‡é‡å€¼ä¹‹åï¼Œ key çš„å€¼ã€‚\nappend append å‘½ä»¤ç”¨äºä¸ºæŒ‡å®šçš„ key è¿½åŠ å€¼ã€‚ å¦‚æœ key å·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ APPEND å‘½ä»¤å°† value è¿½åŠ åˆ° key åŸæ¥çš„å€¼çš„æœ«å°¾ã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œ APPEND å°±ç®€å•åœ°å°†ç»™å®š key è®¾ä¸º value ï¼Œå°±åƒæ‰§è¡Œ SET key value ä¸€æ ·ã€‚ append key_name new_value è¿”å›è¿½åŠ æŒ‡å®šå€¼ä¹‹åï¼Œ key ä¸­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚\nhash hdel hdel å‘½ä»¤ç”¨äºåˆ é™¤å“ˆå¸Œè¡¨ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šå­—æ®µï¼Œä¸å­˜åœ¨çš„å­—æ®µå°†è¢«å¿½ç•¥ã€‚ HDEL KEY_NAME FIELD1.. FIELDN è¢«æˆåŠŸåˆ é™¤å­—æ®µçš„æ•°é‡ï¼Œä¸åŒ…æ‹¬è¢«å¿½ç•¥çš„å­—æ®µã€‚\nhexists hexists å‘½ä»¤ç”¨äºæŸ¥çœ‹å“ˆå¸Œè¡¨çš„æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ã€‚ HEXISTS KEY_NAME FIELD_NAME å¦‚æœå“ˆå¸Œè¡¨å«æœ‰ç»™å®šå­—æ®µï¼Œè¿”å› 1 ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸å«æœ‰ç»™å®šå­—æ®µï¼Œæˆ– key ä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚\nhget hget å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚ HGET KEY_NAME FIELD_NAME è¿”å›ç»™å®šå­—æ®µçš„å€¼ã€‚å¦‚æœç»™å®šçš„å­—æ®µæˆ– key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil ã€‚\nhgetall hgetall å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­ï¼Œæ‰€æœ‰çš„å­—æ®µå’Œå€¼ã€‚ åœ¨è¿”å›å€¼é‡Œï¼Œç´§è·Ÿæ¯ä¸ªå­—æ®µå(field name)ä¹‹åæ˜¯å­—æ®µçš„å€¼(value)ï¼Œæ‰€ä»¥è¿”å›å€¼çš„é•¿åº¦æ˜¯å“ˆå¸Œè¡¨å¤§å°çš„ä¸¤å€ã€‚ HGETALL KEY_NAME ä»¥åˆ—è¡¨å½¢å¼è¿”å›å“ˆå¸Œè¡¨çš„å­—æ®µåŠå­—æ®µå€¼ã€‚ è‹¥ key ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºåˆ—è¡¨ã€‚\nhincrby hincrby å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µå€¼åŠ ä¸ŠæŒ‡å®šå¢é‡å€¼ã€‚ å¢é‡ä¹Ÿå¯ä»¥ä¸ºè´Ÿæ•°ï¼Œç›¸å½“äºå¯¹æŒ‡å®šå­—æ®µè¿›è¡Œå‡æ³•æ“ä½œã€‚ å¦‚æœå“ˆå¸Œè¡¨çš„ key ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶æ‰§è¡Œ HINCRBY å‘½ä»¤ã€‚ å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œå­—æ®µçš„å€¼è¢«åˆå§‹åŒ–ä¸º 0 ã€‚ å¯¹ä¸€ä¸ªå‚¨å­˜å­—ç¬¦ä¸²å€¼çš„å­—æ®µæ‰§è¡Œ HINCRBY å‘½ä»¤å°†é€ æˆä¸€ä¸ªé”™è¯¯ã€‚ æœ¬æ“ä½œçš„å€¼è¢«é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚ HINCRBY KEY_NAME FIELD_NAME INCR_BY_NUMBER hincrbyfloat hincrbyfloat å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µå€¼åŠ ä¸ŠæŒ‡å®šæµ®ç‚¹æ•°å¢é‡å€¼ã€‚ å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œå­—æ®µçš„å€¼è¢«åˆå§‹åŒ–ä¸º 0 ã€‚ HINCRBYFLOAT KEY_NAME FIELD_NAME INCR_BY_NUMBER è¿”å›æ‰§è¡Œ Hincrbyfloat å‘½ä»¤ä¹‹åï¼Œå“ˆå¸Œè¡¨ä¸­å­—æ®µçš„å€¼ã€‚\nhkeys hkeys å‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µåã€‚ HKEYS KEY_NAME FIELD_NAME INCR_BY_NUMBER åŒ…å«å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å­—æ®µçš„åˆ—è¡¨ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚\nhlen hlen å‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚ HLEN KEY_NAME è¿”å›å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0 ã€‚\nhmget hmget å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šå­—æ®µçš„å€¼ã€‚ å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨äºå“ˆå¸Œè¡¨ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª nil å€¼ã€‚ HMGET KEY_NAME FIELD1...FIELDN è¿”å›ä¸€ä¸ªåŒ…å«å¤šä¸ªç»™å®šå­—æ®µå…³è”å€¼çš„è¡¨ï¼Œè¡¨å€¼çš„æ’åˆ—é¡ºåºå’ŒæŒ‡å®šå­—æ®µçš„è¯·æ±‚é¡ºåºä¸€æ ·ã€‚\nhmset hmset å‘½ä»¤ç”¨äºåŒæ—¶å°†å¤šä¸ª field-value (å­—æ®µ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨ä¸­ã€‚ æ­¤å‘½ä»¤ä¼šè¦†ç›–å“ˆå¸Œè¡¨ä¸­å·²å­˜åœ¨çš„å­—æ®µã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç©ºå“ˆå¸Œè¡¨ï¼Œå¹¶æ‰§è¡Œ HMSET æ“ä½œã€‚ HMSET KEY_NAME FIELD1 VALUE1 ...FIELDN VALUEN\nhset hset å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µèµ‹å€¼ ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶è¿›è¡Œ HSET æ“ä½œã€‚ å¦‚æœå­—æ®µå·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œæ—§å€¼å°†è¢«è¦†ç›–ã€‚ HSET KEY_NAME FIELD VALUE è¿”å›å¦‚æœå­—æ®µæ˜¯å“ˆå¸Œè¡¨ä¸­çš„ä¸€ä¸ªæ–°å»ºå­—æ®µï¼Œå¹¶ä¸”å€¼è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸­åŸŸå­—æ®µå·²ç»å­˜åœ¨ä¸”æ—§å€¼å·²è¢«æ–°å€¼è¦†ç›–ï¼Œè¿”å› 0 ã€‚\nhsetnx hsetnx å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨çš„çš„å­—æ®µèµ‹å€¼ ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶è¿›è¡Œ HSET æ“ä½œã€‚ å¦‚æœå­—æ®µå·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œæ“ä½œæ— æ•ˆã€‚ å¦‚æœ key ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶æ‰§è¡Œ HSETNX å‘½ä»¤ã€‚ HSETNX KEY_NAME FIELD VALUE è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ å¦‚æœç»™å®šå­—æ®µå·²ç»å­˜åœ¨ä¸”æ²¡æœ‰æ“ä½œè¢«æ‰§è¡Œï¼Œè¿”å› 0 ã€‚\nhvals hvals å‘½ä»¤è¿”å›å“ˆå¸Œè¡¨æ‰€æœ‰å­—æ®µçš„å€¼ã€‚ HVALS KEY_NAME FIELD VALUE è¿”å›ä¸€ä¸ªåŒ…å«å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼çš„è¡¨ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªç©ºè¡¨ã€‚\nè¿æ¥æ“ä½œå‘½ä»¤ quitï¼šå…³é—­è¿æ¥ï¼ˆconnectionï¼‰ authï¼šç®€å•å¯†ç è®¤è¯ help cmdï¼š æŸ¥çœ‹cmdå¸®åŠ©ï¼Œä¾‹å¦‚ï¼šhelp quit\næŒä¹…åŒ– saveï¼šå°†æ•°æ®åŒæ­¥ä¿å­˜åˆ°ç£ç›˜ bgsaveï¼šå°†æ•°æ®å¼‚æ­¥ä¿å­˜åˆ°ç£ç›˜ lastsaveï¼šè¿”å›ä¸Šæ¬¡æˆåŠŸå°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜çš„Unixæ—¶æˆ³ shundownï¼šå°†æ•°æ®åŒæ­¥ä¿å­˜åˆ°ç£ç›˜ï¼Œç„¶åå…³é—­æœåŠ¡\nè¿œç¨‹æœåŠ¡æ§åˆ¶ infoï¼šæä¾›æœåŠ¡å™¨çš„ä¿¡æ¯å’Œç»Ÿè®¡ monitorï¼šå®æ—¶è½¬å‚¨æ”¶åˆ°çš„è¯·æ±‚ slaveofï¼šæ”¹å˜å¤åˆ¶ç­–ç•¥è®¾ç½® configï¼šåœ¨è¿è¡Œæ—¶é…ç½®RedisæœåŠ¡å™¨\nå¯¹valueæ“ä½œçš„å‘½ä»¤ exists(key)ï¼šç¡®è®¤ä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨ del(key)ï¼šåˆ é™¤ä¸€ä¸ªkey type(key)ï¼šè¿”å›å€¼çš„ç±»å‹ keys(pattern)ï¼šè¿”å›æ»¡è¶³ç»™å®špatternçš„æ‰€æœ‰key randomkeyï¼šéšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ª keyrename(oldname, newname)ï¼šé‡å‘½åkey dbsizeï¼šè¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°ç›® expireï¼šè®¾å®šä¸€ä¸ªkeyçš„æ´»åŠ¨æ—¶é—´ï¼ˆsï¼‰ ttlï¼šè·å¾—ä¸€ä¸ªkeyçš„æ´»åŠ¨æ—¶é—´ select(index)ï¼šæŒ‰ç´¢å¼•æŸ¥è¯¢ move(key, dbindex)ï¼šç§»åŠ¨å½“å‰æ•°æ®åº“ä¸­çš„keyåˆ°dbindexæ•°æ®åº“ flushdbï¼šåˆ é™¤å½“å‰é€‰æ‹©æ•°æ®åº“ä¸­çš„æ‰€æœ‰key flushallï¼šåˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key\nString set(key, value)ï¼šç»™æ•°æ®åº“ä¸­åç§°ä¸ºkeyçš„stringèµ‹äºˆå€¼value get(key)ï¼šè¿”å›æ•°æ®åº“ä¸­åç§°ä¸ºkeyçš„stringçš„value getset(key, value)ï¼šç»™åç§°ä¸ºkeyçš„stringèµ‹äºˆä¸Šä¸€æ¬¡çš„value mget(key1, key2,â€¦, key N)ï¼šè¿”å›åº“ä¸­å¤šä¸ªstringçš„value setnx(key, value)ï¼šæ·»åŠ stringï¼Œåç§°ä¸ºkeyï¼Œå€¼ä¸ºvalue setex(key, time, value)ï¼šå‘åº“ä¸­æ·»åŠ stringï¼Œè®¾å®šè¿‡æœŸæ—¶é—´time mset(key N, value N)ï¼šæ‰¹é‡è®¾ç½®å¤šä¸ªstringçš„å€¼ msetnx(key N, value N)ï¼šå¦‚æœæ‰€æœ‰åç§°ä¸ºkey içš„stringéƒ½ä¸å­˜åœ¨ incr(key)ï¼šåç§°ä¸ºkeyçš„stringå¢1æ“ä½œ incrby(key, integer)ï¼šåç§°ä¸ºkeyçš„stringå¢åŠ integer decr(key)ï¼šåç§°ä¸ºkeyçš„stringå‡1æ“ä½œ decrby(key, integer)ï¼šåç§°ä¸ºkeyçš„stringå‡å°‘integer append(key, value)ï¼šåç§°ä¸ºkeyçš„stringçš„å€¼é™„åŠ value substr(key, start, end)ï¼šè¿”å›åç§°ä¸ºkeyçš„stringçš„valueçš„å­ä¸²\nList rpush(key, value)ï¼šåœ¨åç§°ä¸ºkeyçš„listå°¾æ·»åŠ ä¸€ä¸ªå€¼ä¸ºvalueçš„å…ƒç´  lpush(key, value)ï¼šåœ¨åç§°ä¸ºkeyçš„listå¤´æ·»åŠ ä¸€ä¸ªå€¼ä¸ºvalueçš„ å…ƒç´  llen(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„listçš„é•¿åº¦ lrange(key, start, end)ï¼šè¿”å›åç§°ä¸ºkeyçš„listä¸­startè‡³endä¹‹é—´çš„å…ƒç´  ltrim(key, start, end)ï¼šæˆªå–åç§°ä¸ºkeyçš„list lindex(key, index)ï¼šè¿”å›åç§°ä¸ºkeyçš„listä¸­indexä½ç½®çš„å…ƒç´  lset(key, index, value)ï¼šç»™åç§°ä¸ºkeyçš„listä¸­indexä½ç½®çš„å…ƒç´ èµ‹å€¼ lrem(key, count, value)ï¼šåˆ é™¤countä¸ªkeyçš„listä¸­å€¼ä¸ºvalueçš„å…ƒç´  lpop(key)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„listä¸­çš„é¦–å…ƒç´  rpop(key)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„listä¸­çš„å°¾å…ƒç´  blpop(key1, key2,â€¦ key N, timeout)ï¼šlpopå‘½ä»¤çš„blockç‰ˆæœ¬ã€‚ brpop(key1, key2,â€¦ key N, timeout)ï¼šrpopçš„blockç‰ˆæœ¬ã€‚ rpoplpush(srckey, dstkey)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºsrckeyçš„listçš„å°¾å…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°åç§°ä¸ºdstkeyçš„listçš„å¤´éƒ¨\nSet sadd(key, member)ï¼šå‘åç§°ä¸ºkeyçš„setä¸­æ·»åŠ å…ƒç´ member srem(key, member) ï¼šåˆ é™¤åç§°ä¸ºkeyçš„setä¸­çš„å…ƒç´ member spop(key) ï¼šéšæœºè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„setä¸­ä¸€ä¸ªå…ƒç´  smove(srckey, dstkey, member) ï¼šç§»åˆ°é›†åˆå…ƒç´  scard(key) ï¼šè¿”å›åç§°ä¸ºkeyçš„setçš„åŸºæ•° sismember(key, member) ï¼šmemberæ˜¯å¦æ˜¯åç§°ä¸ºkeyçš„setçš„å…ƒç´  sinter(key1, key2,â€¦key N) ï¼šæ±‚äº¤é›† sinterstore(dstkey, (keys)) ï¼šæ±‚äº¤é›†å¹¶å°†äº¤é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ sunion(key1, (keys)) ï¼šæ±‚å¹¶é›† sunionstore(dstkey, (keys)) ï¼šæ±‚å¹¶é›†å¹¶å°†å¹¶é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ sdiff(key1, (keys)) ï¼šæ±‚å·®é›† sdiffstore(dstkey, (keys)) ï¼šæ±‚å·®é›†å¹¶å°†å·®é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ smembers(key) ï¼šè¿”å›åç§°ä¸ºkeyçš„setçš„æ‰€æœ‰å…ƒç´  srandmember(key) ï¼šéšæœºè¿”å›åç§°ä¸ºkeyçš„setçš„ä¸€ä¸ªå…ƒç´ \nHash hset(key, field, value)ï¼šå‘åç§°ä¸ºkeyçš„hashä¸­æ·»åŠ å…ƒç´ field hget(key, field)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­fieldå¯¹åº”çš„value hmget(key, (fields))ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­field iå¯¹åº”çš„value hmset(key, (fields))ï¼šå‘åç§°ä¸ºkeyçš„hashä¸­æ·»åŠ å…ƒç´ field hincrby(key, field, integer)ï¼šå°†åç§°ä¸ºkeyçš„hashä¸­fieldçš„valueå¢åŠ integer hexists(key, field)ï¼šåç§°ä¸ºkeyçš„hashä¸­æ˜¯å¦å­˜åœ¨é”®ä¸ºfieldçš„åŸŸ hdel(key, field)ï¼šåˆ é™¤åç§°ä¸ºkeyçš„hashä¸­é”®ä¸ºfieldçš„åŸŸ hlen(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­å…ƒç´ ä¸ªæ•° hkeys(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰é”® hvals(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰é”®å¯¹åº”çš„value hgetall(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰çš„é”®ï¼ˆfieldï¼‰åŠå…¶å¯¹åº”çš„value\nåŠŸèƒ½å®ç° ä½¿ç”¨RedisTemplate å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç  æœ€è¿‘ä½¿ç”¨spring-data-redis RedisTemplate æ“ä½œredisæ—¶å‘ç°å­˜å‚¨åœ¨redisä¸­çš„keyä¸æ˜¯è®¾ç½®çš„stringå€¼ï¼Œå‰é¢è¿˜å¤šå‡ºäº†è®¸å¤šç±»ä¼¼\\xac\\xed\\x00\\x05t\\x00è¿™ç§å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹\n1 2 3 4 127.0.0.1:6379\u003e keys * 1) \"\\xac\\xed\\x00\\x05t\\x00\\x04pass\" 2) \"\\xac\\xed\\x00\\x05t\\x00\\x04name\" 3) \"name\" è§£å†³ï¼šä½¿ç”¨StringRedisTemplateï¼Œè€Œä¸æ˜¯RedisTemplateã€‚\nRedisTemplateå’ŒStringRedisTemplateçš„åŒºåˆ« StringRedisTemplateç»§æ‰¿RedisTemplate StringRedisTemplateåªèƒ½ç®¡ç†StringRedisTemplateé‡Œé¢çš„æ•°æ®ï¼ŒRedisTemplateåªèƒ½ç®¡ç†RedisTemplateä¸­çš„æ•°æ®ã€‚ SDR(spring-date-redis)é»˜è®¤é‡‡ç”¨çš„åºåˆ—åŒ–ç­–ç•¥æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯Stringçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¸€ç§æ˜¯JDKçš„åºåˆ—åŒ–ç­–ç•¥ã€‚ StringRedisTemplateé»˜è®¤é‡‡ç”¨çš„æ˜¯Stringçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¿å­˜çš„keyå’Œvalueéƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„ã€‚ RedisTemplateé»˜è®¤é‡‡ç”¨çš„æ˜¯JDKçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¿å­˜çš„keyå’Œvalueéƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„ã€‚ RedisTemplateä½¿ç”¨çš„åºåˆ—ç±»åœ¨åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´å­˜å…¥æ•°æ®ä¼šå°†æ•°æ®å…ˆåºåˆ—åŒ–æˆå­—èŠ‚æ•°ç»„ç„¶ååœ¨å­˜å…¥Redisæ•°æ®åº“ï¼Œè¿™ä¸ªæ—¶å€™æ‰“å¼€RedisæŸ¥çœ‹çš„æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„æ•°æ®ä¸æ˜¯ä»¥å¯è¯»çš„å½¢å¼å±•ç°çš„ï¼Œè€Œæ˜¯ä»¥å­—èŠ‚æ•°ç»„æ˜¾ç¤ºï¼Œç±»ä¼¼ä¸‹é¢ key: \\xAC\\xED\\x00\\x05sr\\x00\nvalue: \\xAC\\xED\\x00\\x05sr\\x00\\x13java.util.ArrayList...\næ€»ç»“ï¼š å½“redisä¸­æœ¬æ¥å­˜çš„æ˜¯å­—ç¬¦ä¸²æ•°æ®ï¼Œæˆ–è€…ä½ è¦å­˜å–çš„æ•°æ®å°±æ˜¯å­—ç¬¦ä¸²ç±»å‹æ•°æ®çš„æ—¶å€™ï¼Œé‚£ä¹ˆä½ å°±ä½¿ç”¨StringRedisTemplateå³å¯ï¼Œä½†æ˜¯å¦‚æœä½ çš„æ•°æ®æ˜¯å¤æ‚çš„å¯¹è±¡ç±»å‹ï¼Œè€Œå–å‡ºçš„æ—¶å€™åˆä¸æƒ³åšä»»ä½•çš„æ•°æ®è½¬æ¢ï¼Œç›´æ¥ä»Redisé‡Œé¢å–å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä½¿ç”¨RedisTemplateæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚\né€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½ ä¿®æ”¹Redisé…ç½®æ–‡ä»¶ï¼Œå¼€å¯è¿‡æœŸé€šçŸ¥åŠŸèƒ½ã€‚ åœ¨é…ç½®æ–‡ä»¶ä¸­æœç´¢notifyï¼Œæ‰¾åˆ°# notify-keyspace-events Exè¿™ä¸€è¡Œï¼Œå°†æ³¨é‡Šå»æ‰ã€‚ åŒæ—¶æ³¨é‡Šæ‰ä¸‹é¢ä¸€è¡Œnotify-keyspace-events \"\"ï¼Œ ä¸ºäº†èŠ‚çº¦cupèµ„æºï¼Œäº‹ä»¶é€šçŸ¥é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œå³notify-keyspace-events \"\"\nä¿®æ”¹ä¹‹ååœ¨éœ€è¦é‡å¯redisï¼Œç„¶åé€šè¿‡cliæŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œconfig get notify-keyspace-eventsï¼Œå¦‚æœæ˜¾ç¤ºExï¼ˆæˆ–è€…xEï¼‰ï¼Œå°±ç”Ÿæ•ˆäº†ã€‚\nåœ¨ç¨‹åºä¸­ä½¿ç”¨redisï¼š\n1 2 3 //å¼•å…¥redis @Resource private RedisTemplate redisTemplate; è®¾ç½®key redisTemplate.opsForValue().set(orderNo, \"valueæ˜¯éšä¾¿å†™çš„ï¼Œå› ä¸ºè¿‡æœŸé€šçŸ¥æ— æ³•å–å¾—value\", 10, TimeUnit.SECONDS);\né…ç½®è¿‡æœŸç›‘å¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 @Slf4j @Component public class RedisTask extends KeyExpirationEventMessageListener { @Autowired private ExecuteHandle executeHandle; /** * * @param listenerContainer must not be {@literal null}. */ public RedisTask(RedisMessageListenerContainer listenerContainer) { super(listenerContainer); } @Override public void onMessage(Message message, byte[] pattern) { String channel = new String(message.getChannel(), StandardCharsets.UTF_8); //è¿‡æœŸçš„key String key = new String(message.getBody(), StandardCharsets.UTF_8); //åœ¨è¿™é‡Œï¼Œå¯ä»¥è¿‡æ»¤è°ƒæˆ‘ä»¬ä¸éœ€è¦çš„key if(key.startsWith(\"shiro_redis_session\")){ return; } log.info(\"redis key è¿‡æœŸï¼špattern={},channel={},key={}\",new String(pattern),channel,key); //ä¸šåŠ¡é€»è¾‘ï¼Œå–æ¶ˆè®¢å•ä»€ä¹ˆçš„ executeHandle.handle(key); } } å› ä¸ºæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šç±»å‹çš„è¿‡æœŸkeyï¼Œæ‰€ä»¥éœ€è¦åŒºåˆ†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 //å¤„ç†åŸºç±»ï¼Œ public abstract class AbstractRedisExpireHandle { //é€šè¿‡å‰ç¼€åŒºåˆ†è¿‡æœŸçš„key private String prefix; public String getPrefix() { return prefix; } public void setPrefix(String prefix) { this.prefix = prefix; } public AbstractRedisExpireHandle(){} //å¤„ç†redisè¿‡æœŸçš„key abstract void expireHandle(String redisKey); } /** * å•†å“è®¢å•è¿‡æœŸ */ @Component public class OrderExpireHandle extends AbstractRedisExpireHandle { private static final String PREFIX = \"12\"; public OrderExpireHandle(){ setPrefix(PREFIX); } @Reference(version = \"1.0.0\") private TaskService taskService; @Override void expireHandle(String redisKey) { //ä¸šåŠ¡é€»è¾‘ taskService.orderExpireHandle(redisKey); } } å…·ä½“å¤„ç†ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 @Slf4j @Component public class ExecuteHandle implements ApplicationContextAware, InitializingBean { //springå®¹å™¨ private ApplicationContext context; //è¿‡æœŸkeyå¤„ç†å™¨ private List expireHandles = new ArrayList\u003c\u003e(); /** * ç¨‹åºå¯åŠ¨ï¼Œå°†å„ä¸ªå¤„ç†ç±»ï¼Œæ”¾åˆ°listä¸­ * @throws Exception */ @Override public void afterPropertiesSet() throws Exception { String[] beanNames = BeanFactoryUtils.beanNamesForTypeIncludingAncestors(context,AbstractRedisExpireHandle.class); for(int i=0;i",
  "wordCount" : "42619",
  "inLanguage": "en",
  "datePublished": "2018-10-06T18:10:43Z",
  "dateModified": "2018-10-06T18:10:43Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/posts/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml-full.min.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      redis
    </h1>
    <div class="post-meta"><span title='2018-10-06 18:10:43 +0000 UTC'>2018-10-06</span>&nbsp;Â·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e6%a6%82%e5%bf%b5" aria-label="æ¦‚å¿µ">æ¦‚å¿µ</a><ul>
                        
                <li>
                    <a href="#redis%e7%bc%93%e5%ad%98%e7%a9%bf%e9%80%8f" aria-label="redisç¼“å­˜ç©¿é€">redisç¼“å­˜ç©¿é€</a></li>
                <li>
                    <a href="#%e7%bc%93%e5%ad%98%e9%9b%aa%e5%b4%a9" aria-label="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</a></li>
                <li>
                    <a href="#%e7%bc%93%e5%ad%98%e5%87%bb%e7%a9%bf" aria-label="ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85redis" aria-label="å®‰è£…redis">å®‰è£…redis</a><ul>
                        
                <li>
                    <a href="#linux%e5%ae%89%e8%a3%85redis" aria-label="linuxå®‰è£…redis">linuxå®‰è£…redis</a><ul>
                        
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5redis" aria-label="è¿æ¥redis">è¿æ¥redis</a></li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%aeredis" aria-label="é…ç½®redis">é…ç½®redis</a></li>
                <li>
                    <a href="#%e5%a6%82%e4%bd%95%e5%81%9c%e6%ad%a2%e5%90%af%e5%8a%a8%e9%87%8d%e5%90%afredis%e6%9c%8d%e5%8a%a1" aria-label="å¦‚ä½•åœæ­¢/å¯åŠ¨/é‡å¯redisæœåŠ¡">å¦‚ä½•åœæ­¢/å¯åŠ¨/é‡å¯redisæœåŠ¡</a></li></ul>
                </li>
                <li>
                    <a href="#windows%e5%ae%89%e8%a3%85redis5x" aria-label="windowså®‰è£…redis5.x">windowså®‰è£…redis5.x</a></li></ul>
                </li>
                <li>
                    <a href="#redis%e5%91%bd%e4%bb%a4" aria-label="rediså‘½ä»¤">rediså‘½ä»¤</a><ul>
                        
                <li>
                    <a href="#key" aria-label="key">key</a><ul>
                        
                <li>
                    <a href="#del" aria-label="del">del</a></li>
                <li>
                    <a href="#dump" aria-label="dump">dump</a></li>
                <li>
                    <a href="#exist" aria-label="exist">exist</a></li>
                <li>
                    <a href="#expire" aria-label="expire">expire</a></li>
                <li>
                    <a href="#expireat" aria-label="expireat">expireat</a></li>
                <li>
                    <a href="#keys" aria-label="keys">keys</a></li>
                <li>
                    <a href="#move" aria-label="move">move</a></li>
                <li>
                    <a href="#persist" aria-label="persist">persist</a></li>
                <li>
                    <a href="#pttl" aria-label="pttl">pttl</a></li>
                <li>
                    <a href="#ttl" aria-label="TTL">TTL</a></li>
                <li>
                    <a href="#randomkey" aria-label="randomkey">randomkey</a></li>
                <li>
                    <a href="#rename" aria-label="rename">rename</a></li>
                <li>
                    <a href="#renamenx" aria-label="renamenx">renamenx</a></li>
                <li>
                    <a href="#type" aria-label="type">type</a></li></ul>
                </li>
                <li>
                    <a href="#string" aria-label="string">string</a><ul>
                        
                <li>
                    <a href="#set" aria-label="set">set</a></li>
                <li>
                    <a href="#get" aria-label="get">get</a></li>
                <li>
                    <a href="#getrange" aria-label="getrange">getrange</a></li>
                <li>
                    <a href="#getset" aria-label="getset">getset</a></li>
                <li>
                    <a href="#getbit" aria-label="getbit">getbit</a></li>
                <li>
                    <a href="#setbit" aria-label="setbit">setbit</a></li>
                <li>
                    <a href="#mget" aria-label="mget">mget</a></li>
                <li>
                    <a href="#setex" aria-label="setex">setex</a></li>
                <li>
                    <a href="#setnx" aria-label="setnx">setnx</a></li>
                <li>
                    <a href="#setrange" aria-label="setrange">setrange</a></li>
                <li>
                    <a href="#strlen" aria-label="strlen">strlen</a></li>
                <li>
                    <a href="#mset" aria-label="mset">mset</a></li>
                <li>
                    <a href="#msetnx" aria-label="msetnx">msetnx</a></li>
                <li>
                    <a href="#psetex" aria-label="psetex">psetex</a></li>
                <li>
                    <a href="#incr" aria-label="incr">incr</a></li>
                <li>
                    <a href="#incrby" aria-label="incrby">incrby</a></li>
                <li>
                    <a href="#incrbyfloat" aria-label="incrbyfloat">incrbyfloat</a></li>
                <li>
                    <a href="#decr" aria-label="decr">decr</a></li>
                <li>
                    <a href="#decrby" aria-label="decrby">decrby</a></li>
                <li>
                    <a href="#append" aria-label="append">append</a></li></ul>
                </li>
                <li>
                    <a href="#hash" aria-label="hash">hash</a><ul>
                        
                <li>
                    <a href="#hdel" aria-label="hdel">hdel</a></li>
                <li>
                    <a href="#hexists" aria-label="hexists">hexists</a></li>
                <li>
                    <a href="#hget" aria-label="hget">hget</a></li>
                <li>
                    <a href="#hgetall" aria-label="hgetall">hgetall</a></li>
                <li>
                    <a href="#hincrby" aria-label="hincrby">hincrby</a></li>
                <li>
                    <a href="#hincrbyfloat" aria-label="hincrbyfloat">hincrbyfloat</a></li>
                <li>
                    <a href="#hkeys" aria-label="hkeys">hkeys</a></li>
                <li>
                    <a href="#hlen" aria-label="hlen">hlen</a></li>
                <li>
                    <a href="#hmget" aria-label="hmget">hmget</a></li>
                <li>
                    <a href="#hmset" aria-label="hmset">hmset</a></li>
                <li>
                    <a href="#hset" aria-label="hset">hset</a></li>
                <li>
                    <a href="#hsetnx" aria-label="hsetnx">hsetnx</a></li>
                <li>
                    <a href="#hvals" aria-label="hvals">hvals</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%bf%9e%e6%8e%a5%e6%93%8d%e4%bd%9c%e5%91%bd%e4%bb%a4" aria-label="è¿æ¥æ“ä½œå‘½ä»¤">è¿æ¥æ“ä½œå‘½ä»¤</a></li>
                <li>
                    <a href="#%e6%8c%81%e4%b9%85%e5%8c%96" aria-label="æŒä¹…åŒ–">æŒä¹…åŒ–</a></li>
                <li>
                    <a href="#%e8%bf%9c%e7%a8%8b%e6%9c%8d%e5%8a%a1%e6%8e%a7%e5%88%b6" aria-label="è¿œç¨‹æœåŠ¡æ§åˆ¶">è¿œç¨‹æœåŠ¡æ§åˆ¶</a></li>
                <li>
                    <a href="#%e5%af%b9value%e6%93%8d%e4%bd%9c%e7%9a%84%e5%91%bd%e4%bb%a4" aria-label="å¯¹valueæ“ä½œçš„å‘½ä»¤">å¯¹valueæ“ä½œçš„å‘½ä»¤</a></li>
                <li>
                    <a href="#string-1" aria-label="String">String</a></li>
                <li>
                    <a href="#list" aria-label="List">List</a></li>
                <li>
                    <a href="#set-1" aria-label="Set">Set</a></li>
                <li>
                    <a href="#hash-1" aria-label="Hash">Hash</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%8a%9f%e8%83%bd%e5%ae%9e%e7%8e%b0" aria-label="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</a><ul>
                        
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8redistemplate-%e5%ad%98%e5%82%a8%e9%94%ae%e5%80%bc%e5%87%ba%e7%8e%b0%e4%b9%b1%e7%a0%81" aria-label="ä½¿ç”¨RedisTemplate å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç ">ä½¿ç”¨RedisTemplate å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç </a></li>
                <li>
                    <a href="#redistemplate%e5%92%8cstringredistemplate%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="RedisTemplateå’ŒStringRedisTemplateçš„åŒºåˆ«">RedisTemplateå’ŒStringRedisTemplateçš„åŒºåˆ«</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87notify-keyspace-events%e5%ae%9e%e7%8e%b0%e8%ae%a2%e5%8d%95%e8%87%aa%e5%8a%a8%e5%85%b3%e9%97%ad%e5%8a%9f%e8%83%bd" aria-label="é€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½">é€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½</a></li>
                <li>
                    <a href="#redis%e5%93%a8%e5%85%b5" aria-label="rediså“¨å…µ">rediså“¨å…µ</a><ul>
                        
                <li>
                    <a href="#java%e4%b8%ad%e4%bd%bf%e7%94%a8%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f" aria-label="Javaä¸­ä½¿ç”¨å“¨å…µæ¨¡å¼">Javaä¸­ä½¿ç”¨å“¨å…µæ¨¡å¼</a></li>
                <li>
                    <a href="#%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f%e7%9a%84%e5%85%b6%e4%bb%96%e9%85%8d%e7%bd%ae%e9%a1%b9" aria-label="å“¨å…µæ¨¡å¼çš„å…¶ä»–é…ç½®é¡¹">å“¨å…µæ¨¡å¼çš„å…¶ä»–é…ç½®é¡¹</a></li></ul>
                </li>
                <li>
                    <a href="#redis%e4%b8%bb%e4%bb%8e%e9%85%8d%e7%bd%ae%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8fdocker%e5%ae%9e%e7%8e%b0" aria-label="Redisä¸»ä»é…ç½®ã€å“¨å…µæ¨¡å¼ï¼ˆDockerå®ç°ï¼‰">Redisä¸»ä»é…ç½®ã€å“¨å…µæ¨¡å¼ï¼ˆDockerå®ç°ï¼‰</a><ul>
                        
                <li>
                    <a href="#%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f" aria-label="å“¨å…µæ¨¡å¼">å“¨å…µæ¨¡å¼</a></li></ul>
                </li>
                <li>
                    <a href="#redisson-%e5%ae%9e%e7%8e%b0%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81" aria-label="redisson å®ç°åˆ†å¸ƒå¼é”">redisson å®ç°åˆ†å¸ƒå¼é”</a><ul>
                        
                <li>
                    <a href="#1-%e5%bc%95%e5%85%a5%e4%be%9d%e8%b5%96" aria-label="1. å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–</a></li>
                <li>
                    <a href="#2-%e9%85%8d%e7%bd%aeredis" aria-label="2. é…ç½®Redis">2. é…ç½®Redis</a></li>
                <li>
                    <a href="#3-%e9%85%8d%e7%bd%ae%e7%b1%bb" aria-label="3. é…ç½®ç±»">3. é…ç½®ç±»</a></li>
                <li>
                    <a href="#4-%e4%bd%bf%e7%94%a8redisson%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81" aria-label="4. ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”">4. ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”</a></li>
                <li>
                    <a href="#waittime-%e7%ad%89%e5%be%85%e6%97%b6%e9%97%b4" aria-label="waitTime (ç­‰å¾…æ—¶é—´)">waitTime (ç­‰å¾…æ—¶é—´)</a></li>
                <li>
                    <a href="#leasetime-%e6%8c%81%e6%9c%89%e6%97%b6%e9%97%b4" aria-label="leaseTime (æŒæœ‰æ—¶é—´)">leaseTime (æŒæœ‰æ—¶é—´)</a></li></ul>
                </li>
                <li>
                    <a href="#redis-setnx-%e5%91%bd%e4%bb%a4%e5%ae%9e%e7%8e%b0%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81%e4%b8%8d%e6%8e%a8%e8%8d%90%e8%af%b7%e4%bd%bf%e7%94%a8redisson" aria-label="Redis SETNX å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ï¼ˆä¸æ¨èï¼Œè¯·ä½¿ç”¨redissonï¼‰">Redis SETNX å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ï¼ˆä¸æ¨èï¼Œè¯·ä½¿ç”¨redissonï¼‰</a></li>
                <li>
                    <a href="#redis-key%e7%9a%84%e8%ae%be%e8%ae%a1" aria-label="redis keyçš„è®¾è®¡">redis keyçš„è®¾è®¡</a></li></ul>
                </li>
                <li>
                    <a href="#jedis%e6%93%8d%e4%bd%9credis" aria-label="Jedisæ“ä½œredis">Jedisæ“ä½œredis</a><ul>
                        
                <li>
                    <a href="#%e5%88%9d%e5%a7%8b%e5%8c%96" aria-label="åˆå§‹åŒ–">åˆå§‹åŒ–</a></li>
                <li>
                    <a href="#key-1" aria-label="key">key</a></li>
                <li>
                    <a href="#string-2" aria-label="string">string</a></li>
                <li>
                    <a href="#list-1" aria-label="list">list</a></li>
                <li>
                    <a href="#set-2" aria-label="set">set</a></li>
                <li>
                    <a href="#sortedset" aria-label="SortedSet">SortedSet</a></li>
                <li>
                    <a href="#hash-2" aria-label="hash">hash</a></li></ul>
                </li>
                <li>
                    <a href="#redistemplate" aria-label="Redistemplate">Redistemplate</a><ul>
                        
                <li>
                    <a href="#%e7%ae%80%e4%bb%8b" aria-label="ç®€ä»‹">ç®€ä»‹</a></li>
                <li>
                    <a href="#%e6%95%b4%e5%90%88spring-boot" aria-label="æ•´åˆspring boot">æ•´åˆspring boot</a></li>
                <li>
                    <a href="#redistemplate%e6%93%8d%e4%bd%9credis" aria-label="RedisTemplateæ“ä½œRedis">RedisTemplateæ“ä½œRedis</a><ul>
                        
                <li>
                    <a href="#%e9%80%9a%e7%94%a8%e6%93%8d%e4%bd%9c" aria-label="é€šç”¨æ“ä½œ">é€šç”¨æ“ä½œ</a></li>
                <li>
                    <a href="#string-3" aria-label="string">string</a></li>
                <li>
                    <a href="#list-2" aria-label="list">list</a></li>
                <li>
                    <a href="#hash-3" aria-label="hash">hash</a></li>
                <li>
                    <a href="#set-3" aria-label="set">set</a></li>
                <li>
                    <a href="#zset" aria-label="zSet">zSet</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#redis%e5%bc%80%e5%8f%91%e8%a7%84%e8%8c%83" aria-label="rediså¼€å‘è§„èŒƒ">rediså¼€å‘è§„èŒƒ</a><ul>
                        
                <li>
                    <a href="#key%e5%90%8d%e8%ae%be%e8%ae%a1" aria-label="keyåè®¾è®¡">keyåè®¾è®¡</a></li>
                <li>
                    <a href="#value%e8%ae%be%e8%ae%a1" aria-label="valueè®¾è®¡">valueè®¾è®¡</a></li>
                <li>
                    <a href="#%e5%91%bd%e4%bb%a4%e4%bd%bf%e7%94%a8" aria-label="å‘½ä»¤ä½¿ç”¨">å‘½ä»¤ä½¿ç”¨</a></li>
                <li>
                    <a href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e4%bd%bf%e7%94%a8" aria-label="å®¢æˆ·ç«¯ä½¿ç”¨">å®¢æˆ·ç«¯ä½¿ç”¨</a></li></ul>
                </li>
                <li>
                    <a href="#redis-%e6%8c%81%e4%b9%85%e5%8c%96%e7%ad%96%e7%95%a5%e6%b5%85%e6%9e%90" aria-label="Redis æŒä¹…åŒ–ç­–ç•¥æµ…æ">Redis æŒä¹…åŒ–ç­–ç•¥æµ…æ</a><ul>
                        
                <li>
                    <a href="#rdb%e6%8c%81%e4%b9%85%e5%8c%96" aria-label="RDBæŒä¹…åŒ–">RDBæŒä¹…åŒ–</a><ul>
                        
                <li>
                    <a href="#rdb-%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84" aria-label="RDB æ–‡ä»¶ç»“æ„">RDB æ–‡ä»¶ç»“æ„</a></li>
                <li>
                    <a href="#rdb-%e6%96%87%e4%bb%b6%e7%9a%84%e5%88%9b%e5%bb%ba%e6%89%8b%e5%8a%a8%e6%8c%87%e4%bb%a4%e8%a7%a6%e5%8f%91" aria-label="RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘ï¼‰">RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘ï¼‰</a></li>
                <li>
                    <a href="#rdb-%e6%96%87%e4%bb%b6%e7%9a%84%e5%88%9b%e5%bb%ba%e8%87%aa%e5%8a%a8%e9%97%b4%e9%9a%94%e6%80%a7%e4%bf%9d%e5%ad%98" aria-label="RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆè‡ªåŠ¨é—´éš”æ€§ä¿å­˜ï¼‰">RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆè‡ªåŠ¨é—´éš”æ€§ä¿å­˜ï¼‰</a></li>
                <li>
                    <a href="#%e8%87%aa%e5%8a%a8%e4%bf%9d%e5%ad%98%e9%85%8d%e7%bd%ae%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="è‡ªåŠ¨ä¿å­˜é…ç½®çš„æ•°æ®ç»“æ„">è‡ªåŠ¨ä¿å­˜é…ç½®çš„æ•°æ®ç»“æ„</a></li>
                <li>
                    <a href="#%e5%a4%87%e4%bb%bd%e8%bf%87%e7%a8%8b" aria-label="å¤‡ä»½è¿‡ç¨‹">å¤‡ä»½è¿‡ç¨‹</a></li>
                <li>
                    <a href="#fork-%e5%ad%90%e8%bf%9b%e7%a8%8b%e7%9a%84%e4%bd%9c%e7%94%a8" aria-label="Fork å­è¿›ç¨‹çš„ä½œç”¨">Fork å­è¿›ç¨‹çš„ä½œç”¨</a></li></ul>
                </li>
                <li>
                    <a href="#aof-%e6%8c%81%e4%b9%85%e5%8c%96" aria-label="AOF æŒä¹…åŒ–">AOF æŒä¹…åŒ–</a><ul>
                        
                <li>
                    <a href="#aof-%e6%96%87%e4%bb%b6%e5%86%85%e5%ae%b9" aria-label="AOF æ–‡ä»¶å†…å®¹">AOF æ–‡ä»¶å†…å®¹</a></li>
                <li>
                    <a href="#aof-%e6%8c%81%e4%b9%85%e5%8c%96%e5%ae%9e%e7%8e%b0" aria-label="AOF æŒä¹…åŒ–å®ç°">AOF æŒä¹…åŒ–å®ç°</a></li>
                <li>
                    <a href="#aof-%e9%87%8d%e5%86%99" aria-label="AOF é‡å†™">AOF é‡å†™</a></li></ul>
                </li>
                <li>
                    <a href="#aof-%e4%b8%8e-wal" aria-label="AOF ä¸ WAL">AOF ä¸ WAL</a></li>
                <li>
                    <a href="#aof-%e5%92%8c-rdb-%e4%b9%8b%e9%97%b4%e7%9a%84%e7%9b%b8%e4%ba%92%e4%bd%9c%e7%94%a8" aria-label="AOF å’Œ RDB ä¹‹é—´çš„ç›¸äº’ä½œç”¨">AOF å’Œ RDB ä¹‹é—´çš„ç›¸äº’ä½œç”¨</a></li>
                <li>
                    <a href="#%e6%b7%b7%e5%90%88%e6%8c%81%e4%b9%85%e5%8c%96" aria-label="æ··åˆæŒä¹…åŒ–">æ··åˆæŒä¹…åŒ–</a></li>
                <li>
                    <a href="#%e6%80%bb%e7%bb%93" aria-label="æ€»ç»“">æ€»ç»“</a></li></ul>
                </li>
                <li>
                    <a href="#redis%e5%a4%a7key%e5%a4%84%e7%90%86" aria-label="rediså¤§keyå¤„ç†">rediså¤§keyå¤„ç†</a><ul>
                        
                <li>
                    <a href="#%e8%83%8c%e6%99%af" aria-label="èƒŒæ™¯">èƒŒæ™¯</a></li>
                <li>
                    <a href="#%e5%a4%a7key%e8%a7%a3%e5%86%b3%e6%89%8b%e6%ae%b5" aria-label="å¤§keyè§£å†³æ‰‹æ®µ">å¤§keyè§£å†³æ‰‹æ®µ</a><ul>
                        
                <li>
                    <a href="#%e5%8e%86%e5%8f%b2key%e6%9c%aa%e4%bd%bf%e7%94%a8" aria-label="å†å²keyæœªä½¿ç”¨">å†å²keyæœªä½¿ç”¨</a></li>
                <li>
                    <a href="#%e5%85%83%e7%b4%a0%e6%95%b0%e8%bf%87%e5%a4%9a" aria-label="å…ƒç´ æ•°è¿‡å¤š">å…ƒç´ æ•°è¿‡å¤š</a></li>
                <li>
                    <a href="#%e5%a4%a7%e5%af%b9%e8%b1%a1%e8%bd%ac%e6%8d%a2%e5%ad%98%e5%82%a8%e5%bd%a2%e5%bc%8f" aria-label="å¤§å¯¹è±¡è½¬æ¢å­˜å‚¨å½¢å¼">å¤§å¯¹è±¡è½¬æ¢å­˜å‚¨å½¢å¼</a></li>
                <li>
                    <a href="#%e5%8e%8b%e7%bc%a9%e5%ad%98%e5%82%a8%e6%95%b0%e6%8d%ae" aria-label="å‹ç¼©å­˜å‚¨æ•°æ®">å‹ç¼©å­˜å‚¨æ•°æ®</a></li>
                <li>
                    <a href="#%e6%9b%bf%e6%8d%a2%e5%ad%98%e5%82%a8%e6%96%b9%e6%a1%88" aria-label="æ›¿æ¢å­˜å‚¨æ–¹æ¡ˆ">æ›¿æ¢å­˜å‚¨æ–¹æ¡ˆ</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%80%bb%e7%bb%93-1" aria-label="æ€»ç»“">æ€»ç»“</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>redisæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œæ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“ã€‚</p>
<h1 id="æ¦‚å¿µ">æ¦‚å¿µ<a hidden class="anchor" aria-hidden="true" href="#æ¦‚å¿µ">#</a></h1>
<p>ç¼“å­˜å¤„ç†æµç¨‹
å‰å°è¯·æ±‚ï¼Œåå°å…ˆä»ç¼“å­˜ä¸­å–æ•°æ®ï¼Œå–åˆ°ç›´æ¥è¿”å›ç»“æœï¼Œå–ä¸åˆ°æ—¶ä»æ•°æ®åº“ä¸­å–ï¼Œæ•°æ®åº“å–åˆ°æ›´æ–°ç¼“å­˜ï¼Œå¹¶è¿”å›ç»“æœï¼Œæ•°æ®åº“ä¹Ÿæ²¡å–åˆ°ï¼Œé‚£ç›´æ¥è¿”å›ç©ºç»“æœã€‚</p>
<h2 id="redisç¼“å­˜ç©¿é€">redisç¼“å­˜ç©¿é€<a hidden class="anchor" aria-hidden="true" href="#redisç¼“å­˜ç©¿é€">#</a></h2>
<p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡ï¼šç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ï¼Œå¦‚å‘èµ·ä¸ºidä¸ºâ€œ-1â€çš„æ•°æ®æˆ–idä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ã€‚
è§£å†³æ–¹æ¡ˆï¼š
æ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¦‚ç”¨æˆ·é‰´æƒæ ¡éªŒï¼ŒidåšåŸºç¡€æ ¡éªŒï¼Œid&lt;=0çš„ç›´æ¥æ‹¦æˆªï¼›
ä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°†key-valueå¯¹å†™ä¸ºkey-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚30ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ”»å‡»ç”¨æˆ·åå¤ç”¨åŒä¸€ä¸ªidæš´åŠ›æ”»å‡»ã€‚</p>
<h2 id="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©<a hidden class="anchor" aria-hidden="true" href="#ç¼“å­˜é›ªå´©">#</a></h2>
<p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ï¼šç¼“å­˜ä¸­æ•°æ®å¤§æ‰¹é‡åˆ°è¿‡æœŸæ—¶é—´ï¼Œè€ŒæŸ¥è¯¢æ•°æ®é‡å·¨å¤§ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³å®•æœºã€‚å’Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸åŒæ•°æ®éƒ½è¿‡æœŸäº†ï¼Œå¾ˆå¤šæ•°æ®éƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚
è§£å†³æ–¹æ¡ˆï¼š
ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚
å¦‚æœç¼“å­˜æ•°æ®åº“æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œå°†çƒ­ç‚¹æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒæå¾—ç¼“å­˜æ•°æ®åº“ä¸­ã€‚
è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</p>
<h2 id="ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿<a hidden class="anchor" aria-hidden="true" href="#ç¼“å­˜å‡»ç©¿">#</a></h2>
<p>ç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚ç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ã€‚
è§£å†³æ–¹æ¡ˆï¼š
è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚
åŠ äº’æ–¥é”ï¼Œäº’æ–¥é”å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> String getData(String key) <span style="color:#fff;font-weight:bold">throws</span> InterruptedException{
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//ä»ç¼“å­˜ä¸­è¯»å–æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    String result = getDataFromRedis(key);
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//ç¼“å­˜ä¸­ä¸å­˜åœ¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(<span style="color:#fff;font-weight:bold">null</span> == result){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//è·å–é”ï¼Œè·å–æˆåŠŸï¼Œå–æ•°æ®åº“è·å–æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span>(reenLock.<span style="color:#007f7f">tryLock</span>()){
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//ä»æ•°æ®åº“è·å–æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            result = getDataFrom Mysql(key);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//æ›´æ–°ç¼“å­˜æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span>(<span style="color:#fff;font-weight:bold">null</span> != result){
</span></span><span style="display:flex;"><span>                setDataToCache(key,result);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//é‡Šæ”¾é”
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            reenLock.<span style="color:#007f7f">unlock</span>();
</span></span><span style="display:flex;"><span>        }<span style="color:#fff;font-weight:bold">else</span>{<span style="color:#007f7f">//è·å–é”å¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#007f7f">//æš‚åœ100mså†é‡æ–°è·å–æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">100</span>);
</span></span><span style="display:flex;"><span>            result = getData(key);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼š</p>
<ul>
<li>ç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œç›´æ¥èµ°ä¸Šè¿°ä»£ç 13è¡Œåå°±è¿”å›ç»“æœäº†</li>
<li>ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼Œç¬¬1ä¸ªè¿›å…¥çš„çº¿ç¨‹ï¼Œè·å–é”å¹¶ä»æ•°æ®åº“å»å–æ•°æ®ï¼Œæ²¡é‡Šæ”¾é”ä¹‹å‰ï¼Œå…¶ä»–å¹¶è¡Œè¿›å…¥çš„çº¿ç¨‹ä¼šç­‰å¾…100msï¼Œå†é‡æ–°å»ç¼“å­˜å–æ•°æ®ã€‚è¿™æ ·å°±é˜²æ­¢éƒ½å»æ•°æ®åº“é‡å¤å–æ•°æ®ï¼Œé‡å¤å¾€ç¼“å­˜ä¸­æ›´æ–°æ•°æ®æƒ…å†µå‡ºç°ã€‚</li>
<li>å½“ç„¶è¿™æ˜¯ç®€åŒ–å¤„ç†ï¼Œç†è®ºä¸Šå¦‚æœèƒ½æ ¹æ®keyå€¼åŠ é”å°±æ›´å¥½äº†ï¼Œå°±æ˜¯çº¿ç¨‹Aä»æ•°æ®åº“å–key1çš„æ•°æ®å¹¶ä¸å¦¨ç¢çº¿ç¨‹Bå–key2çš„æ•°æ®ï¼Œä¸Šé¢ä»£ç æ˜æ˜¾åšä¸åˆ°è¿™ç‚¹ã€‚</li>
</ul>
<h1 id="å®‰è£…redis">å®‰è£…redis<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…redis">#</a></h1>
<h2 id="linuxå®‰è£…redis">linuxå®‰è£…redis<a hidden class="anchor" aria-hidden="true" href="#linuxå®‰è£…redis">#</a></h2>
<h3 id="è¿æ¥redis">è¿æ¥redis<a hidden class="anchor" aria-hidden="true" href="#è¿æ¥redis">#</a></h3>
<p><code>./redis-cli</code>
<code>127.0.0.1:6379&gt;</code></p>
<h3 id="é…ç½®redis">é…ç½®redis<a hidden class="anchor" aria-hidden="true" href="#é…ç½®redis">#</a></h3>
<p>redisçš„é…ç½®æ–‡ä»¶ä½äºRediså®‰è£…ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸º redis.confï¼Œå¯ä»¥é€šè¿‡CONFIGå‘½ä»¤æŸ¥çœ‹æˆ–è€…è®¾ç½®é…ç½®é¡¹ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>127.0.0.1:6379&gt; config get loglevel
</span></span><span style="display:flex;"><span>1) &#34;loglevel&#34;
</span></span><span style="display:flex;"><span>2) &#34;notice&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨<code>*</code>è·å–æ‰€æœ‰é…ç½®é¡¹
<code>config get *</code>
å¾ˆå¤šé…ç½®ï¼Œè¿™é‡Œå°±ä¸è´´äº†ã€‚<a href="https://www.cnblogs.com/ruanraun/p/redis.html">å‚è€ƒè¿™é‡Œ</a>
å¯ä»¥é€šè¿‡ä¿®æ”¹redis.confæ–‡ä»¶æˆ–è€…ä½¿ç”¨config set å‘½ä»¤æ¥ä¿®æ”¹é…ç½®</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>127.0.0.1:6379&gt; config set loglevel &#39;notice&#39;
</span></span><span style="display:flex;"><span>OK
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¦‚ä½•åœæ­¢å¯åŠ¨é‡å¯redisæœåŠ¡">å¦‚ä½•åœæ­¢/å¯åŠ¨/é‡å¯redisæœåŠ¡<a hidden class="anchor" aria-hidden="true" href="#å¦‚ä½•åœæ­¢å¯åŠ¨é‡å¯redisæœåŠ¡">#</a></h3>
<p>å¦‚æœæ˜¯ç”¨apt-getæˆ–è€…yum installå®‰è£…çš„redisï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤åœæ­¢/å¯åŠ¨/é‡å¯redis</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>/etc/init.d/redis-server stop
</span></span><span style="display:flex;"><span>/etc/init.d/redis-server start
</span></span><span style="display:flex;"><span>/etc/init.d/redis-server restart
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæ˜¯é€šè¿‡æºç å®‰è£…çš„redisï¼Œå¯ä»¥é€šè¿‡redisçš„å®¢æˆ·ç«¯ç¨‹åºredis-cliçš„shutdownå‘½ä»¤æ¥åœæ­¢redis</p>
<p><code>redis-cli -h 127.0.0.1 -p 6379 shutdown</code>
æˆ–
<code>./redis-cli shutdown</code>
æ²¡é”™ï¼Œè™½ç„¶å¯åŠ¨çš„æ˜¯serverï¼Œä½†æ˜¯è¿™é‡Œåœæ­¢çš„æ˜¯<code>redis-cli</code>
å¦‚æœä¸Šè¿°æ–¹å¼éƒ½æ²¡æœ‰æˆåŠŸåœæ­¢redisï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç»ˆææ­¦å™¨ kill -9</p>
<p>å¯åŠ¨redisï¼š
<code>cd src</code>
<code>./redis-server</code>
ä¸Šé¢è¿™ç§å¯åŠ¨redisä½¿ç”¨çš„æ˜¯é»˜è®¤é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°å‘Šè¯‰redisä½¿ç”¨æŒ‡å®šé…ç½®
<code>./redis-server ../redis.conf</code></p>
<p>è®©redisåå°è¿è¡Œ
<code>./redis-server &amp;</code>
ç„¶åè¾“å…¥<code>bg</code></p>
<h2 id="windowså®‰è£…redis5x">windowså®‰è£…redis5.x<a hidden class="anchor" aria-hidden="true" href="#windowså®‰è£…redis5x">#</a></h2>
<p><a href="https://www.cnblogs.com/clis/p/14396338.html">å‚è€ƒ</a>
ä¸‹è½½åœ°å€ï¼šhttps://github.com/tporadowski/redis/releases
è¿™é‡Œä¸‹è½½çš„æ˜¯ Redis-x64-5.0.10.msi
ç›´æ¥å®‰è£…ï¼Œå®‰è£…è¿‡ç¨‹å‹¾é€‰æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå…¶ä»–éƒ½ nextã€‚
å®‰è£…ç›®å½•ä¸‹ï¼Œgit bushæ‰§è¡Œå‘½ä»¤ï¼š
<code>./redis-server.exe redis.windows.conf</code></p>
<p>å¦‚æœæ˜¾ç¤ºï¼š
<code>Redis is starting</code>
å°±æ˜¯rediså·²ç»åœ¨è¿è¡Œäº†ã€‚ä¸¤ç§è§£å†³åŠæ³•ï¼š</p>
<ul>
<li>è¿è¡Œrediså®‰è£…ç›®å½•çš„<code>redis-cli.exe</code>ï¼Œ<code>shutdown</code>ï¼Œæ˜¾ç¤º<code>not connected&gt;exit</code>ã€‚</li>
<li>æ‰¾åˆ°windowsæœåŠ¡ï¼Œæ‰¾åˆ°redisï¼Œåœæ­¢ï¼Œç¦ç”¨è‡ªå¯ã€‚</li>
</ul>
<p>redisè®¾ç½®å¯†ç ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ redis.windows.confï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># requirepass foobared
</span></span><span style="display:flex;"><span>requirepass 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹‹åå¯åŠ¨ redis éœ€è¦æŒ‡å®šé…ç½®æ–‡ä»¶ï¼š
<code>redis-server.exe redis.windows.conf</code></p>
<h1 id="rediså‘½ä»¤">rediså‘½ä»¤<a hidden class="anchor" aria-hidden="true" href="#rediså‘½ä»¤">#</a></h1>
<p><a href="https://www.redis.net.cn/">å‚è€ƒredisä¸­æ–‡å®˜ç½‘</a></p>
<h2 id="key">key<a hidden class="anchor" aria-hidden="true" href="#key">#</a></h2>
<h3 id="del">del<a hidden class="anchor" aria-hidden="true" href="#del">#</a></h3>
<p>delç”¨äºåˆ é™¤å·²å­˜åœ¨çš„é”®ï¼Œä¸å­˜åœ¨çš„ key ä¼šè¢«å¿½ç•¥
<code>del key_name</code>
è¿”å›è¢«åˆ é™¤keyçš„æ•°é‡</p>
<h3 id="dump">dump<a hidden class="anchor" aria-hidden="true" href="#dump">#</a></h3>
<p>DUMP å‘½ä»¤ç”¨äºåºåˆ—åŒ–ç»™å®š key ï¼Œå¹¶è¿”å›è¢«åºåˆ—åŒ–çš„å€¼
<code>DUMP KEY_NAME</code>
å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å› nil ã€‚ å¦åˆ™ï¼Œè¿”å›åºåˆ—åŒ–ä¹‹åçš„å€¼ã€‚</p>
<h3 id="exist">exist<a hidden class="anchor" aria-hidden="true" href="#exist">#</a></h3>
<p>EXISTS å‘½ä»¤ç”¨äºæ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚
<code>EXISTS KEY_NAME</code>
è‹¥ key å­˜åœ¨è¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚</p>
<h3 id="expire">expire<a hidden class="anchor" aria-hidden="true" href="#expire">#</a></h3>
<p>Expire å‘½ä»¤ç”¨äºè®¾ç½® key çš„è¿‡æœŸæ—¶é—´ã€‚key è¿‡æœŸåå°†ä¸å†å¯ç”¨ã€‚
<code>Expire KEY_NAME TIME_IN_SECONDS</code>
è®¾ç½®æˆåŠŸè¿”å›1ï¼Œ å½“keyä¸å­˜åœ¨æˆ–è€…ä¸èƒ½ä¸ºkeyè®¾ç½®è¿‡æœŸæ—¶é—´æ—¶è¿”å›0ã€‚</p>
<h3 id="expireat">expireat<a hidden class="anchor" aria-hidden="true" href="#expireat">#</a></h3>
<p>Expireat å‘½ä»¤ç”¨äºä»¥ UNIX æ—¶é—´æˆ³(unix timestamp)æ ¼å¼è®¾ç½® key çš„è¿‡æœŸæ—¶é—´ã€‚key è¿‡æœŸåå°†ä¸å†å¯ç”¨ã€‚
<code>Expireat KEY_NAME TIME_IN_UNIX_TIMESTAMP</code>
è®¾ç½®æˆåŠŸè¿”å›1ï¼Œä¸æˆåŠŸæˆ–ä¸å­˜åœ¨è¿”å›0ã€‚
ç¤ºä¾‹ï¼š
<code>EXPIREAT w3ckey 1293840000</code></p>
<h3 id="keys">keys<a hidden class="anchor" aria-hidden="true" href="#keys">#</a></h3>
<p>Keys å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ key
<code>KEYS PATTERN</code>
è¿”å›ç¬¦åˆç»™å®šæ¨¡å¼çš„ key åˆ—è¡¨ (Array)ã€‚</p>
<p>æŸ¥æ‰¾ä»¥w3cå¼€å¤´çš„keyï¼š
<code>keys w3c*</code>
æŸ¥æ‰¾æ‰€æœ‰çš„key
<code>keys *</code></p>
<h3 id="move">move<a hidden class="anchor" aria-hidden="true" href="#move">#</a></h3>
<p>moveå‘½ä»¤ç”¨äºå°†å½“å‰æ•°æ®åº“çš„keyç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“dbå½“ä¸­ã€‚
<code>MOVE KEY_NAME DESTINATION_DATABASE</code>
ç§»åŠ¨æˆåŠŸè¿”å› 1 ï¼Œå¤±è´¥åˆ™è¿”å› 0 ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SELECT 0     # redisé»˜è®¤ä½¿ç”¨æ•°æ®åº“ 0ï¼Œä¸ºäº†æ¸…æ™°èµ·è§ï¼Œè¿™é‡Œå†æ˜¾å¼æŒ‡å®šä¸€æ¬¡ã€‚
</span></span><span style="display:flex;"><span>set w3c redis  #è®¾ç½®ä¸€ä¸ªkey
</span></span><span style="display:flex;"><span>move w3c 1   #è½¬ç§»åˆ°1åº“
</span></span><span style="display:flex;"><span>exist w3c  #å‘ç°w3cå·²ç»æ²¡æœ‰äº†
</span></span><span style="display:flex;"><span>select 1 #é€‰æ‹©1åº“
</span></span><span style="display:flex;"><span>exist w3c #å‘ç°w3cå·²ç»è½¬ç§»åˆ°1åº“ä¸­
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>ä¸å­˜åœ¨çš„keyæ— æ³•è½¬ç§»</li>
<li>å½“æºæ•°æ®åº“å’Œç›®æ ‡æ•°æ®åº“æœ‰ç›¸åŒçš„ key æ—¶ï¼Œkeyæ— æ³•è½¬ç§»ã€‚</li>
</ol>
<h3 id="persist">persist<a hidden class="anchor" aria-hidden="true" href="#persist">#</a></h3>
<p>persistå‘½ä»¤ç”¨äºç§»é™¤ç»™å®š key çš„è¿‡æœŸæ—¶é—´ï¼Œä½¿å¾— key æ°¸ä¸è¿‡æœŸã€‚
<code>PERSIST KEY_NAME</code>
å½“è¿‡æœŸæ—¶é—´ç§»é™¤æˆåŠŸæ—¶ï¼Œè¿”å› 1 ã€‚ å¦‚æœ key ä¸å­˜åœ¨æˆ– key æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="pttl">pttl<a hidden class="anchor" aria-hidden="true" href="#pttl">#</a></h3>
<p>Pttl å‘½ä»¤ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™è¿‡æœŸæ—¶é—´ã€‚
<code>PTTL KEY_NAME</code>
å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› -2 ã€‚ å½“ key å­˜åœ¨ä½†æ²¡æœ‰è®¾ç½®å‰©ä½™ç”Ÿå­˜æ—¶é—´æ—¶ï¼Œè¿”å› -1 ã€‚ å¦åˆ™ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œè¿”å› key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚</p>
<h3 id="ttl">TTL<a hidden class="anchor" aria-hidden="true" href="#ttl">#</a></h3>
<p>TTL å‘½ä»¤ä»¥ç§’ä¸ºå•ä½è¿”å› key çš„å‰©ä½™è¿‡æœŸæ—¶é—´ã€‚
<code>TTL KEY_NAME</code>
å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› -2 ã€‚ å½“ key å­˜åœ¨ä½†æ²¡æœ‰è®¾ç½®å‰©ä½™ç”Ÿå­˜æ—¶é—´æ—¶ï¼Œè¿”å› -1 ã€‚ å¦åˆ™ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å› key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ã€‚</p>
<h3 id="randomkey">randomkey<a hidden class="anchor" aria-hidden="true" href="#randomkey">#</a></h3>
<p>RANDOMKEY å‘½ä»¤ä»å½“å‰æ•°æ®åº“ä¸­éšæœºè¿”å›ä¸€ä¸ª key ã€‚
<code>randomkey</code>
å½“æ•°æ®åº“ä¸ä¸ºç©ºæ—¶ï¼Œè¿”å›ä¸€ä¸ª key ã€‚ å½“æ•°æ®åº“ä¸ºç©ºæ—¶ï¼Œè¿”å› nil ã€‚</p>
<h3 id="rename">rename<a hidden class="anchor" aria-hidden="true" href="#rename">#</a></h3>
<p>Rename å‘½ä»¤ç”¨äºä¿®æ”¹ key çš„åç§° ã€‚
<code>RENAME OLD_KEY_NAME NEW_KEY_NAME</code>
æ”¹åæˆåŠŸæ—¶æç¤º OK ï¼Œå¤±è´¥æ—¶å€™è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
å½“ OLD_KEY_NAME å’Œ NEW_KEY_NAME ç›¸åŒï¼Œæˆ–è€… OLD_KEY_NAME ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
å½“ NEW_KEY_NAME å·²ç»å­˜åœ¨æ—¶ï¼Œ RENAME å‘½ä»¤å°†è¦†ç›–æ—§å€¼ã€‚</p>
<h3 id="renamenx">renamenx<a hidden class="anchor" aria-hidden="true" href="#renamenx">#</a></h3>
<p>Renamenx å‘½ä»¤ç”¨äºåœ¨æ–°çš„ key ä¸å­˜åœ¨æ—¶ä¿®æ”¹ key çš„åç§° ã€‚
<code>RENAMENX OLD_KEY_NAME NEW_KEY_NAME</code>
ä¿®æ”¹æˆåŠŸæ—¶ï¼Œè¿”å› 1 ã€‚ å¦‚æœ NEW_KEY_NAME å·²ç»å­˜åœ¨ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="type">type<a hidden class="anchor" aria-hidden="true" href="#type">#</a></h3>
<p>Type å‘½ä»¤ç”¨äºè¿”å› key æ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ã€‚
<code>TYPE KEY_NAME </code>
è¿”å› key çš„æ•°æ®ç±»å‹ï¼Œæ•°æ®ç±»å‹æœ‰ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>none (keyä¸å­˜åœ¨)
</span></span><span style="display:flex;"><span>string (å­—ç¬¦ä¸²)
</span></span><span style="display:flex;"><span>list (åˆ—è¡¨)
</span></span><span style="display:flex;"><span>set (é›†åˆ)
</span></span><span style="display:flex;"><span>zset (æœ‰åºé›†)
</span></span><span style="display:flex;"><span>hash (å“ˆå¸Œè¡¨)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="string">string<a hidden class="anchor" aria-hidden="true" href="#string">#</a></h2>
<h3 id="set">set<a hidden class="anchor" aria-hidden="true" href="#set">#</a></h3>
<p>SET å‘½ä»¤ç”¨äºè®¾ç½®ç»™å®š key çš„å€¼ã€‚å¦‚æœ key å·²ç»å­˜å‚¨å…¶ä»–å€¼ï¼Œ SET å°±è¦†å†™æ—§å€¼ï¼Œä¸”æ— è§†ç±»å‹ã€‚
<code>SET KEY_NAME VALUE</code>
ä» Redis 2.6.12 ç‰ˆæœ¬å¼€å§‹ï¼Œ SET åœ¨è®¾ç½®æ“ä½œæˆåŠŸå®Œæˆæ—¶ï¼Œæ‰è¿”å› OK ã€‚</p>
<h3 id="get">get<a hidden class="anchor" aria-hidden="true" href="#get">#</a></h3>
<p>Get å‘½ä»¤ç”¨äºè·å–æŒ‡å®š key çš„å€¼ã€‚
<code>GET KEY_NAME</code>
å¦‚æœ key ä¸å­˜åœ¨ï¼Œè¿”å› nil ã€‚å¦‚æœkey å‚¨å­˜çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p>
<h3 id="getrange">getrange<a hidden class="anchor" aria-hidden="true" href="#getrange">#</a></h3>
<p>getrangeå‘½ä»¤ç”¨äºè·å–å­˜å‚¨åœ¨æŒ‡å®š key ä¸­å­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²çš„æˆªå–èŒƒå›´ç”± start å’Œ end ä¸¤ä¸ªåç§»é‡å†³å®š(åŒ…æ‹¬ start å’Œ end åœ¨å†…)ã€‚
<code>getrange KEY_NAME start end</code></p>
<p>ç¤ºä¾‹ï¼šé¦–å…ˆï¼Œè®¾ç½® mykey çš„å€¼å¹¶æˆªå–å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>redis 127.0.0.1:6379&gt; SET mykey &#34;This is my test key&#34;
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>redis 127.0.0.1:6379&gt; GETRANGE mykey 0 3
</span></span><span style="display:flex;"><span>&#34;This&#34;
</span></span><span style="display:flex;"><span>redis 127.0.0.1:6379&gt; GETRANGE mykey 0 -1
</span></span><span style="display:flex;"><span>&#34;This is my test key&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="getset">getset<a hidden class="anchor" aria-hidden="true" href="#getset">#</a></h3>
<p>getset å‘½ä»¤ç”¨äºè®¾ç½®æŒ‡å®š key çš„å€¼ï¼Œå¹¶è¿”å› key æ—§çš„å€¼ã€‚
<code>getset key_name value</code>
è¿”å›ç»™å®š key çš„æ—§å€¼ã€‚ å½“ key æ²¡æœ‰æ—§å€¼æ—¶ï¼Œå³ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil ã€‚
å½“ key å­˜åœ¨ä½†ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
ç¤ºä¾‹ï¼šé¦–å…ˆï¼Œè®¾ç½® mykey çš„å€¼å¹¶æˆªå–å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>redis 127.0.0.1:6379&gt; GETSET mynewkey &#34;This is my test key&#34;
</span></span><span style="display:flex;"><span>(nil)
</span></span><span style="display:flex;"><span>redis 127.0.0.1:6379&gt; GETSET mynewkey &#34;This is my new value to test getset&#34;
</span></span><span style="display:flex;"><span>&#34;This is my test key&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="getbit">getbit<a hidden class="anchor" aria-hidden="true" href="#getbit">#</a></h3>
<p>getbit å‘½ä»¤ç”¨äºå¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè·å–æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚
<code>getbit key_name offset</code>
è¿”å›å­—ç¬¦ä¸²å€¼æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚
å½“åç§»é‡ OFFSET æ¯”å­—ç¬¦ä¸²å€¼çš„é•¿åº¦å¤§ï¼Œæˆ–è€… key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="setbit">setbit<a hidden class="anchor" aria-hidden="true" href="#setbit">#</a></h3>
<p>setbitå‘½ä»¤ç”¨äºå¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè®¾ç½®æˆ–æ¸…é™¤æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚
<code>setbit key_name offset</code>
è¿”å›æŒ‡å®šåç§»é‡åŸæ¥å‚¨å­˜çš„ä½ã€‚</p>
<h3 id="mget">mget<a hidden class="anchor" aria-hidden="true" href="#mget">#</a></h3>
<p>mgetå‘½ä»¤è¿”å›æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š key çš„å€¼ã€‚ å¦‚æœç»™å®šçš„ key é‡Œé¢ï¼Œæœ‰æŸä¸ª key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ª key è¿”å›ç‰¹æ®Šå€¼ nil ã€‚
<code>MGET KEY1 KEY2 .. KEYN</code></p>
<h3 id="setex">setex<a hidden class="anchor" aria-hidden="true" href="#setex">#</a></h3>
<p>setex å‘½ä»¤ä¸ºæŒ‡å®šçš„ key è®¾ç½®å€¼åŠå…¶è¿‡æœŸæ—¶é—´ã€‚å¦‚æœ key å·²ç»å­˜åœ¨ï¼Œ SETEX å‘½ä»¤å°†ä¼šæ›¿æ¢æ—§çš„å€¼ã€‚
<code>setex key_name timeout value</code>
è®¾ç½®æˆåŠŸæ—¶è¿”å› OK ã€‚
è¯´ç™½äº†å°±æ˜¯åœ¨è®¾ç½®ä¸€ä¸ªå€¼çš„æ—¶å€™ç›´æ¥å°±æŒ‡å®šäº†è¿‡æœŸæ—¶é—´ã€‚</p>
<h3 id="setnx">setnx<a hidden class="anchor" aria-hidden="true" href="#setnx">#</a></h3>
<p>setnx(SET if Not eXists)å‘½ä»¤åœ¨æŒ‡å®šçš„ key ä¸å­˜åœ¨æ—¶ï¼Œä¸º key è®¾ç½®æŒ‡å®šçš„å€¼ã€‚
<code>setnx key_name value</code>
è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ è®¾ç½®å¤±è´¥ï¼Œè¿”å› 0 ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>redis&gt; EXISTS job                # job ä¸å­˜åœ¨
</span></span><span style="display:flex;"><span>(integer) 0
</span></span><span style="display:flex;"><span>redis&gt; SETNX job &#34;programmer&#34;    # job è®¾ç½®æˆåŠŸ
</span></span><span style="display:flex;"><span>(integer) 1
</span></span><span style="display:flex;"><span>redis&gt; SETNX job &#34;code-farmer&#34;   # å°è¯•è¦†ç›– job ï¼Œå¤±è´¥
</span></span><span style="display:flex;"><span>(integer) 0
</span></span><span style="display:flex;"><span>redis&gt; GET job                   # æ²¡æœ‰è¢«è¦†ç›–
</span></span><span style="display:flex;"><span>&#34;programmer&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="setrange">setrange<a hidden class="anchor" aria-hidden="true" href="#setrange">#</a></h3>
<p>setrange å‘½ä»¤ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¦†ç›–ç»™å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè¦†ç›–çš„ä½ç½®ä»åç§»é‡ offset å¼€å§‹ã€‚
<code>SETRANGE KEY_NAME OFFSET VALUE</code>
è¿”å›è¢«ä¿®æ”¹åçš„å­—ç¬¦ä¸²é•¿åº¦ã€‚
å°±æ˜¯ä»æŒ‡å®šä½ç½®ä¿®æ”¹å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p>
<h3 id="strlen">strlen<a hidden class="anchor" aria-hidden="true" href="#strlen">#</a></h3>
<p>strlen å‘½ä»¤ç”¨äºè·å–æŒ‡å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚å½“ key å‚¨å­˜çš„ä¸æ˜¯å­—ç¬¦ä¸²å€¼æ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
<code>strlen key_name</code>
è¿”å›å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0ã€‚</p>
<h3 id="mset">mset<a hidden class="anchor" aria-hidden="true" href="#mset">#</a></h3>
<p>mset å‘½ä»¤ç”¨äºåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚
<code>MSET key1 value1 key2 value2 .. keyN valueN </code>
æ€»æ˜¯è¿”å›OK</p>
<h3 id="msetnx">msetnx<a hidden class="anchor" aria-hidden="true" href="#msetnx">#</a></h3>
<p>msetnx å‘½ä»¤ç”¨äºæ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨æ—¶ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚
<code>MSETNX key1 value1 key2 value2 .. keyN valueN </code>
å½“æ‰€æœ‰ key éƒ½æˆåŠŸè®¾ç½®ï¼Œè¿”å› 1 ã€‚ å¦‚æœæ‰€æœ‰ç»™å®š key éƒ½è®¾ç½®å¤±è´¥(è‡³å°‘æœ‰ä¸€ä¸ª key å·²ç»å­˜åœ¨)ï¼Œé‚£ä¹ˆè¿”å› 0 ã€‚</p>
<p>msetnxæ˜¯åŸå­æ€§æ“ä½œï¼Œåªè¦æœ‰ä¸€ä¸ªå€¼å¤±è´¥ï¼Œæ‰€æœ‰çš„å€¼éƒ½ä¸ä¼šè¢«è®¾ç½®ã€‚</p>
<h3 id="psetex">psetex<a hidden class="anchor" aria-hidden="true" href="#psetex">#</a></h3>
<p>psetex å‘½ä»¤ä»¥æ¯«ç§’ä¸ºå•ä½è®¾ç½® key çš„ç”Ÿå­˜æ—¶é—´ã€‚
<code>PSETEX key1 EXPIRY_IN_MILLISECONDS value1 </code>
è®¾ç½®æˆåŠŸæ—¶è¿”å› OK ã€‚</p>
<h3 id="incr">incr<a hidden class="anchor" aria-hidden="true" href="#incr">#</a></h3>
<p>incr å‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€ã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ INCR æ“ä½œã€‚
å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚
<code>incr key_name</code>
è¿”å›æ‰§è¡Œincrå‘½ä»¤ä¹‹å key çš„å€¼ã€‚</p>
<h3 id="incrby">incrby<a hidden class="anchor" aria-hidden="true" href="#incrby">#</a></h3>
<p>incrbyå‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—åŠ ä¸ŠæŒ‡å®šçš„å¢é‡å€¼ã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ INCRBY å‘½ä»¤ã€‚
å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚
<code>incr key_name incr_amount</code>
è¿”å›åŠ ä¸ŠæŒ‡å®šçš„å¢é‡å€¼ä¹‹åï¼Œ key çš„å€¼ã€‚</p>
<h3 id="incrbyfloat">incrbyfloat<a hidden class="anchor" aria-hidden="true" href="#incrbyfloat">#</a></h3>
<p>incrbyfloatå‘½ä»¤ä¸º key ä¸­æ‰€å‚¨å­˜çš„å€¼åŠ ä¸ŠæŒ‡å®šçš„æµ®ç‚¹æ•°å¢é‡å€¼ã€‚
<code>incrbyfloat key_name incr_amount</code>
è¿”å›æ‰§è¡Œå‘½ä»¤ä¹‹å key çš„å€¼ã€‚</p>
<p>ç”¨ SET è®¾ç½®çš„å€¼å¯ä»¥æ˜¯æŒ‡æ•°ç¬¦å·<code>314e-2</code>ï¼Œä½†æ‰§è¡Œ INCRBYFLOAT ä¹‹åæ ¼å¼ä¼šè¢«æ”¹æˆéæŒ‡æ•°ç¬¦å·<code>3.14</code>
SET è®¾ç½®çš„å€¼å°æ•°éƒ¨åˆ†å¯ä»¥æ˜¯ 0<code>3.0</code>ï¼Œä½† INCRBYFLOAT ä¼šå°†æ— ç”¨çš„ 0 å¿½ç•¥æ‰ï¼Œæœ‰éœ€è¦çš„è¯ï¼Œå°†æµ®ç‚¹å˜ä¸ºæ•´æ•°<code>4</code></p>
<h3 id="decr">decr<a hidden class="anchor" aria-hidden="true" href="#decr">#</a></h3>
<p>decr å‘½ä»¤å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€ã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ DECR æ“ä½œã€‚
å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚
<code>decr key_name</code>
è¿”å›æ‰§è¡Œå‘½ä»¤ä¹‹å key çš„å€¼ã€‚</p>
<h3 id="decrby">decrby<a hidden class="anchor" aria-hidden="true" href="#decrby">#</a></h3>
<p>decrby å‘½ä»¤å°† key æ‰€å‚¨å­˜çš„å€¼å‡å»æŒ‡å®šçš„å‡é‡å€¼ã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åå†æ‰§è¡Œ DECRBY æ“ä½œã€‚
å¦‚æœå€¼åŒ…å«é”™è¯¯çš„ç±»å‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚
æœ¬æ“ä½œçš„å€¼é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚
<code>decrby key_name decrement_amount</code>
è¿”å›å‡å»æŒ‡å®šå‡é‡å€¼ä¹‹åï¼Œ key çš„å€¼ã€‚</p>
<h3 id="append">append<a hidden class="anchor" aria-hidden="true" href="#append">#</a></h3>
<p>append å‘½ä»¤ç”¨äºä¸ºæŒ‡å®šçš„ key è¿½åŠ å€¼ã€‚
å¦‚æœ key å·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ APPEND å‘½ä»¤å°† value è¿½åŠ åˆ° key åŸæ¥çš„å€¼çš„æœ«å°¾ã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œ APPEND å°±ç®€å•åœ°å°†ç»™å®š key è®¾ä¸º value ï¼Œå°±åƒæ‰§è¡Œ SET key value ä¸€æ ·ã€‚
<code>append key_name new_value</code>
è¿”å›è¿½åŠ æŒ‡å®šå€¼ä¹‹åï¼Œ key ä¸­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<h2 id="hash">hash<a hidden class="anchor" aria-hidden="true" href="#hash">#</a></h2>
<h3 id="hdel">hdel<a hidden class="anchor" aria-hidden="true" href="#hdel">#</a></h3>
<p>hdel å‘½ä»¤ç”¨äºåˆ é™¤å“ˆå¸Œè¡¨ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šå­—æ®µï¼Œä¸å­˜åœ¨çš„å­—æ®µå°†è¢«å¿½ç•¥ã€‚
<code>HDEL KEY_NAME FIELD1.. FIELDN </code>
è¢«æˆåŠŸåˆ é™¤å­—æ®µçš„æ•°é‡ï¼Œä¸åŒ…æ‹¬è¢«å¿½ç•¥çš„å­—æ®µã€‚</p>
<h3 id="hexists">hexists<a hidden class="anchor" aria-hidden="true" href="#hexists">#</a></h3>
<p>hexists å‘½ä»¤ç”¨äºæŸ¥çœ‹å“ˆå¸Œè¡¨çš„æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ã€‚
<code>HEXISTS KEY_NAME FIELD_NAME </code>
å¦‚æœå“ˆå¸Œè¡¨å«æœ‰ç»™å®šå­—æ®µï¼Œè¿”å› 1 ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸å«æœ‰ç»™å®šå­—æ®µï¼Œæˆ– key ä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="hget">hget<a hidden class="anchor" aria-hidden="true" href="#hget">#</a></h3>
<p>hget å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼ã€‚
<code>HGET KEY_NAME FIELD_NAME </code>
è¿”å›ç»™å®šå­—æ®µçš„å€¼ã€‚å¦‚æœç»™å®šçš„å­—æ®µæˆ– key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› nil ã€‚</p>
<h3 id="hgetall">hgetall<a hidden class="anchor" aria-hidden="true" href="#hgetall">#</a></h3>
<p>hgetall å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­ï¼Œæ‰€æœ‰çš„å­—æ®µå’Œå€¼ã€‚
åœ¨è¿”å›å€¼é‡Œï¼Œç´§è·Ÿæ¯ä¸ªå­—æ®µå(field name)ä¹‹åæ˜¯å­—æ®µçš„å€¼(value)ï¼Œæ‰€ä»¥è¿”å›å€¼çš„é•¿åº¦æ˜¯å“ˆå¸Œè¡¨å¤§å°çš„ä¸¤å€ã€‚
<code>HGETALL KEY_NAME </code>
ä»¥åˆ—è¡¨å½¢å¼è¿”å›å“ˆå¸Œè¡¨çš„å­—æ®µåŠå­—æ®µå€¼ã€‚ è‹¥ key ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºåˆ—è¡¨ã€‚</p>
<h3 id="hincrby">hincrby<a hidden class="anchor" aria-hidden="true" href="#hincrby">#</a></h3>
<p>hincrby å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µå€¼åŠ ä¸ŠæŒ‡å®šå¢é‡å€¼ã€‚
å¢é‡ä¹Ÿå¯ä»¥ä¸ºè´Ÿæ•°ï¼Œç›¸å½“äºå¯¹æŒ‡å®šå­—æ®µè¿›è¡Œå‡æ³•æ“ä½œã€‚
å¦‚æœå“ˆå¸Œè¡¨çš„ key ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶æ‰§è¡Œ HINCRBY å‘½ä»¤ã€‚
å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œå­—æ®µçš„å€¼è¢«åˆå§‹åŒ–ä¸º 0 ã€‚
å¯¹ä¸€ä¸ªå‚¨å­˜å­—ç¬¦ä¸²å€¼çš„å­—æ®µæ‰§è¡Œ HINCRBY å‘½ä»¤å°†é€ æˆä¸€ä¸ªé”™è¯¯ã€‚
æœ¬æ“ä½œçš„å€¼è¢«é™åˆ¶åœ¨ 64 ä½(bit)æœ‰ç¬¦å·æ•°å­—è¡¨ç¤ºä¹‹å†…ã€‚
<code>HINCRBY KEY_NAME FIELD_NAME INCR_BY_NUMBER </code></p>
<h3 id="hincrbyfloat">hincrbyfloat<a hidden class="anchor" aria-hidden="true" href="#hincrbyfloat">#</a></h3>
<p>hincrbyfloat å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µå€¼åŠ ä¸ŠæŒ‡å®šæµ®ç‚¹æ•°å¢é‡å€¼ã€‚
å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œå­—æ®µçš„å€¼è¢«åˆå§‹åŒ–ä¸º 0 ã€‚
<code>HINCRBYFLOAT KEY_NAME FIELD_NAME INCR_BY_NUMBER </code>
è¿”å›æ‰§è¡Œ Hincrbyfloat å‘½ä»¤ä¹‹åï¼Œå“ˆå¸Œè¡¨ä¸­å­—æ®µçš„å€¼ã€‚</p>
<h3 id="hkeys">hkeys<a hidden class="anchor" aria-hidden="true" href="#hkeys">#</a></h3>
<p>hkeys å‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µåã€‚
<code>HKEYS KEY_NAME FIELD_NAME INCR_BY_NUMBER </code>
åŒ…å«å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å­—æ®µçš„åˆ—è¡¨ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚</p>
<h3 id="hlen">hlen<a hidden class="anchor" aria-hidden="true" href="#hlen">#</a></h3>
<p>hlen å‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚
<code>HLEN KEY_NAME </code>
è¿”å›å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="hmget">hmget<a hidden class="anchor" aria-hidden="true" href="#hmget">#</a></h3>
<p>hmget å‘½ä»¤ç”¨äºè¿”å›å“ˆå¸Œè¡¨ä¸­ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šå­—æ®µçš„å€¼ã€‚
å¦‚æœæŒ‡å®šçš„å­—æ®µä¸å­˜åœ¨äºå“ˆå¸Œè¡¨ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª nil å€¼ã€‚
<code>HMGET KEY_NAME FIELD1...FIELDN </code>
è¿”å›ä¸€ä¸ªåŒ…å«å¤šä¸ªç»™å®šå­—æ®µå…³è”å€¼çš„è¡¨ï¼Œè¡¨å€¼çš„æ’åˆ—é¡ºåºå’ŒæŒ‡å®šå­—æ®µçš„è¯·æ±‚é¡ºåºä¸€æ ·ã€‚</p>
<h3 id="hmset">hmset<a hidden class="anchor" aria-hidden="true" href="#hmset">#</a></h3>
<p>hmset å‘½ä»¤ç”¨äºåŒæ—¶å°†å¤šä¸ª field-value (å­—æ®µ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨ä¸­ã€‚
æ­¤å‘½ä»¤ä¼šè¦†ç›–å“ˆå¸Œè¡¨ä¸­å·²å­˜åœ¨çš„å­—æ®µã€‚
å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç©ºå“ˆå¸Œè¡¨ï¼Œå¹¶æ‰§è¡Œ HMSET æ“ä½œã€‚
<code>HMSET KEY_NAME FIELD1 VALUE1 ...FIELDN VALUEN</code></p>
<h3 id="hset">hset<a hidden class="anchor" aria-hidden="true" href="#hset">#</a></h3>
<p>hset å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­çš„å­—æ®µèµ‹å€¼ ã€‚
å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶è¿›è¡Œ HSET æ“ä½œã€‚
å¦‚æœå­—æ®µå·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œæ—§å€¼å°†è¢«è¦†ç›–ã€‚
<code>HSET KEY_NAME FIELD VALUE</code>
è¿”å›å¦‚æœå­—æ®µæ˜¯å“ˆå¸Œè¡¨ä¸­çš„ä¸€ä¸ªæ–°å»ºå­—æ®µï¼Œå¹¶ä¸”å€¼è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ å¦‚æœå“ˆå¸Œè¡¨ä¸­åŸŸå­—æ®µå·²ç»å­˜åœ¨ä¸”æ—§å€¼å·²è¢«æ–°å€¼è¦†ç›–ï¼Œè¿”å› 0 ã€‚</p>
<h3 id="hsetnx">hsetnx<a hidden class="anchor" aria-hidden="true" href="#hsetnx">#</a></h3>
<p>hsetnx å‘½ä»¤ç”¨äºä¸ºå“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨çš„çš„å­—æ®µèµ‹å€¼ ã€‚
å¦‚æœå“ˆå¸Œè¡¨ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶è¿›è¡Œ HSET æ“ä½œã€‚
å¦‚æœå­—æ®µå·²ç»å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­ï¼Œæ“ä½œæ— æ•ˆã€‚
å¦‚æœ key ä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶æ‰§è¡Œ HSETNX å‘½ä»¤ã€‚
<code>HSETNX KEY_NAME FIELD VALUE</code>
è®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚ å¦‚æœç»™å®šå­—æ®µå·²ç»å­˜åœ¨ä¸”æ²¡æœ‰æ“ä½œè¢«æ‰§è¡Œï¼Œè¿”å› 0 ã€‚</p>
<h3 id="hvals">hvals<a hidden class="anchor" aria-hidden="true" href="#hvals">#</a></h3>
<p>hvals å‘½ä»¤è¿”å›å“ˆå¸Œè¡¨æ‰€æœ‰å­—æ®µçš„å€¼ã€‚
<code>HVALS KEY_NAME FIELD VALUE</code>
è¿”å›ä¸€ä¸ªåŒ…å«å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼çš„è¡¨ã€‚ å½“ key ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªç©ºè¡¨ã€‚</p>
<h2 id="è¿æ¥æ“ä½œå‘½ä»¤">è¿æ¥æ“ä½œå‘½ä»¤<a hidden class="anchor" aria-hidden="true" href="#è¿æ¥æ“ä½œå‘½ä»¤">#</a></h2>
<p>quitï¼šå…³é—­è¿æ¥ï¼ˆconnectionï¼‰
authï¼šç®€å•å¯†ç è®¤è¯
help cmdï¼š æŸ¥çœ‹cmdå¸®åŠ©ï¼Œä¾‹å¦‚ï¼šhelp quit</p>
<h2 id="æŒä¹…åŒ–">æŒä¹…åŒ–<a hidden class="anchor" aria-hidden="true" href="#æŒä¹…åŒ–">#</a></h2>
<p>saveï¼šå°†æ•°æ®åŒæ­¥ä¿å­˜åˆ°ç£ç›˜
bgsaveï¼šå°†æ•°æ®å¼‚æ­¥ä¿å­˜åˆ°ç£ç›˜
lastsaveï¼šè¿”å›ä¸Šæ¬¡æˆåŠŸå°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜çš„Unixæ—¶æˆ³
shundownï¼šå°†æ•°æ®åŒæ­¥ä¿å­˜åˆ°ç£ç›˜ï¼Œç„¶åå…³é—­æœåŠ¡</p>
<h2 id="è¿œç¨‹æœåŠ¡æ§åˆ¶">è¿œç¨‹æœåŠ¡æ§åˆ¶<a hidden class="anchor" aria-hidden="true" href="#è¿œç¨‹æœåŠ¡æ§åˆ¶">#</a></h2>
<p>infoï¼šæä¾›æœåŠ¡å™¨çš„ä¿¡æ¯å’Œç»Ÿè®¡
monitorï¼šå®æ—¶è½¬å‚¨æ”¶åˆ°çš„è¯·æ±‚
slaveofï¼šæ”¹å˜å¤åˆ¶ç­–ç•¥è®¾ç½®
configï¼šåœ¨è¿è¡Œæ—¶é…ç½®RedisæœåŠ¡å™¨</p>
<h2 id="å¯¹valueæ“ä½œçš„å‘½ä»¤">å¯¹valueæ“ä½œçš„å‘½ä»¤<a hidden class="anchor" aria-hidden="true" href="#å¯¹valueæ“ä½œçš„å‘½ä»¤">#</a></h2>
<p>exists(key)ï¼šç¡®è®¤ä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨
del(key)ï¼šåˆ é™¤ä¸€ä¸ªkey
type(key)ï¼šè¿”å›å€¼çš„ç±»å‹
keys(pattern)ï¼šè¿”å›æ»¡è¶³ç»™å®špatternçš„æ‰€æœ‰key
randomkeyï¼šéšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ª
keyrename(oldname, newname)ï¼šé‡å‘½åkey
dbsizeï¼šè¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°ç›®
expireï¼šè®¾å®šä¸€ä¸ªkeyçš„æ´»åŠ¨æ—¶é—´ï¼ˆsï¼‰
ttlï¼šè·å¾—ä¸€ä¸ªkeyçš„æ´»åŠ¨æ—¶é—´
select(index)ï¼šæŒ‰ç´¢å¼•æŸ¥è¯¢
move(key, dbindex)ï¼šç§»åŠ¨å½“å‰æ•°æ®åº“ä¸­çš„keyåˆ°dbindexæ•°æ®åº“
flushdbï¼šåˆ é™¤å½“å‰é€‰æ‹©æ•°æ®åº“ä¸­çš„æ‰€æœ‰key
flushallï¼šåˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key</p>
<h2 id="string-1">String<a hidden class="anchor" aria-hidden="true" href="#string-1">#</a></h2>
<p>set(key, value)ï¼šç»™æ•°æ®åº“ä¸­åç§°ä¸ºkeyçš„stringèµ‹äºˆå€¼value
get(key)ï¼šè¿”å›æ•°æ®åº“ä¸­åç§°ä¸ºkeyçš„stringçš„value
getset(key, value)ï¼šç»™åç§°ä¸ºkeyçš„stringèµ‹äºˆä¸Šä¸€æ¬¡çš„value
mget(key1, key2,â€¦, key N)ï¼šè¿”å›åº“ä¸­å¤šä¸ªstringçš„value
setnx(key, value)ï¼šæ·»åŠ stringï¼Œåç§°ä¸ºkeyï¼Œå€¼ä¸ºvalue
setex(key, time, value)ï¼šå‘åº“ä¸­æ·»åŠ stringï¼Œè®¾å®šè¿‡æœŸæ—¶é—´time
mset(key N, value N)ï¼šæ‰¹é‡è®¾ç½®å¤šä¸ªstringçš„å€¼
msetnx(key N, value N)ï¼šå¦‚æœæ‰€æœ‰åç§°ä¸ºkey içš„stringéƒ½ä¸å­˜åœ¨
incr(key)ï¼šåç§°ä¸ºkeyçš„stringå¢1æ“ä½œ
incrby(key, integer)ï¼šåç§°ä¸ºkeyçš„stringå¢åŠ integer
decr(key)ï¼šåç§°ä¸ºkeyçš„stringå‡1æ“ä½œ
decrby(key, integer)ï¼šåç§°ä¸ºkeyçš„stringå‡å°‘integer
append(key, value)ï¼šåç§°ä¸ºkeyçš„stringçš„å€¼é™„åŠ value
substr(key, start, end)ï¼šè¿”å›åç§°ä¸ºkeyçš„stringçš„valueçš„å­ä¸²</p>
<h2 id="list">List<a hidden class="anchor" aria-hidden="true" href="#list">#</a></h2>
<p>rpush(key, value)ï¼šåœ¨åç§°ä¸ºkeyçš„listå°¾æ·»åŠ ä¸€ä¸ªå€¼ä¸ºvalueçš„å…ƒç´ 
lpush(key, value)ï¼šåœ¨åç§°ä¸ºkeyçš„listå¤´æ·»åŠ ä¸€ä¸ªå€¼ä¸ºvalueçš„ å…ƒç´ 
llen(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„listçš„é•¿åº¦
lrange(key, start, end)ï¼šè¿”å›åç§°ä¸ºkeyçš„listä¸­startè‡³endä¹‹é—´çš„å…ƒç´ 
ltrim(key, start, end)ï¼šæˆªå–åç§°ä¸ºkeyçš„list
lindex(key, index)ï¼šè¿”å›åç§°ä¸ºkeyçš„listä¸­indexä½ç½®çš„å…ƒç´ 
lset(key, index, value)ï¼šç»™åç§°ä¸ºkeyçš„listä¸­indexä½ç½®çš„å…ƒç´ èµ‹å€¼
lrem(key, count, value)ï¼šåˆ é™¤countä¸ªkeyçš„listä¸­å€¼ä¸ºvalueçš„å…ƒç´ 
lpop(key)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„listä¸­çš„é¦–å…ƒç´ 
rpop(key)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„listä¸­çš„å°¾å…ƒç´ 
blpop(key1, key2,â€¦ key N, timeout)ï¼šlpopå‘½ä»¤çš„blockç‰ˆæœ¬ã€‚
brpop(key1, key2,â€¦ key N, timeout)ï¼šrpopçš„blockç‰ˆæœ¬ã€‚
rpoplpush(srckey, dstkey)ï¼šè¿”å›å¹¶åˆ é™¤åç§°ä¸ºsrckeyçš„listçš„å°¾å…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°åç§°ä¸ºdstkeyçš„listçš„å¤´éƒ¨</p>
<h2 id="set-1">Set<a hidden class="anchor" aria-hidden="true" href="#set-1">#</a></h2>
<p>sadd(key, member)ï¼šå‘åç§°ä¸ºkeyçš„setä¸­æ·»åŠ å…ƒç´ member
srem(key, member) ï¼šåˆ é™¤åç§°ä¸ºkeyçš„setä¸­çš„å…ƒç´ member
spop(key) ï¼šéšæœºè¿”å›å¹¶åˆ é™¤åç§°ä¸ºkeyçš„setä¸­ä¸€ä¸ªå…ƒç´ 
smove(srckey, dstkey, member) ï¼šç§»åˆ°é›†åˆå…ƒç´ 
scard(key) ï¼šè¿”å›åç§°ä¸ºkeyçš„setçš„åŸºæ•°
sismember(key, member) ï¼šmemberæ˜¯å¦æ˜¯åç§°ä¸ºkeyçš„setçš„å…ƒç´ 
sinter(key1, key2,â€¦key N) ï¼šæ±‚äº¤é›†
sinterstore(dstkey, (keys)) ï¼šæ±‚äº¤é›†å¹¶å°†äº¤é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ
sunion(key1, (keys)) ï¼šæ±‚å¹¶é›†
sunionstore(dstkey, (keys)) ï¼šæ±‚å¹¶é›†å¹¶å°†å¹¶é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ
sdiff(key1, (keys)) ï¼šæ±‚å·®é›†
sdiffstore(dstkey, (keys)) ï¼šæ±‚å·®é›†å¹¶å°†å·®é›†ä¿å­˜åˆ°dstkeyçš„é›†åˆ
smembers(key) ï¼šè¿”å›åç§°ä¸ºkeyçš„setçš„æ‰€æœ‰å…ƒç´ 
srandmember(key) ï¼šéšæœºè¿”å›åç§°ä¸ºkeyçš„setçš„ä¸€ä¸ªå…ƒç´ </p>
<h2 id="hash-1">Hash<a hidden class="anchor" aria-hidden="true" href="#hash-1">#</a></h2>
<p>hset(key, field, value)ï¼šå‘åç§°ä¸ºkeyçš„hashä¸­æ·»åŠ å…ƒç´ field
hget(key, field)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­fieldå¯¹åº”çš„value
hmget(key, (fields))ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­field iå¯¹åº”çš„value
hmset(key, (fields))ï¼šå‘åç§°ä¸ºkeyçš„hashä¸­æ·»åŠ å…ƒç´ field
hincrby(key, field, integer)ï¼šå°†åç§°ä¸ºkeyçš„hashä¸­fieldçš„valueå¢åŠ integer
hexists(key, field)ï¼šåç§°ä¸ºkeyçš„hashä¸­æ˜¯å¦å­˜åœ¨é”®ä¸ºfieldçš„åŸŸ
hdel(key, field)ï¼šåˆ é™¤åç§°ä¸ºkeyçš„hashä¸­é”®ä¸ºfieldçš„åŸŸ
hlen(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­å…ƒç´ ä¸ªæ•°
hkeys(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰é”®
hvals(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰é”®å¯¹åº”çš„value
hgetall(key)ï¼šè¿”å›åç§°ä¸ºkeyçš„hashä¸­æ‰€æœ‰çš„é”®ï¼ˆfieldï¼‰åŠå…¶å¯¹åº”çš„value</p>
<h1 id="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°<a hidden class="anchor" aria-hidden="true" href="#åŠŸèƒ½å®ç°">#</a></h1>
<h2 id="ä½¿ç”¨redistemplate-å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç ">ä½¿ç”¨RedisTemplate å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç <a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨redistemplate-å­˜å‚¨é”®å€¼å‡ºç°ä¹±ç ">#</a></h2>
<p>æœ€è¿‘ä½¿ç”¨spring-data-redis RedisTemplate æ“ä½œredisæ—¶å‘ç°å­˜å‚¨åœ¨redisä¸­çš„keyä¸æ˜¯è®¾ç½®çš„stringå€¼ï¼Œå‰é¢è¿˜å¤šå‡ºäº†è®¸å¤šç±»ä¼¼\xac\xed\x00\x05t\x00è¿™ç§å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>127.0.0.1:6379&gt; keys *
</span></span><span style="display:flex;"><span>1) &#34;\xac\xed\x00\x05t\x00\x04pass&#34;
</span></span><span style="display:flex;"><span>2) &#34;\xac\xed\x00\x05t\x00\x04name&#34;
</span></span><span style="display:flex;"><span>3) &#34;name&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£å†³ï¼šä½¿ç”¨StringRedisTemplateï¼Œè€Œä¸æ˜¯RedisTemplateã€‚</p>
<h2 id="redistemplateå’Œstringredistemplateçš„åŒºåˆ«">RedisTemplateå’ŒStringRedisTemplateçš„åŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#redistemplateå’Œstringredistemplateçš„åŒºåˆ«">#</a></h2>
<ul>
<li>StringRedisTemplateç»§æ‰¿RedisTemplate</li>
<li>StringRedisTemplateåªèƒ½ç®¡ç†StringRedisTemplateé‡Œé¢çš„æ•°æ®ï¼ŒRedisTemplateåªèƒ½ç®¡ç†RedisTemplateä¸­çš„æ•°æ®ã€‚</li>
<li>SDR(spring-date-redis)é»˜è®¤é‡‡ç”¨çš„åºåˆ—åŒ–ç­–ç•¥æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯Stringçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¸€ç§æ˜¯JDKçš„åºåˆ—åŒ–ç­–ç•¥ã€‚
StringRedisTemplateé»˜è®¤é‡‡ç”¨çš„æ˜¯Stringçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¿å­˜çš„keyå’Œvalueéƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„ã€‚
RedisTemplateé»˜è®¤é‡‡ç”¨çš„æ˜¯JDKçš„åºåˆ—åŒ–ç­–ç•¥ï¼Œä¿å­˜çš„keyå’Œvalueéƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„ã€‚</li>
</ul>
<p>RedisTemplateä½¿ç”¨çš„åºåˆ—ç±»åœ¨åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´å­˜å…¥æ•°æ®ä¼šå°†æ•°æ®å…ˆåºåˆ—åŒ–æˆå­—èŠ‚æ•°ç»„ç„¶ååœ¨å­˜å…¥Redisæ•°æ®åº“ï¼Œè¿™ä¸ªæ—¶å€™æ‰“å¼€RedisæŸ¥çœ‹çš„æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„æ•°æ®ä¸æ˜¯ä»¥å¯è¯»çš„å½¢å¼å±•ç°çš„ï¼Œè€Œæ˜¯ä»¥å­—èŠ‚æ•°ç»„æ˜¾ç¤ºï¼Œç±»ä¼¼ä¸‹é¢
key:
<code>\xAC\xED\x00\x05sr\x00</code></p>
<p>value:
<code>\xAC\xED\x00\x05sr\x00\x13java.util.ArrayList...</code></p>
<p>æ€»ç»“ï¼š
å½“redisä¸­æœ¬æ¥å­˜çš„æ˜¯å­—ç¬¦ä¸²æ•°æ®ï¼Œæˆ–è€…ä½ è¦å­˜å–çš„æ•°æ®å°±æ˜¯å­—ç¬¦ä¸²ç±»å‹æ•°æ®çš„æ—¶å€™ï¼Œé‚£ä¹ˆä½ å°±ä½¿ç”¨StringRedisTemplateå³å¯ï¼Œä½†æ˜¯å¦‚æœä½ çš„æ•°æ®æ˜¯å¤æ‚çš„å¯¹è±¡ç±»å‹ï¼Œè€Œå–å‡ºçš„æ—¶å€™åˆä¸æƒ³åšä»»ä½•çš„æ•°æ®è½¬æ¢ï¼Œç›´æ¥ä»Redisé‡Œé¢å–å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä½¿ç”¨RedisTemplateæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<h2 id="é€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½">é€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½<a hidden class="anchor" aria-hidden="true" href="#é€šè¿‡notify-keyspace-eventså®ç°è®¢å•è‡ªåŠ¨å…³é—­åŠŸèƒ½">#</a></h2>
<p>ä¿®æ”¹Redisé…ç½®æ–‡ä»¶ï¼Œå¼€å¯è¿‡æœŸé€šçŸ¥åŠŸèƒ½ã€‚
åœ¨é…ç½®æ–‡ä»¶ä¸­æœç´¢<code>notify</code>ï¼Œæ‰¾åˆ°<code># notify-keyspace-events Ex</code>è¿™ä¸€è¡Œï¼Œå°†æ³¨é‡Šå»æ‰ã€‚
åŒæ—¶æ³¨é‡Šæ‰ä¸‹é¢ä¸€è¡Œ<code>notify-keyspace-events &quot;&quot;</code>ï¼Œ
ä¸ºäº†èŠ‚çº¦cupèµ„æºï¼Œäº‹ä»¶é€šçŸ¥é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œå³<code>notify-keyspace-events &quot;&quot;</code></p>
<p>ä¿®æ”¹ä¹‹ååœ¨éœ€è¦é‡å¯redisï¼Œç„¶åé€šè¿‡cliæŸ¥çœ‹é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œ<code>config get notify-keyspace-events</code>ï¼Œå¦‚æœæ˜¾ç¤ºExï¼ˆæˆ–è€…xEï¼‰ï¼Œå°±ç”Ÿæ•ˆäº†ã€‚</p>
<p>åœ¨ç¨‹åºä¸­ä½¿ç”¨redisï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>//å¼•å…¥redis
</span></span><span style="display:flex;"><span>@Resource
</span></span><span style="display:flex;"><span>private RedisTemplate redisTemplate;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è®¾ç½®key
<code>redisTemplate.opsForValue().set(orderNo, &quot;valueæ˜¯éšä¾¿å†™çš„ï¼Œå› ä¸ºè¿‡æœŸé€šçŸ¥æ— æ³•å–å¾—value&quot;, 10, TimeUnit.SECONDS);</code></p>
<p>é…ç½®è¿‡æœŸç›‘å¬</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Slf4j
</span></span><span style="display:flex;"><span>@Component
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedisTask <span style="color:#fff;font-weight:bold">extends</span> KeyExpirationEventMessageListener {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Autowired
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> ExecuteHandle executeHandle;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param listenerContainer must not be {@literal null}.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> RedisTask(RedisMessageListenerContainer listenerContainer) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(listenerContainer);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> onMessage(Message message, <span style="color:#fff;font-weight:bold">byte</span>[] pattern) {
</span></span><span style="display:flex;"><span>        String channel = <span style="color:#fff;font-weight:bold">new</span> String(message.<span style="color:#007f7f">getChannel</span>(), StandardCharsets.<span style="color:#007f7f">UTF_8</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//è¿‡æœŸçš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        String key = <span style="color:#fff;font-weight:bold">new</span> String(message.<span style="color:#007f7f">getBody</span>(), StandardCharsets.<span style="color:#007f7f">UTF_8</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">//åœ¨è¿™é‡Œï¼Œå¯ä»¥è¿‡æ»¤è°ƒæˆ‘ä»¬ä¸éœ€è¦çš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">if</span>(key.<span style="color:#007f7f">startsWith</span>(<span style="color:#0ff;font-weight:bold">&#34;shiro_redis_session&#34;</span>)){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        log.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;redis key è¿‡æœŸï¼špattern={},channel={},key={}&#34;</span>,<span style="color:#fff;font-weight:bold">new</span> String(pattern),channel,key);
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">//ä¸šåŠ¡é€»è¾‘ï¼Œå–æ¶ˆè®¢å•ä»€ä¹ˆçš„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        executeHandle.<span style="color:#007f7f">handle</span>(key);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šç±»å‹çš„è¿‡æœŸkeyï¼Œæ‰€ä»¥éœ€è¦åŒºåˆ†</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//å¤„ç†åŸºç±»ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> AbstractRedisExpireHandle {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//é€šè¿‡å‰ç¼€åŒºåˆ†è¿‡æœŸçš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">private</span> String prefix;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getPrefix() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> prefix;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setPrefix(String prefix) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">prefix</span> = prefix;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> AbstractRedisExpireHandle(){}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å¤„ç†redisè¿‡æœŸçš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">void</span> expireHandle(String redisKey);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * å•†å“è®¢å•è¿‡æœŸ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span>@Component
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> OrderExpireHandle <span style="color:#fff;font-weight:bold">extends</span> AbstractRedisExpireHandle {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> String PREFIX = <span style="color:#0ff;font-weight:bold">&#34;12&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> OrderExpireHandle(){
</span></span><span style="display:flex;"><span>        setPrefix(PREFIX);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Reference(version = <span style="color:#0ff;font-weight:bold">&#34;1.0.0&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> TaskService taskService;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">void</span> expireHandle(String redisKey) {
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">//ä¸šåŠ¡é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        taskService.<span style="color:#007f7f">orderExpireHandle</span>(redisKey);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“å¤„ç†ç±»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Slf4j
</span></span><span style="display:flex;"><span>@Component
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ExecuteHandle <span style="color:#fff;font-weight:bold">implements</span> ApplicationContextAware, InitializingBean {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//springå®¹å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">private</span> ApplicationContext context;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è¿‡æœŸkeyå¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">private</span> List&lt;AbstractRedisExpireHandle&gt; expireHandles = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç¨‹åºå¯åŠ¨ï¼Œå°†å„ä¸ªå¤„ç†ç±»ï¼Œæ”¾åˆ°listä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @throws Exception
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> afterPropertiesSet() <span style="color:#fff;font-weight:bold">throws</span> Exception {
</span></span><span style="display:flex;"><span>        String[] beanNames =  BeanFactoryUtils.<span style="color:#007f7f">beanNamesForTypeIncludingAncestors</span>(context,AbstractRedisExpireHandle.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span>(<span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>;i&lt;beanNames.<span style="color:#007f7f">length</span>;i++){
</span></span><span style="display:flex;"><span>            expireHandles.<span style="color:#007f7f">add</span>((AbstractRedisExpireHandle)context.<span style="color:#007f7f">getBean</span>(beanNames[i]));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setApplicationContext(ApplicationContext applicationContext) <span style="color:#fff;font-weight:bold">throws</span> BeansException {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">context</span> = applicationContext;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//æ‰¾åˆ°åˆé€‚çš„å¤„ç†å™¨å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> handle(String redisKey){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(expireHandles.<span style="color:#007f7f">isEmpty</span>()){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        log.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;redisKeyæ˜¯ï¼š&#34;</span> + redisKey);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span>(AbstractRedisExpireHandle i : expireHandles){
</span></span><span style="display:flex;"><span>            log.<span style="color:#007f7f">info</span>(<span style="color:#0ff;font-weight:bold">&#34;i.getPrefix()æ˜¯ï¼š&#34;</span> + i.<span style="color:#007f7f">getPrefix</span>());
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(redisKey.<span style="color:#007f7f">startsWith</span>(i.<span style="color:#007f7f">getPrefix</span>())){
</span></span><span style="display:flex;"><span>                i.<span style="color:#007f7f">expireHandle</span>(redisKey);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="rediså“¨å…µ">rediså“¨å…µ<a hidden class="anchor" aria-hidden="true" href="#rediså“¨å…µ">#</a></h2>
<p>å“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹ã€‚
<img loading="lazy" src="1.jpg" alt=""  />
</p>
<p>é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®©RedisæœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ã€‚
å½“å“¨å…µç›‘æµ‹åˆ°masterå®•æœºï¼Œä¼šè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœåŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœºã€‚
ç„¶è€Œä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹RedisæœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼ã€‚
æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰çš„è¿‡ç¨‹ã€‚å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡æˆä¸ºä¸»è§‚ä¸‹çº¿ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailoveræ“ä½œã€‚åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå®¢è§‚ä¸‹çº¿ã€‚è¿™æ ·å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œä¸€åˆ‡éƒ½æ˜¯é€æ˜çš„ã€‚</p>
<p>é…ç½®3ä¸ªå“¨å…µå’Œ1ä¸»2ä»çš„RedisæœåŠ¡å™¨æ¥æ¼”ç¤ºè¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<table>
<thead>
<tr>
<th>æœåŠ¡ç±»å‹</th>
<th>æ˜¯å¦æ˜¯ä¸»æœåŠ¡å™¨</th>
<th>IPåœ°å€</th>
<th>ç«¯å£</th>
</tr>
</thead>
<tbody>
<tr>
<td>Redis</td>
<td>æ˜¯</td>
<td>192.168.11.128</td>
<td>6379</td>
</tr>
<tr>
<td>Redis</td>
<td>å¦</td>
<td>192.168.11.129</td>
<td>6379</td>
</tr>
<tr>
<td>Redis</td>
<td>å¦</td>
<td>192.168.11.130</td>
<td>6379</td>
</tr>
<tr>
<td>Sentinel</td>
<td>-</td>
<td>192.168.11.128</td>
<td>26379</td>
</tr>
<tr>
<td>Sentinel</td>
<td>-</td>
<td>192.168.11.129</td>
<td>26379</td>
</tr>
<tr>
<td>Sentinel</td>
<td>-</td>
<td>192.168.11.130</td>
<td>26379</td>
</tr>
</tbody>
</table>
<p><img loading="lazy" src="2.jpg" alt=""  />

é¦–å…ˆé…ç½®Redisçš„ä¸»ä»æœåŠ¡å™¨ï¼Œä¿®æ”¹redis.confæ–‡ä»¶å¦‚ä¸‹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># ä½¿å¾—RedisæœåŠ¡å™¨å¯ä»¥è·¨ç½‘ç»œè®¿é—®
</span></span><span style="display:flex;"><span>bind 0.0.0.0
</span></span><span style="display:flex;"><span># è®¾ç½®å¯†ç 
</span></span><span style="display:flex;"><span>requirepass &#34;123456&#34;
</span></span><span style="display:flex;"><span># æŒ‡å®šä¸»æœåŠ¡å™¨ï¼Œæ³¨æ„ï¼šæœ‰å…³slaveofçš„é…ç½®åªæ˜¯é…ç½®ä»æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨ä¸éœ€è¦é…ç½®
</span></span><span style="display:flex;"><span>slaveof 192.168.11.128 6379
</span></span><span style="display:flex;"><span># ä¸»æœåŠ¡å™¨å¯†ç ï¼Œæ³¨æ„ï¼šæœ‰å…³slaveofçš„é…ç½®åªæ˜¯é…ç½®ä»æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨ä¸éœ€è¦é…ç½®
</span></span><span style="display:flex;"><span>masterauth 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°å†…å®¹ä¸»è¦æ˜¯é…ç½®RedisæœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨æ¯”ä¸»æœåŠ¡å™¨å¤šä¸€ä¸ªslaveofçš„é…ç½®å’Œå¯†ç ã€‚
é…ç½®3ä¸ªå“¨å…µï¼Œæ¯ä¸ªå“¨å…µçš„é…ç½®éƒ½æ˜¯ä¸€æ ·çš„ã€‚åœ¨Rediså®‰è£…ç›®å½•ä¸‹æœ‰ä¸€ä¸ªsentinel.confæ–‡ä»¶ï¼Œcopyä¸€ä»½è¿›è¡Œä¿®æ”¹ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># ç¦æ­¢ä¿æŠ¤æ¨¡å¼
</span></span><span style="display:flex;"><span>protected-mode no
</span></span><span style="display:flex;"><span># é…ç½®ç›‘å¬çš„ä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œsentinel monitorä»£è¡¨ç›‘æ§ï¼Œmymasterä»£è¡¨æœåŠ¡å™¨çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œ192.168.11.128ä»£è¡¨ç›‘æ§çš„ä¸»æœåŠ¡å™¨ï¼Œ6379ä»£è¡¨ç«¯å£ï¼Œ2ä»£è¡¨åªæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å“¨å…µè®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œfailoveræ“ä½œã€‚
</span></span><span style="display:flex;"><span>sentinel monitor mymaster 192.168.11.128 6379 2
</span></span><span style="display:flex;"><span># sentinel author-passå®šä¹‰æœåŠ¡çš„å¯†ç ï¼Œmymasteræ˜¯æœåŠ¡åç§°ï¼Œ123456æ˜¯RedisæœåŠ¡å™¨å¯†ç 
</span></span><span style="display:flex;"><span># sentinel auth-pass &lt;master-name&gt; &lt;password&gt;
</span></span><span style="display:flex;"><span>sentinel auth-pass mymaster 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šè¿°å…³é—­äº†ä¿æŠ¤æ¨¡å¼ï¼Œä¾¿äºæµ‹è¯•ã€‚
æœ‰äº†ä¸Šè¿°çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥Redisçš„å®‰è£…ç›®å½•çš„srcç›®å½•ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨æœåŠ¡å™¨å’Œå“¨å…µ</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># å¯åŠ¨RedisæœåŠ¡å™¨è¿›ç¨‹
</span></span><span style="display:flex;"><span>./redis-server ../redis.conf
</span></span><span style="display:flex;"><span># å¯åŠ¨å“¨å…µè¿›ç¨‹
</span></span><span style="display:flex;"><span>./redis-sentinel ../sentinel.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„å¯åŠ¨çš„é¡ºåºã€‚é¦–å…ˆæ˜¯ä¸»æœºï¼ˆ192.168.11.128ï¼‰çš„RedisæœåŠ¡è¿›ç¨‹ï¼Œç„¶åå¯åŠ¨ä»æœºçš„æœåŠ¡è¿›ç¨‹ï¼Œæœ€åå¯åŠ¨3ä¸ªå“¨å…µçš„æœåŠ¡è¿›ç¨‹ã€‚</p>
<h3 id="javaä¸­ä½¿ç”¨å“¨å…µæ¨¡å¼">Javaä¸­ä½¿ç”¨å“¨å…µæ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#javaä¸­ä½¿ç”¨å“¨å…µæ¨¡å¼">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * æµ‹è¯•Rediså“¨å…µæ¨¡å¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @author liu
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> TestSentinels {
</span></span><span style="display:flex;"><span>    @SuppressWarnings(<span style="color:#0ff;font-weight:bold">&#34;resource&#34;</span>)
</span></span><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> testSentinel() {
</span></span><span style="display:flex;"><span>        JedisPoolConfig jedisPoolConfig = <span style="color:#fff;font-weight:bold">new</span> JedisPoolConfig();
</span></span><span style="display:flex;"><span>        jedisPoolConfig.<span style="color:#007f7f">setMaxTotal</span>(<span style="color:#ff0;font-weight:bold">10</span>);
</span></span><span style="display:flex;"><span>        jedisPoolConfig.<span style="color:#007f7f">setMaxIdle</span>(<span style="color:#ff0;font-weight:bold">5</span>);
</span></span><span style="display:flex;"><span>        jedisPoolConfig.<span style="color:#007f7f">setMinIdle</span>(<span style="color:#ff0;font-weight:bold">5</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å“¨å…µä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Set&lt;String&gt; sentinels = <span style="color:#fff;font-weight:bold">new</span> HashSet&lt;&gt;(Arrays.<span style="color:#007f7f">asList</span>(<span style="color:#0ff;font-weight:bold">&#34;192.168.11.128:26379&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#0ff;font-weight:bold">&#34;192.168.11.129:26379&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;192.168.11.130:26379&#34;</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åˆ›å»ºè¿æ¥æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        JedisSentinelPool pool = <span style="color:#fff;font-weight:bold">new</span> JedisSentinelPool(<span style="color:#0ff;font-weight:bold">&#34;mymaster&#34;</span>, sentinels,jedisPoolConfig,<span style="color:#0ff;font-weight:bold">&#34;123456&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// è·å–å®¢æˆ·ç«¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Jedis jedis = pool.<span style="color:#007f7f">getResource</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        jedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;mykey&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;myvalue&#34;</span>);
</span></span><span style="display:flex;"><span>        String value = jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;mykey&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢æ˜¯é€šè¿‡Jedisè¿›è¡Œä½¿ç”¨çš„ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨Springè¿›è¡Œé…ç½®RedisTemplateä½¿ç”¨ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;bean id = &#34;poolConfig&#34; class=&#34;redis.clients.jedis.JedisPoolConfig&#34;&gt;
</span></span><span style="display:flex;"><span>	&lt;!-- æœ€å¤§ç©ºé—²æ•° --&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;maxIdle&#34; value=&#34;50&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;!-- æœ€å¤§è¿æ¥æ•° --&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;maxTotal&#34; value=&#34;100&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;!-- æœ€å¤§ç­‰å¾…æ—¶é—´ --&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;maxWaitMillis&#34; value=&#34;20000&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>&lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;bean id=&#34;connectionFactory&#34; class=&#34;org.springframework.data.redis.connection.jedis.JedisConnectionFactory&#34;&gt;
</span></span><span style="display:flex;"><span>	&lt;constructor-arg name=&#34;poolConfig&#34; ref=&#34;poolConfig&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>	&lt;constructor-arg name=&#34;sentinelConfig&#34; ref=&#34;sentinelConfig&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;password&#34; value=&#34;123456&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>&lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;!-- JDKåºåˆ—åŒ–å™¨ --&gt;
</span></span><span style="display:flex;"><span>&lt;bean id=&#34;jdkSerializationRedisSerializer&#34; class=&#34;org.springframework.data.redis.serializer.JdkSerializationRedisSerializer&#34;&gt;&lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;!-- Stringåºåˆ—åŒ–å™¨ --&gt;
</span></span><span style="display:flex;"><span>&lt;bean id=&#34;stringRedisSerializer&#34; class=&#34;org.springframework.data.redis.serializer.StringRedisSerializer&#34;&gt;&lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;bean id=&#34;redisTemplate&#34; class=&#34;org.springframework.data.redis.core.RedisTemplate&#34;&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;connectionFactory&#34; ref=&#34;connectionFactory&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;keySerializer&#34; ref=&#34;stringRedisSerializer&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;defaultSerializer&#34; ref=&#34;stringRedisSerializer&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;valueSerializer&#34; ref=&#34;jdkSerializationRedisSerializer&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>&lt;/bean&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;!-- å“¨å…µé…ç½® --&gt;
</span></span><span style="display:flex;"><span>&lt;bean id=&#34;sentinelConfig&#34; class=&#34;org.springframework.data.redis.connection.RedisSentinelConfiguration&#34;&gt;
</span></span><span style="display:flex;"><span>	&lt;!-- æœåŠ¡åç§° --&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;master&#34;&gt;
</span></span><span style="display:flex;"><span>		&lt;bean class=&#34;org.springframework.data.redis.connection.RedisNode&#34;&gt;
</span></span><span style="display:flex;"><span>			&lt;property name=&#34;name&#34; value=&#34;mymaster&#34;&gt;&lt;/property&gt;
</span></span><span style="display:flex;"><span>		&lt;/bean&gt;
</span></span><span style="display:flex;"><span>	&lt;/property&gt;
</span></span><span style="display:flex;"><span>	&lt;!-- å“¨å…µæœåŠ¡IPå’Œç«¯å£ --&gt;
</span></span><span style="display:flex;"><span>	&lt;property name=&#34;sentinels&#34;&gt;
</span></span><span style="display:flex;"><span>		&lt;set&gt;
</span></span><span style="display:flex;"><span>			&lt;bean class=&#34;org.springframework.data.redis.connection.RedisNode&#34;&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;host&#34; value=&#34;192.168.11.128&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;port&#34; value=&#34;26379&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>			&lt;/bean&gt;
</span></span><span style="display:flex;"><span>			&lt;bean class=&#34;org.springframework.data.redis.connection.RedisNode&#34;&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;host&#34; value=&#34;192.168.11.129&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;port&#34; value=&#34;26379&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>			&lt;/bean&gt;
</span></span><span style="display:flex;"><span>			&lt;bean class=&#34;org.springframework.data.redis.connection.RedisNode&#34;&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;host&#34; value=&#34;192.168.11.130&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>				&lt;constructor-arg name=&#34;port&#34; value=&#34;26379&#34;&gt;&lt;/constructor-arg&gt;
</span></span><span style="display:flex;"><span>			&lt;/bean&gt;
</span></span><span style="display:flex;"><span>		&lt;/set&gt;
</span></span><span style="display:flex;"><span>	&lt;/property&gt;
</span></span><span style="display:flex;"><span>&lt;/bean&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å“¨å…µæ¨¡å¼çš„å…¶ä»–é…ç½®é¡¹">å“¨å…µæ¨¡å¼çš„å…¶ä»–é…ç½®é¡¹<a hidden class="anchor" aria-hidden="true" href="#å“¨å…µæ¨¡å¼çš„å…¶ä»–é…ç½®é¡¹">#</a></h3>
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å‚æ•°ç±»å‹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>port</td>
<td>æ•´æ•°</td>
<td>å¯åŠ¨å“¨å…µè¿›ç¨‹ç«¯å£</td>
</tr>
<tr>
<td>dir</td>
<td>æ–‡ä»¶å¤¹ç›®å½•</td>
<td>å“¨å…µè¿›ç¨‹æœåŠ¡ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º/tmpï¼Œè¦ä¿è¯æœ‰å¯å†™å…¥çš„æƒé™</td>
</tr>
<tr>
<td>sentinel down-after-milliseconds</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šå“¨å…µåœ¨ç›‘æ§RedisæœåŠ¡æ—¶ï¼Œå½“RedisæœåŠ¡åœ¨ä¸€ä¸ªé»˜è®¤æ¯«ç§’æ•°å†…éƒ½æ— æ³•å›ç­”æ—¶ï¼Œå•ä¸ªå“¨å…µè®¤ä¸ºçš„ä¸»è§‚ä¸‹çº¿æ—¶é—´ï¼Œé»˜è®¤ä¸º30000ï¼ˆ30ç§’ï¼‰</td>
</tr>
<tr>
<td>sentinel parallel-syncs</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æœåŠ¡å™¨æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šå¯ä»¥æœ‰å¤šå°‘ä¸ªRedisæœåŠ¡åŒæ­¥æ–°çš„ä¸»æœºï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¿™ä¸ªæ•°å­—è¶Šå°åŒæ­¥æ—¶é—´è¶Šé•¿ï¼Œè€Œè¶Šå¤§ï¼Œåˆ™å¯¹ç½‘ç»œèµ„æºè¦æ±‚è¶Šé«˜</td>
</tr>
<tr>
<td>sentinel failover-timeout</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šæ•…éšœåˆ‡æ¢å…è®¸çš„æ¯«ç§’æ•°ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œå°±è®¤ä¸ºæ•…éšœåˆ‡æ¢å¤±è´¥ï¼Œé»˜è®¤ä¸º3åˆ†é’Ÿ</td>
</tr>
<tr>
<td>sentinel notification-script</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;è„šæœ¬è·¯å¾„&gt;</td>
<td>æŒ‡å®šsentinelæ£€æµ‹åˆ°è¯¥ç›‘æ§çš„rediså®ä¾‹æŒ‡å‘çš„å®ä¾‹å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨çš„æŠ¥è­¦è„šæœ¬ã€‚è¯¥é…ç½®é¡¹å¯é€‰ï¼Œæ¯”è¾ƒå¸¸ç”¨</td>
</tr>
</tbody>
</table>
<p>sentinel down-after-millisecondsé…ç½®é¡¹åªæ˜¯ä¸€ä¸ªå“¨å…µåœ¨è¶…è¿‡è§„å®šæ—¶é—´ä¾æ—§æ²¡æœ‰å¾—åˆ°å“åº”åï¼Œä¼šè‡ªå·±è®¤ä¸ºä¸»æœºä¸å¯ç”¨ã€‚å¯¹äºå…¶ä»–å“¨å…µè€Œè¨€ï¼Œå¹¶ä¸æ˜¯è¿™æ ·è®¤ä¸ºã€‚å“¨å…µä¼šè®°å½•è¿™ä¸ªæ¶ˆæ¯ï¼Œå½“æ‹¥æœ‰è®¤ä¸ºä¸»è§‚ä¸‹çº¿çš„å“¨å…µè¾¾åˆ°sentinel monitoræ‰€é…ç½®çš„æ•°é‡æ—¶ï¼Œå°±ä¼šå‘èµ·ä¸€æ¬¡æŠ•ç¥¨ï¼Œè¿›è¡Œfailoverï¼Œæ­¤æ—¶å“¨å…µä¼šé‡å†™Redisçš„å“¨å…µé…ç½®æ–‡ä»¶ï¼Œä»¥é€‚åº”æ–°åœºæ™¯çš„éœ€è¦ã€‚</p>
<h2 id="redisä¸»ä»é…ç½®å“¨å…µæ¨¡å¼dockerå®ç°">Redisä¸»ä»é…ç½®ã€å“¨å…µæ¨¡å¼ï¼ˆDockerå®ç°ï¼‰<a hidden class="anchor" aria-hidden="true" href="#redisä¸»ä»é…ç½®å“¨å…µæ¨¡å¼dockerå®ç°">#</a></h2>
<p>ä½¿ç”¨dockerä¸‹è½½redisé•œåƒï¼Œé»˜è®¤ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ã€‚
<code>docker pull redis</code></p>
<p>åˆ›å»ºæ–‡ä»¶å¤¹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cd /home
</span></span><span style="display:flex;"><span>mkdir docker
</span></span><span style="display:flex;"><span>cd docker
</span></span><span style="display:flex;"><span>mkdir redis
</span></span><span style="display:flex;"><span>cd redis
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mkdir redis-6379-data
</span></span><span style="display:flex;"><span>mkdir redis-6380-data
</span></span><span style="display:flex;"><span>mkdir redis-6381-data
</span></span><span style="display:flex;"><span>mkdir sentinel-26379-data
</span></span><span style="display:flex;"><span>mkdir sentinel-26380-data
</span></span><span style="display:flex;"><span>mkdir sentinel-26381-data
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºè‡ªå®šä¹‰é…ç½®æ–‡ä»¶</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>touch redis-6379.conf
</span></span><span style="display:flex;"><span>touch redis-6380.conf
</span></span><span style="display:flex;"><span>touch redis-6381.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­redis-6379.confæ˜¯masteræœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼Œredis-6380.confã€redis-6381.conf æ˜¯slaveæœåŠ¡å™¨é…ç½®æ–‡ä»¶ã€‚</p>
<p>ç¼–è¾‘6379é…ç½®æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 6379
</span></span><span style="display:flex;"><span>logfile &#34;redis-6379.log&#34;
</span></span><span style="display:flex;"><span>dir /data
</span></span><span style="display:flex;"><span>appendonly yes
</span></span><span style="display:flex;"><span>appendfilename appendonly.aof
</span></span><span style="display:flex;"><span>masterauth 123456
</span></span><span style="display:flex;"><span>requirepass 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¾‘6380ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 6380
</span></span><span style="display:flex;"><span>logfile &#34;redis-6380.log&#34;
</span></span><span style="display:flex;"><span>dir /data
</span></span><span style="display:flex;"><span>appendonly yes
</span></span><span style="display:flex;"><span>appendfilename appendonly.aof
</span></span><span style="display:flex;"><span>slaveof 192.168.43.188 6379
</span></span><span style="display:flex;"><span>masterauth 123456
</span></span><span style="display:flex;"><span>requirepass 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¾‘6381ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 6381
</span></span><span style="display:flex;"><span>logfile &#34;redis-6381.log&#34;
</span></span><span style="display:flex;"><span>dir /data
</span></span><span style="display:flex;"><span>appendonly yes
</span></span><span style="display:flex;"><span>appendfilename appendonly.aof
</span></span><span style="display:flex;"><span>slaveof 192.168.43.188 6379
</span></span><span style="display:flex;"><span>masterauth 123456
</span></span><span style="display:flex;"><span>requirepass 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åå¯åŠ¨ä¸‰ä¸ªrediså®¹å™¨ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker run -p 6379:6379 --net=host --restart=always --name redis-6379 -v /home/docker/redis/redis-6379.conf:/etc/redis/redis-6379.conf -v /home/docker/redis/redis-6379-data:/data -d redis redis-server /etc/redis/redis-6379.conf
</span></span><span style="display:flex;"><span>docker run -p 6380:6380 --net=host --restart=always --name redis-6380 -v /home/docker/redis/redis-6380.conf:/etc/redis/redis-6380.conf -v /home/docker/redis/redis-6380-data:/data -d redis redis-server /etc/redis/redis-6380.conf
</span></span><span style="display:flex;"><span>docker run -p 6381:6381 --net=host --restart=always --name redis-6381 -v /home/docker/redis/redis-6381.conf:/etc/redis/redis-6381.conf -v /home/docker/redis/redis-6381-data:/data -d redis redis-server /etc/redis/redis-6381.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘½ä»¤è§£é‡Šï¼š
<code>-v /home/docker/redis/redis-6379-data:/data</code>
è¯¥å‘½ä»¤æ˜¯å°†rediså®¹å™¨ä¸­ï¼Œredisé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„æ•°æ®å­˜å‚¨ç›®å½•/dataä¸‹æ–‡ä»¶çš„å†…å®¹å…±äº«åˆ°å®¿ä¸»æœº/home/docker/redis/redis-6379-dataç›®å½•ä¸‹ã€‚
ä¸ºä½•å¿…é¡»æŒ‚è½½<code>/data</code>ç›®å½•ï¼Ÿæœ‰çŠ¶æ€å®¹å™¨éƒ½æœ‰æ•°æ®æŒä¹…åŒ–éœ€æ±‚ï¼Œåœ¨å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œæ•°æ®æŒä¹…åŒ–æ˜¯æŒç»­çš„ï¼ŒåŒ…æ‹¬å®¹å™¨åœ¨è¢«åœæ­¢åï¼Œä½†å½“å®¹å™¨è¢«åˆ é™¤åï¼Œæ•°æ®ä¹Ÿéšä¹‹è¢«åˆ é™¤äº†ï¼Œå› æ­¤Docker é‡‡ç”¨ volume ï¼ˆå·ï¼‰çš„å½¢å¼æ¥å‘å®¹å™¨æä¾›æŒä¹…åŒ–å­˜å‚¨ï¼Œå¦‚æœä¸è®¾ç½®è¯¥å‘½ä»¤ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®ä¼šé»˜è®¤ä¿å­˜åœ¨rediså®¹å™¨ä¸­çš„/dataç›®å½•ä¸‹ï¼Œè¿™æ ·å½“æ‰§è¡Œ docker rm å®¹å™¨id/å®¹å™¨name å‘½ä»¤ï¼Œä¼šä¸¢å¤±æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p>
<p>æŸ¥çœ‹å®¹å™¨çŠ¶æ€ï¼š
<code>docker ps -a</code></p>
<p>å¦‚æœSTATUSçŠ¶æ€æ˜¯Upè¡¨ç¤ºæˆåŠŸå¯åŠ¨å®¹å™¨ï¼Œå¦‚æœSTATUSçŠ¶æ€æ˜¯Exited (1) æˆ–è€… Restarting (1) è¡¨ç¤ºæœªèƒ½æ­£å¸¸å¯åŠ¨ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦æŸ¥çœ‹rediså®¹å™¨æ—¥å¿—ä¿®æ”¹é…ç½®æ–‡ä»¶å†…å®¹é‡æ–°è¿è¡Œå®¹å™¨
<code>docker logs redis-6379|less</code>
æŸ¥æ‰¾å‡ºé—®é¢˜ååœæ­¢rediså®¹å™¨
<code>docker stop redis-6379</code>
åˆ é™¤rediså®¹å™¨
<code>docker rm redis-6379</code>
ç„¶åé‡æ–°æ‰§è¡Œæ­¥éª¤6ã€‚</p>
<p>å¯åŠ¨rediså®¹å™¨åï¼Œåˆ†åˆ«è§‚å¯Ÿä¸‰ä¸ªrediså®¹å™¨å†…éƒ¨æƒ…å†µ
<code>docker exec -it redis-6379 /bin/bash</code>
<code>redis-cli</code>
<code>127.0.0.1:6379&gt; auth 123456</code>
<code>info replication</code></p>
<p>masterä¼šæœ‰å¦‚ä¸‹æ˜¾ç¤º</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># Replication
</span></span><span style="display:flex;"><span>role:master
</span></span><span style="display:flex;"><span>connected_slaves:2
</span></span><span style="display:flex;"><span>slave0:ip=172.17.0.1,port=6379,state=online,offset=707,lag=0
</span></span><span style="display:flex;"><span>slave1:ip=172.17.0.1,port=6379,state=online,offset=707,lag=0
</span></span><span style="display:flex;"><span>master_replid:db3135b2f4cba8e6c1eb4be290b9dbfc2ec3b6d0
</span></span><span style="display:flex;"><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style="display:flex;"><span>master_repl_offset:707
</span></span><span style="display:flex;"><span>second_repl_offset:-1
</span></span><span style="display:flex;"><span>repl_backlog_active:1
</span></span><span style="display:flex;"><span>repl_backlog_size:1048576
</span></span><span style="display:flex;"><span>repl_backlog_first_byte_offset:1
</span></span><span style="display:flex;"><span>repl_backlog_histlen:707
</span></span></code></pre></td></tr></table>
</div>
</div><p>slaveæ˜¾ç¤ºï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>role:slave
</span></span><span style="display:flex;"><span>master_host:192.168.43.188
</span></span><span style="display:flex;"><span>master_port:6379
</span></span><span style="display:flex;"><span>master_link_status:up
</span></span><span style="display:flex;"><span>master_last_io_seconds_ago:8
</span></span><span style="display:flex;"><span>master_sync_in_progress:0
</span></span><span style="display:flex;"><span>slave_repl_offset:833
</span></span><span style="display:flex;"><span>slave_priority:100
</span></span><span style="display:flex;"><span>slave_read_only:1
</span></span><span style="display:flex;"><span>connected_slaves:0
</span></span><span style="display:flex;"><span>master_replid:db3135b2f4cba8e6c1eb4be290b9dbfc2ec3b6d0
</span></span><span style="display:flex;"><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style="display:flex;"><span>master_repl_offset:833
</span></span><span style="display:flex;"><span>second_repl_offset:-1
</span></span><span style="display:flex;"><span>repl_backlog_active:1
</span></span><span style="display:flex;"><span>repl_backlog_size:1048576
</span></span><span style="display:flex;"><span>repl_backlog_first_byte_offset:1
</span></span><span style="display:flex;"><span>repl_backlog_histlen:833
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹åˆ°ä¸»æœºrole:masterã€connected_slaves:2ï¼Œä¸¤å°ä»æœºrole:slaveã€master_hostæœ‰åœ°å€ï¼Œå¯ä»¥ç¡®è®¤redisä¸»ä»æ¨¡å¼å·²ç»å»ºç«‹æˆåŠŸã€‚
ä¸‹é¢å¯ä»¥ä½¿ç”¨<code>RedisDesktopManager</code>æˆ–åˆ†åˆ«è¿›å…¥å„ä¸ªrediså®¹å™¨ï¼Œæ¥æµ‹è¯•æ•°æ®æ˜¯å¦åŒæ­¥ã€‚æµ‹è¯•è¿‡ç¨‹æˆ‘å°±ç•¥äº†ã€‚</p>
<h3 id="å“¨å…µæ¨¡å¼">å“¨å…µæ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#å“¨å…µæ¨¡å¼">#</a></h3>
<p>ä¸»æœºä¸Šåˆ›å»ºå“¨å…µé…ç½®æ–‡ä»¶</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>touch sentinel-26379.conf
</span></span><span style="display:flex;"><span>touch sentinel-26380.conf
</span></span><span style="display:flex;"><span>touch sentinel-26381.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¾‘sentinel-26379.conf</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 26379
</span></span><span style="display:flex;"><span>dir &#34;/data&#34;
</span></span><span style="display:flex;"><span>logfile &#34;sentinel-26379.log&#34;
</span></span><span style="display:flex;"><span>sentinel monitor mymaster 192.168.43.188 6379 2
</span></span><span style="display:flex;"><span>sentinel down-after-milliseconds mymaster 10000
</span></span><span style="display:flex;"><span>sentinel failover-timeout mymaster 60000
</span></span><span style="display:flex;"><span>sentinel auth-pass mymaster 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¾‘sentinel-26380.conf</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 26380
</span></span><span style="display:flex;"><span>dir &#34;/data&#34;
</span></span><span style="display:flex;"><span>logfile &#34;sentinel-26380.log&#34;
</span></span><span style="display:flex;"><span>sentinel monitor mymaster 192.168.43.188 6379 2
</span></span><span style="display:flex;"><span>sentinel down-after-milliseconds mymaster 10000
</span></span><span style="display:flex;"><span>sentinel failover-timeout mymaster 60000
</span></span><span style="display:flex;"><span>sentinel auth-pass mymaster 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¾‘sentinel-26381.conf</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>port 26381
</span></span><span style="display:flex;"><span>dir &#34;/data&#34;
</span></span><span style="display:flex;"><span>logfile &#34;sentinel-26381.log&#34;
</span></span><span style="display:flex;"><span>sentinel monitor mymaster 192.168.43.188 6379 2
</span></span><span style="display:flex;"><span>sentinel down-after-milliseconds mymaster 10000
</span></span><span style="display:flex;"><span>sentinel failover-timeout mymaster 60000
</span></span><span style="display:flex;"><span>sentinel auth-pass mymaster 123456
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯åŠ¨å“¨å…µï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker run -p 26379:26379 --restart=always --name sentinel-26379 -v/home/docker/redis/sentinel-26379.conf:/etc/redis/sentinel.conf -v /home/docker/redis/sentinel-26379-data:/data -d redis redis-sentinel /etc/redis/sentinel.conf
</span></span><span style="display:flex;"><span>docker run -p 26380:26380 --restart=always --name sentinel-26380 -v/home/docker/redis/sentinel-26380.conf:/etc/redis/sentinel.conf -v /home/docker/redis/sentinel-26380-data:/data -d redis redis-sentinel /etc/redis/sentinel.conf
</span></span><span style="display:flex;"><span>docker run -p 26381:26381 --restart=always --name sentinel-26381 -v/home/docker/redis/sentinel-26381.conf:/etc/redis/sentinel.conf -v /home/docker/redis/sentinel-26381-data:/data -d redis redis-sentinel /etc/redis/sentinel.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹å“¨å…µå®¹å™¨çŠ¶æ€
<code>docker ps -a</code></p>
<p>è‡³æ­¤ï¼Œå“¨å…µæ¨¡å¼å·²ç»å»ºç«‹èµ·æ¥ï¼ŒæŸ¥çœ‹å“¨å…µä¿¡æ¯</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost redis]# docker exec -it sentinel-26379 /bin/bash
</span></span><span style="display:flex;"><span>root@zhangqian527halbin:/data# redis-cli -p 26379
</span></span><span style="display:flex;"><span>127.0.0.1:26379&gt;  info sentinel
</span></span><span style="display:flex;"><span># Sentinel
</span></span><span style="display:flex;"><span>sentinel_masters:1
</span></span><span style="display:flex;"><span>sentinel_tilt:0
</span></span><span style="display:flex;"><span>sentinel_running_scripts:0
</span></span><span style="display:flex;"><span>sentinel_scripts_queue_length:0
</span></span><span style="display:flex;"><span>sentinel_simulate_failure_flags:0
</span></span><span style="display:flex;"><span>master0:name=mymaster,status=ok,address=192.168.43.188:6379,slaves=2,sentinels=3
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨ç«¯å£å·ä¸º:6379çš„redisæœåŠ¡å™¨æ˜¯masteræœåŠ¡å™¨ï¼Œè¿™æ—¶æˆ‘ä»¬å…³é—­ç«¯å£å·ä¸º6379çš„redis-6379å®¹å™¨æµ‹è¯•å“¨å…µé…ç½®æ˜¯å¦ç”Ÿæ•ˆ
<code>docker stop redis-6379</code></p>
<p>ç„¶åå†æŸ¥çœ‹å“¨å…µä¿¡æ¯ï¼Œå“¨å…µæ¨¡å¼ä¸‹ï¼Œå½“masteræœåŠ¡å™¨å®•æœºä¹‹åï¼Œå“¨å…µè‡ªåŠ¨ä¼šåœ¨ä»slave redisæœåŠ¡å™¨é‡Œé¢æŠ•ç¥¨é€‰ä¸¾ä¸€ä¸ªmasteræœåŠ¡å™¨æ¥ï¼Œè¿™ä¸ªmasteræœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œ</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost redis]# docker exec -it sentinel-26379 /bin/bash
</span></span><span style="display:flex;"><span>root@zhangqian527halbin:/data# redis-cli -p 26379
</span></span><span style="display:flex;"><span>127.0.0.1:26379&gt;  info sentinel
</span></span><span style="display:flex;"><span>sentinel_masters:1
</span></span><span style="display:flex;"><span>sentinel_tilt:0
</span></span><span style="display:flex;"><span>sentinel_running_scripts:0
</span></span><span style="display:flex;"><span>sentinel_scripts_queue_length:0
</span></span><span style="display:flex;"><span>sentinel_simulate_failure_flags:0
</span></span><span style="display:flex;"><span>master0:name=mymaster,status=ok,address=192.168.43.188:6380,slaves=2,sentinels=3
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°ç«¯å£å·ä¸º:6380çš„redisæœåŠ¡å™¨å·²ç»å˜æˆmasteræœåŠ¡å™¨äº†ï¼Œè¯´æ˜å“¨å…µé…ç½®æˆåŠŸã€‚
<a href="https://www.jianshu.com/p/ce1d78cd368a">å‚è€ƒ</a></p>
<h2 id="redisson-å®ç°åˆ†å¸ƒå¼é”">redisson å®ç°åˆ†å¸ƒå¼é”<a hidden class="anchor" aria-hidden="true" href="#redisson-å®ç°åˆ†å¸ƒå¼é”">#</a></h2>
<h3 id="1-å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1-å¼•å…¥ä¾èµ–">#</a></h3>
<p>åœ¨ä½ çš„<code>pom.xml</code>æ–‡ä»¶ä¸­æ·»åŠ Redissonçš„Spring Boot Starterä¾èµ–ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;groupId&gt;</span>org.redisson<span style="font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;artifactId&gt;</span>redisson-spring-boot-starter<span style="font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="font-weight:bold">&lt;version&gt;</span>3.17.6<span style="font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-é…ç½®redis">2. é…ç½®Redis<a hidden class="anchor" aria-hidden="true" href="#2-é…ç½®redis">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#007f7f">spring</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#007f7f">data</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">redis</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">host</span>: <span style="color:#0ff;font-weight:bold">192.168.1.1 # RedisæœåŠ¡å™¨åœ°å€</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">database</span>: <span style="color:#0ff;font-weight:bold">3 # Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">port</span>: <span style="color:#0ff;font-weight:bold">6379 # RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">password</span>: <span style="color:#0ff;font-weight:bold">123456 # RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">timeout</span>: <span style="color:#0ff;font-weight:bold">30000 # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">minIdle</span>: <span style="color:#0ff;font-weight:bold">20</span>
</span></span><span style="display:flex;"><span>      <span style="color:#007f7f">poolSize</span>: <span style="color:#0ff;font-weight:bold">30</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-é…ç½®ç±»">3. é…ç½®ç±»<a hidden class="anchor" aria-hidden="true" href="#3-é…ç½®ç±»">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Getter
</span></span><span style="display:flex;"><span>@Setter
</span></span><span style="display:flex;"><span>@Configuration
</span></span><span style="display:flex;"><span>@ConfigurationProperties(prefix = <span style="color:#0ff;font-weight:bold">&#34;spring.data.redis&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedissonConfig {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> String host;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> Integer database;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> String port;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> String password;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> minIdle;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> poolSize;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Bean
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> RedissonClient redissonClient() {
</span></span><span style="display:flex;"><span>        Config config = <span style="color:#fff;font-weight:bold">new</span> Config();
</span></span><span style="display:flex;"><span>        String node = <span style="color:#0ff;font-weight:bold">&#34;redis://&#34;</span> + host + <span style="color:#0ff;font-weight:bold">&#34;:&#34;</span> + port;
</span></span><span style="display:flex;"><span>        SingleServerConfig serverConfig = config.<span style="color:#007f7f">useSingleServer</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#007f7f">setAddress</span>(node)
</span></span><span style="display:flex;"><span>            .<span style="color:#007f7f">setDatabase</span>(database)
</span></span><span style="display:flex;"><span>            .<span style="color:#007f7f">setConnectionPoolSize</span>(poolSize)
</span></span><span style="display:flex;"><span>            .<span style="color:#007f7f">setConnectionMinimumIdleSize</span>(minIdle);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (StringUtils.<span style="color:#007f7f">isNotBlank</span>(password)) {
</span></span><span style="display:flex;"><span>            serverConfig.<span style="color:#007f7f">setPassword</span>(password);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> Redisson.<span style="color:#007f7f">create</span>(config);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-ä½¿ç”¨redissonåˆ†å¸ƒå¼é”">4. ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”<a hidden class="anchor" aria-hidden="true" href="#4-ä½¿ç”¨redissonåˆ†å¸ƒå¼é”">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.redisson.api.RLock;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.redisson.api.RedissonClient;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.beans.factory.annotation.Autowired;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.stereotype.Service;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.concurrent.TimeUnit;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@Service
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MyService {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Autowired
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> RedissonClient redissonClient;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> doSomething() {
</span></span><span style="display:flex;"><span>        RLock lock = redissonClient.<span style="color:#007f7f">getLock</span>(<span style="color:#0ff;font-weight:bold">&#34;myLock&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// å°è¯•è·å–é”ï¼Œæœ€å¤šç­‰å¾…2ç§’ï¼Œä¸Šé”å10ç§’è‡ªåŠ¨è§£é”
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (lock.<span style="color:#007f7f">tryLock</span>(<span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#ff0;font-weight:bold">10</span>, TimeUnit.<span style="color:#007f7f">SECONDS</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// åœ¨é”å†…æ‰§è¡Œçš„ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–é”æˆåŠŸï¼Œæ‰§è¡Œå—ä¿æŠ¤çš„ä»£ç &#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// æ¨¡æ‹Ÿä¸€äº›é•¿æ—¶é—´æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">5000</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// è·å–é”å¤±è´¥ï¼Œå¯ä»¥æç¤ºç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå…¶ä»–æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                Assert.<span style="color:#007f7f">isTrue</span>(<span style="color:#fff;font-weight:bold">false</span>, <span style="color:#0ff;font-weight:bold">&#34;æ‚¨çš„è¯·æ±‚è¿‡äºé¢‘ç¹&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (lock.<span style="color:#007f7f">isLocked</span>() &amp;&amp; lock.<span style="color:#007f7f">isHeldByCurrentThread</span>()) {
</span></span><span style="display:flex;"><span>                lock.<span style="color:#007f7f">unlock</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ Redisson ä¸­ï¼Œ<code>tryLock</code> æ–¹æ³•çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li><strong>waitTime (long)</strong>ï¼šç­‰å¾…æ—¶é—´ï¼Œå³å°è¯•è·å–é”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚</li>
<li><strong>leaseTime (long)</strong>ï¼šç§Ÿçº¦æ—¶é—´ï¼Œå³é”çš„æŒæœ‰æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´åé”ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚</li>
<li><strong>timeUnit (TimeUnit)</strong>ï¼šæ—¶é—´å•ä½ï¼Œç”¨äºæŒ‡å®š <code>waitTime</code> å’Œ <code>leaseTime</code> çš„å•ä½ã€‚</li>
</ol>
<h3 id="waittime-ç­‰å¾…æ—¶é—´"><code>waitTime</code> (ç­‰å¾…æ—¶é—´)<a hidden class="anchor" aria-hidden="true" href="#waittime-ç­‰å¾…æ—¶é—´">#</a></h3>
<p><code>waitTime</code> æ˜¯æŒ‡çº¿ç¨‹åœ¨å°è¯•è·å–é”æ—¶ï¼Œç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚è®¾ç½® <code>waitTime</code> æ—¶åº”è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p>
<ol>
<li><strong>ä¸šåŠ¡æ“ä½œçš„é‡è¦æ€§å’Œç´§æ€¥æ€§</strong>ï¼š
<ul>
<li>å¦‚æœä¸šåŠ¡æ“ä½œéå¸¸é‡è¦ä¸”å¿…é¡»ç¡®ä¿å®Œæˆï¼Œå¯ä»¥è®¾ç½®è¾ƒé•¿çš„ <code>waitTime</code>ï¼Œä»¥å°½é‡è·å–é”ã€‚</li>
<li>å¦‚æœä¸šåŠ¡æ“ä½œå¯ä»¥å»¶è¿Ÿæˆ–è€…æœ‰æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥è®¾ç½®è¾ƒçŸ­çš„ <code>waitTime</code>ï¼Œé¿å…é•¿æ—¶é—´é˜»å¡çº¿ç¨‹ã€‚</li>
</ul>
</li>
<li><strong>ç³»ç»Ÿçš„è´Ÿè½½å’Œå¹¶å‘æƒ…å†µ</strong>ï¼š
<ul>
<li>åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸­ï¼Œè¾ƒé•¿çš„ <code>waitTime</code> å¯èƒ½å¯¼è‡´æ›´å¤šçº¿ç¨‹ç­‰å¾…ï¼Œä»è€Œå¢åŠ ç³»ç»Ÿå‹åŠ›ã€‚</li>
<li>åœ¨ä½å¹¶å‘ç¯å¢ƒä¸­ï¼Œè¾ƒé•¿çš„ <code>waitTime</code> æœ‰åŠ©äºæˆåŠŸè·å–é”ï¼Œæé«˜ä»»åŠ¡æˆåŠŸç‡ã€‚</li>
</ul>
</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼š
<ul>
<li>å¯¹äºç”¨æˆ·æ“ä½œçš„è¯·æ±‚ï¼Œè¿‡é•¿çš„ <code>waitTime</code> å¯èƒ½å¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ï¼Œåº”å°½é‡å‡å°‘ç­‰å¾…æ—¶é—´ã€‚</li>
</ul>
</li>
</ol>
<h3 id="leasetime-æŒæœ‰æ—¶é—´"><code>leaseTime</code> (æŒæœ‰æ—¶é—´)<a hidden class="anchor" aria-hidden="true" href="#leasetime-æŒæœ‰æ—¶é—´">#</a></h3>
<p><code>leaseTime</code> æ˜¯æŒ‡é”çš„æŒæœ‰æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´åé”ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚è®¾ç½® <code>leaseTime</code> æ—¶åº”è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p>
<ol>
<li><strong>ä¸šåŠ¡æ“ä½œçš„æ‰§è¡Œæ—¶é—´</strong>ï¼š
<ul>
<li><code>leaseTime</code> åº”è¯¥è¶³å¤Ÿé•¿ï¼Œèƒ½å¤Ÿè¦†ç›–ä¸šåŠ¡æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œç¡®ä¿åœ¨æ“ä½œå®Œæˆä¹‹å‰é”ä¸ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚</li>
<li>å¯ä»¥æ ¹æ®æ“ä½œçš„å¤æ‚åº¦å’Œæ‰§è¡Œæ—¶é—´è®¾ç½®é€‚å½“çš„ <code>leaseTime</code>ï¼Œä¾‹å¦‚ä¸šåŠ¡æ“ä½œé€šå¸¸åœ¨5ç§’å†…å®Œæˆï¼Œå¯ä»¥è®¾ç½®ä¸º10ç§’ä»¥ç¡®ä¿å®‰å…¨ã€‚</li>
</ul>
</li>
<li><strong>é˜²æ­¢æ­»é”</strong>ï¼š
<ul>
<li>é€šè¿‡è®¾ç½® <code>leaseTime</code>ï¼Œå¯ä»¥é˜²æ­¢é”å› çº¿ç¨‹æ„å¤–ç»ˆæ­¢æˆ–æœªæ­£å¸¸é‡Šæ”¾è€Œå¯¼è‡´çš„æ­»é”ã€‚</li>
<li>ç¡®ä¿ <code>leaseTime</code> ä¸è¦è¿‡é•¿ï¼Œä»¥ä¾¿é”å¯ä»¥å°½å¿«é‡Šæ”¾ä¾›å…¶ä»–çº¿ç¨‹ä½¿ç”¨ã€‚</li>
</ul>
</li>
</ol>
<h2 id="redis-setnx-å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ä¸æ¨èè¯·ä½¿ç”¨redisson">Redis SETNX å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ï¼ˆä¸æ¨èï¼Œè¯·ä½¿ç”¨redissonï¼‰<a hidden class="anchor" aria-hidden="true" href="#redis-setnx-å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ä¸æ¨èè¯·ä½¿ç”¨redisson">#</a></h2>
<p>èµ·å› ï¼š
æœ€å¼€å§‹æˆ‘ä»¬æ˜¯å•æœåŠ¡ï¼Œæ³¨å†Œæ—¶å€™æ€»æ˜¯å‡ºç°é‡å¤çš„æ‰‹æœºå·ç”¨æˆ·ã€‚
äºæ˜¯åŠ äº†åŒæ­¥é”<code>synchronized</code>ï¼Œè§£å†³äº†é—®é¢˜ã€‚</p>
<p>åæ¥ç”¨äº†é˜¿é‡Œäº‘SLBåˆ†å¸ƒå¼æœåŠ¡ã€‚åˆå‡ºç°äº†é‡å¤æ³¨å†Œçš„é—®é¢˜ï¼Œæƒ³åˆ°ç”¨redisçš„SETNXæ¥è§£å†³é—®é¢˜ã€‚
ç°åœ¨åˆ†å¸ƒå¼çš„åº”ç”¨åœºæ™¯å¾ˆå¤šï¼Œä¸ºäº†ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ï¼Œç»å¸¸ç¢°åˆ°éœ€è¦å¯¹èµ„æºåŠ é”çš„æƒ…å½¢ã€‚åˆ©ç”¨redisæ¥å®ç°åˆ†å¸ƒå¼é”å°±æ˜¯å…¶ä¸­çš„ä¸€ç§å®ç°æ–¹æ¡ˆã€‚
å‘½ä»¤å„å¼ï¼š
<code>SETNX key value</code></p>
<p>å°† key çš„å€¼è®¾ä¸º value ï¼Œå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨ã€‚
è‹¥ç»™å®šçš„ key å·²ç»å­˜åœ¨ï¼Œåˆ™ SETNX ä¸åšä»»ä½•åŠ¨ä½œã€‚
SETNX æ˜¯ã€SET if Not eXistsã€(å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ SET)çš„ç®€å†™ã€‚
è®¾ç½®æˆåŠŸï¼Œè¿”å›1ã€‚
è®¾ç½®å¤±è´¥ï¼Œè¿”å›0ã€‚
åˆ©ç”¨SETNXçš„ç‰¹æ€§ï¼Œå¾ˆå®¹æ˜“çš„æƒ³åˆ°ï¼Œåœ¨éœ€è¦åŠ é”çš„æ—¶å€™ï¼Œè°ƒç”¨SETNXå‘½ä»¤ï¼Œå¦‚æœè¿”å›äº†1ï¼Œè¡¨ç¤ºè®¾ç½®æˆåŠŸï¼Œè·å¾—äº†å½“å‰é”ï¼Œä¹‹ååšä¸€äº›æƒ³è¦çš„æ“ä½œï¼Œå®Œæˆä¹‹åè°ƒç”¨DELå‘½ä»¤é‡Šæ”¾é”ã€‚
å› ä¸ºjavaçš„try/catchç‰¹æ€§ï¼Œå³ä½¿ç¨‹åºæŠ¥é”™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨finallyå—é‡Šæ”¾é”ï¼Œè¿™æ ·ä¸ä¼šå› ä¸ºç¨‹åºæŠ¥é”™å¯¼è‡´æ‰€æ— æ³•é‡Šæ”¾çš„æƒ…å†µã€‚
ç¤ºä¾‹ä»£ç ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>    Boolean result = redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">setIfAbsent</span>(<span style="color:#0ff;font-weight:bold">&#34;reg_&#34;</span> + newUser.<span style="color:#007f7f">getMobile</span>(),newUser.<span style="color:#007f7f">getMobile</span>(),<span style="color:#ff0;font-weight:bold">30</span>,TimeUnit.<span style="color:#007f7f">SECONDS</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span>(result){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//æ’å…¥æ–°ç”¨æˆ·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        usersMapper.<span style="color:#007f7f">insertSelective</span>(newUser);
</span></span><span style="display:flex;"><span>        redisTemplate.<span style="color:#007f7f">delete</span>(<span style="color:#0ff;font-weight:bold">&#34;reg_&#34;</span> + newUser.<span style="color:#007f7f">getMobile</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>} <span style="color:#fff;font-weight:bold">catch</span> (java.<span style="color:#007f7f">lang</span>.<span style="color:#007f7f">Exception</span> e) {
</span></span><span style="display:flex;"><span>    e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>} <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>    redisTemplate.<span style="color:#007f7f">delete</span>(<span style="color:#0ff;font-weight:bold">&#34;reg_&#34;</span> + newUser.<span style="color:#007f7f">getMobile</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¹‚ç­‰æ€§ï¼š
HTTP/1.1ä¸­å¯¹å¹‚ç­‰æ€§çš„å®šä¹‰æ˜¯ï¼šä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æºå¯¹äºèµ„æºæœ¬èº«åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœï¼ˆç½‘ç»œè¶…æ—¶ç­‰é—®é¢˜é™¤å¤–ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œå¯¹èµ„æºæœ¬èº«æ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚
å¾ˆå¤šå¤æ‚çš„äº‹åŠ¡è¦åˆ†å¸ƒè¿›è¡Œï¼Œä½†å®ƒä»¬ç»„æˆäº†ä¸€ä¸ªæ•´ä½“ï¼Œè¦ä¹ˆæ•´ä½“ç”Ÿæ•ˆï¼Œè¦ä¹ˆæ•´ä½“å¤±æ•ˆã€‚è¿™ç§æ€æƒ³ååº”åˆ°æ•°æ®åº“ä¸Šï¼Œå°±æ˜¯å¤šæ¡SQLè¯­å¥ï¼Œè¦ä¹ˆæ‰€æœ‰æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆæ‰€æœ‰æ‰§è¡Œå¤±è´¥ã€‚</p>
<p><a href="https://blog.csdn.net/harleylau/article/details/85856774">å‚è€ƒ</a></p>
<h2 id="redis-keyçš„è®¾è®¡">redis keyçš„è®¾è®¡<a hidden class="anchor" aria-hidden="true" href="#redis-keyçš„è®¾è®¡">#</a></h2>
<p>å…³ç³»å‹æ•°æ®åº“çš„redis
ä¾‹ï¼š<code>user:userId:9:username</code></p>
<ol>
<li>è¡¨åï¼š<code>user:</code></li>
<li>åˆ—åï¼š<code>userId:</code></li>
<li>åˆ—å€¼ï¼š<code>9:</code></li>
<li>è¦å­˜å‚¨çš„åˆ—åï¼š<code>username</code></li>
</ol>
<p><a href="https://www.joshua317.com/article/37">å‚è€ƒ</a></p>
<h1 id="jedisæ“ä½œredis">Jedisæ“ä½œredis<a hidden class="anchor" aria-hidden="true" href="#jedisæ“ä½œredis">#</a></h1>
<h2 id="åˆå§‹åŒ–">åˆå§‹åŒ–<a hidden class="anchor" aria-hidden="true" href="#åˆå§‹åŒ–">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedisClient {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> Jedis jedis;<span style="color:#007f7f">// éåˆ‡ç‰‡å®¢æˆ·ç«¯è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">private</span> JedisPool jedisPool;<span style="color:#007f7f">// éåˆ‡ç‰‡è¿æ¥æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">private</span> ShardedJedis shardedJedis;<span style="color:#007f7f">// åˆ‡ç‰‡å®¢æˆ·ç«¯è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">private</span> ShardedJedisPool shardedJedisPool;<span style="color:#007f7f">// åˆ‡ç‰‡è¿æ¥æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> RedisClient() {
</span></span><span style="display:flex;"><span>	initialPool();
</span></span><span style="display:flex;"><span>	initialShardedPool();
</span></span><span style="display:flex;"><span>	shardedJedis = shardedJedisPool.<span style="color:#007f7f">getResource</span>();
</span></span><span style="display:flex;"><span>	jedis = jedisPool.<span style="color:#007f7f">getResource</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆå§‹åŒ–éåˆ‡ç‰‡è¿æ¥æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> initialPool() {
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ± åŸºæœ¬é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	JedisPoolConfig config = <span style="color:#fff;font-weight:bold">new</span> JedisPoolConfig();
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//å¯ç”¨è¿æ¥å®ä¾‹çš„æœ€å¤§æ•°ç›®ï¼Œé»˜è®¤å€¼ä¸º8
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	config.<span style="color:#007f7f">setMaxActive</span>(<span style="color:#ff0;font-weight:bold">20</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//æ§åˆ¶ä¸€ä¸ªpoolæœ€å¤šæœ‰å¤šå°‘ä¸ªçŠ¶æ€ä¸ºidle(ç©ºé—²çš„)çš„jediså®ä¾‹ï¼Œé»˜è®¤å€¼ä¹Ÿæ˜¯8
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	config.<span style="color:#007f7f">setMaxIdle</span>(<span style="color:#ff0;font-weight:bold">5</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//ç­‰å¾…å¯ç”¨è¿æ¥çš„æœ€å¤§æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤å€¼ä¸º-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœè¶…è¿‡ç­‰å¾…æ—¶é—´ï¼Œåˆ™ç›´æ¥æŠ›å‡ºJedisConnectionException
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	config.<span style="color:#007f7f">setMaxWait</span>(<span style="color:#ff0;font-weight:bold">1000l</span>);
</span></span><span style="display:flex;"><span>	config.<span style="color:#007f7f">setTestOnBorrow</span>(<span style="color:#fff;font-weight:bold">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	jedisPool = <span style="color:#fff;font-weight:bold">new</span> JedisPool(config, <span style="color:#0ff;font-weight:bold">&#34;127.0.0.1&#34;</span>, <span style="color:#ff0;font-weight:bold">6379</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆå§‹åŒ–åˆ‡ç‰‡æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> initialShardedPool() {
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ± åŸºæœ¬é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	JedisPoolConfig config = <span style="color:#fff;font-weight:bold">new</span> JedisPoolConfig();
</span></span><span style="display:flex;"><span>	config.<span style="color:#007f7f">setMaxActive</span>(<span style="color:#ff0;font-weight:bold">20</span>);
</span></span><span style="display:flex;"><span>	config.<span style="color:#007f7f">setMaxIdle</span>(<span style="color:#ff0;font-weight:bold">5</span>);
</span></span><span style="display:flex;"><span>	config.<span style="color:#007f7f">setMaxWait</span>(<span style="color:#ff0;font-weight:bold">1000l</span>);
</span></span><span style="display:flex;"><span>	config.<span style="color:#007f7f">setTestOnBorrow</span>(<span style="color:#fff;font-weight:bold">false</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// slaveé“¾æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	List&lt;JedisShardInfo&gt; shards = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;JedisShardInfo&gt;();
</span></span><span style="display:flex;"><span>	shards.<span style="color:#007f7f">add</span>(<span style="color:#fff;font-weight:bold">new</span> JedisShardInfo(<span style="color:#0ff;font-weight:bold">&#34;127.0.0.1&#34;</span>, <span style="color:#ff0;font-weight:bold">6379</span>, <span style="color:#0ff;font-weight:bold">&#34;master&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ„é€ æ± 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	shardedJedisPool = <span style="color:#fff;font-weight:bold">new</span> ShardedJedisPool(config, shards);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> show() {
</span></span><span style="display:flex;"><span>	KeyOperate();
</span></span><span style="display:flex;"><span>	StringOperate();
</span></span><span style="display:flex;"><span>	ListOperate();
</span></span><span style="display:flex;"><span>	SetOperate();
</span></span><span style="display:flex;"><span>	SortedSetOperate();
</span></span><span style="display:flex;"><span>	HashOperate();
</span></span><span style="display:flex;"><span>	jedisPool.<span style="color:#007f7f">returnResource</span>(jedis);
</span></span><span style="display:flex;"><span>	shardedJedisPool.<span style="color:#007f7f">returnResource</span>(shardedJedis);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="key-1">key<a hidden class="anchor" aria-hidden="true" href="#key-1">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * key åŠŸèƒ½ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.æ¸…ç©ºæ‰€æœ‰æ•°æ® jedis.flushDB()
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ shardedJedis.exists(&#34;key1&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.æ–°å¢é”®å€¼å¯¹ shardedJedis.set(&#34;key001&#34;, &#34;value001&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.åˆ é™¤æŸä¸ªkey,è‹¥keyä¸å­˜åœ¨ï¼Œåˆ™å¿½ç•¥è¯¥å‘½ä»¤ jedis.del(&#34;key002&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.è®¾ç½® key001çš„è¿‡æœŸæ—¶é—´ jedis.expire(&#34;key001&#34;, 5)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.æŸ¥çœ‹æŸä¸ªkeyçš„å‰©ä½™ç”Ÿå­˜æ—¶é—´,å•ä½ã€ç§’ã€‘.æ°¸ä¹…ç”Ÿå­˜æˆ–è€…ä¸å­˜åœ¨çš„éƒ½è¿”å›-1  jedis.ttl(&#34;key001&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 7.ç§»é™¤æŸä¸ªkeyçš„ç”Ÿå­˜æ—¶é—´  jedis.persist(&#34;key001&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 8.æŸ¥çœ‹keyæ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ jedis.type(&#34;key001&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> KeyOperate() {
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================key==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ¸…ç©ºåº“ä¸­æ‰€æœ‰æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// åˆ¤æ–­keyå¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ¤æ–­key999é”®æ˜¯å¦å­˜åœ¨ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">exists</span>(<span style="color:#0ff;font-weight:bold">&#34;key999&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ–°å¢key001,value001é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ¤æ–­key001æ˜¯å¦å­˜åœ¨ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">exists</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// è¾“å‡ºç³»ç»Ÿä¸­æ‰€æœ‰çš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ–°å¢key002,value002é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç³»ç»Ÿä¸­æ‰€æœ‰é”®å¦‚ä¸‹ï¼š&#34;</span>);
</span></span><span style="display:flex;"><span>	Set&lt;String&gt; keys = jedis.<span style="color:#007f7f">keys</span>(<span style="color:#0ff;font-weight:bold">&#34;*&#34;</span>);
</span></span><span style="display:flex;"><span>	Iterator&lt;String&gt; it = keys.<span style="color:#007f7f">iterator</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">while</span> (it.<span style="color:#007f7f">hasNext</span>()) {
</span></span><span style="display:flex;"><span>		String key = it.<span style="color:#007f7f">next</span>();
</span></span><span style="display:flex;"><span>		System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(key);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// åˆ é™¤æŸä¸ªkey,è‹¥keyä¸å­˜åœ¨ï¼Œåˆ™å¿½ç•¥è¯¥å‘½ä»¤ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç³»ç»Ÿä¸­åˆ é™¤key002: &#34;</span> + jedis.<span style="color:#007f7f">del</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ¤æ–­key002æ˜¯å¦å­˜åœ¨ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">exists</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// è®¾ç½® key001çš„è¿‡æœŸæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è®¾ç½® key001çš„è¿‡æœŸæ—¶é—´ä¸º5ç§’:&#34;</span> + jedis.<span style="color:#007f7f">expire</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#ff0;font-weight:bold">5</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>		Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">2000</span>);
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æŸ¥çœ‹æŸä¸ªkeyçš„å‰©ä½™ç”Ÿå­˜æ—¶é—´,å•ä½ã€ç§’ã€‘.æ°¸ä¹…ç”Ÿå­˜æˆ–è€…ä¸å­˜åœ¨çš„éƒ½è¿”å›-1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹key001çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼š&#34;</span> + jedis.<span style="color:#007f7f">ttl</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// ç§»é™¤æŸä¸ªkeyçš„ç”Ÿå­˜æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç§»é™¤key001çš„ç”Ÿå­˜æ—¶é—´ï¼š&#34;</span> + jedis.<span style="color:#007f7f">persist</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹key001çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼š&#34;</span> + jedis.<span style="color:#007f7f">ttl</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æŸ¥çœ‹keyæ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹keyæ‰€å‚¨å­˜çš„å€¼çš„ç±»å‹ï¼š&#34;</span> + jedis.<span style="color:#007f7f">type</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">/*
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * ä¸€äº›å…¶ä»–æ–¹æ³•ï¼š1ã€ä¿®æ”¹é”®åï¼šjedis.rename(&#34;key6&#34;, &#34;key0&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * 2ã€å°†å½“å‰dbçš„keyç§»åŠ¨åˆ°ç»™å®šçš„dbå½“ä¸­ï¼šjedis.move(&#34;foo&#34;, 1)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 */</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="string-2">string<a hidden class="anchor" aria-hidden="true" href="#string-2">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * StringåŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.ä¸€æ¬¡æ€§æ–°å¢key201,key202  jedis.mset(&#34;key201&#34;, &#34;value201&#34;, &#34;key202&#34;, &#34;value202&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.ä¸€æ¬¡æ€§åˆ é™¤key201,key202  jedis.del(new String[] { &#34;key201&#34;, &#34;key202&#34; }
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.ä¸€æ¬¡æ€§è·å–key201,key202  jedis.mget(&#34;key201&#34;, &#34;key202&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.æ–°å¢é”®å€¼å¯¹æ—¶é˜²æ­¢è¦†ç›–åŸå…ˆå€¼  shardedJedis.setnx(&#34;key302&#34;, &#34;value302_new&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.è·å–åŸå€¼ï¼Œæ›´æ–°ä¸ºæ–°å€¼ä¸€æ­¥å®Œæˆ shardedJedis.getSet(&#34;key302&#34;, &#34;value302-after-getset&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.è·å–key302å¯¹åº”å€¼ä¸­çš„å­ä¸²   shardedJedis.getrange(&#34;key302&#34;, 5, 7)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> StringOperate() {
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================String_1==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ¸…ç©ºåº“ä¸­æ‰€æœ‰æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢=============&#34;</span>);
</span></span><span style="display:flex;"><span>	jedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value001&#34;</span>);
</span></span><span style="display:flex;"><span>	jedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value002&#34;</span>);
</span></span><span style="display:flex;"><span>	jedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value003&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å·²æ–°å¢çš„3ä¸ªé”®å€¼å¯¹å¦‚ä¸‹ï¼š&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============åˆ =============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ é™¤key003é”®å€¼å¯¹ï¼š&#34;</span> + jedis.<span style="color:#007f7f">del</span>(<span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key003é”®å¯¹åº”çš„å€¼ï¼š&#34;</span> + jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ”¹=============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// 1ã€ç›´æ¥è¦†ç›–åŸæ¥çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç›´æ¥è¦†ç›–key001åŸæ¥çš„æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">set</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value001-update&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key001å¯¹åº”çš„æ–°å€¼ï¼š&#34;</span> + jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// 2ã€ç›´æ¥è¦†ç›–åŸæ¥çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åœ¨key002åŸæ¥å€¼åé¢è¿½åŠ ï¼š&#34;</span> + jedis.<span style="color:#007f7f">append</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;+appendString&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key002å¯¹åº”çš„æ–°å€¼&#34;</span> + jedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢ï¼Œåˆ ï¼ŒæŸ¥ï¼ˆå¤šä¸ªï¼‰=============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * mset,mgetåŒæ—¶æ–°å¢ï¼Œä¿®æ”¹ï¼ŒæŸ¥è¯¢å¤šä¸ªé”®å€¼å¯¹ ç­‰ä»·äºï¼š jedis.set(&#34;name&#34;,&#34;ssss&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * jedis.set(&#34;jarorwar&#34;,&#34;xxxx&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 */</span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ä¸€æ¬¡æ€§æ–°å¢key201,key202,key203,key204åŠå…¶å¯¹åº”å€¼ï¼š&#34;</span>
</span></span><span style="display:flex;"><span>			+ jedis.<span style="color:#007f7f">mset</span>(<span style="color:#0ff;font-weight:bold">&#34;key201&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value201&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key202&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value202&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key203&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value203&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key204&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value204&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(
</span></span><span style="display:flex;"><span>			<span style="color:#0ff;font-weight:bold">&#34;ä¸€æ¬¡æ€§è·å–key201,key202,key203,key204å„è‡ªå¯¹åº”çš„å€¼ï¼š&#34;</span> + jedis.<span style="color:#007f7f">mget</span>(<span style="color:#0ff;font-weight:bold">&#34;key201&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key202&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key203&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key204&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ä¸€æ¬¡æ€§åˆ é™¤key201,key202ï¼š&#34;</span> + jedis.<span style="color:#007f7f">del</span>(<span style="color:#fff;font-weight:bold">new</span> String[] { <span style="color:#0ff;font-weight:bold">&#34;key201&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key202&#34;</span> }));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(
</span></span><span style="display:flex;"><span>			<span style="color:#0ff;font-weight:bold">&#34;ä¸€æ¬¡æ€§è·å–key201,key202,key203,key204å„è‡ªå¯¹åº”çš„å€¼ï¼š&#34;</span> + jedis.<span style="color:#007f7f">mget</span>(<span style="color:#0ff;font-weight:bold">&#34;key201&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key202&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key203&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key204&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// jediså…·å¤‡çš„åŠŸèƒ½shardedJedisä¸­ä¹Ÿå¯ç›´æ¥ä½¿ç”¨ï¼Œä¸‹é¢æµ‹è¯•ä¸€äº›å‰é¢æ²¡ç”¨è¿‡çš„æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================String_2==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ¸…ç©ºåº“ä¸­æ‰€æœ‰æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ–°å¢é”®å€¼å¯¹æ—¶é˜²æ­¢è¦†ç›–åŸå…ˆå€¼=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åŸå…ˆkey301ä¸å­˜åœ¨æ—¶ï¼Œæ–°å¢key301ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">setnx</span>(<span style="color:#0ff;font-weight:bold">&#34;key301&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value301&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åŸå…ˆkey302ä¸å­˜åœ¨æ—¶ï¼Œæ–°å¢key302ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">setnx</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value302&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å½“key302å­˜åœ¨æ—¶ï¼Œå°è¯•æ–°å¢key302ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">setnx</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value302_new&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key301å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key301&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key302å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============è¶…è¿‡æœ‰æ•ˆæœŸé”®å€¼å¯¹è¢«åˆ é™¤=============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// è®¾ç½®keyçš„æœ‰æ•ˆæœŸï¼Œå¹¶å­˜å‚¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ–°å¢key303ï¼Œå¹¶æŒ‡å®šè¿‡æœŸæ—¶é—´ä¸º2ç§’&#34;</span> + shardedJedis.<span style="color:#007f7f">setex</span>(<span style="color:#0ff;font-weight:bold">&#34;key303&#34;</span>, <span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#0ff;font-weight:bold">&#34;key303-2second&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key303å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key303&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>		Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">3000</span>);
</span></span><span style="display:flex;"><span>	} <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;3ç§’ä¹‹åï¼Œè·å–key303å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key303&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============è·å–åŸå€¼ï¼Œæ›´æ–°ä¸ºæ–°å€¼ä¸€æ­¥å®Œæˆ=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;key302åŸå€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">getSet</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value302-after-getset&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;key302æ–°å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">get</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============è·å–å­ä¸²=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key302å¯¹åº”å€¼ä¸­çš„å­ä¸²ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">getrange</span>(<span style="color:#0ff;font-weight:bold">&#34;key302&#34;</span>, <span style="color:#ff0;font-weight:bold">5</span>, <span style="color:#ff0;font-weight:bold">7</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="list-1">list<a hidden class="anchor" aria-hidden="true" href="#list-1">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * ListåŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 7.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 8.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> ListOperate() {
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================list==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ¸…ç©ºåº“ä¸­æ‰€æœ‰æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢=============&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;vector&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;ArrayList&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;vector&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;vector&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;LinkedList&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;MapList&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;SerialList&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;HashList&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;3&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;1&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;5&#34;</span>);
</span></span><span style="display:flex;"><span>	shardedJedis.<span style="color:#007f7f">lpush</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;2&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ‰€æœ‰å…ƒç´ -stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ‰€æœ‰å…ƒç´ -numberlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============åˆ =============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// åˆ é™¤åˆ—è¡¨æŒ‡å®šçš„å€¼ ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºåˆ é™¤çš„ä¸ªæ•°ï¼ˆæœ‰é‡å¤æ—¶ï¼‰ï¼Œåaddè¿›å»çš„å€¼å…ˆè¢«åˆ ï¼Œç±»ä¼¼äºå‡ºæ ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æˆåŠŸåˆ é™¤æŒ‡å®šå…ƒç´ ä¸ªæ•°-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrem</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">2</span>, <span style="color:#0ff;font-weight:bold">&#34;vector&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ é™¤æŒ‡å®šå…ƒç´ ä¹‹å-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// åˆ é™¤åŒºé—´ä»¥å¤–çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ é™¤ä¸‹æ ‡0-3åŒºé—´ä¹‹å¤–çš„å…ƒç´ ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">ltrim</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">3</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ é™¤æŒ‡å®šåŒºé—´ä¹‹å¤–å…ƒç´ å-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// åˆ—è¡¨å…ƒç´ å‡ºæ ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å‡ºæ ˆå…ƒç´ ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lpop</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å…ƒç´ å‡ºæ ˆå-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ”¹=============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// ä¿®æ”¹åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	shardedJedis.<span style="color:#007f7f">lset</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#0ff;font-weight:bold">&#34;hello list!&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ä¸‹æ ‡ä¸º0çš„å€¼ä¿®æ”¹å-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æŸ¥=============&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ•°ç»„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;é•¿åº¦-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">llen</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;é•¿åº¦-numberlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">llen</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ’åº
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	<span style="color:#007f7f">/*
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * listä¸­å­˜å­—ç¬¦ä¸²æ—¶å¿…é¡»æŒ‡å®šå‚æ•°ä¸ºalphaï¼Œå¦‚æœä¸ä½¿ç”¨SortingParamsï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨sort(&#34;list&#34;)ï¼Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * ä¼šå‡ºç°&#34;ERR One or more scores can&#39;t be converted into double&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 */</span>
</span></span><span style="display:flex;"><span>	SortingParams sortingParameters = <span style="color:#fff;font-weight:bold">new</span> SortingParams();
</span></span><span style="display:flex;"><span>	sortingParameters.<span style="color:#007f7f">alpha</span>();
</span></span><span style="display:flex;"><span>	sortingParameters.<span style="color:#007f7f">limit</span>(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">3</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è¿”å›æ’åºåçš„ç»“æœ-stringlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">sort</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, sortingParameters));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è¿”å›æ’åºåçš„ç»“æœ-numberlistsï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">sort</span>(<span style="color:#0ff;font-weight:bold">&#34;numberlists&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// å­ä¸²ï¼š startä¸ºå…ƒç´ ä¸‹æ ‡ï¼Œendä¹Ÿä¸ºå…ƒç´ ä¸‹æ ‡ï¼›-1ä»£è¡¨å€’æ•°ä¸€ä¸ªå…ƒç´ ï¼Œ-2ä»£è¡¨å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å­ä¸²-ç¬¬äºŒä¸ªå¼€å§‹åˆ°ç»“æŸï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lrange</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">1</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// è·å–åˆ—è¡¨æŒ‡å®šä¸‹æ ‡çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–ä¸‹æ ‡ä¸º2çš„å…ƒç´ ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">lindex</span>(<span style="color:#0ff;font-weight:bold">&#34;stringlists&#34;</span>, <span style="color:#ff0;font-weight:bold">2</span>) + <span style="color:#0ff;font-weight:bold">&#34;\n&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="set-2">set<a hidden class="anchor" aria-hidden="true" href="#set-2">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * SetåŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 7.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 8.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> SetOperate() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================set==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ¸…ç©ºåº“ä¸­æ‰€æœ‰æ•°æ®ï¼š&#34;</span> + jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å‘setsé›†åˆä¸­åŠ å…¥å…ƒç´ element001ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å‘setsé›†åˆä¸­åŠ å…¥å…ƒç´ element002ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å‘setsé›†åˆä¸­åŠ å…¥å…ƒç´ element003ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å‘setsé›†åˆä¸­åŠ å…¥å…ƒç´ element004ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element004&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹setsé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ :&#34;</span> + jedis.<span style="color:#007f7f">smembers</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============åˆ =============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;é›†åˆsetsä¸­åˆ é™¤å…ƒç´ element003ï¼š&#34;</span> + jedis.<span style="color:#007f7f">srem</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹setsé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ :&#34;</span> + jedis.<span style="color:#007f7f">smembers</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">/*
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * System.out.println(&#34;setsé›†åˆä¸­ä»»æ„ä½ç½®çš„å…ƒç´ å‡ºæ ˆï¼š&#34;+jedis.spop(&#34;sets&#34;));//æ³¨ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * å‡ºæ ˆå…ƒç´ ä½ç½®å±…ç„¶ä¸å®šï¼Ÿ--æ— å®é™…æ„ä¹‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 * System.out.println(&#34;æŸ¥çœ‹setsé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ :&#34;+jedis.smembers(&#34;sets&#34;));
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	 */</span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ”¹=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æŸ¥=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ¤æ–­element001æ˜¯å¦åœ¨é›†åˆsetsä¸­ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sismember</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;å¾ªç¯æŸ¥è¯¢è·å–setsä¸­çš„æ¯ä¸ªå…ƒç´ ï¼š&#34;</span>);
</span></span><span style="display:flex;"><span>	Set&lt;String&gt; set = jedis.<span style="color:#007f7f">smembers</span>(<span style="color:#0ff;font-weight:bold">&#34;sets&#34;</span>);
</span></span><span style="display:flex;"><span>	Iterator&lt;String&gt; it = set.<span style="color:#007f7f">iterator</span>();
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">while</span> (it.<span style="color:#007f7f">hasNext</span>()) {
</span></span><span style="display:flex;"><span>		Object obj = it.<span style="color:#007f7f">next</span>();
</span></span><span style="display:flex;"><span>		System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(obj);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============é›†åˆè¿ç®—=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element001ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element002ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element003ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element002ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element003ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1ä¸­æ·»åŠ å…ƒç´ element004ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sadd</span>(<span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element004&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹sets1é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ :&#34;</span> + jedis.<span style="color:#007f7f">smembers</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹sets2é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ :&#34;</span> + jedis.<span style="color:#007f7f">smembers</span>(<span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1å’Œsets2äº¤é›†ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sinter</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1å’Œsets2å¹¶é›†ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sunion</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1å’Œsets2å·®é›†ï¼š&#34;</span> + jedis.<span style="color:#007f7f">sdiff</span>(<span style="color:#0ff;font-weight:bold">&#34;sets1&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;sets2&#34;</span>));<span style="color:#007f7f">// å·®é›†ï¼šset1ä¸­æœ‰ï¼Œset2ä¸­æ²¡æœ‰çš„å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="sortedset">SortedSet<a hidden class="anchor" aria-hidden="true" href="#sortedset">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * SortedSetåŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 7.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 8.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> SortedSetOperate() {
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================zset==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zsetä¸­æ·»åŠ å…ƒç´ element001ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zadd</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">7.0</span>, <span style="color:#0ff;font-weight:bold">&#34;element001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zsetä¸­æ·»åŠ å…ƒç´ element002ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zadd</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">8.0</span>, <span style="color:#0ff;font-weight:bold">&#34;element002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zsetä¸­æ·»åŠ å…ƒç´ element003ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zadd</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">2.0</span>, <span style="color:#0ff;font-weight:bold">&#34;element003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zsetä¸­æ·»åŠ å…ƒç´ element004ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zadd</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">3.0</span>, <span style="color:#0ff;font-weight:bold">&#34;element004&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zseté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zrange</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));<span style="color:#007f7f">// æŒ‰ç…§æƒé‡å€¼æ’åº
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============åˆ =============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zsetä¸­åˆ é™¤å…ƒç´ element002ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zrem</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;zseté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zrange</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ”¹=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æŸ¥=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç»Ÿè®¡zseté›†åˆä¸­çš„å…ƒç´ ä¸­ä¸ªæ•°ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zcard</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ç»Ÿè®¡zseté›†åˆä¸­æƒé‡æŸä¸ªèŒƒå›´å†…ï¼ˆ1.0â€”â€”5.0ï¼‰ï¼Œå…ƒç´ çš„ä¸ªæ•°ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zcount</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">1.0</span>, <span style="color:#ff0;font-weight:bold">5.0</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹zseté›†åˆä¸­element004çš„æƒé‡ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zscore</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;element004&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æŸ¥çœ‹ä¸‹æ ‡1åˆ°2èŒƒå›´å†…çš„å…ƒç´ å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">zrange</span>(<span style="color:#0ff;font-weight:bold">&#34;zset&#34;</span>, <span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">2</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hash-2">hash<a hidden class="anchor" aria-hidden="true" href="#hash-2">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * HashåŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 1.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 2.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 3.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 4.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 5.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 6.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 7.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 8.
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> HashOperate() {
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;======================hash==========================&#34;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// æ¸…ç©ºæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(jedis.<span style="color:#007f7f">flushDB</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============å¢=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­æ·»åŠ key001å’Œvalue001é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hset</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value001&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­æ·»åŠ key002å’Œvalue002é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hset</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­æ·»åŠ key003å’Œvalue003é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hset</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;value003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ–°å¢key004å’Œ4çš„æ•´å‹é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hincrBy</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key004&#34;</span>, <span style="color:#ff0;font-weight:bold">4l</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­çš„æ‰€æœ‰å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hvals</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============åˆ =============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­åˆ é™¤key002é”®å€¼å¯¹ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hdel</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key002&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­çš„æ‰€æœ‰å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hvals</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æ”¹=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;key004æ•´å‹é”®å€¼çš„å€¼å¢åŠ 100ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hincrBy</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key004&#34;</span>, <span style="color:#ff0;font-weight:bold">100l</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;hashsä¸­çš„æ‰€æœ‰å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hvals</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;=============æŸ¥=============&#34;</span>);
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;åˆ¤æ–­key003æ˜¯å¦å­˜åœ¨ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hexists</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–key004å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hget</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key004&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;æ‰¹é‡è·å–key001å’Œkey003å¯¹åº”çš„å€¼ï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hmget</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key001&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;key003&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–hashsä¸­æ‰€æœ‰çš„keyï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hkeys</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;è·å–hashsä¸­æ‰€æœ‰çš„valueï¼š&#34;</span> + shardedJedis.<span style="color:#007f7f">hvals</span>(<span style="color:#0ff;font-weight:bold">&#34;hashs&#34;</span>));
</span></span><span style="display:flex;"><span>	System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="redistemplate">Redistemplate<a hidden class="anchor" aria-hidden="true" href="#redistemplate">#</a></h1>
<p><a href="https://blog.csdn.net/lydms/article/details/105224210">å‚è€ƒ</a>
Jedis å’Œ Lettuce æ˜¯ Java æ“ä½œ Redis çš„å®¢æˆ·ç«¯ã€‚åœ¨ Spring Boot 1.x ç‰ˆæœ¬é»˜è®¤ä½¿ç”¨çš„æ˜¯ jedis ï¼Œè€Œåœ¨ Spring Boot 2.x ç‰ˆæœ¬é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯Lettuceã€‚å…³äº Jedis è·Ÿ Lettuce çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>Jedisåœ¨å®ç°ä¸Šæ˜¯ç›´æ¥è¿æ¥çš„redis serverï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™ä¸ªæ—¶å€™åªæœ‰ä½¿ç”¨è¿æ¥æ± ï¼Œä¸ºæ¯ä¸ªJediså®ä¾‹å¢åŠ ç‰©ç†è¿æ¥ã€‚</li>
<li>Lettuceçš„è¿æ¥æ˜¯åŸºäºNettyçš„ï¼Œè¿æ¥å®ä¾‹ï¼ˆStatefulRedisConnectionï¼‰å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹é—´å¹¶å‘è®¿é—®ï¼Œåº”ä¸ºStatefulRedisConnectionæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªè¿æ¥å®ä¾‹ï¼ˆStatefulRedisConnectionï¼‰å°±å¯ä»¥æ»¡è¶³å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å¹¶å‘è®¿é—®ï¼Œå½“ç„¶è¿™ä¸ªä¹Ÿæ˜¯å¯ä¼¸ç¼©çš„è®¾è®¡ï¼Œä¸€ä¸ªè¿æ¥å®ä¾‹ä¸å¤Ÿçš„æƒ…å†µä¹Ÿå¯ä»¥æŒ‰éœ€å¢åŠ è¿æ¥å®ä¾‹ã€‚</li>
</ul>
<p>RedisTemplateæ˜¯Spring Data Redisæä¾›ç»™ç”¨æˆ·çš„æœ€é«˜çº§çš„æŠ½è±¡å®¢æˆ·ç«¯ï¼Œç”¨æˆ·å¯ç›´æ¥é€šè¿‡RedisTemplateè¿›è¡Œå¤šç§æ“ä½œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹RedisTemplateå°è£…äº†å“ªäº›æ“ä½œã€‚ä¸‹é¢è¿™åˆ—è¡¨æ˜¯RedisTemplateçš„ç»§æ‰¿å…³ç³»å’Œæ‰€æœ‰æ–¹æ³•ï¼ˆå·²è¿‡æ»¤é‡è½½æ–¹æ³•ï¼Œå…±æœ‰81ä¸ªæ–¹æ³•ï¼‰</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//RedisAccessoræ˜¯RedisTemplateå®šä¹‰æ™®é€šå±æ€§çš„åŸºç±»ï¼Œä¸ç›´æ¥ä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//RedisOperationsæ˜¯æŒ‡å®šRedisTemplateå®ç°çš„Redis connectionæ“ä½œçš„é›†åˆæ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//BeanClassLoaderAwareæ˜¯ç»™å…¶å®ç°ç±»æ˜¯è®¾ç½®ç±»åŠ è½½å™¨çš„æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>RedisTemplate&lt;K, V&gt; <span style="color:#fff;font-weight:bold">extends</span> RedisAccessor <span style="color:#fff;font-weight:bold">implements</span> RedisOperations&lt;K, V&gt;, BeanClassLoaderAware
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//é…ç½®é»˜è®¤åºåˆ—åŒ–ä¸ååºåˆ—åŒ–å·¥å…·ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">2.</span>afterPropertiesSet
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ ¹æ®å‚æ•°æ‰§è¡Œç›¸å…³operationæ“ä½œï¼Œä¾‹å¦‚ï¼Œäº‹åŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">3.</span>execute
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ‰§è¡Œpipeliningæµæ°´çº¿ç›¸å…³æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">4.</span>executePipelined
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ‰§è¡ŒæŒ‡å®šconnectionè¿æ¥çš„ç›¸å…³æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">5.</span>executeWithStickyConnection
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ‰§è¡Œsessionå†…çš„executeæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">6.</span>executeSession
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ›å»ºRedisConnectionä»£ç†ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">7.</span>createRedisConnectionProxy
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//connectionè¿æ¥çš„é¢„å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">8.</span>preProcessConnection
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ç»“æœçš„åå¤„ç†ï¼Œé»˜è®¤ä»€ä¹ˆéƒ½ä¸åš
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">9.</span>postProcessResult
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ˜¯å¦å‘RedisCallbackæš´éœ²æœ¬åœ°è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">10.</span>isExposeConnection
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è®¾ç½®æ˜¯å¦å‘RedisCallbackæš´éœ²æœ¬åœ°è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">11.</span>setExposeConnection
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//12åˆ°26éƒ½æ˜¯è®¾ç½®å’Œè·å–ç›¸å…³åºåˆ—åŒ–å·¥å…·ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">12.</span>isEnableDefaultSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">13.</span>setEnableDefaultSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">14.</span>getDefaultSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">15.</span>setDefaultSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">16.</span>setKeySerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">17.</span>getKeySerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">18.</span>setValueSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">19.</span>getValueSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">20.</span>getHashKeySerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">21.</span>setHashKeySerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">22.</span>getHashValueSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">23.</span>setHashValueSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">24.</span>getStringSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">25.</span>setStringSerializer
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">26.</span>setScriptExecutor
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//27åˆ°34ä¸ºç§æœ‰æ–¹æ³•ï¼Œä¸å¯¹å¤–æä¾›ä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">27.</span>rawKey
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">28.</span>rawString
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">29.</span>rawValue
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">30.</span>rawKeys
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">31.d</span>eserializeKey
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">32.d</span>eserializeMixedResults
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">33.d</span>eserializeSet
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">34.</span>convertTupleValues
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ‰§è¡Œäº‹åŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">35.</span>exec
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">36.</span>execRaw
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ é™¤æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">37.d</span>elete
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ¥è§¦é“¾æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">38.</span>unlink
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æŸ¥çœ‹æ˜¯å¦å«æœ‰æŒ‡å®škey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">39.</span>hasKey
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">40.</span>countExistingKeys
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è®¾ç½®è¿‡æœŸæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">41.</span>expire
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">42.</span>expireAt
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è½¬æ¢æˆå­—èŠ‚æµå¹¶å‘channelå‘é€message
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">43.</span>convertAndSend
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è·å–è¿‡æœŸæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">44.</span>getExpire
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ ¹æ®ä¼ å…¥çš„æ­£åˆ™è¡¨è¾¾å¼è¿”å›æ‰€æœ‰çš„key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">46.</span>keys
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å–æ¶ˆæŒ‡å®škeyçš„è¿‡æœŸæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">47.</span>persist
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ç§»åŠ¨æŒ‡å®šçš„keyå’Œindexåˆ°æ•°æ®åº“ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">48.</span>move
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ä»é”®ç©ºé—´éšæœºè·å–ä¸€ä¸ªkey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">49.</span>randomKey
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å°†æŒ‡å®škeyæ”¹æˆç›®æ ‡key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">50.</span>rename
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//keyä¸å­˜åœ¨æ—¶ï¼Œå°†æŒ‡å®škeyæ”¹æˆç›®æ ‡key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">51.</span>renameIfAbsent
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è®¾ç½®å­˜å‚¨åœ¨æŒ‡å®škeyçš„ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">52.</span>type
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ£€ç´¢å­˜å‚¨åœ¨keyçš„å€¼çš„åºåˆ—åŒ–ç‰ˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">53.d</span>ump
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ‰§è¡ŒRedisçš„restoreçš„å‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">54.</span>restore
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ ‡è®°äº‹åŠ¡é˜»å¡çš„å¼€å§‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">55.</span>multi
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ä¸¢å¼ƒæ‰€æœ‰åœ¨multiä¹‹åå‘å‡ºçš„å‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">56.d</span>iscard
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è§‚å¯ŸæŒ‡å®škeyåœ¨äº‹åŠ¡å¤„ç†å¼€å§‹å³multiä¹‹åçš„ä¿®æ”¹æƒ…å†µ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">57.</span>watch
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ·æ–°å…ˆå‰è§‚å¯Ÿçš„æ‰€æœ‰key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">58.</span>unwatch
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ä¸ºkeyå…ƒç´ æ’åº
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">59.</span>sort
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å…³é—­å®¢æˆ·ç«¯è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">60.</span>killClient
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¯·æ±‚è¿æ¥å®¢æˆ·ç«¯çš„ç›¸å…³ä¿¡æ¯å’Œç»Ÿè®¡æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">61.</span>getClientList
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ›´æ”¹å¤åˆ¶é…ç½®åˆ°æ–°çš„master
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">62.</span>slaveOf
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å°†æœ¬æœºæ›´æ”¹ä¸ºmaster
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">63.</span>slaveOfNoOne
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//64åˆ°79éƒ½æ˜¯è·å–ç›¸å¯¹åº”çš„æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">64.</span>opsForCluster
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">65.</span>opsForGeo
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">66.</span>boundGeoOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">67.</span>boundHashOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">68.</span>opsForHash
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">69.</span>opsForHyperLogLog
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">70.</span>opsForList
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">71.</span>boundListOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">72.</span>boundSetOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">73.</span>opsForSet
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">74.</span>opsForStream
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">75.</span>boundStreamOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">76.</span>boundValueOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">77.</span>opsForValue
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">78.</span>boundZSetOps
</span></span><span style="display:flex;"><span><span style="color:#ff0;font-weight:bold">79.</span>opsForZSet
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è®¾ç½®æ˜¯å¦æ”¯æŒäº‹åŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">80.</span>setEnableTransactionSupport
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è®¾ç½®beançš„ç±»åŠ è½½å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">81.</span>setBeanClassLoader
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç®€ä»‹">ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#ç®€ä»‹">#</a></h2>
<p>spring-data-redisé’ˆå¯¹jedisæä¾›äº†å¦‚ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œæä¾›äº†ä¸€ä¸ªé«˜åº¦å°è£…çš„â€œRedisTemplateâ€ç±»</li>
<li>é’ˆå¯¹jediså®¢æˆ·ç«¯ä¸­å¤§é‡apiè¿›è¡Œäº†å½’ç±»å°è£…ï¼Œå°†åŒä¸€ç±»å‹æ“ä½œå°è£…ä¸ºoperationæ¥å£</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ValueOperationsï¼šç®€å•K-Væ“ä½œ
</span></span><span style="display:flex;"><span>SetOperationsï¼šsetç±»å‹æ•°æ®æ“ä½œ
</span></span><span style="display:flex;"><span>ZSetOperationsï¼šzsetç±»å‹æ•°æ®æ“ä½œ
</span></span><span style="display:flex;"><span>HashOperationsï¼šé’ˆå¯¹mapç±»å‹çš„æ•°æ®æ“ä½œ
</span></span><span style="display:flex;"><span>ListOperationsï¼šé’ˆå¯¹listç±»å‹çš„æ•°æ®æ“ä½œ
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æä¾›äº†å¯¹keyçš„<code>bound</code>(ç»‘å®š)ä¾¿æ·åŒ–æ“ä½œAPIï¼Œå¯ä»¥é€šè¿‡boundå°è£…æŒ‡å®šçš„keyï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œè€Œæ— é¡»â€œæ˜¾å¼â€çš„å†æ¬¡æŒ‡å®šKeyï¼Œå³BoundKeyOperationsï¼š</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>BoundValueOperations
</span></span><span style="display:flex;"><span>BoundSetOperations
</span></span><span style="display:flex;"><span>BoundListOperations
</span></span><span style="display:flex;"><span>BoundSetOperations
</span></span><span style="display:flex;"><span>BoundHashOperations
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å°†äº‹åŠ¡æ“ä½œå°è£…ï¼Œæœ‰å®¹å™¨æ§åˆ¶ã€‚</li>
<li>é’ˆå¯¹æ•°æ®çš„â€œåºåˆ—åŒ–/ååºåˆ—åŒ–â€ï¼Œæä¾›äº†å¤šç§å¯é€‰æ‹©ç­–ç•¥(RedisSerializer)
<ul>
<li>1.JdkSerializationRedisSerializerï¼šPOJOå¯¹è±¡çš„å­˜å–åœºæ™¯ï¼Œä½¿ç”¨JDKæœ¬èº«åºåˆ—åŒ–æœºåˆ¶ï¼Œå°†pojoç±»é€šè¿‡ObjectInputStream/ObjectOutputStreamè¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæœ€ç»ˆredis-serverä¸­å°†å­˜å‚¨å­—èŠ‚åºåˆ—ã€‚æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„åºåˆ—åŒ–ç­–ç•¥ã€‚</li>
<li>2.StringRedisSerializerï¼šKeyæˆ–è€…valueä¸ºå­—ç¬¦ä¸²çš„åœºæ™¯ï¼Œæ ¹æ®æŒ‡å®šçš„charsetå¯¹æ•°æ®çš„å­—èŠ‚åºåˆ—ç¼–ç æˆstringï¼Œæ˜¯â€œnewString(bytes,charset)â€å’Œâ€œstring.getBytes(charset)â€çš„ç›´æ¥å°è£…ã€‚æ˜¯æœ€è½»é‡çº§å’Œé«˜æ•ˆçš„ç­–ç•¥ã€‚</li>
<li>3.JacksonJsonRedisSerializerï¼šjackson-jsonå·¥å…·æä¾›äº†javabeanä¸jsonä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œå¯ä»¥å°†pojoå®ä¾‹åºåˆ—åŒ–æˆjsonæ ¼å¼å­˜å‚¨åœ¨redisä¸­ï¼Œä¹Ÿå¯ä»¥å°†jsonæ ¼å¼çš„æ•°æ®è½¬æ¢æˆpojoå®ä¾‹ã€‚å› ä¸ºjacksonå·¥å…·åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶ï¼Œéœ€è¦æ˜ç¡®æŒ‡å®šClassç±»å‹ï¼Œå› æ­¤æ­¤ç­–ç•¥å°è£…èµ·æ¥ç¨å¾®å¤æ‚ã€‚</li>
<li>4.OxmSerializerï¼šæä¾›äº†å°†javabeanä¸xmlä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œç›®å‰å¯ç”¨çš„ä¸‰æ–¹æ”¯æŒåŒ…æ‹¬jaxbï¼Œapache-xmlbeansï¼›rediså­˜å‚¨çš„æ•°æ®å°†æ˜¯xmlå·¥å…·ã€‚ä¸è¿‡ä½¿ç”¨æ­¤ç­–ç•¥ï¼Œç¼–ç¨‹å°†ä¼šæœ‰äº›éš¾åº¦ï¼Œè€Œä¸”æ•ˆç‡æœ€ä½ï¼›ä¸å»ºè®®ä½¿ç”¨ã€‚ã€éœ€è¦spring-oxmæ¨¡å—çš„æ”¯æŒã€‘</li>
</ul>
</li>
</ul>
<p>å¦‚æœä½ çš„æ•°æ®éœ€è¦è¢«ç¬¬ä¸‰æ–¹å·¥å…·è§£æï¼Œé‚£ä¹ˆæ•°æ®åº”è¯¥ä½¿ç”¨StringRedisSerializerè€Œä¸æ˜¯JdkSerializationRedisSerializerã€‚</p>
<p>RedisTemplateä¸­å®šä¹‰äº†å¯¹5ç§æ•°æ®ç»“æ„æ“ä½œ</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>redisTemplate.opsForValue();//æ“ä½œå­—ç¬¦ä¸²
</span></span><span style="display:flex;"><span>redisTemplate.opsForHash();//æ“ä½œhash
</span></span><span style="display:flex;"><span>redisTemplate.opsForList();//æ“ä½œlist
</span></span><span style="display:flex;"><span>redisTemplate.opsForSet();//æ“ä½œset
</span></span><span style="display:flex;"><span>redisTemplate.opsForZSet();//æ“ä½œæœ‰åºset
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®è¿™é‡Œçš„opsç›¸å½“äºoptionsï¼Œ æ˜¯RedisTemplateå¯¹å„ç§ä¸åŒçš„Redisæ•°æ®ç±»å‹è¿›è¡Œæ“ä½œã€‚å…¶å®è¿˜æœ‰å¦å¤–çš„æ–¹æ³•</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>redistempalate.boundValueOps
</span></span><span style="display:flex;"><span>redistempalate.boundSetOps
</span></span><span style="display:flex;"><span>redistempalate.boundListOps
</span></span><span style="display:flex;"><span>redistempalate.boundHashOps
</span></span><span style="display:flex;"><span>redistempalate.boundZSetOps
</span></span></code></pre></td></tr></table>
</div>
</div><p>opsForXXXå’ŒboundXXXOpsçš„åŒºåˆ«ï¼Ÿ
XXXä¸ºvalueçš„ç±»å‹ï¼Œå‰è€…è·å–ä¸€ä¸ªoperatorï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šæ“ä½œçš„å¯¹è±¡ï¼ˆkeyï¼‰ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªè¿æ¥ï¼ˆäº‹åŠ¡ï¼‰å†…æ“ä½œå¤šä¸ªkeyä»¥åŠå¯¹åº”çš„valueï¼›
åè€…è·å–äº†ä¸€ä¸ªæŒ‡å®šæ“ä½œå¯¹è±¡ï¼ˆkeyï¼‰çš„operatorï¼Œåœ¨ä¸€ä¸ªè¿æ¥ï¼ˆäº‹åŠ¡ï¼‰å†…åªèƒ½æ“ä½œè¿™ä¸ªkeyå¯¹åº”çš„valueã€‚</p>
<h2 id="æ•´åˆspring-boot">æ•´åˆspring boot<a hidden class="anchor" aria-hidden="true" href="#æ•´åˆspring-boot">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">&lt;groupId&gt;</span>org.springframework.boot<span style="font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span style="font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>application.properties</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#007f7f"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.database</span>=<span style="color:#0ff;font-weight:bold">0  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># RedisæœåŠ¡å™¨åœ°å€</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.host</span>=<span style="color:#0ff;font-weight:bold">127.0.0.1</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.port</span>=<span style="color:#0ff;font-weight:bold">6379  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.password</span>=
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.pool.max-active</span>=<span style="color:#0ff;font-weight:bold">8  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.pool.max-wait</span>=<span style="color:#0ff;font-weight:bold">-1  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.pool.max-idle</span>=<span style="color:#0ff;font-weight:bold">8  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.pool.min-idle</span>=<span style="color:#0ff;font-weight:bold">0  </span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">spring.redis.timeout</span>=<span style="color:#0ff;font-weight:bold">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>redisé…ç½®</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> com.wjy.redis.config;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> com.fasterxml.jackson.databind.ObjectMapper;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> com.wjy.redis.util.RedisUtil;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.context.annotation.Bean;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.context.annotation.Configuration;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.data.redis.core.RedisTemplate;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@Configuration
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedisConfig {
</span></span><span style="display:flex;"><span>    @Bean
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> RedisTemplate&lt;String,Object&gt; redisTemplate(RedisConnectionFactory factory) {
</span></span><span style="display:flex;"><span>        RedisTemplate&lt;String, Object&gt; template = <span style="color:#fff;font-weight:bold">new</span> RedisTemplate&lt;&gt;();
</span></span><span style="display:flex;"><span>        template.<span style="color:#007f7f">setConnectionFactory</span>(factory);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span style="color:#fff;font-weight:bold">new</span> Jackson2JsonRedisSerializer(Object.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        ObjectMapper om = <span style="color:#fff;font-weight:bold">new</span> ObjectMapper();
</span></span><span style="display:flex;"><span>        om.<span style="color:#007f7f">setVisibility</span>(PropertyAccessor.<span style="color:#007f7f">ALL</span>, JsonAutoDetect.<span style="color:#007f7f">Visibility</span>.<span style="color:#007f7f">ANY</span>);
</span></span><span style="display:flex;"><span>        om.<span style="color:#007f7f">enableDefaultTyping</span>(ObjectMapper.<span style="color:#007f7f">DefaultTyping</span>.<span style="color:#007f7f">NON_FINAL</span>);
</span></span><span style="display:flex;"><span>        jackson2JsonRedisSerializer.<span style="color:#007f7f">setObjectMapper</span>(om);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        StringRedisSerializer stringRedisSerializer = <span style="color:#fff;font-weight:bold">new</span> StringRedisSerializer();
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        template.<span style="color:#007f7f">setKeySerializer</span>(stringRedisSerializer);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        template.<span style="color:#007f7f">setHashKeySerializer</span>(stringRedisSerializer);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        template.<span style="color:#007f7f">setValueSerializer</span>(jackson2JsonRedisSerializer);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        template.<span style="color:#007f7f">setHashValueSerializer</span>(jackson2JsonRedisSerializer);
</span></span><span style="display:flex;"><span>        template.<span style="color:#007f7f">afterPropertiesSet</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> template;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ³¨å…¥å°è£…RedisTemplate
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return RedisUtil
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @throws
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @Title: redisUtil
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @autor admin
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @date
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    @Bean(name = <span style="color:#0ff;font-weight:bold">&#34;redisUtil&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> RedisUtil redisUtil(RedisTemplate&lt;String, Object&gt; redisTemplate) {
</span></span><span style="display:flex;"><span>        RedisUtil redisUtil = <span style="color:#fff;font-weight:bold">new</span> RedisUtil();
</span></span><span style="display:flex;"><span>        redisUtil.<span style="color:#007f7f">setRedisTemplate</span>(redisTemplate);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisUtil;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="redistemplateæ“ä½œredis">RedisTemplateæ“ä½œRedis<a hidden class="anchor" aria-hidden="true" href="#redistemplateæ“ä½œredis">#</a></h2>
<h3 id="é€šç”¨æ“ä½œ">é€šç”¨æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#é€šç”¨æ“ä½œ">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> com.wjy.redis.util;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> org.springframework.data.redis.core.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.*;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.concurrent.TimeUnit;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å‚è€ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// https://blog.csdn.net/lydms/article/details/105224210
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> RedisUtil {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> setRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">redisTemplate</span> = redisTemplate;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//============================= é€šç”¨æ“ä½œ ============================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> expire(String key,<span style="color:#fff;font-weight:bold">long</span> time){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(time &gt; <span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">//redisTemplate.boundValueOps(&#34;HashKey&#34;).expire(1,TimeUnit.MINUTES);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                redisTemplate.<span style="color:#007f7f">expire</span>(key, time, TimeUnit.<span style="color:#007f7f">SECONDS</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”® ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> getExpire(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">getExpire</span>(key,TimeUnit.<span style="color:#007f7f">SECONDS</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hasKey(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">hasKey</span>(key);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åˆ é™¤ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    @SuppressWarnings(<span style="color:#0ff;font-weight:bold">&#34;unchecked&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> del(String ... key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(key!=<span style="color:#fff;font-weight:bold">null</span>&amp;&amp;key.<span style="color:#007f7f">length</span> &gt; <span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(key.<span style="color:#007f7f">length</span> == <span style="color:#ff0;font-weight:bold">1</span>){
</span></span><span style="display:flex;"><span>                redisTemplate.<span style="color:#007f7f">delete</span>(key[<span style="color:#ff0;font-weight:bold">0</span>]);
</span></span><span style="display:flex;"><span>            }<span style="color:#fff;font-weight:bold">else</span>{
</span></span><span style="display:flex;"><span>                redisTemplate.<span style="color:#007f7f">delete</span>(<span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;(Arrays.<span style="color:#007f7f">asList</span>(key)));
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="string-3">string<a hidden class="anchor" aria-hidden="true" href="#string-3">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//============================ Stringæ“ä½œ =============================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ™®é€šç¼“å­˜è·å–
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Object get(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(key == <span style="color:#fff;font-weight:bold">null</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//String str1 = (String) redisTemplate.boundValueOps(&#34;StringKey&#34;).get();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">get</span>(key);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ™®é€šç¼“å­˜æ”¾å…¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return trueæˆåŠŸ falseå¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> set(String key,Object value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">set</span>(key, value);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundValueOps(&#34;StringKey&#34;).set(&#34;StringValue&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return trueæˆåŠŸ false å¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> set(String key,Object value,<span style="color:#fff;font-weight:bold">long</span> time){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(time &gt; <span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">set</span>(key, value, time, TimeUnit.<span style="color:#007f7f">SECONDS</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">//redisTemplate.boundValueOps(&#34;StringKey&#34;).set(&#34;StringValue&#34;,1, TimeUnit.MINUTES);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            }<span style="color:#fff;font-weight:bold">else</span>{
</span></span><span style="display:flex;"><span>                set(key, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * é€’å¢
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param delta è¦å¢åŠ å‡ (å¤§äº0)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> incr(String key, <span style="color:#fff;font-weight:bold">long</span> delta){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(delta&lt;<span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(<span style="color:#0ff;font-weight:bold">&#34;é€’å¢å› å­å¿…é¡»å¤§äº0&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">increment</span>(key, delta);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * é€’å‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param delta è¦å‡å°‘å‡ (å°äº0)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> decr(String key, <span style="color:#fff;font-weight:bold">long</span> delta){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(delta&lt;<span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(<span style="color:#0ff;font-weight:bold">&#34;é€’å‡å› å­å¿…é¡»å¤§äº0&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForValue</span>().<span style="color:#007f7f">increment</span>(key, -delta);
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="list-2">list<a hidden class="anchor" aria-hidden="true" href="#list-2">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//=============================== listæ“ä½œ =================================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–listç¼“å­˜çš„å†…å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param start å¼€å§‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param end ç»“æŸ  0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> List&lt;Object&gt; lGet(String key, <span style="color:#fff;font-weight:bold">long</span> start, <span style="color:#fff;font-weight:bold">long</span> end){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">range</span>(key, start, end);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–listç¼“å­˜çš„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> lGetListSize(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">size</span>(key);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param index ç´¢å¼•  index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Object lGetIndex(String key,<span style="color:#fff;font-weight:bold">long</span> index){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">index</span>(key, index);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç»™ç¼“å­˜ä¸­çš„listæ·»åŠ å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> lSet(String key, Object value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundListOps(&#34;listKey&#34;).leftPush(&#34;listLeftValue1&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#007f7f">//redisTemplate.boundListOps(&#34;listKey&#34;).rightPush(&#34;listRightValue2&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">rightPush</span>(key, value);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.opsForList().leftPush(key, value);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç»™ç¼“å­˜ä¸­çš„listæ·»åŠ å…ƒç´ ï¼Œå¹¶è®¾ç½®æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> lSet(String key, Object value, <span style="color:#fff;font-weight:bold">long</span> time) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">rightPush</span>(key, value);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.opsForList().leftPush(key, value);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (time &gt; <span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                expire(key, time);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å°†æ•´ä¸ªlistæ”¾å…¥ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param list å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> lSet(String key, List&lt;Object&gt; list) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">rightPushAll</span>(key, list);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundListOps(&#34;listKey&#34;).leftPushAll(list);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å°†æ•´ä¸ªlistæ”¾å…¥ç¼“å­˜ï¼Œå¹¶è®¾ç½®æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param list å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> lSet(String key, List&lt;Object&gt; list, <span style="color:#fff;font-weight:bold">long</span> time) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">rightPushAll</span>(key, list);
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundListOps(&#34;listKey&#34;).leftPushAll(list);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">if</span> (time &gt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>                expire(key, time);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param index ç´¢å¼•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> lUpdateIndex(String key, <span style="color:#fff;font-weight:bold">long</span> index,Object value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">set</span>(key, index, value);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç§»é™¤Nä¸ªå€¼ä¸ºvalue
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param count ç§»é™¤å¤šå°‘ä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return ç§»é™¤çš„ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> lRemove(String key,<span style="color:#fff;font-weight:bold">long</span> count,Object value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            Long remove = redisTemplate.<span style="color:#007f7f">opsForList</span>().<span style="color:#007f7f">remove</span>(key, count, value);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> remove;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä»å·¦ä¾§å¼¹å‡ºå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> leftPopValue(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä»å·¦ä¾§å¼¹å‡ºä¸€ä¸ªå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        String listKey = (String) redisTemplate.<span style="color:#007f7f">boundListOps</span>(<span style="color:#0ff;font-weight:bold">&#34;listKey&#34;</span>).<span style="color:#007f7f">leftPop</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä»å³ä¾§å¼¹å‡ºå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> rightPopValue(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä»å³ä¾§å¼¹å‡ºä¸€ä¸ªå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        String listKey = (String) redisTemplate.<span style="color:#007f7f">boundListOps</span>(<span style="color:#0ff;font-weight:bold">&#34;listKey&#34;</span>).<span style="color:#007f7f">rightPop</span>();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="hash-3">hash<a hidden class="anchor" aria-hidden="true" href="#hash-3">#</a></h3>
<p>Redisçš„Hashç»“æ„ç±»ä¼¼äºJavaä¸­çš„Map&lt;String,Map&lt;String,Stgring&raquo;ï¼Œé”®æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼æ˜¯å¦ä¸€ä¸ªæ˜ å°„ã€‚å› æ­¤Hashç»“æ„å¾ˆé€‚åˆç”¨æ¥å­˜å‚¨å¯¹è±¡ã€‚
é”®ï¼šå¯¹è±¡åç§°
å­—æ®µåï¼šå±æ€§å
å­—æ®µå€¼ï¼šå±æ€§å€¼ã€‚</p>
<p>string + json ä¹Ÿæ˜¯å­˜å‚¨å¯¹è±¡çš„ä¸€ç§æ–¹å¼ï¼Œé‚£ä¹ˆå­˜å‚¨å¯¹è±¡æ—¶ï¼Œåˆ°åº•ç”¨ string + json è¿˜æ˜¯ç”¨ hash å‘¢ï¼Ÿ</p>
<p>ä¸¤ç§å­˜å‚¨æ–¹å¼çš„å¯¹æ¯”å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>String + json</th>
<th>Hash</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•ˆç‡</td>
<td>å¾ˆé«˜</td>
</tr>
<tr>
<td>å®¹é‡</td>
<td>ä½</td>
</tr>
<tr>
<td>çµæ´»æ€§</td>
<td>ä½</td>
</tr>
<tr>
<td>åºåˆ—åŒ–</td>
<td>ç®€å•</td>
</tr>
</tbody>
</table>
<p>å½“å¯¹è±¡çš„æŸä¸ªå±æ€§éœ€è¦é¢‘ç¹ä¿®æ”¹æ—¶ï¼Œä¸é€‚åˆç”¨ string+jsonï¼Œå› ä¸ºå®ƒä¸å¤Ÿçµæ´»ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦é‡æ–°å°†æ•´ä¸ªå¯¹è±¡åºåˆ—åŒ–å¹¶èµ‹å€¼ï¼Œå¦‚æœä½¿ç”¨ hash ç±»å‹ï¼Œåˆ™å¯ä»¥é’ˆå¯¹æŸä¸ªå±æ€§å•ç‹¬ä¿®æ”¹ï¼Œæ²¡æœ‰åºåˆ—åŒ–ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹æ•´ä¸ªå¯¹è±¡ã€‚æ¯”å¦‚ï¼Œå•†å“çš„ä»·æ ¼ã€é”€é‡ã€å…³æ³¨æ•°ã€è¯„ä»·æ•°ç­‰å¯èƒ½ç»å¸¸å‘ç”Ÿå˜åŒ–çš„å±æ€§ï¼Œå°±é€‚åˆå­˜å‚¨åœ¨hashç±»å‹é‡Œã€‚å½“ç„¶ï¼Œä¸å¸¸å˜åŒ–çš„å±æ€§å­˜å‚¨åœ¨ hash ç±»å‹é‡Œä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œæ¯”å¦‚å•†å“åç§°ã€å•†å“æè¿°ã€ä¸Šå¸‚æ—¥æœŸç­‰ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“å¯¹è±¡çš„æŸä¸ªå±æ€§ä¸æ˜¯åŸºæœ¬ç±»å‹æˆ–å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨ hash ç±»å‹å°±å¿…é¡»æ‰‹åŠ¨è¿›è¡Œå¤æ‚åºåˆ—åŒ–ï¼Œæ¯”å¦‚ï¼Œå•†å“çš„æ ‡ç­¾æ˜¯ä¸€ä¸ªæ ‡ç­¾å¯¹è±¡çš„åˆ—è¡¨ï¼Œå•†å“å¯é¢†å–çš„ä¼˜æƒ åˆ¸æ˜¯ä¸€ä¸ªä¼˜æƒ åˆ¸å¯¹è±¡çš„åˆ—è¡¨ç­‰ï¼Œå³ä½¿ä»¥ couponsï¼ˆä¼˜æƒ åˆ¸ï¼‰ä½œä¸º fieldï¼Œvalue æƒ³å­˜å‚¨ä¼˜æƒ åˆ¸å¯¹è±¡åˆ—è¡¨ä¹Ÿè¿˜æ˜¯è¦ä½¿ç”¨ json æ¥åºåˆ—åŒ–ï¼Œè¿™æ ·çš„è¯åºåˆ—åŒ–å·¥ä½œå°±å¤ªç¹çäº†ï¼Œä¸å¦‚ç›´æ¥ç”¨ string + json çš„æ–¹å¼å­˜å‚¨å•†å“ä¿¡æ¯æ¥çš„ç®€å•ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//================================ hashæ“ä½œ =================================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * HashGet
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key redisé”® ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param mapKey mapé”® ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Object hGet(String key,String mapKey){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">get</span>(key, mapKey);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return å¯¹åº”çš„å¤šä¸ªé”®å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Map&lt;Object,Object&gt; hGetMap(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//é€šè¿‡BoundValueOperationsè·å–å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">//Map entries = redisTemplate.boundHashOps(&#34;HashKey&#34;).entries();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">entries</span>(key);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–mapçš„æ‰€æœ‰key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;Object&gt; hGetMapKeys(String hashKey){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//1ã€é€šè¿‡BoundValueOperationsè·å–å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//        Set keys1 = redisTemplate.boundHashOps(hashKey).keys();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//2ã€é€šè¿‡ValueOperationsè·å–å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Set keys3 = redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">keys</span>(hashKey);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> keys3;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–mapçš„æ‰€æœ‰value
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> List&lt;Object&gt; hGetMapValues(String hashKey){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//1ã€é€šè¿‡BoundValueOperationsè·å–å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//        List values1 = redisTemplate.boundHashOps(hashKey).values();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//2ã€é€šè¿‡ValueOperationsè·å–å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        List values3 = redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">values</span>(hashKey);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> values3;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç›´æ¥setä¸€ä¸ªmapåˆ°redis
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true æˆåŠŸ false å¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hSetMap(String key, Map&lt;String,Object&gt; map){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">putAll</span>(key, map);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç›´æ¥setä¸€ä¸ªmapåˆ°redisï¼Œå¹¶è®¾ç½®æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return trueæˆåŠŸ falseå¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hSetMap(String key, Map&lt;String,Object&gt; map, <span style="color:#fff;font-weight:bold">long</span> time){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">putAll</span>(key, map);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(time&gt;<span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                expire(key, time);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true æˆåŠŸ falseå¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hSet(String key,String item,Object value) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundHashOps(&#34;HashKey&#34;).put(&#34;SmallKey&#34;, &#34;HashValue&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">put</span>(key, item, value);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)  æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true æˆåŠŸ falseå¤±è´¥
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hSet(String key,String item,Object value,<span style="color:#fff;font-weight:bold">long</span> time) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">put</span>(key, item, value);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(time&gt;<span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                expire(key, time);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åˆ é™¤hashè¡¨ä¸­çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”® ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> hDel(String key, Object... item){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//redisTemplate.boundHashOps(&#34;HashKey&#34;).delete(&#34;SmallKey&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">delete</span>(key,item);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”® ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹ ä¸èƒ½ä¸ºnull
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hHasKey(String key, String item){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//Boolean isEmpty = redisTemplate.boundHashOps(&#34;HashKey&#34;).hasKey(&#34;SmallKey&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">hasKey</span>(key, item);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param by è¦å¢åŠ å‡ (å¤§äº0)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">double</span> hIncr(String key, String item,<span style="color:#fff;font-weight:bold">double</span> by){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">increment</span>(key, item, by);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * hashé€’å‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param item é¡¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param by è¦å‡å°‘è®°(å°äº0)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">double</span> hDecr(String key, String item,<span style="color:#fff;font-weight:bold">double</span> by){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForHash</span>().<span style="color:#007f7f">increment</span>(key, item,-by);
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="set-3">set<a hidden class="anchor" aria-hidden="true" href="#set-3">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">99
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//============================ setæ“ä½œ =============================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;Object&gt; sGet(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//Set set1 = redisTemplate.boundSetOps(&#34;setKey&#34;).members();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">members</span>(key);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param value å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> sHasKey(String key,Object value){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//Boolean isEmpty = redisTemplate.boundSetOps(&#34;setKey&#34;).isMember(&#34;setValue2&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">isMember</span>(key, value);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å°†æ•°æ®æ”¾å…¥setç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return æˆåŠŸä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> sSet(String key, Object...<span style="color:#007f7f">values</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//redisTemplate.boundSetOps(&#34;setKey&#34;).add(&#34;setValue1&#34;, &#34;setValue2&#34;, &#34;setValue3&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">add</span>(key, values);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param time æ—¶é—´(ç§’)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return æˆåŠŸä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> sSetAndTime(String key,<span style="color:#fff;font-weight:bold">long</span> time,Object...<span style="color:#007f7f">values</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            Long count = redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">add</span>(key, values);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span>(time &gt; <span style="color:#ff0;font-weight:bold">0</span>){
</span></span><span style="display:flex;"><span>                expire(key, time);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> count;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–setç¼“å­˜çš„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> sGetSetSize(String key){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//Long size = redisTemplate.boundSetOps(&#34;setKey&#34;).size();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">return</span> redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">size</span>(key);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ç§»é™¤å€¼ä¸ºvalueçš„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param key é”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return ç§»é™¤çš„ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> setRemove(String key, Object ...<span style="color:#007f7f">values</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//Long result1 = redisTemplate.boundSetOps(&#34;setKey&#34;).remove(&#34;setValue1&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Long count = redisTemplate.<span style="color:#007f7f">opsForSet</span>().<span style="color:#007f7f">remove</span>(key, values);
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> count;
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="zset">zSet<a hidden class="anchor" aria-hidden="true" href="#zset">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//=============================== zSetæ“ä½œ =================================
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘é›†åˆä¸­æ’å…¥å…ƒç´ ï¼Œå¹¶è®¾ç½®åˆ†æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetValue
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param score
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> zSetSet(String zSetKey,String zSetValue,<span style="color:#fff;font-weight:bold">double</span> score){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//é€šè¿‡ValueOperationsè®¾ç½®å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">//ZSetOperations zSetOps = redisTemplate.opsForZSet();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">//zSetOps.add(&#34;zSetKey&#34;, &#34;zSetValue&#34;, 100D);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">boolean</span> success = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">add</span>(zSetValue, score);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> success;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘é›†åˆä¸­æ’å…¥å¤šä¸ªå…ƒç´ ,å¹¶è®¾ç½®åˆ†æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> zSetMany(String zSetKey){
</span></span><span style="display:flex;"><span>        DefaultTypedTuple&lt;String&gt; p1 = <span style="color:#fff;font-weight:bold">new</span> DefaultTypedTuple&lt;&gt;(<span style="color:#0ff;font-weight:bold">&#34;zSetValue1&#34;</span>, <span style="color:#ff0;font-weight:bold">2.1D</span>);
</span></span><span style="display:flex;"><span>        DefaultTypedTuple&lt;String&gt; p2 = <span style="color:#fff;font-weight:bold">new</span> DefaultTypedTuple&lt;&gt;(<span style="color:#0ff;font-weight:bold">&#34;zSetValue2&#34;</span>, <span style="color:#ff0;font-weight:bold">3.3D</span>);
</span></span><span style="display:flex;"><span>        redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">add</span>(<span style="color:#fff;font-weight:bold">new</span> HashSet(Arrays.<span style="color:#007f7f">asList</span>(p1,p2)));
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–åŒºé—´å†…çš„å…ƒç´ ï¼ŒæŒ‰ç…§æ’åå…ˆå(ä»å°åˆ°å¤§)-1ä¸ºæ‰“å°å…¨éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;Object&gt; getSet(String zSetKey){
</span></span><span style="display:flex;"><span>        Set&lt;Object&gt; range = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">range</span>(<span style="color:#ff0;font-weight:bold">0</span>, -<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> range;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è¿”å›é›†åˆå†…çš„æˆå‘˜ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> getZSetCount(String zSetKey){
</span></span><span style="display:flex;"><span>        Long count = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">size</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> count;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è¿”å›é›†åˆå†…æŒ‡å®šåˆ†æ•°èŒƒå›´çš„æˆå‘˜ä¸ªæ•°ï¼ˆDoubleç±»å‹ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> getZSetCountRange(String zSetKey){
</span></span><span style="display:flex;"><span>        Long count = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">count</span>(<span style="color:#ff0;font-weight:bold">0D</span>, <span style="color:#ff0;font-weight:bold">2.2D</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> count;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è¿”å›é›†åˆå†…å…ƒç´ åœ¨æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æ’åï¼ˆä»å°åˆ°å¤§ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;Object&gt; getSetByRange(String zSetKey){
</span></span><span style="display:flex;"><span>        Set&lt;Object&gt; byScore = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">rangeByScore</span>(<span style="color:#ff0;font-weight:bold">0D</span>, <span style="color:#ff0;font-weight:bold">2.2D</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> byScore;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è¿”å›é›†åˆå†…å…ƒç´ åœ¨æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æ’åï¼šå¸¦åç§»é‡å’Œä¸ªæ•°ï¼Œ(keyï¼Œèµ·å§‹åˆ†æ•°ï¼Œæœ€å¤§åˆ†æ•°ï¼Œåç§»é‡ï¼Œä¸ªæ•°)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;Object&gt; getSetByOffset(String zSetKey){
</span></span><span style="display:flex;"><span>        Set&lt;Object&gt; rank = redisTemplate.<span style="color:#007f7f">opsForZSet</span>().<span style="color:#007f7f">rangeByScore</span>(<span style="color:#0ff;font-weight:bold">&#34;zSetKey&#34;</span>, <span style="color:#ff0;font-weight:bold">0D</span>, <span style="color:#ff0;font-weight:bold">2.2D</span>,<span style="color:#ff0;font-weight:bold">1</span>, <span style="color:#ff0;font-weight:bold">3</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> rank;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è¿”å›é›†åˆå†…å…ƒç´ çš„æ’åï¼Œä»¥åŠåˆ†æ•°ï¼ˆä»å°åˆ°å¤§ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Set&lt;ZSetOperations.<span style="color:#007f7f">TypedTuple</span>&lt;Object&gt;&gt; getSetByRangeAndScore(String zSetKey){
</span></span><span style="display:flex;"><span>        Set&lt;ZSetOperations.<span style="color:#007f7f">TypedTuple</span>&lt;Object&gt;&gt; tuples = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">rangeWithScores</span>(<span style="color:#ff0;font-weight:bold">0</span>L, <span style="color:#ff0;font-weight:bold">3L</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (ZSetOperations.<span style="color:#007f7f">TypedTuple</span>&lt;Object&gt; tuple : tuples) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(tuple.<span style="color:#007f7f">getValue</span>() + <span style="color:#0ff;font-weight:bold">&#34; : &#34;</span> + tuple.<span style="color:#007f7f">getScore</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> tuples;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å–æŒ‡å®šæˆå‘˜çš„æ’å
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> getStartRank(String zSetKey){
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä»å°åˆ°å¤§
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Long startRank = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">rank</span>(<span style="color:#0ff;font-weight:bold">&#34;zSetValue&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//ä»å¤§åˆ°å°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#007f7f">//Long endRank = redisTemplate.boundZSetOps(zSetKey).reverseRank(&#34;zSetValue&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">return</span> startRank;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä¸ºæŒ‡å®šå…ƒç´ åŠ åˆ†ï¼ˆDoubleç±»å‹ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Double zSetAddScore(String zSetKey){
</span></span><span style="display:flex;"><span>        Double score = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">incrementScore</span>(<span style="color:#0ff;font-weight:bold">&#34;zSetValue&#34;</span>,<span style="color:#ff0;font-weight:bold">1.1D</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> score;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è·å¾—æŒ‡å®šå…ƒç´ çš„åˆ†æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @param zSetKey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Double getScoreByZSetKey(String zSetKey){
</span></span><span style="display:flex;"><span>        Double score = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">score</span>(<span style="color:#0ff;font-weight:bold">&#34;zSetValue&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> score;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return åˆ é™¤æˆåŠŸçš„å…ƒç´ ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> zSetRemove(String zSetKey){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">long</span> delNum = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">remove</span>(<span style="color:#0ff;font-weight:bold">&#34;zSetValue&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> delNum;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ ï¼Œæ ¹æ®èŒƒå›´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return åˆ é™¤æˆåŠŸçš„å…ƒç´ ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> zSetRemoveByRange(String zSetKey){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">long</span> delNum = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">removeRange</span>(<span style="color:#ff0;font-weight:bold">0</span>L,<span style="color:#ff0;font-weight:bold">3L</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> delNum;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * ä»é›†åˆä¸­åˆ é™¤æŒ‡å®šå…ƒç´ ï¼Œæ ¹æ®åˆ†æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * @return åˆ é™¤æˆåŠŸçš„å…ƒç´ ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">long</span> zSetRemoveByScore(String zSetKey){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">long</span> delNum = redisTemplate.<span style="color:#007f7f">boundZSetOps</span>(zSetKey).<span style="color:#007f7f">removeRangeByScore</span>(<span style="color:#ff0;font-weight:bold">0D</span>,<span style="color:#ff0;font-weight:bold">2.2D</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> delNum;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="rediså¼€å‘è§„èŒƒ">rediså¼€å‘è§„èŒƒ<a hidden class="anchor" aria-hidden="true" href="#rediså¼€å‘è§„èŒƒ">#</a></h1>
<h2 id="keyåè®¾è®¡">keyåè®¾è®¡<a hidden class="anchor" aria-hidden="true" href="#keyåè®¾è®¡">#</a></h2>
<p>ã€å»ºè®®ã€‘: å¯è¯»æ€§å’Œå¯ç®¡ç†æ€§</p>
<p>ä»¥ä¸šåŠ¡åï¼ˆæˆ–æ•°æ®åº“åï¼‰ä¸ºå‰ç¼€ï¼ˆé˜²æ­¢keyå†²çªï¼‰ï¼Œç”¨å†’å·åˆ†éš”ï¼Œæ¯”å¦‚</p>
<p><code>ä¸šåŠ¡å:è¡¨å:id</code></p>
<p><code>ugc:video:1</code></p>
<p>ã€å»ºè®®ã€‘ï¼šç®€æ´æ€§</p>
<p>ä¿è¯è¯­ä¹‰çš„å‰æä¸‹ï¼Œæ§åˆ¶keyçš„é•¿åº¦ï¼Œå½“keyè¾ƒå¤šæ—¶ï¼Œå†…å­˜å ç”¨ä¹Ÿä¸å®¹å¿½è§†ï¼Œä¾‹å¦‚ï¼š</p>
<p><code>user:{uid}:friends:messages:{mid}</code></p>
<p>ç®€åŒ–ä¸º</p>
<p><code>u:{uid}ğŸ‡«ğŸ‡·m:{mid}</code></p>
<p>ã€å¼ºåˆ¶ã€‘ï¼šä¸è¦åŒ…å«ç‰¹æ®Šå­—ç¬¦</p>
<p>åä¾‹ï¼šåŒ…å«ç©ºæ ¼ã€æ¢è¡Œã€å•åŒå¼•å·ä»¥åŠå…¶ä»–è½¬ä¹‰å­—ç¬¦</p>
<p><a href="https://mp.weixin.qq.com/s?spm=a2c6h.12873639.article-detail.7.23551fee7lWP7T&amp;__biz=Mzg2NTEyNzE0OA==&amp;mid=2247483663&amp;idx=1&amp;sn=7c4ad441eaec6f0ff38d1c6a097b1fa4&amp;chksm=ce5f9e8cf928179a2c74227da95bec575bdebc682e8630b5b1bb2071c0a1b4be6f98d67c37ca&amp;scene=21#wechat_redirect">è¯¦è§£</a></p>
<h2 id="valueè®¾è®¡">valueè®¾è®¡<a hidden class="anchor" aria-hidden="true" href="#valueè®¾è®¡">#</a></h2>
<p>ã€å¼ºåˆ¶ã€‘ï¼šæ‹’ç» bigkeyï¼ˆé˜²æ­¢ç½‘å¡æµé‡ã€æ…¢æŸ¥è¯¢ï¼‰</p>
<p>stringç±»å‹æ§åˆ¶åœ¨10KBä»¥å†…ï¼Œhashã€listã€setã€zsetå…ƒç´ ä¸ªæ•°ä¸è¦è¶…è¿‡5000ã€‚</p>
<p>åä¾‹ï¼šä¸€ä¸ªåŒ…å«200ä¸‡ä¸ªå…ƒç´ çš„listã€‚</p>
<p>éå­—ç¬¦ä¸²çš„bigkeyï¼Œä¸è¦ä½¿ç”¨delåˆ é™¤ï¼Œä½¿ç”¨hscanã€sscanã€zscanæ–¹å¼æ¸è¿›å¼åˆ é™¤ï¼ŒåŒæ—¶è¦æ³¨æ„é˜²æ­¢bigkeyè¿‡æœŸæ—¶é—´è‡ªåŠ¨åˆ é™¤é—®é¢˜(ä¾‹å¦‚ä¸€ä¸ª200ä¸‡çš„zsetè®¾ç½®1å°æ—¶è¿‡æœŸï¼Œä¼šè§¦å‘delæ“ä½œï¼Œé€ æˆé˜»å¡ï¼Œè€Œä¸”è¯¥æ“ä½œä¸ä¼šä¸å‡ºç°åœ¨æ…¢æŸ¥è¯¢ä¸­(latencyå¯æŸ¥))ï¼ŒæŸ¥æ‰¾æ–¹æ³•å’Œåˆ é™¤æ–¹æ³•ã€‚</p>
<p>ã€æ¨èã€‘ï¼šé€‰æ‹©é€‚åˆçš„æ•°æ®ç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼šå®ä½“ç±»å‹ï¼Œè¦åˆç†æ§åˆ¶å’Œä½¿ç”¨æ•°æ®ç»“æ„å†…å­˜ç¼–ç ä¼˜åŒ–é…ç½®ï¼Œä¾‹å¦‚ziplistï¼Œä½†ä¹Ÿè¦æ³¨æ„èŠ‚çœå†…å­˜å’Œæ€§èƒ½ä¹‹é—´çš„å¹³è¡¡</p>
<p>åä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">set</span> user:1:name tom
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">set</span> user:1:age <span style="color:#ff0;font-weight:bold">19</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">set</span> user:1:favor football
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­£ä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hmset user:1 name tom age <span style="color:#ff0;font-weight:bold">19</span> favor football
</span></span></code></pre></td></tr></table>
</div>
</div><p>ã€æ¨èã€‘ï¼šæ§åˆ¶keyçš„ç”Ÿå‘½å‘¨æœŸ</p>
<p>å»ºè®®ä½¿ç”¨expireè®¾ç½®è¿‡æœŸæ—¶é—´(æ¡ä»¶å…è®¸å¯ä»¥æ‰“æ•£è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢é›†ä¸­è¿‡æœŸ)ï¼Œä¸è¿‡æœŸçš„æ•°æ®é‡ç‚¹å…³æ³¨idletimeã€‚</p>
<h2 id="å‘½ä»¤ä½¿ç”¨">å‘½ä»¤ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#å‘½ä»¤ä½¿ç”¨">#</a></h2>
<p>ã€æ¨èã€‘ O(N)å‘½ä»¤å…³æ³¨Nçš„æ•°é‡
ä¾‹å¦‚hgetallã€lrangeã€smembersã€zrangeã€sinterç­‰å¹¶éä¸èƒ½ä½¿ç”¨ï¼Œä½†æ˜¯éœ€è¦æ˜ç¡®Nçš„å€¼ã€‚æœ‰éå†çš„éœ€æ±‚å¯ä»¥ä½¿ç”¨hscanã€sscanã€zscanä»£æ›¿ã€‚</p>
<p>ã€æ¨èã€‘ï¼šç¦ç”¨å‘½ä»¤
ç¦æ­¢çº¿ä¸Šä½¿ç”¨keysã€flushallã€flushdbç­‰ï¼Œé€šè¿‡redisçš„renameæœºåˆ¶ç¦æ‰å‘½ä»¤ï¼Œæˆ–è€…ä½¿ç”¨scançš„æ–¹å¼æ¸è¿›å¼å¤„ç†ã€‚</p>
<p>ã€æ¨èã€‘åˆç†ä½¿ç”¨select
redisçš„å¤šæ•°æ®åº“è¾ƒå¼±ï¼Œä½¿ç”¨æ•°å­—è¿›è¡ŒåŒºåˆ†ï¼Œå¾ˆå¤šå®¢æˆ·ç«¯æ”¯æŒè¾ƒå·®ï¼ŒåŒæ—¶å¤šä¸šåŠ¡ç”¨å¤šæ•°æ®åº“å®é™…è¿˜æ˜¯å•çº¿ç¨‹å¤„ç†ï¼Œä¼šæœ‰å¹²æ‰°ã€‚</p>
<p>ã€æ¨èã€‘ä½¿ç”¨æ‰¹é‡æ“ä½œæé«˜æ•ˆç‡</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>åŸç”Ÿå‘½ä»¤ï¼šä¾‹å¦‚mgetã€msetã€‚
</span></span><span style="display:flex;"><span>éåŸç”Ÿå‘½ä»¤ï¼šå¯ä»¥ä½¿ç”¨pipelineæé«˜æ•ˆç‡ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†è¦æ³¨æ„æ§åˆ¶ä¸€æ¬¡æ‰¹é‡æ“ä½œçš„<strong>å…ƒç´ ä¸ªæ•°</strong>(ä¾‹å¦‚500ä»¥å†…ï¼Œå®é™…ä¹Ÿå’Œå…ƒç´ å­—èŠ‚æ•°æœ‰å…³)ã€‚</p>
<p>æ³¨æ„ä¸¤è€…ä¸åŒï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>1. åŸç”Ÿæ˜¯åŸå­æ“ä½œï¼Œpipelineæ˜¯éåŸå­æ“ä½œã€‚
</span></span><span style="display:flex;"><span>2. pipelineå¯ä»¥æ‰“åŒ…ä¸åŒçš„å‘½ä»¤ï¼ŒåŸç”Ÿåšä¸åˆ°
</span></span><span style="display:flex;"><span>3. pipelineéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŒæ—¶æ”¯æŒã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>ã€å»ºè®®ã€‘Redisäº‹åŠ¡åŠŸèƒ½è¾ƒå¼±ï¼Œä¸å»ºè®®è¿‡å¤šä½¿ç”¨
Redisçš„äº‹åŠ¡åŠŸèƒ½è¾ƒå¼±(ä¸æ”¯æŒå›æ»š)ï¼Œè€Œä¸”é›†ç¾¤ç‰ˆæœ¬(è‡ªç ”å’Œå®˜æ–¹)è¦æ±‚ä¸€æ¬¡äº‹åŠ¡æ“ä½œçš„keyå¿…é¡»åœ¨ä¸€ä¸ªslotä¸Š(å¯ä»¥ä½¿ç”¨hashtagåŠŸèƒ½è§£å†³)</p>
<p>ã€å»ºè®®ã€‘Redisé›†ç¾¤ç‰ˆæœ¬åœ¨ä½¿ç”¨Luaä¸Šæœ‰ç‰¹æ®Šè¦æ±‚ï¼š</p>
<ul>
<li>1.æ‰€æœ‰keyéƒ½åº”è¯¥ç”± KEYS æ•°ç»„æ¥ä¼ é€’ï¼Œredis.call/pcall é‡Œé¢è°ƒç”¨çš„rediså‘½ä»¤ï¼Œkeyçš„ä½ç½®ï¼Œå¿…é¡»æ˜¯KEYS array, å¦åˆ™ç›´æ¥è¿”å›errorï¼Œ&quot;-ERR bad lua script for redis cluster, all the keys that the script uses should be passed using the KEYS array&quot;</li>
<li>2.æ‰€æœ‰keyï¼Œå¿…é¡»åœ¨1ä¸ªslotä¸Šï¼Œå¦åˆ™ç›´æ¥è¿”å›error, &ldquo;-ERR eval/evalsha command keys must in same slot&rdquo;</li>
</ul>
<p>ã€å»ºè®®ã€‘å¿…è¦æƒ…å†µä¸‹ä½¿ç”¨monitorå‘½ä»¤æ—¶ï¼Œè¦æ³¨æ„ä¸è¦é•¿æ—¶é—´ä½¿ç”¨ã€‚</p>
<h2 id="å®¢æˆ·ç«¯ä½¿ç”¨">å®¢æˆ·ç«¯ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#å®¢æˆ·ç«¯ä½¿ç”¨">#</a></h2>
<p>ã€æ¨èã€‘
é¿å…å¤šä¸ªåº”ç”¨ä½¿ç”¨ä¸€ä¸ªRediså®ä¾‹
æ­£ä¾‹ï¼šä¸ç›¸å¹²çš„ä¸šåŠ¡æ‹†åˆ†ï¼Œå…¬å…±æ•°æ®åšæœåŠ¡åŒ–ã€‚</p>
<p>ã€æ¨èã€‘
ä½¿ç”¨å¸¦æœ‰è¿æ¥æ± çš„æ•°æ®åº“ï¼Œå¯ä»¥æœ‰æ•ˆæ§åˆ¶è¿æ¥ï¼ŒåŒæ—¶æé«˜æ•ˆç‡ï¼Œæ ‡å‡†ä½¿ç”¨æ–¹å¼ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f00">æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</span>
</span></span><span style="display:flex;"><span>Jedis jedis = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>    jedis = jedisPool.<span style="color:#007f7f">getResource</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å…·ä½“çš„å‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    jedis.<span style="color:#007f7f">executeCommand</span>()
</span></span><span style="display:flex;"><span>} <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>    logger.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;op key {} error: &#34;</span> + e.<span style="color:#007f7f">getMessage</span>(), key, e);
</span></span><span style="display:flex;"><span>} <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//æ³¨æ„è¿™é‡Œä¸æ˜¯å…³é—­è¿æ¥ï¼Œåœ¨JedisPoolæ¨¡å¼ä¸‹ï¼ŒJedisä¼šè¢«å½’è¿˜ç»™èµ„æºæ± ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span> (jedis != <span style="color:#fff;font-weight:bold">null</span>) 
</span></span><span style="display:flex;"><span>        jedis.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ã€å»ºè®®ã€‘
é«˜å¹¶å‘ä¸‹å»ºè®®å®¢æˆ·ç«¯æ·»åŠ ç†”æ–­åŠŸèƒ½(ä¾‹å¦‚netflix hystrix)</p>
<p>ã€æ¨èã€‘
è®¾ç½®åˆç†çš„å¯†ç ï¼Œå¦‚æœ‰å¿…è¦å¯ä»¥ä½¿ç”¨SSLåŠ å¯†è®¿é—®ï¼ˆé˜¿é‡Œäº‘Redisæ”¯æŒï¼‰</p>
<p>ã€å»ºè®®ã€‘</p>
<p>æ ¹æ®è‡ªèº«ä¸šåŠ¡ç±»å‹ï¼Œé€‰å¥½maxmemory-policy(æœ€å¤§å†…å­˜æ·˜æ±°ç­–ç•¥)ï¼Œè®¾ç½®å¥½è¿‡æœŸæ—¶é—´ã€‚</p>
<p>é»˜è®¤ç­–ç•¥æ˜¯volatile-lruï¼Œå³è¶…è¿‡æœ€å¤§å†…å­˜åï¼Œåœ¨è¿‡æœŸé”®ä¸­ä½¿ç”¨lruç®—æ³•è¿›è¡Œkeyçš„å‰”é™¤ï¼Œä¿è¯ä¸è¿‡æœŸæ•°æ®ä¸è¢«åˆ é™¤ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°OOMé—®é¢˜ã€‚</p>
<p>å…¶ä»–ç­–ç•¥å¦‚ä¸‹ï¼š</p>
<ul>
<li>allkeys-lruï¼šæ ¹æ®LRUç®—æ³•åˆ é™¤é”®ï¼Œä¸ç®¡æ•°æ®æœ‰æ²¡æœ‰è®¾ç½®è¶…æ—¶å±æ€§ï¼Œç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li>
<li>allkeys-randomï¼šéšæœºåˆ é™¤æ‰€æœ‰é”®ï¼Œç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li>
<li>volatile-random:éšæœºåˆ é™¤è¿‡æœŸé”®ï¼Œç›´åˆ°è…¾å‡ºè¶³å¤Ÿç©ºé—´ä¸ºæ­¢ã€‚</li>
<li>volatile-ttlï¼šæ ¹æ®é”®å€¼å¯¹è±¡çš„ttlå±æ€§ï¼Œåˆ é™¤æœ€è¿‘å°†è¦è¿‡æœŸæ•°æ®ã€‚å¦‚æœæ²¡æœ‰ï¼Œå›é€€åˆ°noevictionç­–ç•¥ã€‚</li>
<li>noevictionï¼šä¸ä¼šå‰”é™¤ä»»ä½•æ•°æ®ï¼Œæ‹’ç»æ‰€æœ‰å†™å…¥æ“ä½œå¹¶è¿”å›å®¢æˆ·ç«¯é”™è¯¯ä¿¡æ¯&quot;(error) OOM command not allowed when used memory&quot;ï¼Œæ­¤æ—¶Redisåªå“åº”è¯»æ“ä½œã€‚</li>
</ul>
<h1 id="redis-æŒä¹…åŒ–ç­–ç•¥æµ…æ">Redis æŒä¹…åŒ–ç­–ç•¥æµ…æ<a hidden class="anchor" aria-hidden="true" href="#redis-æŒä¹…åŒ–ç­–ç•¥æµ…æ">#</a></h1>
<p>Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œæ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ºäº†é¿å…è¿›ç¨‹é€€å‡ºå¯¼è‡´æ•°æ®çš„æ°¸ä¹…ä¸¢å¤±ï¼Œéœ€è¦å®šæœŸå°† Redis ä¸­çš„æ•°æ®ä»¥æŸç§å½¢å¼ï¼ˆæ•°æ®æˆ–å‘½ä»¤ï¼‰ä»å†…å­˜ä¿å­˜åˆ°ç¡¬ç›˜ã€‚å½“ä¸‹æ¬¡ Redis é‡å¯æ—¶ï¼Œåˆ©ç”¨æŒä¹…åŒ–æ–‡ä»¶å®ç°æ•°æ®æ¢å¤ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†è¿›è¡Œç¾éš¾å¤‡ä»½ï¼Œå¯ä»¥å°†æŒä¹…åŒ–æ–‡ä»¶æ‹·è´åˆ°ä¸€ä¸ªè¿œç¨‹ä½ç½®ã€‚Redis çš„æŒä¹…åŒ–æœºåˆ¶æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>
<p>RDBï¼ˆRedis Data Baseï¼‰å†…å­˜å¿«ç…§</p>
</li>
<li>
<p>AOFï¼ˆAppend Only Fileï¼‰å¢é‡æ—¥å¿—</p>
</li>
</ul>
<p>RDB å°†å½“å‰æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ï¼ŒAOF åˆ™æ˜¯å°†æ¯æ¬¡æ‰§è¡Œçš„å†™å‘½ä»¤ä¿å­˜åˆ°ç¡¬ç›˜ï¼ˆç±»ä¼¼äº MySQL çš„ Binlogï¼‰ã€‚AOF æŒä¹…åŒ–çš„å®æ—¶æ€§æ›´å¥½ï¼Œå³å½“è¿›ç¨‹æ„å¤–é€€å‡ºæ—¶ä¸¢å¤±çš„æ•°æ®æ›´å°‘ã€‚</p>
<h2 id="rdbæŒä¹…åŒ–">RDBæŒä¹…åŒ–<a hidden class="anchor" aria-hidden="true" href="#rdbæŒä¹…åŒ–">#</a></h2>
<p>RDBï¼ˆRedis Data Baseï¼‰æŒ‡çš„æ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼ŒRDB æ˜¯å†…å­˜å¿«ç…§ï¼ˆå†…å­˜æ•°æ®çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å½¢å¼ï¼‰çš„æ–¹å¼æŒä¹…åŒ–ï¼Œæ¯æ¬¡éƒ½æ˜¯ä» Redis ä¸­ç”Ÿæˆä¸€ä¸ªå¿«ç…§è¿›è¡Œæ•°æ®çš„å…¨é‡å¤‡ä»½ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>å­˜å‚¨ç´§å‡‘ï¼ŒèŠ‚çœå†…å­˜ç©ºé—´ã€‚</p>
</li>
<li>
<p>æ¢å¤é€Ÿåº¦éå¸¸å¿«ã€‚</p>
</li>
<li>
<p>é€‚åˆå…¨é‡å¤‡ä»½ã€å…¨é‡å¤åˆ¶çš„åœºæ™¯ï¼Œç»å¸¸ç”¨äºç¾éš¾æ¢å¤ï¼ˆå¯¹æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§è¦æ±‚ç›¸å¯¹è¾ƒä½çš„åœºåˆï¼‰ã€‚</p>
</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å®¹æ˜“ä¸¢å¤±æ•°æ®ï¼Œå®¹æ˜“ä¸¢å¤±ä¸¤æ¬¡å¿«ç…§ä¹‹é—´ Redis æœåŠ¡å™¨ä¸­å˜åŒ–çš„æ•°æ®ã€‚</li>
<li>RDB é€šè¿‡ fork å­è¿›ç¨‹å¯¹å†…å­˜å¿«ç…§è¿›è¡Œå…¨é‡å¤‡ä»½ï¼Œæ˜¯ä¸€ä¸ªé‡é‡çº§æ“ä½œï¼Œé¢‘ç¹æ‰§è¡Œæˆæœ¬é«˜ã€‚</li>
</ul>
<h3 id="rdb-æ–‡ä»¶ç»“æ„">RDB æ–‡ä»¶ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#rdb-æ–‡ä»¶ç»“æ„">#</a></h3>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚RDB æ–‡ä»¶ç»“æ„ç”±äº”ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>é•¿åº¦ä¸º5å­—èŠ‚çš„ <code>REDIS</code> å¸¸é‡å­—ç¬¦ä¸²ã€‚</li>
<li>4å­—èŠ‚çš„ db_versionï¼Œæ ‡è¯† RDB æ–‡ä»¶ç‰ˆæœ¬ã€‚</li>
<li>databasesï¼šä¸å®šé•¿åº¦ï¼ŒåŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“ï¼Œä»¥åŠå„æ•°æ®åº“ä¸­çš„é”®å€¼å¯¹æ•°æ®ã€‚</li>
<li>1å­—èŠ‚çš„ EOF å¸¸é‡ï¼Œè¡¨ç¤ºæ–‡ä»¶æ­£æ–‡å†…å®¹ç»“æŸã€‚</li>
<li>check_sumï¼š8å­—èŠ‚é•¿çš„æ— ç¬¦å·æ•´æ•°ï¼Œä¿å­˜æ ¡éªŒå’Œã€‚</li>
</ul>
<h3 id="rdb-æ–‡ä»¶çš„åˆ›å»ºæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘">RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘ï¼‰<a hidden class="anchor" aria-hidden="true" href="#rdb-æ–‡ä»¶çš„åˆ›å»ºæ‰‹åŠ¨æŒ‡ä»¤è§¦å‘">#</a></h3>
<p>æ‰‹åŠ¨è§¦å‘ RDB æŒä¹…åŒ–çš„æ–¹å¼å¯ä»¥ä½¿ç”¨ <code>save</code> å‘½ä»¤å’Œ <code>bgsave</code> å‘½ä»¤ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<p><code>save</code>ï¼šæ‰§è¡Œ<code>save</code>æŒ‡ä»¤ï¼Œé˜»å¡ Redis çš„å…¶ä»–æ“ä½œï¼Œä¼šå¯¼è‡´ Redis æ— æ³•å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</p>
<p><code>bgsave</code>ï¼šæ‰§è¡Œ <code>bgsave</code> æŒ‡ä»¤ï¼ŒRedis åå°åˆ›å»ºå­è¿›ç¨‹ï¼Œå¼‚æ­¥è¿›è¡Œå¿«ç…§çš„ä¿å­˜æ“ä½œï¼Œæ­¤æ—¶ Redis ä»ç„¶èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p>
<h3 id="rdb-æ–‡ä»¶çš„åˆ›å»ºè‡ªåŠ¨é—´éš”æ€§ä¿å­˜">RDB æ–‡ä»¶çš„åˆ›å»ºï¼ˆè‡ªåŠ¨é—´éš”æ€§ä¿å­˜ï¼‰<a hidden class="anchor" aria-hidden="true" href="#rdb-æ–‡ä»¶çš„åˆ›å»ºè‡ªåŠ¨é—´éš”æ€§ä¿å­˜">#</a></h3>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdbçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œè®©å®ƒåœ¨â€œ N ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œè‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚</p>
<p>æ¯”å¦‚è¯´ï¼Œ ä»¥ä¸‹è®¾ç½®ä¼šè®© Redis åœ¨æ»¡è¶³â€œ 60 ç§’å†…æœ‰è‡³å°‘æœ‰ 10 ä¸ªé”®è¢«æ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶æ—¶ï¼Œè‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†:<code>save 60 10</code>ã€‚</p>
<p>Redis çš„é»˜è®¤é…ç½®å¦‚ä¸‹ï¼Œä¸‰ä¸ªè®¾ç½®æ»¡è¶³å…¶ä¸€å³å¯è§¦å‘è‡ªåŠ¨ä¿å­˜ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>save <span style="color:#ff0;font-weight:bold">60</span> <span style="color:#ff0;font-weight:bold">10000</span>
</span></span><span style="display:flex;"><span>save <span style="color:#ff0;font-weight:bold">300</span> <span style="color:#ff0;font-weight:bold">10</span>
</span></span><span style="display:flex;"><span>save <span style="color:#ff0;font-weight:bold">900</span> <span style="color:#ff0;font-weight:bold">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è‡ªåŠ¨ä¿å­˜é…ç½®çš„æ•°æ®ç»“æ„">è‡ªåŠ¨ä¿å­˜é…ç½®çš„æ•°æ®ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#è‡ªåŠ¨ä¿å­˜é…ç½®çš„æ•°æ®ç»“æ„">#</a></h3>
<p>è®°å½•äº†æœåŠ¡å™¨è§¦å‘è‡ªåŠ¨ <code>BGSAVE</code> æ¡ä»¶çš„<code>saveparams</code>å±æ€§ã€‚</p>
<p><code>lastsave</code> å±æ€§ï¼šè®°å½•æœåŠ¡å™¨æœ€åä¸€æ¬¡æ‰§è¡Œ <code>SAVE</code> æˆ–è€… <code>BGSAVE</code> çš„æ—¶é—´ã€‚</p>
<p><code>dirty</code> å±æ€§ï¼šä»¥åŠè‡ªæœ€åä¸€æ¬¡ä¿å­˜ RDB æ–‡ä»¶ä»¥æ¥ï¼ŒæœåŠ¡å™¨è¿›è¡Œäº†å¤šå°‘æ¬¡å†™å…¥ã€‚</p>
<h3 id="å¤‡ä»½è¿‡ç¨‹">å¤‡ä»½è¿‡ç¨‹<a hidden class="anchor" aria-hidden="true" href="#å¤‡ä»½è¿‡ç¨‹">#</a></h3>
<p>RDB æŒä¹…åŒ–æ–¹æ¡ˆè¿›è¡Œå¤‡ä»½æ—¶ï¼ŒRedis ä¼šå•ç‹¬ fork ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå°†æ•°æ®å†™å…¥ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼ŒæŒä¹…åŒ–å®Œæˆåæ›¿æ¢æ—§çš„ RDB æ–‡ä»¶ã€‚åœ¨æ•´ä¸ªæŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹ï¼ˆä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡çš„è¿›ç¨‹ï¼‰ä¸å‚ä¸ IO æ“ä½œï¼Œè¿™æ ·èƒ½ç¡®ä¿ Redis æœåŠ¡çš„é«˜æ€§èƒ½ï¼ŒRDB æŒä¹…åŒ–æœºåˆ¶é€‚åˆå¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚ä¸é«˜ä½†è¿½æ±‚é«˜æ•ˆæ¢å¤çš„ä½¿ç”¨åœºæ™¯ã€‚ä¸‹é¢å±•ç¤º RDB æŒä¹…åŒ–æµç¨‹ï¼š</p>
<p><img loading="lazy" src="1.png" alt=""  />
</p>
<p>å…³é”®æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹</p>
<ol>
<li>
<p>Redis çˆ¶è¿›ç¨‹é¦–å…ˆåˆ¤æ–­ï¼šå½“å‰æ˜¯å¦åœ¨æ‰§è¡Œ saveï¼Œæˆ– bgsave/bgrewriteaof çš„å­è¿›ç¨‹ï¼Œå¦‚æœåœ¨æ‰§è¡Œåˆ™ bgsave å‘½ä»¤ç›´æ¥è¿”å›ã€‚bgsave/bgrewriteaof çš„å­è¿›ç¨‹ä¸èƒ½åŒæ—¶æ‰§è¡Œï¼Œä¸»è¦æ˜¯åŸºäºæ€§èƒ½æ–¹é¢çš„è€ƒè™‘ï¼šä¸¤ä¸ªå¹¶å‘çš„å­è¿›ç¨‹åŒæ—¶æ‰§è¡Œå¤§é‡çš„ç£ç›˜å†™æ“ä½œï¼Œå¯èƒ½å¼•èµ·ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚</p>
</li>
<li>
<p>çˆ¶è¿›ç¨‹æ‰§è¡Œ fork æ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­çˆ¶è¿›ç¨‹æ˜¯é˜»å¡çš„ï¼ŒRedis ä¸èƒ½æ‰§è¡Œæ¥è‡ªå®¢æˆ·ç«¯çš„ä»»ä½•å‘½ä»¤ã€‚çˆ¶è¿›ç¨‹ fork åï¼Œbgsave å‘½ä»¤è¿”å›â€Background saving startedâ€ä¿¡æ¯å¹¶ä¸å†é˜»å¡çˆ¶è¿›ç¨‹ï¼Œå¹¶å¯ä»¥å“åº”å…¶ä»–å‘½ä»¤ã€‚</p>
</li>
<li>
<p>å­è¿›ç¨‹è¿›ç¨‹å¯¹å†…å­˜æ•°æ®ç”Ÿæˆå¿«ç…§æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>çˆ¶è¿›ç¨‹åœ¨æ­¤æœŸé—´æ¥æ”¶çš„æ–°çš„å†™æ“ä½œï¼Œä½¿ç”¨ COW æœºåˆ¶å†™å…¥ã€‚</p>
</li>
<li>
<p>å­è¿›ç¨‹å®Œæˆå¿«ç…§å†™å…¥ï¼Œæ›¿æ¢æ—§ RDB æ–‡ä»¶ï¼Œéšåå­è¿›ç¨‹é€€å‡ºã€‚</p>
</li>
</ol>
<blockquote>
<p>åœ¨ç”Ÿæˆ RDB æ–‡ä»¶çš„æ­¥éª¤ä¸­ï¼Œåœ¨åŒæ­¥åˆ°ç£ç›˜å’ŒæŒç»­å†™å…¥è¿™ä¸ªè¿‡ç¨‹æ˜¯å¦‚ä½•å¤„ç†æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µå‘¢ï¼Ÿç”Ÿæˆå¿«ç…§ RDB æ–‡ä»¶æ—¶æ˜¯å¦ä¼šå¯¹ä¸šåŠ¡äº§ç”Ÿå½±å“ï¼Ÿ</p>
</blockquote>
<h3 id="fork-å­è¿›ç¨‹çš„ä½œç”¨">Fork å­è¿›ç¨‹çš„ä½œç”¨<a hidden class="anchor" aria-hidden="true" href="#fork-å­è¿›ç¨‹çš„ä½œç”¨">#</a></h3>
<p>ä¸Šé¢è¯´åˆ°äº† RDB æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹ä¼š fork ä¸€ä¸ªå­è¿›ç¨‹æ¥è´Ÿè´£ RDB çš„å¤‡ä»½ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ forkï¼š</p>
<ul>
<li>
<p>Linux æ“ä½œç³»ç»Ÿä¸­çš„ç¨‹åºï¼Œfork ä¼šäº§ç”Ÿä¸€ä¸ªå’Œçˆ¶è¿›ç¨‹å®Œå…¨ç›¸åŒçš„å­è¿›ç¨‹ã€‚å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹æ‰€æœ‰çš„æ•°æ®å‡ä¸€è‡´ï¼Œä½†æ˜¯å­è¿›ç¨‹æ˜¯ä¸€ä¸ªå…¨æ–°çš„è¿›ç¨‹ï¼Œä¸åŸè¿›ç¨‹æ˜¯çˆ¶å­è¿›ç¨‹å…³ç³»ã€‚</p>
</li>
<li>
<p>å‡ºäºæ•ˆç‡è€ƒè™‘ï¼ŒLinux æ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨ COW(Copy On Write)å†™æ—¶å¤åˆ¶æœºåˆ¶ï¼Œfork å­è¿›ç¨‹ä¸€èˆ¬æƒ…å†µä¸‹ä¸çˆ¶è¿›ç¨‹å…±åŒä½¿ç”¨ä¸€æ®µç‰©ç†å†…å­˜ï¼Œåªæœ‰åœ¨è¿›ç¨‹ç©ºé—´ä¸­çš„å†…å­˜å‘ç”Ÿä¿®æ”¹æ—¶ï¼Œå†…å­˜ç©ºé—´æ‰ä¼šå¤åˆ¶ä¸€ä»½å‡ºæ¥ã€‚</p>
</li>
</ul>
<p>åœ¨ Redis ä¸­ï¼ŒRDB æŒä¹…åŒ–å°±æ˜¯å……åˆ†çš„åˆ©ç”¨äº†è¿™é¡¹æŠ€æœ¯ï¼ŒRedis åœ¨æŒä¹…åŒ–æ—¶è°ƒç”¨ glibc å‡½æ•° fork ä¸€ä¸ªå­è¿›ç¨‹ï¼Œå…¨æƒè´Ÿè´£æŒä¹…åŒ–å·¥ä½œï¼Œè¿™æ ·çˆ¶è¿›ç¨‹ä»ç„¶èƒ½ç»§ç»­ç»™å®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚fork çš„å­è¿›ç¨‹åˆå§‹æ—¶ä¸çˆ¶è¿›ç¨‹ï¼ˆRedis çš„ä¸»è¿›ç¨‹ï¼‰å…±äº«åŒä¸€å—å†…å­˜ï¼›å½“æŒä¹…åŒ–è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯çš„è¯·æ±‚å¯¹å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ­¤æ—¶å°±ä¼šé€šè¿‡ COW (Copy On Write) æœºåˆ¶å¯¹æ•°æ®æ®µé¡µé¢è¿›è¡Œåˆ†ç¦»ï¼Œä¹Ÿå°±æ˜¯å¤åˆ¶ä¸€å—å†…å­˜å‡ºæ¥ç»™ä¸»è¿›ç¨‹å»ä¿®æ”¹ã€‚</p>
<p><img loading="lazy" src="2.png" alt=""  />
</p>
<p>é€šè¿‡ fork åˆ›å»ºçš„å­è¿›ç¨‹èƒ½å¤Ÿè·å¾—å’Œçˆ¶è¿›ç¨‹å®Œå…¨ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œçˆ¶è¿›ç¨‹å¯¹å†…å­˜çš„ä¿®æ”¹å¯¹äºå­è¿›ç¨‹æ˜¯ä¸å¯è§çš„ï¼Œä¸¤è€…ä¸ä¼šç›¸äº’å½±å“ï¼›</p>
<p>é€šè¿‡ fork åˆ›å»ºå­è¿›ç¨‹æ—¶ä¸ä¼šç«‹åˆ»è§¦å‘å¤§é‡å†…å­˜çš„æ‹·è´ï¼Œé‡‡ç”¨çš„æ˜¯å†™æ—¶æ‹·è´ COW (Copy On Write)ã€‚å†…æ ¸åªä¸ºæ–°ç”Ÿæˆçš„å­è¿›ç¨‹åˆ›å»ºè™šæ‹Ÿç©ºé—´ç»“æ„ï¼Œå®ƒä»¬æ¥å¤åˆ¶äºçˆ¶è¿›ç¨‹çš„è™šæ‹Ÿç©¶ç«Ÿç»“æ„ï¼Œä½†æ˜¯ä¸ä¸ºè¿™äº›æ®µåˆ†é…ç‰©ç†å†…å­˜ï¼Œå®ƒä»¬å…±äº«çˆ¶è¿›ç¨‹çš„ç‰©ç†ç©ºé—´ï¼Œå½“çˆ¶å­è¿›ç¨‹ä¸­æœ‰æ›´æ”¹ç›¸åº”æ®µçš„è¡Œä¸ºå‘ç”Ÿæ—¶ï¼Œå†ä¸ºå­è¿›ç¨‹ç›¸åº”çš„æ®µåˆ†é…ç‰©ç†ç©ºé—´ï¼›</p>
<h2 id="aof-æŒä¹…åŒ–">AOF æŒä¹…åŒ–<a hidden class="anchor" aria-hidden="true" href="#aof-æŒä¹…åŒ–">#</a></h2>
<p><strong>AOF</strong> <strong>(Append Only File)</strong> æ˜¯æŠŠæ‰€æœ‰å¯¹å†…å­˜è¿›è¡Œä¿®æ”¹çš„æŒ‡ä»¤ï¼ˆå†™æ“ä½œï¼‰ä»¥ç‹¬ç«‹æ—¥å¿—æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œè®°å½•ï¼Œé‡å¯æ—¶é€šè¿‡æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„ Redis å‘½ä»¤æ¥æ¢å¤æ•°æ®ã€‚ç±»ä¼¼MySql bin-log åŸç†ã€‚AOF èƒ½å¤Ÿè§£å†³æ•°æ®æŒä¹…åŒ–å®æ—¶æ€§é—®é¢˜ï¼Œæ˜¯ç°åœ¨ Redis æŒä¹…åŒ–æœºåˆ¶ä¸­ä¸»æµçš„æŒä¹…åŒ–æ–¹æ¡ˆã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>æ•°æ®çš„å¤‡ä»½æ›´åŠ å®Œæ•´ï¼Œä¸¢å¤±æ•°æ®çš„æ¦‚ç‡æ›´ä½ï¼Œé€‚åˆå¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜çš„åœºæ™¯</p>
</li>
<li>
<p>æ—¥å¿—æ–‡ä»¶å¯è¯»ï¼ŒAOF å¯æ“ä½œæ€§æ›´å¼ºï¼Œå¯é€šè¿‡æ“ä½œæ—¥å¿—æ–‡ä»¶è¿›è¡Œä¿®å¤</p>
</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>
<p>AOF æ—¥å¿—è®°å½•åœ¨é•¿æœŸè¿è¡Œä¸­é€æ¸åºå¤§ï¼Œæ¢å¤èµ·æ¥éå¸¸è€—æ—¶ï¼Œéœ€è¦å®šæœŸå¯¹ AOF æ—¥å¿—è¿›è¡Œç˜¦èº«å¤„ç†</p>
</li>
<li>
<p>æ¢å¤å¤‡ä»½é€Ÿåº¦æ¯”è¾ƒæ…¢</p>
</li>
<li>
<p>åŒæ­¥å†™æ“ä½œé¢‘ç¹ä¼šå¸¦æ¥æ€§èƒ½å‹åŠ›</p>
</li>
</ul>
<h3 id="aof-æ–‡ä»¶å†…å®¹">AOF æ–‡ä»¶å†…å®¹<a hidden class="anchor" aria-hidden="true" href="#aof-æ–‡ä»¶å†…å®¹">#</a></h3>
<p>è¢«å†™å…¥ AOF æ–‡ä»¶çš„æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯ä»¥ RESP æ ¼å¼ä¿å­˜çš„ï¼Œæ˜¯çº¯æ–‡æœ¬æ ¼å¼ä¿å­˜åœ¨ AOF æ–‡ä»¶ä¸­ã€‚</p>
<blockquote>
<p>Redis å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä½¿ç”¨ä¸€ç§åä¸º <code>RESP(REdis Serialization Protocol)</code> çš„äºŒè¿›åˆ¶å®‰å…¨æ–‡æœ¬åè®®è¿›è¡Œé€šä¿¡ã€‚</p>
</blockquote>
<p>ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„ SET å‘½ä»¤è¿›è¡Œä¸¾ä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>redis&gt; SET mykey <span style="color:#0ff;font-weight:bold">&#34;hello&#34;</span>    //å®¢æˆ·ç«¯å‘½ä»¤
</span></span><span style="display:flex;"><span>OK
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¢æˆ·ç«¯å°è£…ä¸ºä»¥ä¸‹æ ¼å¼ï¼ˆæ¯è¡Œç”¨<code> \r\n</code>åˆ†éš”ï¼‰</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*3
</span></span><span style="display:flex;"><span>$3
</span></span><span style="display:flex;"><span>SET
</span></span><span style="display:flex;"><span>$5
</span></span><span style="display:flex;"><span>mykey
</span></span><span style="display:flex;"><span>$5
</span></span><span style="display:flex;"><span>hello
</span></span></code></pre></td></tr></table>
</div>
</div><p>AOF æ–‡ä»¶ä¸­è®°å½•çš„æ–‡æœ¬å†…å®¹å¦‚ä¸‹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*2<span style="color:#0ff;font-weight:bold">\r\n</span>$6<span style="color:#0ff;font-weight:bold">\r\n</span>SELECT<span style="color:#0ff;font-weight:bold">\r\n</span>$1<span style="color:#0ff;font-weight:bold">\r\n</span>0<span style="color:#0ff;font-weight:bold">\r\n</span>       //å¤šå‡ºä¸€ä¸ªSELECT <span style="color:#ff0;font-weight:bold">0</span> å‘½ä»¤ï¼Œç”¨äºæŒ‡å®šæ•°æ®åº“ï¼Œä¸ºç³»ç»Ÿè‡ªåŠ¨æ·»åŠ 
</span></span><span style="display:flex;"><span>*3<span style="color:#0ff;font-weight:bold">\r\n</span>$3<span style="color:#0ff;font-weight:bold">\r\n</span>SET<span style="color:#0ff;font-weight:bold">\r\n</span>$5<span style="color:#0ff;font-weight:bold">\r\n</span>mykey<span style="color:#0ff;font-weight:bold">\r\n</span>$5<span style="color:#0ff;font-weight:bold">\r\n</span>hello<span style="color:#0ff;font-weight:bold">\r\n</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="aof-æŒä¹…åŒ–å®ç°">AOF æŒä¹…åŒ–å®ç°<a hidden class="anchor" aria-hidden="true" href="#aof-æŒä¹…åŒ–å®ç°">#</a></h3>
<p>AOF æŒä¹…åŒ–æ–¹æ¡ˆè¿›è¡Œå¤‡ä»½æ—¶ï¼Œå®¢æˆ·ç«¯æ‰€æœ‰è¯·æ±‚çš„å†™å‘½ä»¤éƒ½ä¼šè¢«è¿½åŠ åˆ° AOF ç¼“å†²åŒºä¸­ï¼Œç¼“å†²åŒºä¸­çš„æ•°æ®ä¼šæ ¹æ® Redis é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„åŒæ­¥ç­–ç•¥æ¥åŒæ­¥åˆ°ç£ç›˜ä¸Šçš„ AOF æ–‡ä»¶ä¸­ï¼Œè¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ã€‚åŒæ—¶å½“ AOF çš„æ–‡ä»¶è¾¾åˆ°é‡å†™ç­–ç•¥é…ç½®çš„é˜ˆå€¼æ—¶ï¼ŒRedis ä¼šå¯¹ AOF æ—¥å¿—æ–‡ä»¶è¿›è¡Œé‡å†™ï¼Œç»™ AOF æ—¥å¿—æ–‡ä»¶ç˜¦èº«ã€‚Redis æœåŠ¡é‡å¯çš„æ—¶å€™ï¼Œé€šè¿‡åŠ è½½ AOF æ—¥å¿—æ–‡ä»¶æ¥æ¢å¤æ•°æ®ã€‚</p>
<p><img loading="lazy" src="3.png" alt=""  />
</p>
<p>AOF çš„æ‰§è¡Œæµç¨‹åŒ…æ‹¬ï¼š</p>
<p><strong>å‘½ä»¤è¿½åŠ (append)</strong></p>
<p>Redis å…ˆå°†å†™å‘½ä»¤è¿½åŠ åˆ°ç¼“å†²åŒº aof_bufï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…¥æ–‡ä»¶ï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å…æ¯æ¬¡æœ‰å†™å‘½ä»¤éƒ½ç›´æ¥å†™å…¥ç¡¬ç›˜ï¼Œå¯¼è‡´ç¡¬ç›˜ IO æˆä¸º Redis è´Ÿè½½çš„ç“¶é¢ˆã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>struct redisServer {
</span></span><span style="display:flex;"><span>   //å…¶ä»–åŸŸ...
</span></span><span style="display:flex;"><span>   sds  aof_buf;           // sdsç±»ä¼¼äºJavaä¸­çš„String
</span></span><span style="display:flex;"><span>   //å…¶ä»–åŸŸ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ–‡ä»¶å†™å…¥(write)å’Œæ–‡ä»¶åŒæ­¥(sync)</strong></p>
<p>æ ¹æ®ä¸åŒçš„åŒæ­¥ç­–ç•¥å°† aof_buf ä¸­çš„å†…å®¹åŒæ­¥åˆ°ç¡¬ç›˜ï¼›</p>
<p>Linux æ“ä½œç³»ç»Ÿä¸­ä¸ºäº†æå‡æ€§èƒ½ï¼Œä½¿ç”¨äº†é¡µç¼“å­˜ï¼ˆpage cacheï¼‰ã€‚å½“æˆ‘ä»¬å°† aof_buf çš„å†…å®¹å†™åˆ°ç£ç›˜ä¸Šæ—¶ï¼Œæ­¤æ—¶æ•°æ®å¹¶æ²¡æœ‰çœŸæ­£çš„è½ç›˜ï¼Œè€Œæ˜¯åœ¨ page cache ä¸­ï¼Œä¸ºäº†å°† page cache ä¸­çš„æ•°æ®çœŸæ­£è½ç›˜ï¼Œéœ€è¦æ‰§è¡Œ fsync / fdatasync å‘½ä»¤æ¥å¼ºåˆ¶åˆ·ç›˜ã€‚è¿™è¾¹çš„æ–‡ä»¶åŒæ­¥åšçš„å°±æ˜¯åˆ·ç›˜æ“ä½œï¼Œæˆ–è€…å«æ–‡ä»¶åˆ·ç›˜å¯èƒ½æ›´å®¹æ˜“ç†è§£ä¸€äº›ã€‚</p>
<p>AOF ç¼“å­˜åŒºçš„åŒæ­¥æ–‡ä»¶ç­–ç•¥ç”±å‚æ•° appendfsync æ§åˆ¶ï¼Œæœ‰ä¸‰ç§åŒæ­¥ç­–ç•¥ï¼Œå„ä¸ªå€¼çš„å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><code>always</code>ï¼šå‘½ä»¤å†™å…¥ aof_buf åç«‹å³è°ƒç”¨ç³»ç»Ÿ write æ“ä½œå’Œç³»ç»Ÿ fsync æ“ä½œåŒæ­¥åˆ° AOF æ–‡ä»¶ï¼Œfsync å®Œæˆåçº¿ç¨‹è¿”å›ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æœ‰å†™å‘½ä»¤éƒ½è¦åŒæ­¥åˆ° AOF æ–‡ä»¶ï¼Œç¡¬ç›˜ IO æˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼ŒRedis åªèƒ½æ”¯æŒå¤§çº¦å‡ ç™¾TPSå†™å…¥ï¼Œä¸¥é‡é™ä½äº† Redis çš„æ€§èƒ½ï¼›å³ä¾¿æ˜¯ä½¿ç”¨å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰ï¼Œæ¯ç§’å¤§çº¦ä¹Ÿåªèƒ½å¤„ç†å‡ ä¸‡ä¸ªå‘½ä»¤ï¼Œè€Œä¸”ä¼šå¤§å¤§é™ä½ SSD çš„å¯¿å‘½ã€‚å¯é æ€§è¾ƒé«˜ï¼Œæ•°æ®åŸºæœ¬ä¸ä¸¢å¤±ã€‚</p>
</li>
<li>
<p><code>no</code>ï¼šå‘½ä»¤å†™å…¥ aof_buf åè°ƒç”¨ç³»ç»Ÿ write æ“ä½œï¼Œä¸å¯¹ AOF æ–‡ä»¶åš fsync åŒæ­¥ï¼›åŒæ­¥ç”±æ“ä½œç³»ç»Ÿè´Ÿè´£ï¼Œé€šå¸¸åŒæ­¥å‘¨æœŸä¸º30ç§’ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒæ­¥çš„æ—¶é—´ä¸å¯æ§ï¼Œä¸”ç¼“å†²åŒºä¸­å †ç§¯çš„æ•°æ®ä¼šå¾ˆå¤šï¼Œæ•°æ®å®‰å…¨æ€§æ— æ³•ä¿è¯ã€‚</p>
</li>
<li>
<p><code>everysec</code>ï¼šå‘½ä»¤å†™å…¥ aof_buf åè°ƒç”¨ç³»ç»Ÿ write æ“ä½œï¼Œwrite å®Œæˆåçº¿ç¨‹è¿”å›ï¼›fsync åŒæ­¥æ–‡ä»¶æ“ä½œç”±ä¸“é—¨çš„çº¿ç¨‹æ¯ç§’è°ƒç”¨ä¸€æ¬¡ã€‚everysec æ˜¯å‰è¿°ä¸¤ç§ç­–ç•¥çš„æŠ˜ä¸­ï¼Œæ˜¯æ€§èƒ½å’Œæ•°æ®å®‰å…¨æ€§çš„å¹³è¡¡ï¼Œå› æ­¤æ˜¯ Redis çš„é»˜è®¤é…ç½®ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ¨èçš„é…ç½®ã€‚</p>
</li>
</ul>
<p><strong>æ–‡ä»¶é‡å†™(rewrite)</strong></p>
<p>å®šæœŸé‡å†™ AOF æ–‡ä»¶ï¼Œè¾¾åˆ°å‹ç¼©çš„ç›®çš„ã€‚</p>
<p>AOF é‡å†™æ˜¯ AOF æŒä¹…åŒ–çš„ä¸€ä¸ªæœºåˆ¶ï¼Œç”¨æ¥å‹ç¼© AOF æ–‡ä»¶ï¼Œé€šè¿‡ fork ä¸€ä¸ªå­è¿›ç¨‹ï¼Œé‡æ–°å†™ä¸€ä¸ªæ–°çš„ AOF æ–‡ä»¶ï¼Œè¯¥æ¬¡é‡å†™ä¸æ˜¯è¯»å–æ—§çš„ AOF æ–‡ä»¶è¿›è¡Œå¤åˆ¶ï¼Œè€Œæ˜¯è¯»å–å†…å­˜ä¸­çš„Redisæ•°æ®åº“ï¼Œé‡å†™ä¸€ä»½ AOF æ–‡ä»¶ï¼Œæœ‰ç‚¹ç±»ä¼¼äº RDB çš„å¿«ç…§æ–¹å¼ã€‚</p>
<p>æ–‡ä»¶é‡å†™ä¹‹æ‰€ä»¥èƒ½å¤Ÿå‹ç¼© AOF æ–‡ä»¶ï¼ŒåŸå› åœ¨äºï¼š</p>
<ul>
<li>
<p>è¿‡æœŸçš„æ•°æ®ä¸å†å†™å…¥æ–‡ä»¶</p>
</li>
<li>
<p>æ— æ•ˆçš„å‘½ä»¤ä¸å†å†™å…¥æ–‡ä»¶ï¼šå¦‚æœ‰äº›æ•°æ®è¢«é‡å¤è®¾å€¼(set mykey v1, set mykey v2)ã€æœ‰äº›æ•°æ®è¢«åˆ é™¤äº†(sadd myset v1, del myset)ç­‰ç­‰</p>
</li>
<li>
<p>å¤šæ¡å‘½ä»¤å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªï¼šå¦‚ sadd myset v1, sadd myset v2, sadd myset v3 å¯ä»¥åˆå¹¶ä¸º sadd myset v1 v2 v3ã€‚ä¸è¿‡ä¸ºäº†é˜²æ­¢å•æ¡å‘½ä»¤è¿‡å¤§é€ æˆå®¢æˆ·ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå¯¹äº listã€setã€hashã€zsetç±»å‹çš„ keyï¼Œå¹¶ä¸ä¸€å®šåªä½¿ç”¨ä¸€æ¡å‘½ä»¤ï¼›è€Œæ˜¯ä»¥æŸä¸ªå¸¸é‡ä¸ºç•Œå°†å‘½ä»¤æ‹†åˆ†ä¸ºå¤šæ¡ã€‚è¿™ä¸ªå¸¸é‡åœ¨ redis.h/REDIS_AOF_REWRITE_ITEMS_PER_CMD ä¸­å®šä¹‰ï¼Œä¸å¯æ›´æ”¹ï¼Œ2.9ç‰ˆæœ¬ä¸­å€¼æ˜¯64ã€‚</p>
</li>
</ul>
<h3 id="aof-é‡å†™"><strong>AOF</strong> é‡å†™<a hidden class="anchor" aria-hidden="true" href="#aof-é‡å†™">#</a></h3>
<p>å‰é¢æåˆ° AOF çš„ç¼ºç‚¹æ—¶ï¼Œè¯´è¿‡ AOF å±äºæ—¥å¿—è¿½åŠ çš„å½¢å¼æ¥å­˜å‚¨ Redis çš„å†™æŒ‡ä»¤ï¼Œè¿™ä¼šå¯¼è‡´å¤§é‡å†—ä½™çš„æŒ‡ä»¤å­˜å‚¨ï¼Œä»è€Œä½¿å¾— AOF æ—¥å¿—æ–‡ä»¶éå¸¸åºå¤§ï¼Œæ¯”å¦‚åŒä¸€ä¸ª key è¢«å†™äº† 10000 æ¬¡ï¼Œæœ€åå´è¢«åˆ é™¤äº†ï¼Œè¿™ç§æƒ…å†µä¸ä»…å å†…å­˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ¢å¤çš„æ—¶å€™éå¸¸ç¼“æ…¢ï¼Œå› æ­¤ Redis æä¾›é‡å†™æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚Redis çš„ AOF æŒä¹…åŒ–æœºåˆ¶æ‰§è¡Œé‡å†™åï¼Œä¿å­˜çš„åªæ˜¯æ¢å¤æ•°æ®çš„æœ€å°æŒ‡ä»¤é›†ï¼Œæˆ‘ä»¬å¦‚æœæƒ³æ‰‹åŠ¨è§¦å‘å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<p><code>bgrewriteaof</code></p>
<p><strong>æ–‡ä»¶é‡å†™æ—¶æœº</strong></p>
<p>ç›¸å…³å‚æ•°ï¼š</p>
<ul>
<li>
<p>aof_current_sizeï¼šè¡¨ç¤ºå½“å‰ AOF æ–‡ä»¶ç©ºé—´</p>
</li>
<li>
<p>aof_base_sizeï¼šè¡¨ç¤ºä¸Šä¸€æ¬¡é‡å†™å AOF æ–‡ä»¶ç©ºé—´</p>
</li>
<li>
<p>auto-aof-rewrite-min-size: è¡¨ç¤ºè¿è¡Œ AOF é‡å†™æ—¶æ–‡ä»¶çš„æœ€å°ä½“ç§¯ï¼Œé»˜è®¤ä¸º64MB</p>
</li>
<li>
<p>auto-aof-rewrite-percentageï¼šè¡¨ç¤ºå½“å‰ AOF é‡å†™æ—¶æ–‡ä»¶ç©ºé—´ï¼ˆaof_current_sizeï¼‰è¶…è¿‡ä¸Šä¸€æ¬¡é‡å†™å AOF æ–‡ä»¶ç©ºé—´ï¼ˆaof_base_sizeï¼‰çš„æ¯”å€¼å¤šå°‘åä¼šé‡å†™ã€‚</p>
</li>
</ul>
<p>åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼Œåˆ™è§¦å‘ AOF é‡å†™æœºåˆ¶ï¼š</p>
<ul>
<li>
<p>aof_current_size å¤§äº auto-aof-rewrite-min-size</p>
</li>
<li>
<p>å½“å‰ AOF ç›¸æ¯”ä¸Šä¸€æ¬¡ AOF çš„å¢é•¿ç‡ï¼š(aof_current_size - aof_base_size)/aof_base_size å¤§äºæˆ–ç­‰äº auto-aof-rewrite-percentage</p>
</li>
</ul>
<p><strong>AOF</strong> <strong>é‡å†™æµç¨‹å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>
<p>bgrewriteaof è§¦å‘é‡å†™ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ bgsave æˆ–è€… bgrewriteaof æ­£åœ¨æ‰§è¡Œï¼Œå­˜åœ¨åˆ™ç­‰å¾…å…¶æ‰§è¡Œç»“æŸå†æ‰§è¡Œ</p>
</li>
<li>
<p>ä¸»è¿›ç¨‹ fork å­è¿›ç¨‹ï¼Œé˜²æ­¢ä¸»è¿›ç¨‹é˜»å¡æ— æ³•æä¾›æœåŠ¡ï¼Œç±»ä¼¼ RDB</p>
</li>
<li>
<p>å­è¿›ç¨‹éå† Redis å†…å­˜å¿«ç…§ä¸­æ•°æ®å†™å…¥ä¸´æ—¶ AOF æ–‡ä»¶ï¼ŒåŒæ—¶ä¼šå°†æ–°çš„å†™æŒ‡ä»¤å†™å…¥ aof_buf å’Œ aof_rewrite_buf ä¸¤ä¸ªé‡å†™ç¼“å†²åŒºï¼Œå‰è€…æ˜¯ä¸ºäº†å†™å›æ—§çš„ AOF æ–‡ä»¶ï¼Œåè€…æ˜¯ä¸ºäº†åç»­åˆ·æ–°åˆ°ä¸´æ—¶ AOF æ–‡ä»¶ä¸­ï¼Œé˜²æ­¢å¿«ç…§å†…å­˜éå†æ—¶æ–°çš„å†™å…¥æ“ä½œä¸¢å¤±</p>
</li>
<li>
<p>å­è¿›ç¨‹ç»“æŸä¸´æ—¶ AOF æ–‡ä»¶å†™å…¥åï¼Œé€šçŸ¥ä¸»è¿›ç¨‹</p>
</li>
<li>
<p>ä¸»è¿›ç¨‹ä¼šå°†ä¸Šé¢ 3 ä¸­çš„ aof_rewirte_buf ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°å­è¿›ç¨‹ç”Ÿæˆçš„ä¸´æ—¶ AOF æ–‡ä»¶ä¸­</p>
</li>
<li>
<p>ä¸»è¿›ç¨‹ä½¿ç”¨ä¸´æ—¶ AOF æ–‡ä»¶æ›¿æ¢æ—§ AOF æ–‡ä»¶ï¼Œå®Œæˆæ•´ä¸ªé‡å†™è¿‡ç¨‹ã€‚</p>
</li>
</ol>
<p><img loading="lazy" src="4.png" alt=""  />
</p>
<p>åœ¨å®é™…ä¸­ï¼Œä¸ºäº†é¿å…åœ¨æ‰§è¡Œå‘½ä»¤æ—¶é€ æˆå®¢æˆ·ç«¯è¾“å…¥ç¼“å†²åŒºæº¢å‡ºï¼Œé‡å†™ç¨‹åºä¼šæ£€æŸ¥é›†åˆå…ƒç´ æ•°é‡æ˜¯å¦è¶…è¿‡ REDIS_AOF_REWRITE_ITEMS_PER_CMD å¸¸é‡çš„å€¼ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œåˆ™ä¼šä½¿ç”¨å¤šä¸ªå‘½ä»¤æ¥è®°å½•ï¼Œè€Œä¸å•å•ä½¿ç”¨ä¸€æ¡å‘½ä»¤ã€‚</p>
<p>Redis 2.9ç‰ˆæœ¬ä¸­è¯¥å¸¸é‡ä¸º64ï¼Œå¦‚æœä¸€ä¸ªå‘½ä»¤çš„é›†åˆé”®åŒ…å«è¶…è¿‡äº†64ä¸ªå…ƒç´ ï¼Œé‡å†™ç¨‹åºä¼šæ‹†æˆå¤šä¸ªå‘½ä»¤ã€‚</p>
<p><code>SADD &lt;key&gt; &lt;elem1&gt; &lt;elem2&gt;...&lt;elem64&gt;</code></p>
<p><code>SADD &lt;key&gt; &lt;elem65&gt; &lt;elem66&gt;...&lt;elem128&gt;</code></p>
<blockquote>
<p>AOFé‡å†™æ˜¯ä¸€ä¸ªæœ‰æ­§ä¹‰çš„åå­—ï¼Œè¯¥åŠŸèƒ½æ˜¯é€šè¿‡ç›´æ¥è¯»å–æ•°æ®åº“çš„é”®å€¼å¯¹å®ç°çš„ï¼Œç¨‹åºæ— éœ€å¯¹ç°æœ‰AOFæ–‡ä»¶è¿›è¡Œä»»ä½•è¯»å…¥ã€åˆ†ææˆ–è€…å†™å…¥æ“ä½œã€‚</p>
</blockquote>
<h2 id="aof-ä¸-wal">AOF ä¸ WAL<a hidden class="anchor" aria-hidden="true" href="#aof-ä¸-wal">#</a></h2>
<p>Redis ä¸ºä»€ä¹ˆè€ƒè™‘ä½¿ç”¨ AOF è€Œä¸æ˜¯ WAL å‘¢?</p>
<p>å¾ˆå¤šæ•°æ®åº“éƒ½æ˜¯é‡‡ç”¨çš„ Write Ahead Logï¼ˆWALï¼‰å†™å‰æ—¥å¿—ï¼Œå…¶ç‰¹ç‚¹å°±æ˜¯å…ˆæŠŠä¿®æ”¹çš„æ•°æ®è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œå†è¿›è¡Œå†™æ•°æ®çš„æäº¤ï¼Œå¯ä»¥æ–¹ä¾¿é€šè¿‡æ—¥å¿—è¿›è¡Œæ•°æ®æ¢å¤ã€‚</p>
<p>ä½†æ˜¯ Redis é‡‡ç”¨çš„å´æ˜¯ AOFï¼ˆAppend Only Fileï¼‰å†™åæ—¥å¿—ï¼Œç‰¹ç‚¹å°±æ˜¯å…ˆæ‰§è¡Œå†™å‘½ä»¤ï¼ŒæŠŠæ•°æ®å†™å…¥å†…å­˜ä¸­ï¼Œå†è®°å½•æ—¥å¿—ã€‚</p>
<p>å¦‚æœå…ˆè®©ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤ï¼Œåªæœ‰å‘½ä»¤èƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰ä¼šè¢«è®°å½•åˆ°æ—¥å¿—ä¸­ã€‚å› æ­¤ï¼ŒRedis ä½¿ç”¨å†™åæ—¥å¿—è¿™ç§å½¢å¼ï¼Œå¯ä»¥é¿å…å‡ºç°è®°å½•é”™è¯¯å‘½ä»¤çš„æƒ…å†µã€‚</p>
<p>å¦å¤–è¿˜æœ‰ä¸€ä¸ªåŸå› å°±æ˜¯ï¼šAOF æ˜¯åœ¨å‘½ä»¤æ‰§è¡Œåæ‰è®°å½•æ—¥å¿—ï¼Œæ‰€ä»¥ä¸ä¼šé˜»å¡å½“å‰çš„å†™æ“ä½œã€‚</p>
<h2 id="aof-å’Œ-rdb-ä¹‹é—´çš„ç›¸äº’ä½œç”¨">AOF å’Œ RDB ä¹‹é—´çš„ç›¸äº’ä½œç”¨<a hidden class="anchor" aria-hidden="true" href="#aof-å’Œ-rdb-ä¹‹é—´çš„ç›¸äº’ä½œç”¨">#</a></h2>
<p>åœ¨ç‰ˆæœ¬å·å¤§äºç­‰äº2.4çš„ Redis ä¸­ï¼ŒBGSAVE æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸å¯ä»¥æ‰§è¡Œ BGREWRITEAOFã€‚åè¿‡æ¥è¯´ï¼Œåœ¨ BGREWRITEAOF æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¸å¯ä»¥æ‰§è¡Œ BGSAVEã€‚è¿™å¯ä»¥é˜²æ­¢ä¸¤ä¸ª Redis åå°è¿›ç¨‹åŒæ—¶å¯¹ç£ç›˜è¿›è¡Œå¤§é‡çš„ I/O æ“ä½œã€‚</p>
<p>å¦‚æœ BGSAVE æ­£åœ¨æ‰§è¡Œï¼Œå¹¶ä¸”ç”¨æˆ·æ˜¾ç¤ºåœ°è°ƒç”¨ BGREWRITEAOF å‘½ä»¤ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†å‘ç”¨æˆ·å›å¤ä¸€ä¸ª OK çŠ¶æ€ï¼Œå¹¶å‘ŠçŸ¥ç”¨æˆ·ï¼ŒBGREWRITEAOF å·²ç»è¢«é¢„å®šæ‰§è¡Œï¼šä¸€æ—¦ BGSAVE æ‰§è¡Œå®Œæ¯• BGREWRITEAOF å°±ä¼šæ­£å¼å¼€å§‹ã€‚</p>
<p>å½“ Redis å¯åŠ¨æ—¶ï¼Œå¦‚æœ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–éƒ½è¢«æ‰“å¼€äº†ï¼Œé‚£ä¹ˆç¨‹åºä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶æ¥æ¢å¤æ•°æ®é›†ï¼Œå› ä¸º AOF æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®é€šå¸¸æ˜¯æœ€å®Œæ•´çš„ã€‚</p>
<h2 id="æ··åˆæŒä¹…åŒ–">æ··åˆæŒä¹…åŒ–<a hidden class="anchor" aria-hidden="true" href="#æ··åˆæŒä¹…åŒ–">#</a></h2>
<p>Redis4.0 åå¤§éƒ¨åˆ†çš„ä½¿ç”¨åœºæ™¯éƒ½ä¸ä¼šå•ç‹¬ä½¿ç”¨ RDB æˆ–è€… AOF æ¥åšæŒä¹…åŒ–æœºåˆ¶ï¼Œè€Œæ˜¯å…¼é¡¾äºŒè€…çš„ä¼˜åŠ¿æ··åˆä½¿ç”¨ã€‚å…¶åŸå› æ˜¯ RDB è™½ç„¶å¿«ï¼Œä½†æ˜¯ä¼šä¸¢å¤±æ¯”è¾ƒå¤šçš„æ•°æ®ï¼Œä¸èƒ½ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼›AOF è™½ç„¶èƒ½å°½å¯èƒ½ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼Œä½†æ˜¯æ€§èƒ½ç¡®å®æ˜¯ä¸€ä¸ªè¯Ÿç—…ï¼Œæ¯”å¦‚é‡æ”¾æ¢å¤æ•°æ®ã€‚</p>
<p>Redisä»4.0ç‰ˆæœ¬å¼€å§‹å¼•å…¥ RDB-AOF æ··åˆæŒä¹…åŒ–æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯åŸºäº AOF æŒä¹…åŒ–æ¨¡å¼æ„å»ºè€Œæ¥çš„ï¼Œæ··åˆæŒä¹…åŒ–é€šè¿‡ <code>aof-use-rdb-preamble yes</code> å¼€å¯ã€‚</p>
<p>é‚£ä¹ˆ Redis æœåŠ¡å™¨åœ¨æ‰§è¡Œ AOF é‡å†™æ“ä½œæ—¶ï¼Œå°±ä¼šåƒæ‰§è¡Œ BGSAVE å‘½ä»¤é‚£æ ·ï¼Œæ ¹æ®æ•°æ®åº“å½“å‰çš„çŠ¶æ€ç”Ÿæˆå‡ºç›¸åº”çš„ RDB æ•°æ®ï¼Œå¹¶å°†è¿™äº›æ•°æ®å†™å…¥æ–°å»ºçš„ AOF æ–‡ä»¶ä¸­ï¼Œè‡³äºé‚£äº›åœ¨ AOF é‡å†™å¼€å§‹ä¹‹åæ‰§è¡Œçš„ Redis å‘½ä»¤ï¼Œåˆ™ä¼šç»§ç»­ä»¥åè®®æ–‡æœ¬çš„æ–¹å¼è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œå³å·²æœ‰çš„ RDB æ•°æ®çš„åé¢ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œåœ¨å¼€å¯äº† RDB-AOF æ··åˆæŒä¹…åŒ–åŠŸèƒ½ä¹‹åï¼ŒæœåŠ¡å™¨ç”Ÿæˆçš„ AOF æ–‡ä»¶å°†ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ä½äº AOF æ–‡ä»¶å¼€å¤´çš„æ˜¯ RDB æ ¼å¼çš„æ•°æ®ï¼Œè€Œè·Ÿåœ¨ RDB æ•°æ®åé¢çš„åˆ™æ˜¯ AOF æ ¼å¼çš„æ•°æ®ã€‚</p>
<p>å½“ä¸€ä¸ªæ”¯æŒ RDB-AOF æ··åˆæŒä¹…åŒ–æ¨¡å¼çš„ Redis æœåŠ¡å™¨å¯åŠ¨å¹¶è½½å…¥ AOF æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ AOF æ–‡ä»¶çš„å¼€å¤´æ˜¯å¦åŒ…å«äº† RDB æ ¼å¼çš„å†…å®¹ã€‚</p>
<ul>
<li>å¦‚æœåŒ…å«ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šå…ˆè½½å…¥å¼€å¤´çš„ RDB æ•°æ®ï¼Œç„¶åå†è½½å…¥ä¹‹åçš„ AOF æ•°æ®ã€‚</li>
<li>å¦‚æœ AOF æ–‡ä»¶åªåŒ…å« AOF æ•°æ®ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ç›´æ¥è½½å…¥ AOF æ•°æ®ã€‚</li>
</ul>
<p>å…¶æ—¥å¿—æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img loading="lazy" src="5.png" alt=""  />
</p>
<h2 id="æ€»ç»“">æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ€»ç»“">#</a></h2>
<p>æœ€åæ¥æ€»ç»“è¿™ä¸¤è€…ï¼Œåˆ°åº•ç”¨å“ªä¸ªæ›´å¥½å‘¢ï¼Ÿ</p>
<ul>
<li>
<p>æ¨èæ˜¯ä¸¤è€…å‡å¼€å¯ã€‚</p>
</li>
<li>
<p>å¦‚æœå¯¹æ•°æ®ä¸æ•æ„Ÿï¼Œå¯ä»¥é€‰å•ç‹¬ç”¨ RDBã€‚</p>
</li>
<li>
<p>å¦‚æœåªæ˜¯åšçº¯å†…å­˜ç¼“å­˜ï¼Œå¯ä»¥éƒ½ä¸ç”¨ã€‚</p>
</li>
</ul>
<h1 id="rediså¤§keyå¤„ç†">rediså¤§keyå¤„ç†<a hidden class="anchor" aria-hidden="true" href="#rediså¤§keyå¤„ç†">#</a></h1>
<h2 id="èƒŒæ™¯">èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#èƒŒæ™¯">#</a></h2>
<p>æƒ³è¦è§£å†³å¤§keyï¼Œé¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“ä»€ä¹ˆå®šä¹‰ä¸ºå¤§keyã€‚å¤§key å¹¶ä¸æ˜¯æŒ‡ key çš„å€¼å¾ˆå¤§ï¼Œè€Œæ˜¯ key å¯¹åº”çš„ value å¾ˆå¤§ï¼ˆéå¸¸å å†…å­˜ï¼‰ã€‚æ­¤å¤„ä¸ºä¸­é—´ä»¶ç»™å‡ºçš„å®šä¹‰ï¼š</p>
<ul>
<li>å•ä¸ªStringç±»å‹çš„Keyå¤§å°è¾¾åˆ°20KBå¹¶ä¸”OPSé«˜</li>
<li>å•ä¸ªStringè¾¾åˆ°100KB</li>
<li>é›†åˆç±»å‹çš„Keyæ€»å¤§å°è¾¾åˆ°1MB</li>
<li>é›†åˆç±»å‹çš„Keyä¸­å…ƒç´ è¶…è¿‡5000ä¸ª</li>
</ul>
<p><strong>å¤§KEYå¸¦æ¥çš„å½±å“</strong></p>
<p>çŸ¥é“äº†å¤§keyçš„å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¾—çŸ¥é“å¤§keyçš„å¸¦æ¥çš„å½±å“ï¼š</p>
<ul>
<li>**å®¢æˆ·ç«¯è¶…æ—¶é˜»å¡ã€‚**Redis æ‰§è¡Œå‘½ä»¤æ˜¯å•çº¿ç¨‹å¤„ç†ï¼Œç„¶ååœ¨å¤§ keyå¤„ç†æ—¶ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿé˜»å¡ ï¼ŒæœŸé—´å°±ä¼šå„ç§ä¸šåŠ¡è¶…æ—¶å‡ºç°ã€‚</li>
<li><strong>å¼•å‘ç½‘ç»œé˜»å¡</strong>ã€‚æ¯æ¬¡è·å–å¤§ key äº§ç”Ÿçš„ç½‘ç»œæµé‡è¾ƒå¤§ï¼Œå¦‚æœä¸€ä¸ª key çš„å¤§å°æ˜¯ 1 MBï¼Œæ¯ç§’è®¿é—®é‡ä¸º 1000ï¼Œé‚£ä¹ˆæ¯ç§’ä¼šäº§ç”Ÿ 1000MB çš„æµé‡ï¼Œè¿™å¯¹äºæœåŠ¡å™¨æ¥è¯´æ˜¯ç¾éš¾æ€§çš„ã€‚</li>
<li>**é˜»å¡å·¥ä½œçº¿ç¨‹ã€‚**å¦‚æœä½¿ç”¨ del åˆ é™¤å¤§ key æ—¶ï¼Œä¼šé˜»å¡å·¥ä½œçº¿ç¨‹ï¼Œæ— æ³•å¤„ç†åç»­çš„å‘½ä»¤ã€‚</li>
<li><strong>å†…å­˜åˆ†å¸ƒä¸å‡</strong>ã€‚é›†ç¾¤å„åˆ†ç‰‡å†…å­˜ä½¿ç”¨ä¸å‡ã€‚æŸä¸ªåˆ†ç‰‡å ç”¨å†…å­˜è¾ƒé«˜æˆ–OOMï¼Œå‘é€ç¼“å­˜åŒºå¢å¤§ç­‰ï¼Œå¯¼è‡´è¯¥åˆ†ç‰‡å…¶ä»–Keyè¢«é€å‡ºï¼ŒåŒæ—¶ä¹Ÿä¼šé€ æˆå…¶ä»–åˆ†ç‰‡çš„èµ„æºæµªè´¹ã€‚</li>
</ul>
<h2 id="å¤§keyè§£å†³æ‰‹æ®µ">å¤§keyè§£å†³æ‰‹æ®µ<a hidden class="anchor" aria-hidden="true" href="#å¤§keyè§£å†³æ‰‹æ®µ">#</a></h2>
<h3 id="å†å²keyæœªä½¿ç”¨">å†å²keyæœªä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#å†å²keyæœªä½¿ç”¨">#</a></h3>
<p>é’ˆå¯¹è¿™ç§keyåœºæ™¯ï¼Œå…¶å®å­˜åœ¨ç€å†å²åŸå› ï¼Œå¯èƒ½æ˜¯ä¼´éšç€æŸä¸ªä¸šåŠ¡ä¸‹çº¿æˆ–è€…ä¸ä½¿ç”¨ï¼Œå¾€å¾€å¯¹åº”å®ç°çš„ç¼“å­˜æ“ä½œä»£ç ä¼šåˆ é™¤ï¼Œä½†æ˜¯å¯¹äºç¼“å­˜æ•°æ®å¾€å¾€ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œè¿™ç§è„æ•°æ®ä¼šä¸€ç›´å †ç§¯ï¼Œå ç”¨ç€èµ„æºã€‚é‚£ä¹ˆå¦‚æœç¡®å®šå·²ç»æ— ä½¿ç”¨ï¼Œå¹¶ä¸”å¯ä»¥ç¡®è®¤æœ‰æŒä¹…åŒ–æ•°æ®ï¼ˆå¦‚mysqlã€esç­‰ï¼‰å¤‡ä»½çš„è¯ï¼Œå¯ä»¥ç›´æ¥å°†å¯¹åº”keyåˆ é™¤ã€‚</p>
<h3 id="å…ƒç´ æ•°è¿‡å¤š">å…ƒç´ æ•°è¿‡å¤š<a hidden class="anchor" aria-hidden="true" href="#å…ƒç´ æ•°è¿‡å¤š">#</a></h3>
<p>é’ˆå¯¹äºSetã€HASHè¿™ç§åœºæ™¯ï¼Œå¦‚æœå…ƒç´ æ•°é‡è¶…è¿‡5000å°±è§†ä¸ºå¤§çš„keyã€‚å¦‚æœå¯¹åº”valueå€¼ä¸å¤§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å¹³é“ºçš„å½¢å¼ï¼Œ</p>
<p>æ¯”å¦‚ç³»ç»Ÿå†…å†å²çš„è®¾è®¡æ˜¯å­˜å‚¨ä¸‹æ¯ä¸ªå“ç‰Œå¯¹åº”çš„åç§°ï¼Œé‚£ä¹ˆå°±è®¾ç½®äº†ç»Ÿä¸€çš„keyï¼Œç„¶åä¸åŒçš„å“ç‰Œidä½œä¸ºfildï¼Œæ“ä½œäº†hSetå’ŒhGetæ¥å­˜å‚¨è·å–æ•°æ®ï¼Œé™ä½æŸ¥è¯¢å¤–å›´æœåŠ¡çš„é¢‘ç‡ã€‚ä½†æ˜¯éšç€å“ç‰Œæ•°é‡çš„å¢é•¿ï¼Œå¯¼è‡´å…ƒç´ é€æ­¥å¢å¤šï¼Œå…ƒç´ ä¸ªæ•°å°±è¶…è¿‡äº†å¤§keyçš„é¢„è®¾å€¼äº†ã€‚è¿™ç§æ ¹æ®åœºæ™¯ï¼Œæˆ‘ä»¬å…¶å®å­˜å‚¨æœ¬èº«åªæœ‰ä¸€ä¸ªå“ç‰Œåç§°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é’ˆå¯¹äºå“ç‰Œidå¯¹åº”åŠ ä¸Šä¸€ä¸ªç»Ÿä¸€å‰ç¼€ä½œä¸ºå”¯ä¸€keyï¼Œé‡‡ç”¨å¹³é“ºæ–¹å¼ç¼“å­˜å¯¹åº”æ•°æ®å³å¯ã€‚é‚£ä¹ˆé’ˆå¯¹è¿™ç§æ•°æ®çš„æ›¿æ¢ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ€»ç»“äº†ä¸‹å…·ä½“è¦å®ç°çš„æ­¥éª¤ï¼š</p>
<p>ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹ä»£ç æŸ¥è¯¢å’Œèµ‹å€¼é€»è¾‘ï¼š</p>
<ul>
<li>
<p>æŠŠåŸå§‹çš„hGetçš„é€»è¾‘ä¿®æ”¹ä¸ºgetè·å–ï¼›</p>
</li>
<li>
<p>æŠŠåŸå§‹hSetçš„é€»è¾‘ä¿®æ”¹ä¸ºsetèµ‹å€¼ã€‚</p>
</li>
</ul>
<p>ç¬¬ä¸€æ­¥ï¼šå†å²æ•°æ®åˆ·æ–°åˆ°æ–°ç¼“å­˜keyï¼š</p>
<p>ä¸ºäº†é¿å…ä¸Šçº¿ä¹‹åå‡ºç°ç¼“å­˜é›ªå´©ï¼Œå› ä¸ºæ›¿æ¢äº†æ–°çš„keyï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ç°æœ‰çš„HASHçš„æ•°æ®åˆ·æ–°åˆ°æ–°çš„ç¼“å­˜ä¸­ï¼Œæ‰€ä»¥éœ€è¦å†å²æ•°æ®å¤„ç†ã€‚</p>
<p>é€šè¿‡hGetAllè·å–æ‰€ä»¥å…ƒç´ æ•°æ®ï¼Œå¾ªç¯ç¼“å­˜å…ƒç´ æ•°æ®æ“ä½œå­˜å‚¨æ–°çš„ç¼“å­˜keyå’Œvalueã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> String refreshHistoryData(){
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        String key = <span style="color:#0ff;font-weight:bold">&#34;historyKey&#34;</span>;
</span></span><span style="display:flex;"><span>        Map&lt;String, String&gt; redisInfoMap= redisUtils.<span style="color:#007f7f">hGetAll</span>(key);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (redisInfoMap.<span style="color:#007f7f">isEmpty</span>()){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;æŸ¥è¯¢ç¼“å­˜æ— æ•°æ®&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (Map.<span style="color:#007f7f">Entry</span>&lt;String, String&gt; entry : redisInfoMap.<span style="color:#007f7f">entrySet</span>()) {
</span></span><span style="display:flex;"><span>            String redisVal = entry.<span style="color:#007f7f">getValue</span>();
</span></span><span style="display:flex;"><span>            String filedKey = entry.<span style="color:#007f7f">getKey</span>();
</span></span><span style="display:flex;"><span>            String newDataRedisKey = <span style="color:#0ff;font-weight:bold">&#34;newDataKey&#34;</span>+filedKey;
</span></span><span style="display:flex;"><span>            redisUtils.<span style="color:#007f7f">set</span>(newDataRedisKey,redisVal);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>;
</span></span><span style="display:flex;"><span>    }<span style="color:#fff;font-weight:bold">catch</span> (Exception e){
</span></span><span style="display:flex;"><span>        LOG.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;refreshHistoryData å¼‚å¸¸:&#34;</span>,e);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;failed&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šè¿™é‡Œä¸€å®šè¦å…ˆåˆ·å†å²æ•°æ®ï¼Œå†ä¸Šçº¿ä»£ç ä¸šåŠ¡é€»è¾‘çš„ä¿®æ”¹ã€‚é˜²æ­¢å¼•å‘ç¼“å­˜é›ªå´©ã€‚</p>
<h3 id="å¤§å¯¹è±¡è½¬æ¢å­˜å‚¨å½¢å¼">å¤§å¯¹è±¡è½¬æ¢å­˜å‚¨å½¢å¼<a hidden class="anchor" aria-hidden="true" href="#å¤§å¯¹è±¡è½¬æ¢å­˜å‚¨å½¢å¼">#</a></h3>
<p>å¤æ‚çš„å¤§å¯¹è±¡å¯ä»¥å°è¯•å°†å¯¹è±¡åˆ†æ‹†æˆå‡ ä¸ªkey-valueï¼Œ ä½¿ç”¨mGetå’ŒmSetæ“ä½œå¯¹åº”å€¼æˆ–è€…pipelineçš„å½¢å¼ï¼Œæœ€åæ‹¼è£…æˆéœ€è¦è¿”å›çš„å¤§å¯¹è±¡ã€‚è¿™æ ·æ„ä¹‰åœ¨äºå¯ä»¥åˆ†æ•£å•æ¬¡æ“ä½œçš„å‹åŠ›ï¼Œå°†æ“ä½œå‹åŠ›å¹³æ‘Šåˆ°å¤šä¸ªrediså®ä¾‹ä¸­ï¼Œé™ä½å¯¹å•ä¸ªredisçš„IOå½±å“ã€‚</p>
<p>è¿™é‡Œä»¥ç³»ç»Ÿå†…è®¢å•å¯¹è±¡ä¸ºä¾‹ï¼šè®¢å•å¯¹è±¡OrderåŸºç¡€å±æ€§æœ‰å‡ åä¸ªï¼Œå¦‚è®¢å•å·ã€é‡‘é¢ã€æ—¶é—´ã€ç±»å‹ç­‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦åŒ…å«è®¢å•ä¸‹çš„å•†å“OrderSubã€é¢„å”®ä¿¡æ¯PresaleOrderã€å‘ç¥¨ä¿¡æ¯OrderInvoiceã€è®¢å•æ—¶æ•ˆOrderPremiseInfoã€è®¢å•è½¨è¿¹OrderTrackInfoã€è®¢å•è¯¦ç»†è´¹ç”¨OrderFeeç­‰ä¿¡æ¯ã€‚</p>
<p>é‚£ä¹ˆå¯¹äºæ¯ä¸ªè®¢å•ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸ºå•ç‹¬çš„keyï¼ŒæŠŠè®¢å•ä¿¡æ¯å’Œå‡ ä¸ªç›¸å…³çš„å…³è”æ•°æ®æ¯ä¸ªæŒ‰ç…§å•ç‹¬keyå­˜å‚¨ï¼Œæ¥ç€é€šè¿‡mGetæ–¹å¼è·å–æ¯ä¸ªä¿¡æ¯ä¹‹åï¼Œæœ€åå°è£…æˆæ•´ä½“Orderå¯¹è±¡ã€‚ä¸‹é¢ä»…å±•ç¤ºå…³é”®ä¼ªä»£ç ä»¥mSetå’ŒmGetå®ç°ã€‚</p>
<p><strong>ç¼“å­˜å®šä¹‰ï¼š</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">enum</span> CacheKeyConstant {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•åŸºç¡€ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    REDIS_ORDER_BASE_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_BASE_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•å•†å“ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_SUB_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_SUB_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•é¢„å”®ä¿¡æ¯ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_PRESALE_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_PRESALE_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•å±¥çº¦ä¿¡æ¯ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_PREMISE_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_PREMISE_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•å‘ç¥¨ä¿¡æ¯ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_INVOICE_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_INVOICE_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•è½¨è¿¹ä¿¡æ¯ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_TRACK_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_TRACK_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * è®¢å•è¯¦ç»†è´¹ç”¨ä¿¡æ¯ç¼“å­˜key
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    ORDER_FEE_INFO(<span style="color:#0ff;font-weight:bold">&#34;ORDER_FEE_INFO&#34;</span>),
</span></span><span style="display:flex;"><span>    ;
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‰ç¼€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> String prefix;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * é¡¹ç›®ç»Ÿä¸€å‰ç¼€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> String COMMON_PREFIX = <span style="color:#0ff;font-weight:bold">&#34;XXX&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CacheKeyConstant(String prefix){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">prefix</span> = prefix;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getPrefix(String subKey) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span>(StringUtil.<span style="color:#007f7f">isNotEmpty</span>(subKey)){
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> COMMON_PREFIX + prefix + <span style="color:#0ff;font-weight:bold">&#34;_&#34;</span> + subKey;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> COMMON_PREFIX + prefix;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String getPrefix() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> COMMON_PREFIX + prefix;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¼“å­˜å­˜å‚¨ï¼š</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @description åˆ·æ–°è®¢å•åˆ°ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param order è®¢å•ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> refreshOrderToCache(Order order){
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span>(order == <span style="color:#fff;font-weight:bold">null</span> || order.<span style="color:#007f7f">getOrderId</span>() == <span style="color:#fff;font-weight:bold">null</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> ;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    String orderId = order.<span style="color:#007f7f">getOrderId</span>().<span style="color:#007f7f">toString</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¾ç½®å­˜å‚¨ç¼“å­˜æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    Map&lt;String,String&gt; cacheOrderMap = <span style="color:#fff;font-weight:bold">new</span> HashMap&lt;&gt;(<span style="color:#ff0;font-weight:bold">16</span>);
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_BASE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(buildBaseOrderVo(order)));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_SUB_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(order.<span style="color:#007f7f">getCustomerOrderSubs</span>()));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_PRESALE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(order.<span style="color:#007f7f">getPresaleOrderData</span>()));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_INVOICE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(order.<span style="color:#007f7f">getOrderInvoice</span>()));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_TRACK_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(order.<span style="color:#007f7f">getOrderTrackInfo</span>()));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_PREMISE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>( order.<span style="color:#007f7f">getPresaleOrderData</span>()));
</span></span><span style="display:flex;"><span>    cacheOrderMap.<span style="color:#007f7f">put</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_FEE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId), JSON.<span style="color:#007f7f">toJSONString</span>(order.<span style="color:#007f7f">getOrderFeeVo</span>()));
</span></span><span style="display:flex;"><span>    superRedisUtils.<span style="color:#007f7f">mSetString</span>(cacheOrderMap);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¼“å­˜è·å–ï¼š</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @description é€šè¿‡è®¢å•å·è·å–ç¼“å­˜æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param orderId è®¢å•å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @return Order è®¢å•å®ä½“ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> Order getOrderFromCache(String orderId){
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isBlank</span>(orderId)){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å®šä¹‰æŸ¥è¯¢ç¼“å­˜é›†åˆkey
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    List&lt;String&gt; queryOrderKey = Arrays.<span style="color:#007f7f">asList</span>(CacheKeyConstant.<span style="color:#007f7f">ORDER_BASE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),CacheKeyConstant.<span style="color:#007f7f">ORDER_SUB_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),
</span></span><span style="display:flex;"><span>                                               CacheKeyConstant.<span style="color:#007f7f">ORDER_PRESALE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),CacheKeyConstant.<span style="color:#007f7f">ORDER_INVOICE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),CacheKeyConstant.<span style="color:#007f7f">ORDER_TRACK_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),
</span></span><span style="display:flex;"><span>                                               CacheKeyConstant.<span style="color:#007f7f">ORDER_PREMISE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId),CacheKeyConstant.<span style="color:#007f7f">ORDER_FEE_INFO</span>.<span style="color:#007f7f">getPrefix</span>(orderId));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//æŸ¥è¯¢ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    List&lt;String&gt; result = redisUtils.<span style="color:#007f7f">mGet</span>(queryOrderKey);
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//åŸºç¡€ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(CollectionUtils.<span style="color:#007f7f">isEmpty</span>(result)){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    String[] resultInfo = result.<span style="color:#007f7f">toArray</span>(<span style="color:#fff;font-weight:bold">new</span> String[<span style="color:#ff0;font-weight:bold">0</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//åŸºç¡€ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">0</span>])){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    BaseOrderVo baseOrderVo = JSON.<span style="color:#007f7f">parseObject</span>(resultInfo[<span style="color:#ff0;font-weight:bold">0</span>],BaseOrderVo.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>    Order order = coverBaseOrderVoToOrder(baseOrderVo);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•å•†å“
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">1</span>])){
</span></span><span style="display:flex;"><span>        List&lt;OrderSub&gt; orderSubs =JSON.<span style="color:#007f7f">parseObject</span>(result.<span style="color:#007f7f">get</span>(<span style="color:#ff0;font-weight:bold">1</span>), <span style="color:#fff;font-weight:bold">new</span> TypeReference&lt;List&lt;OrderSub&gt;&gt;(){});
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setCustomerOrderSubs</span>(orderSubs);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•é¢„å”®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">2</span>])){
</span></span><span style="display:flex;"><span>        PresaleOrderData presaleOrderData = JSON.<span style="color:#007f7f">parseObject</span>(resultInfo[<span style="color:#ff0;font-weight:bold">2</span>],PresaleOrderData.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setPresaleOrderData</span>(presaleOrderData);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•å‘ç¥¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">3</span>])){
</span></span><span style="display:flex;"><span>        OrderInvoice orderInvoice = JSON.<span style="color:#007f7f">parseObject</span>(resultInfo[<span style="color:#ff0;font-weight:bold">3</span>],OrderInvoice.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setOrderInvoice</span>(orderInvoice);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•è½¨è¿¹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">5</span>])){
</span></span><span style="display:flex;"><span>        OrderTrackInfo orderTrackInfo = JSON.<span style="color:#007f7f">parseObject</span>(resultInfo[<span style="color:#ff0;font-weight:bold">5</span>],OrderTrackInfo.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setOrderTrackInfo</span>(orderTrackInfo);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•å±¥çº¦ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">6</span>])){
</span></span><span style="display:flex;"><span>        List&lt;OrderPremiseInfo&gt; orderPremiseInfos =JSON.<span style="color:#007f7f">parseObject</span>(result.<span style="color:#007f7f">get</span>(<span style="color:#ff0;font-weight:bold">6</span>), <span style="color:#fff;font-weight:bold">new</span> TypeReference&lt;List&lt;OrderPremiseInfo&gt;&gt;(){});
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setPremiseInfos</span>(orderPremiseInfos);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¢å•è´¹ç”¨æ˜ç»†ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span>(StringUtils.<span style="color:#007f7f">isNotBlank</span>(resultInfo[<span style="color:#ff0;font-weight:bold">7</span>])){
</span></span><span style="display:flex;"><span>        OrderFeeVo orderFeeVo = JSON.<span style="color:#007f7f">parseObject</span>(resultInfo[<span style="color:#ff0;font-weight:bold">7</span>],OrderFeeVo.<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>        order.<span style="color:#007f7f">setOrderFeeVo</span>(orderFeeVo);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> order;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šè·å–ç¼“å­˜çš„ç»“æœè·Ÿä¼ å…¥çš„keyçš„é¡ºåºä¿æŒå¯¹åº”å³å¯ã€‚</p>
<p><strong>ç¼“å­˜utilæ–¹æ³•å°è£…ï¼š</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @description åŒæ—¶å°†å¤šä¸ª key-value (åŸŸ-å€¼)å¯¹è®¾ç½®åˆ°ç¼“å­˜ä¸­ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param mappings éœ€è¦æ’å…¥çš„æ•°æ®ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> mSetString(Map&lt;String, String&gt; mappings) {
</span></span><span style="display:flex;"><span>    CallerInfo callerInfo = Ump.<span style="color:#007f7f">methodReg</span>(UmpKeyConstants.<span style="color:#007f7f">REDIS</span>.<span style="color:#007f7f">REDIS_STATUS_READ_MSET</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        redisClient.<span style="color:#007f7f">getClientInstance</span>().<span style="color:#007f7f">mSetString</span>(mappings);
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">funcError</span>(callerInfo);
</span></span><span style="display:flex;"><span>    }<span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">methodRegEnd</span>(callerInfo);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @description åŒæ—¶å°†å¤šä¸ªkeyçš„ç»“æœè¿”å›ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param queryKeys æŸ¥è¯¢çš„ç¼“å­˜keyé›†åˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> List&lt;String&gt; mGet(List&lt;String&gt; queryKeys) {
</span></span><span style="display:flex;"><span>    CallerInfo callerInfo = Ump.<span style="color:#007f7f">methodReg</span>(UmpKeyConstants.<span style="color:#007f7f">REDIS</span>.<span style="color:#007f7f">REDIS_STATUS_READ_MGET</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> redisClient.<span style="color:#007f7f">getClientInstance</span>().<span style="color:#007f7f">mGet</span>(queryKeys.<span style="color:#007f7f">toArray</span>(<span style="color:#fff;font-weight:bold">new</span> String[<span style="color:#ff0;font-weight:bold">0</span>]));
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">funcError</span>(callerInfo);
</span></span><span style="display:flex;"><span>    }<span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">methodRegEnd</span>(callerInfo);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;String&gt;(queryKeys.<span style="color:#007f7f">size</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œé™„ä¸Šé€šè¿‡pipelineçš„utilå°è£…ï¼Œå¯å‚è€ƒã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @description pipelineæ”¾æ¾æŸ¥è¯¢æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param redisKeyList
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @return java.util.List&lt;java.lang.String&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> List&lt;String&gt; getValueByPipeline(List&lt;String&gt; redisKeyList) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span>(CollectionUtils.<span style="color:#007f7f">isEmpty</span>(redisKeyList)){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    List&lt;String&gt; resultInfo = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;(redisKeyList);
</span></span><span style="display:flex;"><span>    CallerInfo callerInfo = Ump.<span style="color:#007f7f">methodReg</span>(UmpKeyConstants.<span style="color:#007f7f">REDIS</span>.<span style="color:#007f7f">REDIS_STATUS_READ_GET</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        PipelineClient pipelineClient = redisClient.<span style="color:#007f7f">getClientInstance</span>().<span style="color:#007f7f">pipelineClient</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//æ·»åŠ æ‰¹é‡æŸ¥è¯¢ä»»åŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        List&lt;JimFuture&gt; futures = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;();
</span></span><span style="display:flex;"><span>        redisKeyList.<span style="color:#007f7f">forEach</span>(redisKey -&gt; {
</span></span><span style="display:flex;"><span>            futures.<span style="color:#007f7f">add</span>(pipelineClient.<span style="color:#007f7f">get</span>(redisKey.<span style="color:#007f7f">getBytes</span>()));
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å¤„ç†æŸ¥è¯¢ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        pipelineClient.<span style="color:#007f7f">flush</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å¯ä»¥ç­‰å¾…futureçš„è¿”å›ç»“æœï¼Œæ¥åˆ¤æ–­å‘½ä»¤æ˜¯å¦æˆåŠŸã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">for</span> (JimFuture future : futures) {
</span></span><span style="display:flex;"><span>            resultInfo.<span style="color:#007f7f">add</span>(<span style="color:#fff;font-weight:bold">new</span> String((<span style="color:#fff;font-weight:bold">byte</span>[])future.<span style="color:#007f7f">get</span>()));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        log.<span style="color:#007f7f">error</span>(<span style="color:#0ff;font-weight:bold">&#34;getValueByPipeline error:&#34;</span>,e);
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">funcError</span>(callerInfo);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;(redisKeyList.<span style="color:#007f7f">size</span>());
</span></span><span style="display:flex;"><span>    }<span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        Ump.<span style="color:#007f7f">methodRegEnd</span>(callerInfo);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> resultInfo;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼šPipelineä¸å»ºè®®ç”¨æ¥è®¾ç½®ç¼“å­˜å€¼ï¼Œå› ä¸ºæœ¬èº«ä¸æ˜¯åŸå­æ€§çš„æ“ä½œã€‚</p>
<h3 id="å‹ç¼©å­˜å‚¨æ•°æ®">å‹ç¼©å­˜å‚¨æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#å‹ç¼©å­˜å‚¨æ•°æ®">#</a></h3>
<p>DefaultOutputStream</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">byte</span>[] compressToByteArray(String text) <span style="color:#fff;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>    ByteArrayOutputStream outputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayOutputStream();
</span></span><span style="display:flex;"><span>    Deflater deflater = <span style="color:#fff;font-weight:bold">new</span> Deflater();
</span></span><span style="display:flex;"><span>    DeflaterOutputStream deflaterOutputStream = <span style="color:#fff;font-weight:bold">new</span> DeflaterOutputStream(outputStream, deflater);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    deflaterOutputStream.<span style="color:#007f7f">write</span>(text.<span style="color:#007f7f">getBytes</span>());
</span></span><span style="display:flex;"><span>    deflaterOutputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> outputStream.<span style="color:#007f7f">toByteArray</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// è§£å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> String decompressFromByteArray(<span style="color:#fff;font-weight:bold">byte</span>[] bytes) <span style="color:#fff;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>    ByteArrayInputStream inputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayInputStream(bytes);
</span></span><span style="display:flex;"><span>    Inflater inflater = <span style="color:#fff;font-weight:bold">new</span> Inflater();
</span></span><span style="display:flex;"><span>    InflaterInputStream inflaterInputStream = <span style="color:#fff;font-weight:bold">new</span> InflaterInputStream(inputStream, inflater);
</span></span><span style="display:flex;"><span>    ByteArrayOutputStream outputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayOutputStream();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">byte</span>[] buffer = <span style="color:#fff;font-weight:bold">new</span> <span style="color:#fff;font-weight:bold">byte</span>[<span style="color:#ff0;font-weight:bold">1024</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> length;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> ((length = inflaterInputStream.<span style="color:#007f7f">read</span>(buffer)) != -<span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        outputStream.<span style="color:#007f7f">write</span>(buffer, <span style="color:#ff0;font-weight:bold">0</span>, length);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    inflaterInputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>    outputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">byte</span>[] decompressedData = outputStream.<span style="color:#007f7f">toByteArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> String(decompressedData);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>GZIPOutputStream</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">byte</span>[] compressGzip(String str) {
</span></span><span style="display:flex;"><span>    ByteArrayOutputStream outputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayOutputStream();
</span></span><span style="display:flex;"><span>    GZIPOutputStream gzipOutputStream = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        gzipOutputStream = <span style="color:#fff;font-weight:bold">new</span> GZIPOutputStream(outputStream);
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        gzipOutputStream.<span style="color:#007f7f">write</span>(str.<span style="color:#007f7f">getBytes</span>(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>));
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>    }<span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            gzipOutputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> outputStream.<span style="color:#007f7f">toByteArray</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// è§£å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> String decompressGzip(<span style="color:#fff;font-weight:bold">byte</span>[] compressed) <span style="color:#fff;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>    ByteArrayInputStream inputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayInputStream(compressed);
</span></span><span style="display:flex;"><span>    GZIPInputStream gzipInputStream = <span style="color:#fff;font-weight:bold">new</span> GZIPInputStream(inputStream);
</span></span><span style="display:flex;"><span>    ByteArrayOutputStream outputStream = <span style="color:#fff;font-weight:bold">new</span> ByteArrayOutputStream();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">byte</span>[] buffer = <span style="color:#fff;font-weight:bold">new</span> <span style="color:#fff;font-weight:bold">byte</span>[<span style="color:#ff0;font-weight:bold">1024</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> length;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> ((length = gzipInputStream.<span style="color:#007f7f">read</span>(buffer)) &gt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>        outputStream.<span style="color:#007f7f">write</span>(buffer, <span style="color:#ff0;font-weight:bold">0</span>, length);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    gzipInputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>    outputStream.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> outputStream.<span style="color:#007f7f">toString</span>(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ZlibCompress</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span>  <span style="color:#fff;font-weight:bold">byte</span>[] zlibCompress(String message) <span style="color:#fff;font-weight:bold">throws</span> Exception {
</span></span><span style="display:flex;"><span>    String chatacter = <span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">byte</span>[] input = message.<span style="color:#007f7f">getBytes</span>(chatacter);
</span></span><span style="display:flex;"><span>    BigDecimal bigDecimal = BigDecimal.<span style="color:#007f7f">valueOf</span>(<span style="color:#ff0;font-weight:bold">0.25f</span>);
</span></span><span style="display:flex;"><span>    BigDecimal length = BigDecimal.<span style="color:#007f7f">valueOf</span>(input.<span style="color:#007f7f">length</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">byte</span>[] output = <span style="color:#fff;font-weight:bold">new</span> <span style="color:#fff;font-weight:bold">byte</span>[input.<span style="color:#007f7f">length</span> + <span style="color:#ff0;font-weight:bold">10</span> + <span style="color:#fff;font-weight:bold">new</span> Double(Math.<span style="color:#007f7f">ceil</span>(Double.<span style="color:#007f7f">parseDouble</span>(bigDecimal.<span style="color:#007f7f">multiply</span>(length).<span style="color:#007f7f">toString</span>()))).<span style="color:#007f7f">intValue</span>()];
</span></span><span style="display:flex;"><span>    Deflater compresser = <span style="color:#fff;font-weight:bold">new</span> Deflater();
</span></span><span style="display:flex;"><span>    compresser.<span style="color:#007f7f">setInput</span>(input);
</span></span><span style="display:flex;"><span>    compresser.<span style="color:#007f7f">finish</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> compressedDataLength = compresser.<span style="color:#007f7f">deflate</span>(output);
</span></span><span style="display:flex;"><span>    compresser.<span style="color:#007f7f">end</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> Arrays.<span style="color:#007f7f">copyOf</span>(output, compressedDataLength);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// è§£å‹ç¼©
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> String zlibInfCompress(<span style="color:#fff;font-weight:bold">byte</span>[] data) {
</span></span><span style="display:flex;"><span>    String s = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Inflater decompresser = <span style="color:#fff;font-weight:bold">new</span> Inflater();
</span></span><span style="display:flex;"><span>    decompresser.<span style="color:#007f7f">reset</span>();
</span></span><span style="display:flex;"><span>    decompresser.<span style="color:#007f7f">setInput</span>(data);
</span></span><span style="display:flex;"><span>    ByteArrayOutputStream o = <span style="color:#fff;font-weight:bold">new</span> ByteArrayOutputStream(data.<span style="color:#007f7f">length</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">byte</span>[] buf = <span style="color:#fff;font-weight:bold">new</span> <span style="color:#fff;font-weight:bold">byte</span>[<span style="color:#ff0;font-weight:bold">1024</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">while</span> (!decompresser.<span style="color:#007f7f">finished</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">int</span> i = decompresser.<span style="color:#007f7f">inflate</span>(buf);
</span></span><span style="display:flex;"><span>            o.<span style="color:#007f7f">write</span>(buf, <span style="color:#ff0;font-weight:bold">0</span>, i);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        s = o.<span style="color:#007f7f">toString</span>(<span style="color:#0ff;font-weight:bold">&#34;UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            o.<span style="color:#007f7f">close</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    decompresser.<span style="color:#007f7f">end</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> s;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°å‹ç¼©æ•ˆç‡æ¯”è¾ƒå¥½ï¼Œå‹ç¼©æ•ˆç‡å¯ä»¥ä»å‡ ç™¾kbå‹ç¼©åˆ°å‡ kbå†…ï¼›å½“ç„¶ä¹Ÿæ˜¯çœ‹å…·ä½“åœºæ™¯ã€‚ä¸è¿‡è¿™é‡Œå°±æ˜¯æœ€å¥½æ˜¯é¿å…è°ƒç”¨é‡å¤§çš„åœºæ™¯ä½¿ç”¨ï¼Œæ¯•ç«Ÿè§£å‹å’Œå‹ç¼©æ•°æ®é‡å¤§ä¼šæ¯”è¾ƒè€—è´¹cpuæ€§èƒ½ã€‚å¦‚æœæ˜¯é»„é‡‘é“¾è·¯ä½¿ç”¨ï¼Œè¿˜éœ€è¦å…·ä½“é…åˆå‹æµ‹ï¼Œå¯¹æ¯”å‰åæ¥å£æ€§èƒ½ã€‚</p>
<h3 id="æ›¿æ¢å­˜å‚¨æ–¹æ¡ˆ">æ›¿æ¢å­˜å‚¨æ–¹æ¡ˆ<a hidden class="anchor" aria-hidden="true" href="#æ›¿æ¢å­˜å‚¨æ–¹æ¡ˆ">#</a></h3>
<p>å¦‚æœæ•°æ®é‡åºå¤§ï¼Œé‚£ä¹ˆå…¶å®æœ¬èº«æ˜¯ä¸æ˜¯å°±ä¸å¤ªé€‚åˆredisè¿™ç§ç¼“å­˜å­˜å‚¨äº†ã€‚å¯ä»¥è€ƒè™‘esæˆ–è€…mongoè¿™ç§æ–‡æ¡£å¼å­˜å‚¨ç»“æ„ï¼Œå­˜å‚¨å¤§çš„æ•°æ®æ ¼å¼ã€‚</p>
<h2 id="æ€»ç»“-1">æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ€»ç»“-1">#</a></h2>
<p>redisç¼“å­˜çš„ä½¿ç”¨æ˜¯ä¸€ä¸ªæ”¯æŒä¸šåŠ¡å’ŒåŠŸèƒ½é«˜å¹¶å‘çš„å¾ˆå¥½çš„ä½¿ç”¨æ–¹æ¡ˆï¼Œä½†æ˜¯éšç€ä½¿ç”¨åœºæ™¯çš„å¤šæ ·æ€§ä»¥åŠæ•°æ®çš„å¢åŠ ï¼Œå¯èƒ½é€æ¸çš„ä¼šå‡ºç°å¤§keyï¼Œæ—¥å¸¸ä½¿ç”¨ä¸­éƒ½å¯ä»¥æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<p>**1.åˆ†è€Œæ²»ä¹‹ã€‚**å¦‚æœéœ€è¦å­˜å‚¨å¤§é‡çš„æ•°æ®ï¼Œé¿å…ç›´æ¥æ”¾åˆ°ç¼“å­˜ä¸­ã€‚å¯ä»¥å°†å…¶æ‹†åˆ†æˆå¤šä¸ªå°çš„valueã€‚å°±åƒæ˜¯å’±ä»¬æ—¥å¸¸åƒé¥­ï¼Œç››åˆ°ç¢—é‡Œï¼Œä¸€å£ä¸€å£çš„åƒï¼Œä¿—è¯è¯´çš„å¥½å‘€ï¼šâ€œç»†åš¼æ…¢å’½â€ã€‚</p>
<p>**2.é¿å…ä½¿ç”¨ä¸å¿…è¦çš„æ•°æ®ç»“æ„ã€‚**ä¾‹å¦‚ï¼Œå¦‚æœåªéœ€è¦å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æ„çš„æ•°æ®ï¼Œå°±ä¸è¦è¿‡åº¦è®¾è®¡ï¼Œä½¿ç”¨Hashæˆ–è€…Listç­‰æ•°æ®ç»“æ„ã€‚</p>
<p>**3.å®šæœŸæ¸…ç†è¿‡æœŸçš„keyã€‚**å¦‚æœRedisä¸­å­˜åœ¨å¤§é‡çš„è¿‡æœŸkeyï¼Œå°±ä¼šå¯¼è‡´Redisçš„æ€§èƒ½ä¸‹é™ï¼Œæˆ–è€…åœºæ™¯éå¿…è¦ä»¥ç¼“å­˜æ¥æŒä¹…å­˜å‚¨çš„ï¼Œå¯ä»¥æ·»åŠ è¿‡æœŸæ—¶é—´ï¼Œå®šæ—¶æ¸…ç†è¿‡æœŸçš„keyï¼Œå°±åƒæ˜¯å®¶ä¸­çš„æ—¥å¸¸åƒåœ¾ç±»ä¼¼ï¼Œå®šæœŸçš„æ¸…æ´å’Œæ‰“æ‰«ï¼Œå±…ä½èµ·æ¥å’±ä»¬æ‰ä¼šæ›´åŠ èˆ’æœå’Œæ–¹ä¾¿ã€‚</p>
<p>**4.å¯¹è±¡å‹ç¼©ã€‚**å°†å¤§çš„æ•°æ®å‹ç¼©æˆæ›´å°çš„æ•°æ®ï¼Œä¹Ÿæ˜¯ä¸€ç§å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡è¦æ³¨æ„å‹ç¼©å’Œè§£å‹çš„é¢‘ç‡ï¼Œæ¯•ç«Ÿæ˜¯æ¯”è¾ƒè€—è´¹cpuçš„ã€‚</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/">ä¸­é—´ä»¶</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://funny-toffee-4aa7c3.netlify.app/">Wjy&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>