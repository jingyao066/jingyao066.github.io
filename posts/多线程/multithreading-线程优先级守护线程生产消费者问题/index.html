<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜ | Wjy&#39;s Blog</title>
<meta name="keywords" content="multithreading">
<meta name="description" content="çº¿ç¨‹ä¼˜å…ˆçº§
java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚
java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚
ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚
ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚">
<meta name="author" content="Me, You">
<link rel="canonical" href="http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E7%94%9F%E4%BA%A7%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜" />
<meta property="og:description" content="çº¿ç¨‹ä¼˜å…ˆçº§
java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚
java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚
ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚
ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E7%94%9F%E4%BA%A7%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-28T16:23:30+00:00" />
<meta property="article:modified_time" content="2019-03-28T16:23:30+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜"/>
<meta name="twitter:description" content="çº¿ç¨‹ä¼˜å…ˆçº§
java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚
java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚
ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚
ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜",
      "item": "http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E7%94%9F%E4%BA%A7%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜",
  "name": "multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜",
  "description": "çº¿ç¨‹ä¼˜å…ˆçº§ java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚ java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚ ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚ ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚\n",
  "keywords": [
    "multithreading"
  ],
  "articleBody": "çº¿ç¨‹ä¼˜å…ˆçº§ java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚ java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚ ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚ ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚\nJDK ä¸­å…³äºçº¿ç¨‹ä¼˜å…ˆçº§å’Œå®ˆæŠ¤çº¿ç¨‹çš„ä»‹ç»å¦‚ä¸‹ï¼š Every thread has a priority. Threads with higher priority are executed in preference to threads with lower priority. Each thread may or may not also be marked as a daemon. When code running in some thread creates a new Thread object, the new thread has its priority initially set equal to the priority of the creating thread, and is a daemon thread if and only if the creating thread is a daemon.\nWhen a Java Virtual Machine starts up, there is usually a single non-daemon thread (which typically calls the method named main of some designated class). The Java Virtual Machine continues to execute threads until either of the following occurs:\nThe exit method of class Runtime has been called and the security manager has permitted the exit operation to take place. All threads that are not daemon threads have died, either by returning from the call to the run method or by throwing an exception that propagates beyond the run method. Marks this thread as either a daemon thread or a user thread. The Java Virtual Machine exits when the only threads running are all daemon threads. æ„æ€æ˜¯ï¼š æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è¢«æ ‡è®°ä¸ºä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹æˆ–éå®ˆæŠ¤è¿›ç¨‹ã€‚åœ¨ä¸€äº›è¿è¡Œçš„ä¸»çº¿ç¨‹ä¸­åˆ›å»ºæ–°çš„å­çº¿ç¨‹æ—¶ï¼Œå­çº¿ç¨‹çš„ä¼˜å…ˆçº§è¢«è®¾ç½®ä¸ºç­‰äºâ€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹çš„ä¼˜å…ˆçº§â€ï¼Œå½“ä¸”ä»…å½“â€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹â€æ—¶â€œå­çº¿ç¨‹æ‰ä¼šæ˜¯å®ˆæŠ¤çº¿ç¨‹â€ã€‚\nå½“Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªå•ä¸€çš„éå®ˆæŠ¤çº¿ç¨‹ï¼ˆè¯¥çº¿ç¨‹é€šè¿‡æ˜¯é€šè¿‡main()æ–¹æ³•å¯åŠ¨ï¼‰ã€‚JVMä¼šä¸€ç›´è¿è¡Œç›´åˆ°ä¸‹é¢çš„ä»»æ„ä¸€ä¸ªæ¡ä»¶å‘ç”Ÿï¼ŒJVMå°±ä¼šç»ˆæ­¢è¿è¡Œï¼š (01) è°ƒç”¨äº†exit()æ–¹æ³•ï¼Œå¹¶ä¸”exit()æœ‰æƒé™è¢«æ­£å¸¸æ‰§è¡Œã€‚ (02) æ‰€æœ‰çš„â€œéå®ˆæŠ¤çº¿ç¨‹â€éƒ½æ­»äº†(å³JVMä¸­ä»…ä»…åªæœ‰â€œå®ˆæŠ¤çº¿ç¨‹â€)ã€‚\næ¯ä¸€ä¸ªçº¿ç¨‹éƒ½è¢«æ ‡è®°ä¸ºâ€œå®ˆæŠ¤çº¿ç¨‹â€æˆ–â€œç”¨æˆ·çº¿ç¨‹â€ã€‚å½“åªæœ‰å®ˆæŠ¤çº¿ç¨‹è¿è¡Œæ—¶ï¼ŒJVMä¼šè‡ªåŠ¨é€€å‡ºã€‚\nçº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public class MyThread extends Thread{ public MyThread(String name) { super(name); } public void run(){ for (int i=0; i\u003c5; i++) { System.out.println(Thread.currentThread().getName() +\"(\"+Thread.currentThread().getPriority()+ \")\" +\", loop \"+i); } } }; public class Demo { public static void main(String[] args) { System.out.println(Thread.currentThread().getName() +\"(\"+Thread.currentThread().getPriority()+ \")\"); Thread t1=new MyThread(\"t1\"); // æ–°å»ºt1 Thread t2=new MyThread(\"t2\"); // æ–°å»ºt2 t1.setPriority(1); // è®¾ç½®t1çš„ä¼˜å…ˆçº§ä¸º1 t2.setPriority(10); // è®¾ç½®t2çš„ä¼˜å…ˆçº§ä¸º10 t1.start(); // å¯åŠ¨t1 t2.start(); // å¯åŠ¨t2 } } è¿è¡Œç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 main(5) t1(1), loop 0 t1(1), loop 1 t1(1), loop 2 t1(1), loop 3 t1(1), loop 4 t2(10), loop 0 t2(10), loop 1 t2(10), loop 2 t2(10), loop 3 t2(10), loop 4 ç»“æœè¯´æ˜ï¼š 1.ä¸»çº¿ç¨‹mainçš„ä¼˜å…ˆçº§æ˜¯5ã€‚ 2.è™½ç„¶t1çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º1ï¼Œt2çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º10ï¼Œç»è¿‡å¤šæ¬¡è¿è¡Œå‘ç°ï¼Œä¸Šè¾¹çš„ç»“æœæ˜¯å‡ºç°æ¬¡æ•°æœ€å¤šçš„ï¼Œæå°‘æ•°æ—¶t1å’Œt2ä¼šäº¤æ›¿æ‰§è¡Œã€‚ è¿™è¯´æ˜äº†å³ä½¿å°†ä¼˜å…ˆçº§è°ƒé«˜ï¼Œä¹Ÿä¸èƒ½ä¿è¯ç³»ç»Ÿå®Œå…¨æŒ‰ç…§è®¾å®šçš„ä¼˜å…ˆçº§æ‰§è¡Œï¼Œè¿˜è¦å–å†³äºç³»ç»Ÿçš„çº¿ç¨‹è§„åˆ’å™¨ã€‚\nå®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 public class MyThread extends Thread{ public MyThread(String name) { super(name); } public void run(){ try { for (int i=0; i\u003c5; i++) { Thread.sleep(3); System.out.println(this.getName() +\"(isDaemon=\"+this.isDaemon()+ \")\" +\", loop \"+i); } } catch (InterruptedException e) { } } }; public class MyDaemon extends Thread{ public MyDaemon(String name) { super(name); } public void run(){ try { for (int i=0; i\u003c10000; i++) { Thread.sleep(1); System.out.println(this.getName() +\"(isDaemon=\"+this.isDaemon()+ \")\" +\", loop \"+i); } } catch (InterruptedException e) { } } } public class Demo { public static void main(String[] args) { System.out.println(Thread.currentThread().getName() +\"(isDaemon=\"+Thread.currentThread().isDaemon()+ \")\"); Thread t1=new MyThread(\"t1\"); // æ–°å»ºt1 Thread t2=new MyDaemon(\"t2\"); // æ–°å»ºt2 t2.setDaemon(true); // è®¾ç½®t2ä¸ºå®ˆæŠ¤çº¿ç¨‹ t1.start(); // å¯åŠ¨t1 t2.start(); // å¯åŠ¨t2 } } è¿è¡Œç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 main(isDaemon=false) t1(isDaemon=false), loop 0 t2(isDaemon=true), loop 0 t2(isDaemon=true), loop 1 t1(isDaemon=false), loop 1 t1(isDaemon=false), loop 2 t2(isDaemon=true), loop 2 t1(isDaemon=false), loop 3 t2(isDaemon=true), loop 3 t2(isDaemon=true), loop 4 t2(isDaemon=true), loop 5 t1(isDaemon=false), loop 4 ç»“æœè¯´æ˜ï¼š ç»“æœè¯´æ˜ï¼š (01) ä¸»çº¿ç¨‹mainæ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œå®ƒåˆ›å»ºçš„å­çº¿ç¨‹t1ä¹Ÿæ˜¯ç”¨æˆ·çº¿ç¨‹ã€‚ (02) t2æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚åœ¨â€œä¸»çº¿ç¨‹mainâ€å’Œâ€œå­çº¿ç¨‹t1â€(å®ƒä»¬éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹)æ‰§è¡Œå®Œæ¯•ï¼Œåªå‰©t2è¿™ä¸ªå®ˆæŠ¤çº¿ç¨‹çš„æ—¶å€™ï¼ŒJVMè‡ªåŠ¨é€€å‡ºã€‚\nç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹ ç”Ÿäº§/æ¶ˆè´¹è€…é—®é¢˜æ˜¯ä¸ªéå¸¸å…¸å‹çš„å¤šçº¿ç¨‹é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„å¯¹è±¡åŒ…æ‹¬â€œç”Ÿäº§è€…â€ã€â€œæ¶ˆè´¹è€…â€ã€â€œä»“åº“â€å’Œâ€œäº§å“â€ã€‚ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š (01) ç”Ÿäº§è€…ä»…ä»…åœ¨ä»“å‚¨æœªæ»¡æ—¶å€™ç”Ÿäº§ï¼Œä»“æ»¡åˆ™åœæ­¢ç”Ÿäº§ã€‚ (02) æ¶ˆè´¹è€…ä»…ä»…åœ¨ä»“å‚¨æœ‰äº§å“æ—¶å€™æ‰èƒ½æ¶ˆè´¹ï¼Œä»“ç©ºåˆ™ç­‰å¾…ã€‚ (03) å½“æ¶ˆè´¹è€…å‘ç°ä»“å‚¨æ²¡äº§å“å¯æ¶ˆè´¹æ—¶å€™ä¼šé€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§ã€‚ (04) ç”Ÿäº§è€…åœ¨ç”Ÿäº§å‡ºå¯æ¶ˆè´¹äº§å“æ—¶å€™ï¼Œåº”è¯¥é€šçŸ¥ç­‰å¾…çš„æ¶ˆè´¹è€…å»æ¶ˆè´¹ã€‚\nç”Ÿäº§/æ¶ˆè´¹è€…å®ç° ä¸‹é¢é€šè¿‡wait()/notify()æ–¹å¼å®ç°è¯¥æ¨¡å‹(åé¢åœ¨å­¦ä¹ äº†çº¿ç¨‹æ± ç›¸å…³å†…å®¹ä¹‹åï¼Œå†é€šè¿‡å…¶å®ƒæ–¹å¼å®ç°ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹)ã€‚æºç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 // ä»“åº“ class Depot { private int capacity; // ä»“åº“çš„å®¹é‡ private int size; // ä»“åº“çš„å®é™…æ•°é‡ public Depot(int capacity) { this.capacity = capacity; this.size = 0; } public synchronized void produce(int val) { try { // left è¡¨ç¤ºâ€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€(æœ‰å¯èƒ½ç”Ÿäº§é‡å¤ªå¤šï¼Œéœ€å¤šæ¬¡ç”Ÿäº§) int left = val; while (left \u003e 0) { // åº“å­˜å·²æ»¡æ—¶ï¼Œç­‰å¾…â€œæ¶ˆè´¹è€…â€æ¶ˆè´¹äº§å“ã€‚ while (size \u003e= capacity) wait(); // è·å–â€œå®é™…ç”Ÿäº§çš„æ•°é‡â€(å³åº“å­˜ä¸­æ–°å¢çš„æ•°é‡) // å¦‚æœâ€œåº“å­˜â€+â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€\u003eâ€œæ€»çš„å®¹é‡â€ï¼Œåˆ™â€œå®é™…å¢é‡â€=â€œæ€»çš„å®¹é‡â€-â€œå½“å‰å®¹é‡â€ã€‚(æ­¤æ—¶å¡«æ»¡ä»“åº“) // å¦åˆ™â€œå®é™…å¢é‡â€=â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€ int inc = (size+left)\u003ecapacity ? (capacity-size) : left; size += inc; left -= inc; System.out.printf(\"%s produce(%3d) --\u003e left=%3d, inc=%3d, size=%3d\\n\", Thread.currentThread().getName(), val, left, inc, size); // é€šçŸ¥â€œæ¶ˆè´¹è€…â€å¯ä»¥æ¶ˆè´¹äº†ã€‚ notifyAll(); } } catch (InterruptedException e) { } } public synchronized void consume(int val) { try { // left è¡¨ç¤ºâ€œå®¢æˆ·è¦æ¶ˆè´¹æ•°é‡â€(æœ‰å¯èƒ½æ¶ˆè´¹é‡å¤ªå¤§ï¼Œåº“å­˜ä¸å¤Ÿï¼Œéœ€å¤šæ­¤æ¶ˆè´¹) int left = val; while (left \u003e 0) { // åº“å­˜ä¸º0æ—¶ï¼Œç­‰å¾…â€œç”Ÿäº§è€…â€ç”Ÿäº§äº§å“ã€‚ while (size \u003c= 0) wait(); // è·å–â€œå®é™…æ¶ˆè´¹çš„æ•°é‡â€(å³åº“å­˜ä¸­å®é™…å‡å°‘çš„æ•°é‡) // å¦‚æœâ€œåº“å­˜â€\u003câ€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ï¼Œåˆ™â€œå®é™…æ¶ˆè´¹é‡â€=â€œåº“å­˜â€ï¼› // å¦åˆ™ï¼Œâ€œå®é™…æ¶ˆè´¹é‡â€=â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ã€‚ int dec = (size",
  "wordCount" : "3135",
  "inLanguage": "en",
  "datePublished": "2019-03-28T16:23:30Z",
  "dateModified": "2019-03-28T16:23:30Z",
  "author":[{
    "@type": "Person",
    "name": "Me"
  }, {
    "@type": "Person",
    "name": "You"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E7%94%9F%E4%BA%A7%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title">
      multithreading-çº¿ç¨‹ä¼˜å…ˆçº§ã€å®ˆæŠ¤çº¿ç¨‹ã€ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜
    </h1>
    <div class="post-meta"><span title='2019-03-28 16:23:30 +0000 UTC'>2019-03-28</span>&nbsp;Â·&nbsp;Me, You

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e7%ba%bf%e7%a8%8b%e4%bc%98%e5%85%88%e7%ba%a7" aria-label="çº¿ç¨‹ä¼˜å…ˆçº§">çº¿ç¨‹ä¼˜å…ˆçº§</a></li>
                <li>
                    <a href="#%e7%ba%bf%e7%a8%8b%e4%bc%98%e5%85%88%e7%ba%a7%e7%a4%ba%e4%be%8b" aria-label="çº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹">çº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹</a></li>
                <li>
                    <a href="#%e5%ae%88%e6%8a%a4%e7%ba%bf%e7%a8%8b%e7%a4%ba%e4%be%8b" aria-label="å®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹">å®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹</a></li>
                <li>
                    <a href="#%e7%94%9f%e4%ba%a7%e6%b6%88%e8%b4%b9%e8%80%85%e6%a8%a1%e5%9e%8b" aria-label="ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹">ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹</a></li>
                <li>
                    <a href="#%e7%94%9f%e4%ba%a7%e6%b6%88%e8%b4%b9%e8%80%85%e5%ae%9e%e7%8e%b0" aria-label="ç”Ÿäº§/æ¶ˆè´¹è€…å®ç°">ç”Ÿäº§/æ¶ˆè´¹è€…å®ç°</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="çº¿ç¨‹ä¼˜å…ˆçº§">çº¿ç¨‹ä¼˜å…ˆçº§<a hidden class="anchor" aria-hidden="true" href="#çº¿ç¨‹ä¼˜å…ˆçº§">#</a></h1>
<p>java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚10è¡¨ç¤ºæœ€é«˜ä¼˜å…ˆçº§ï¼Œ1è¡¨ç¤ºæœ€ä½ä¼˜å…ˆçº§ï¼Œ5æ˜¯æ™®é€šä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚
java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚
ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ï¼Œä½œç”¨æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©æœåŠ¡ï¼Œå®ˆæŠ¤çº¿ç¨‹æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯ GC (åƒåœ¾å›æ”¶å™¨)ã€‚
ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ä¸¤è€…å‡ ä¹æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„ä¸åŒä¹‹å¤„å°±åœ¨äºè™šæ‹Ÿæœºçš„ç¦»å¼€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚</p>
<p>JDK ä¸­å…³äºçº¿ç¨‹ä¼˜å…ˆçº§å’Œå®ˆæŠ¤çº¿ç¨‹çš„ä»‹ç»å¦‚ä¸‹ï¼š
Every thread has a priority. Threads with higher priority are executed in preference to threads with lower priority. Each thread may or may not also be marked as a daemon. When code running in some thread creates a new Thread object, the new thread has its priority initially set equal to the priority of the creating thread, and is a daemon thread if and only if the creating thread is a daemon.</p>
<p>When a Java Virtual Machine starts up, there is usually a single non-daemon thread (which typically calls the method named main of some designated class). The Java Virtual Machine continues to execute threads until either of the following occurs:</p>
<p>The exit method of class Runtime has been called and the security manager has permitted the exit operation to take place.
All threads that are not daemon threads have died, either by returning from the call to the run method or by throwing an exception that propagates beyond the run method.
Marks this thread as either a daemon thread or a user thread. The Java Virtual Machine exits when the only threads running are all daemon threads.
æ„æ€æ˜¯ï¼š
æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è¢«æ ‡è®°ä¸ºä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹æˆ–éå®ˆæŠ¤è¿›ç¨‹ã€‚åœ¨ä¸€äº›è¿è¡Œçš„ä¸»çº¿ç¨‹ä¸­åˆ›å»ºæ–°çš„å­çº¿ç¨‹æ—¶ï¼Œå­çº¿ç¨‹çš„ä¼˜å…ˆçº§è¢«è®¾ç½®ä¸ºç­‰äºâ€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹çš„ä¼˜å…ˆçº§â€ï¼Œå½“ä¸”ä»…å½“â€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹â€æ—¶â€œå­çº¿ç¨‹æ‰ä¼šæ˜¯å®ˆæŠ¤çº¿ç¨‹â€ã€‚</p>
<p>å½“Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªå•ä¸€çš„éå®ˆæŠ¤çº¿ç¨‹ï¼ˆè¯¥çº¿ç¨‹é€šè¿‡æ˜¯é€šè¿‡main()æ–¹æ³•å¯åŠ¨ï¼‰ã€‚JVMä¼šä¸€ç›´è¿è¡Œç›´åˆ°ä¸‹é¢çš„ä»»æ„ä¸€ä¸ªæ¡ä»¶å‘ç”Ÿï¼ŒJVMå°±ä¼šç»ˆæ­¢è¿è¡Œï¼š
(01) è°ƒç”¨äº†exit()æ–¹æ³•ï¼Œå¹¶ä¸”exit()æœ‰æƒé™è¢«æ­£å¸¸æ‰§è¡Œã€‚
(02) æ‰€æœ‰çš„â€œéå®ˆæŠ¤çº¿ç¨‹â€éƒ½æ­»äº†(å³JVMä¸­ä»…ä»…åªæœ‰â€œå®ˆæŠ¤çº¿ç¨‹â€)ã€‚</p>
<p>æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½è¢«æ ‡è®°ä¸ºâ€œå®ˆæŠ¤çº¿ç¨‹â€æˆ–â€œç”¨æˆ·çº¿ç¨‹â€ã€‚å½“åªæœ‰å®ˆæŠ¤çº¿ç¨‹è¿è¡Œæ—¶ï¼ŒJVMä¼šè‡ªåŠ¨é€€å‡ºã€‚</p>
<h1 id="çº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹">çº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#çº¿ç¨‹ä¼˜å…ˆçº§ç¤ºä¾‹">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MyThread <span style="color:#fff;font-weight:bold">extends</span> Thread{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyThread(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run(){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>; i&lt;<span style="color:#ff0;font-weight:bold">5</span>; i++) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()
</span></span><span style="display:flex;"><span>                    +<span style="color:#0ff;font-weight:bold">&#34;(&#34;</span>+Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getPriority</span>()+ <span style="color:#0ff;font-weight:bold">&#34;)&#34;</span>
</span></span><span style="display:flex;"><span>                    +<span style="color:#0ff;font-weight:bold">&#34;, loop &#34;</span>+i);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>}; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()
</span></span><span style="display:flex;"><span>                +<span style="color:#0ff;font-weight:bold">&#34;(&#34;</span>+Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getPriority</span>()+ <span style="color:#0ff;font-weight:bold">&#34;)&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Thread t1=<span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t1&#34;</span>);    <span style="color:#007f7f">// æ–°å»ºt1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Thread t2=<span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t2&#34;</span>);    <span style="color:#007f7f">// æ–°å»ºt2
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t1.<span style="color:#007f7f">setPriority</span>(<span style="color:#ff0;font-weight:bold">1</span>);               <span style="color:#007f7f">// è®¾ç½®t1çš„ä¼˜å…ˆçº§ä¸º1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t2.<span style="color:#007f7f">setPriority</span>(<span style="color:#ff0;font-weight:bold">10</span>);              <span style="color:#007f7f">// è®¾ç½®t2çš„ä¼˜å…ˆçº§ä¸º10
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t1.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨t1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t2.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨t2
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>main(5)
</span></span><span style="display:flex;"><span>t1(1), loop 0
</span></span><span style="display:flex;"><span>t1(1), loop 1
</span></span><span style="display:flex;"><span>t1(1), loop 2
</span></span><span style="display:flex;"><span>t1(1), loop 3
</span></span><span style="display:flex;"><span>t1(1), loop 4
</span></span><span style="display:flex;"><span>t2(10), loop 0
</span></span><span style="display:flex;"><span>t2(10), loop 1
</span></span><span style="display:flex;"><span>t2(10), loop 2
</span></span><span style="display:flex;"><span>t2(10), loop 3
</span></span><span style="display:flex;"><span>t2(10), loop 4
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¯´æ˜ï¼š
1.ä¸»çº¿ç¨‹mainçš„ä¼˜å…ˆçº§æ˜¯5ã€‚
2.è™½ç„¶t1çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º1ï¼Œt2çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º10ï¼Œç»è¿‡å¤šæ¬¡è¿è¡Œå‘ç°ï¼Œä¸Šè¾¹çš„ç»“æœæ˜¯å‡ºç°æ¬¡æ•°æœ€å¤šçš„ï¼Œæå°‘æ•°æ—¶t1å’Œt2ä¼šäº¤æ›¿æ‰§è¡Œã€‚
è¿™è¯´æ˜äº†å³ä½¿å°†ä¼˜å…ˆçº§è°ƒé«˜ï¼Œä¹Ÿä¸èƒ½ä¿è¯ç³»ç»Ÿå®Œå…¨æŒ‰ç…§è®¾å®šçš„ä¼˜å…ˆçº§æ‰§è¡Œï¼Œè¿˜è¦å–å†³äºç³»ç»Ÿçš„çº¿ç¨‹è§„åˆ’å™¨ã€‚</p>
<h1 id="å®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹">å®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#å®ˆæŠ¤çº¿ç¨‹ç¤ºä¾‹">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MyThread <span style="color:#fff;font-weight:bold">extends</span> Thread{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyThread(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run(){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>; i&lt;<span style="color:#ff0;font-weight:bold">5</span>; i++) {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">3</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34;(isDaemon=&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">isDaemon</span>()+ <span style="color:#0ff;font-weight:bold">&#34;)&#34;</span> +<span style="color:#0ff;font-weight:bold">&#34;, loop &#34;</span>+i);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> MyDaemon <span style="color:#fff;font-weight:bold">extends</span> Thread{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyDaemon(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run(){
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>; i&lt;<span style="color:#ff0;font-weight:bold">10000</span>; i++) {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34;(isDaemon=&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">isDaemon</span>()+ <span style="color:#0ff;font-weight:bold">&#34;)&#34;</span> +<span style="color:#0ff;font-weight:bold">&#34;, loop &#34;</span>+i);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()
</span></span><span style="display:flex;"><span>                +<span style="color:#0ff;font-weight:bold">&#34;(isDaemon=&#34;</span>+Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">isDaemon</span>()+ <span style="color:#0ff;font-weight:bold">&#34;)&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Thread t1=<span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t1&#34;</span>);    <span style="color:#007f7f">// æ–°å»ºt1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        Thread t2=<span style="color:#fff;font-weight:bold">new</span> MyDaemon(<span style="color:#0ff;font-weight:bold">&#34;t2&#34;</span>);    <span style="color:#007f7f">// æ–°å»ºt2
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t2.<span style="color:#007f7f">setDaemon</span>(<span style="color:#fff;font-weight:bold">true</span>);              <span style="color:#007f7f">// è®¾ç½®t2ä¸ºå®ˆæŠ¤çº¿ç¨‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t1.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨t1
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        t2.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨t2
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>main(isDaemon=false)
</span></span><span style="display:flex;"><span>t1(isDaemon=false), loop 0
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 0
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 1
</span></span><span style="display:flex;"><span>t1(isDaemon=false), loop 1
</span></span><span style="display:flex;"><span>t1(isDaemon=false), loop 2
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 2
</span></span><span style="display:flex;"><span>t1(isDaemon=false), loop 3
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 3
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 4
</span></span><span style="display:flex;"><span>t2(isDaemon=true), loop 5
</span></span><span style="display:flex;"><span>t1(isDaemon=false), loop 4
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¯´æ˜ï¼š
ç»“æœè¯´æ˜ï¼š
(01) ä¸»çº¿ç¨‹mainæ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œå®ƒåˆ›å»ºçš„å­çº¿ç¨‹t1ä¹Ÿæ˜¯ç”¨æˆ·çº¿ç¨‹ã€‚
(02) t2æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚åœ¨â€œä¸»çº¿ç¨‹mainâ€å’Œâ€œå­çº¿ç¨‹t1â€(å®ƒä»¬éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹)æ‰§è¡Œå®Œæ¯•ï¼Œåªå‰©t2è¿™ä¸ªå®ˆæŠ¤çº¿ç¨‹çš„æ—¶å€™ï¼ŒJVMè‡ªåŠ¨é€€å‡ºã€‚</p>
<h1 id="ç”Ÿäº§æ¶ˆè´¹è€…æ¨¡å‹">ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹<a hidden class="anchor" aria-hidden="true" href="#ç”Ÿäº§æ¶ˆè´¹è€…æ¨¡å‹">#</a></h1>
<p>ç”Ÿäº§/æ¶ˆè´¹è€…é—®é¢˜æ˜¯ä¸ªéå¸¸å…¸å‹çš„å¤šçº¿ç¨‹é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„å¯¹è±¡åŒ…æ‹¬â€œç”Ÿäº§è€…â€ã€â€œæ¶ˆè´¹è€…â€ã€â€œä»“åº“â€å’Œâ€œäº§å“â€ã€‚ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š
(01) ç”Ÿäº§è€…ä»…ä»…åœ¨ä»“å‚¨æœªæ»¡æ—¶å€™ç”Ÿäº§ï¼Œä»“æ»¡åˆ™åœæ­¢ç”Ÿäº§ã€‚
(02) æ¶ˆè´¹è€…ä»…ä»…åœ¨ä»“å‚¨æœ‰äº§å“æ—¶å€™æ‰èƒ½æ¶ˆè´¹ï¼Œä»“ç©ºåˆ™ç­‰å¾…ã€‚
(03) å½“æ¶ˆè´¹è€…å‘ç°ä»“å‚¨æ²¡äº§å“å¯æ¶ˆè´¹æ—¶å€™ä¼šé€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§ã€‚
(04) ç”Ÿäº§è€…åœ¨ç”Ÿäº§å‡ºå¯æ¶ˆè´¹äº§å“æ—¶å€™ï¼Œåº”è¯¥é€šçŸ¥ç­‰å¾…çš„æ¶ˆè´¹è€…å»æ¶ˆè´¹ã€‚</p>
<h1 id="ç”Ÿäº§æ¶ˆè´¹è€…å®ç°">ç”Ÿäº§/æ¶ˆè´¹è€…å®ç°<a hidden class="anchor" aria-hidden="true" href="#ç”Ÿäº§æ¶ˆè´¹è€…å®ç°">#</a></h1>
<p>ä¸‹é¢é€šè¿‡wait()/notify()æ–¹å¼å®ç°è¯¥æ¨¡å‹(åé¢åœ¨å­¦ä¹ äº†çº¿ç¨‹æ± ç›¸å…³å†…å®¹ä¹‹åï¼Œå†é€šè¿‡å…¶å®ƒæ–¹å¼å®ç°ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹)ã€‚æºç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// ä»“åº“
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> Depot {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> capacity;    <span style="color:#007f7f">// ä»“åº“çš„å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> size;        <span style="color:#007f7f">// ä»“åº“çš„å®é™…æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Depot(<span style="color:#fff;font-weight:bold">int</span> capacity) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">capacity</span> = capacity;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">size</span> = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">synchronized</span> <span style="color:#fff;font-weight:bold">void</span> produce(<span style="color:#fff;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>             <span style="color:#007f7f">// left è¡¨ç¤ºâ€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€(æœ‰å¯èƒ½ç”Ÿäº§é‡å¤ªå¤šï¼Œéœ€å¤šæ¬¡ç”Ÿäº§)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">int</span> left = val;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">while</span> (left &gt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// åº“å­˜å·²æ»¡æ—¶ï¼Œç­‰å¾…â€œæ¶ˆè´¹è€…â€æ¶ˆè´¹äº§å“ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#fff;font-weight:bold">while</span> (size &gt;= capacity)
</span></span><span style="display:flex;"><span>                    wait();
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// è·å–â€œå®é™…ç”Ÿäº§çš„æ•°é‡â€(å³åº“å­˜ä¸­æ–°å¢çš„æ•°é‡)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#007f7f">// å¦‚æœâ€œåº“å­˜â€+â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€&gt;â€œæ€»çš„å®¹é‡â€ï¼Œåˆ™â€œå®é™…å¢é‡â€=â€œæ€»çš„å®¹é‡â€-â€œå½“å‰å®¹é‡â€ã€‚(æ­¤æ—¶å¡«æ»¡ä»“åº“)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#007f7f">// å¦åˆ™â€œå®é™…å¢é‡â€=â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#fff;font-weight:bold">int</span> inc = (size+left)&gt;capacity ? (capacity-size) : left;
</span></span><span style="display:flex;"><span>                size += inc;
</span></span><span style="display:flex;"><span>                left -= inc;
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">printf</span>(<span style="color:#0ff;font-weight:bold">&#34;%s produce(%3d) --&gt; left=%3d, inc=%3d, size=%3d\n&#34;</span>, 
</span></span><span style="display:flex;"><span>                        Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>(), val, left, inc, size);
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// é€šçŸ¥â€œæ¶ˆè´¹è€…â€å¯ä»¥æ¶ˆè´¹äº†ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                notifyAll();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">synchronized</span> <span style="color:#fff;font-weight:bold">void</span> consume(<span style="color:#fff;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// left è¡¨ç¤ºâ€œå®¢æˆ·è¦æ¶ˆè´¹æ•°é‡â€(æœ‰å¯èƒ½æ¶ˆè´¹é‡å¤ªå¤§ï¼Œåº“å­˜ä¸å¤Ÿï¼Œéœ€å¤šæ­¤æ¶ˆè´¹)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">int</span> left = val;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">while</span> (left &gt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// åº“å­˜ä¸º0æ—¶ï¼Œç­‰å¾…â€œç”Ÿäº§è€…â€ç”Ÿäº§äº§å“ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#fff;font-weight:bold">while</span> (size &lt;= <span style="color:#ff0;font-weight:bold">0</span>)
</span></span><span style="display:flex;"><span>                    wait();
</span></span><span style="display:flex;"><span>                <span style="color:#007f7f">// è·å–â€œå®é™…æ¶ˆè´¹çš„æ•°é‡â€(å³åº“å­˜ä¸­å®é™…å‡å°‘çš„æ•°é‡)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#007f7f">// å¦‚æœâ€œåº“å­˜â€&lt;â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ï¼Œåˆ™â€œå®é™…æ¶ˆè´¹é‡â€=â€œåº“å­˜â€ï¼›
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#007f7f">// å¦åˆ™ï¼Œâ€œå®é™…æ¶ˆè´¹é‡â€=â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                <span style="color:#fff;font-weight:bold">int</span> dec = (size&lt;left) ? size : left;
</span></span><span style="display:flex;"><span>                size -= dec;
</span></span><span style="display:flex;"><span>                left -= dec;
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">printf</span>(<span style="color:#0ff;font-weight:bold">&#34;%s consume(%3d) &lt;-- left=%3d, dec=%3d, size=%3d\n&#34;</span>, 
</span></span><span style="display:flex;"><span>                        Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>(), val, left, dec, size);
</span></span><span style="display:flex;"><span>                notifyAll();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> String toString() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#0ff;font-weight:bold">&#34;capacity:&#34;</span>+capacity+<span style="color:#0ff;font-weight:bold">&#34;, actual size:&#34;</span>+size;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>} 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ç”Ÿäº§è€…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> Producer {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> Depot depot;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Producer(Depot depot) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">depot</span> = depot;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å‘ä»“åº“ä¸­ç”Ÿäº§äº§å“ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> produce(<span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">new</span> Thread() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>                depot.<span style="color:#007f7f">produce</span>(val);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }.<span style="color:#007f7f">start</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// æ¶ˆè´¹è€…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> Customer {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> Depot depot;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Customer(Depot depot) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">depot</span> = depot;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ä»ä»“åº“ä¸­æ¶ˆè´¹äº§å“ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> consume(<span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">int</span> val) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">new</span> Thread() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>                depot.<span style="color:#007f7f">consume</span>(val);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }.<span style="color:#007f7f">start</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo1 {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        Depot mDepot = <span style="color:#fff;font-weight:bold">new</span> Depot(<span style="color:#ff0;font-weight:bold">100</span>);
</span></span><span style="display:flex;"><span>        Producer mPro = <span style="color:#fff;font-weight:bold">new</span> Producer(mDepot);
</span></span><span style="display:flex;"><span>        Customer mCus = <span style="color:#fff;font-weight:bold">new</span> Customer(mDepot);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        mPro.<span style="color:#007f7f">produce</span>(<span style="color:#ff0;font-weight:bold">60</span>);
</span></span><span style="display:flex;"><span>        mPro.<span style="color:#007f7f">produce</span>(<span style="color:#ff0;font-weight:bold">120</span>);
</span></span><span style="display:flex;"><span>        mCus.<span style="color:#007f7f">consume</span>(<span style="color:#ff0;font-weight:bold">90</span>);
</span></span><span style="display:flex;"><span>        mCus.<span style="color:#007f7f">consume</span>(<span style="color:#ff0;font-weight:bold">150</span>);
</span></span><span style="display:flex;"><span>        mPro.<span style="color:#007f7f">produce</span>(<span style="color:#ff0;font-weight:bold">110</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼š
(01) Produceræ˜¯â€œç”Ÿäº§è€…â€ç±»ï¼Œå®ƒä¸â€œä»“åº“(depot)â€å…³è”ã€‚å½“è°ƒç”¨â€œç”Ÿäº§è€…â€çš„produce()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å‘â€œä»“åº“â€ä¸­ç”Ÿäº§äº§å“ã€‚
(02) Customeræ˜¯â€œæ¶ˆè´¹è€…â€ç±»ï¼Œå®ƒä¸â€œä»“åº“(depot)â€å…³è”ã€‚å½“è°ƒç”¨â€œæ¶ˆè´¹è€…â€çš„consume()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶æ¶ˆè´¹â€œä»“åº“â€ä¸­çš„äº§å“ã€‚
(03) Depotæ˜¯â€œä»“åº“â€ç±»ï¼Œä»“åº“ä¸­è®°å½•â€œä»“åº“çš„å®¹é‡(capacity)â€ä»¥åŠâ€œä»“åº“ä¸­å½“å‰äº§å“æ•°ç›®(size)â€ã€‚
â€œä»“åº“â€ç±»çš„ç”Ÿäº§æ–¹æ³•produce()å’Œæ¶ˆè´¹æ–¹æ³•consume()æ–¹æ³•éƒ½æ˜¯synchronizedæ–¹æ³•ï¼Œè¿›å…¥synchronizedæ–¹æ³•ä½“ï¼Œæ„å‘³ç€è¿™ä¸ªçº¿ç¨‹è·å–åˆ°äº†è¯¥â€œä»“åº“â€å¯¹è±¡çš„åŒæ­¥é”ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€æ—¶é—´ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªèƒ½è¿è¡Œã€‚é€šè¿‡åŒæ­¥é”ï¼Œå®ç°äº†å¯¹â€œæ®‹é…·â€çš„äº’æ–¥è®¿é—®ã€‚
å¯¹äºç”Ÿäº§æ–¹æ³•produce()è€Œè¨€ï¼šå½“ä»“åº“æ»¡æ—¶ï¼Œç”Ÿäº§è€…çº¿ç¨‹ç­‰å¾…ï¼Œéœ€è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“ä¹‹åï¼Œç”Ÿäº§çº¿ç¨‹æ‰èƒ½ç”Ÿäº§ï¼›ç”Ÿäº§è€…çº¿ç¨‹ç”Ÿäº§å®Œäº§å“ä¹‹åï¼Œä¼šé€šè¿‡notifyAll()å”¤é†’åŒæ­¥é”ä¸Šçš„æ‰€æœ‰çº¿ç¨‹ï¼ŒåŒ…æ‹¬â€œæ¶ˆè´¹è€…çº¿ç¨‹â€ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„â€œé€šçŸ¥æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹â€ã€‚
å¯¹äºæ¶ˆè´¹æ–¹æ³•consume()è€Œè¨€ï¼šå½“ä»“åº“ä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ç­‰å¾…ï¼Œéœ€è¦ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§äº§å“ä¹‹åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹æ‰èƒ½æ¶ˆè´¹ï¼›æ¶ˆè´¹è€…çº¿ç¨‹æ¶ˆè´¹å®Œäº§å“ä¹‹åï¼Œä¼šé€šè¿‡notifyAll()å”¤é†’åŒæ­¥é”ä¸Šçš„æ‰€æœ‰çº¿ç¨‹ï¼ŒåŒ…æ‹¬â€œç”Ÿäº§è€…çº¿ç¨‹â€ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„â€œé€šçŸ¥ç”Ÿäº§è€…è¿›è¡Œç”Ÿäº§â€ã€‚</p>
<p>æŸä¸€æ¬¡è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Thread-0 produce( 60) --&gt; left=  0, inc= 60, size= 60
</span></span><span style="display:flex;"><span>Thread-4 produce(110) --&gt; left= 70, inc= 40, size=100
</span></span><span style="display:flex;"><span>Thread-2 consume( 90) &lt;-- left=  0, dec= 90, size= 10
</span></span><span style="display:flex;"><span>Thread-3 consume(150) &lt;-- left=140, dec= 10, size=  0
</span></span><span style="display:flex;"><span>Thread-1 produce(120) --&gt; left= 20, inc=100, size=100
</span></span><span style="display:flex;"><span>Thread-3 consume(150) &lt;-- left= 40, dec=100, size=  0
</span></span><span style="display:flex;"><span>Thread-4 produce(110) --&gt; left=  0, inc= 70, size= 70
</span></span><span style="display:flex;"><span>Thread-3 consume(150) &lt;-- left=  0, dec= 40, size= 30
</span></span><span style="display:flex;"><span>Thread-1 produce(120) --&gt; left=  0, inc= 20, size= 50
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/multithreading/">multithreading</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-juc%E5%8E%9F%E5%AD%90%E7%B1%BB/">
    <span class="title">Â« Prev</span>
    <br>
    <span>multithreading-JUCåŸå­ç±»</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-interrupt/">
    <span class="title">Next Â»</span>
    <br>
    <span>multithreading-interrupt</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="http://localhost:1313/">Wjy&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>