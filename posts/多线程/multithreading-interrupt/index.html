<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>multithreading-interrupt | Wjy&#39;s Blog</title>
<meta name="keywords" content="multithreading">
<meta name="description" content="interruptä»‹ç»
JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š
Interrupts this thread.
Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown.
If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.
If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread&rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException.
If this thread is blocked in a Selector then the thread&rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector&rsquo;s wakeup method were invoked.
If none of the previous conditions hold then this thread&rsquo;s interrupt status will be set.
Interrupting a thread that is not alive need not have any effect.">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-interrupt/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="multithreading-interrupt" />
<meta property="og:description" content="interruptä»‹ç»
JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š
Interrupts this thread.
Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown.
If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.
If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread&rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException.
If this thread is blocked in a Selector then the thread&rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector&rsquo;s wakeup method were invoked.
If none of the previous conditions hold then this thread&rsquo;s interrupt status will be set.
Interrupting a thread that is not alive need not have any effect." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-interrupt/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-26T16:50:17+00:00" />
<meta property="article:modified_time" content="2019-03-26T16:50:17+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="multithreading-interrupt"/>
<meta name="twitter:description" content="interruptä»‹ç»
JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š
Interrupts this thread.
Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown.
If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.
If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread&rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException.
If this thread is blocked in a Selector then the thread&rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector&rsquo;s wakeup method were invoked.
If none of the previous conditions hold then this thread&rsquo;s interrupt status will be set.
Interrupting a thread that is not alive need not have any effect."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "multithreading-interrupt",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-interrupt/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "multithreading-interrupt",
  "name": "multithreading-interrupt",
  "description": "interruptä»‹ç» JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š Interrupts this thread. Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown. If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException. If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread\u0026rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException. If this thread is blocked in a Selector then the thread\u0026rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector\u0026rsquo;s wakeup method were invoked. If none of the previous conditions hold then this thread\u0026rsquo;s interrupt status will be set. Interrupting a thread that is not alive need not have any effect.\n",
  "keywords": [
    "multithreading"
  ],
  "articleBody": "interruptä»‹ç» JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š Interrupts this thread. Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown. If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException. If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the threadâ€™s interrupt status will be set, and the thread will receive a ClosedByInterruptException. If this thread is blocked in a Selector then the threadâ€™s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selectorâ€™s wakeup method were invoked. If none of the previous conditions hold then this threadâ€™s interrupt status will be set. Interrupting a thread that is not alive need not have any effect.\ninterrupt()çš„ä½œç”¨æ˜¯ä¸­æ–­æœ¬çº¿ç¨‹ã€‚ æœ¬çº¿ç¨‹ä¸­æ–­è‡ªå·±æ˜¯è¢«å…è®¸çš„ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨æœ¬çº¿ç¨‹çš„interrupt()æ–¹æ³•æ—¶ï¼Œä¼šé€šè¿‡checkAccess()æ£€æŸ¥æƒé™ã€‚è¿™æœ‰å¯èƒ½æŠ›å‡ºSecurityExceptionå¼‚å¸¸ã€‚ å¦‚æœæœ¬çº¿ç¨‹æ˜¯å¤„äºé˜»å¡çŠ¶æ€ï¼Œè°ƒç”¨çº¿ç¨‹çš„wait(), wait(long)æˆ–wait(long, int)ã€join(), join(long), join(long, int)ã€sleep(long), sleep(long, int)ï¼Œéƒ½ä¼šè®©å®ƒè¿›å…¥é˜»å¡çŠ¶æ€ã€‚ è‹¥çº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨äº†å®ƒçš„interrupt()æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„ä¸­æ–­çŠ¶æ€ä¼šè¢«æ¸…é™¤å¹¶ä¸”ä¼šæ”¶åˆ°ä¸€ä¸ªInterruptedExceptionå¼‚å¸¸ã€‚ ä¾‹å¦‚ï¼Œçº¿ç¨‹é€šè¿‡wait()è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡interrupt()ä¸­æ–­è¯¥çº¿ç¨‹ï¼›è°ƒç”¨interrupt()ä¼šç«‹å³å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueï¼Œä½†æ˜¯ç”±äºçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥è¯¥ä¸­æ–­æ ‡è®°ä¼šç«‹å³è¢«æ¸…é™¤ä¸ºfalseï¼ŒåŒæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªInterruptedExceptionçš„å¼‚å¸¸ã€‚ å¦‚æœçº¿ç¨‹è¢«é˜»å¡åœ¨ä¸€ä¸ªSelectoré€‰æ‹©å™¨ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡interrupt()ä¸­æ–­å®ƒæ—¶ï¼›çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸ºinterrupt()ï¼Œå¹¶ä¸”å®ƒä¼šç«‹å³ä»é€‰æ‹©æ“ä½œä¸­è¿”å›ã€‚ å¦‚æœä¸å±äºå‰é¢æ‰€è¯´çš„æƒ…å†µï¼Œé‚£ä¹ˆé€šè¿‡interrupt()ä¸­æ–­çº¿ç¨‹æ—¶ï¼Œå®ƒçš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸ºtrueã€‚ ä¸­æ–­ä¸€ä¸ªå·²ç»ˆæ­¢çš„çº¿ç¨‹ä¸ä¼šäº§ç”Ÿä»»ä½•æ“ä½œã€‚\nç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼ Threadä¸­çš„stop()å’Œsuspend()æ–¹æ³•ï¼Œç”±äºå›ºæœ‰çš„ä¸å®‰å…¨æ€§ï¼Œå·²ç»å»ºè®®ä¸å†ä½¿ç”¨ã€‚ ä¸‹é¢ï¼Œæˆ‘å…ˆåˆ†åˆ«è®¨è®ºçº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€å’Œè¿è¡ŒçŠ¶æ€çš„ç»ˆæ­¢æ–¹å¼ï¼Œç„¶åå†æ€»ç»“å‡ºä¸€ä¸ªé€šç”¨çš„æ–¹å¼ã€‚\nç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡ä¸­æ–­æ–¹å¼ç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ã€‚ å½“çº¿ç¨‹ç”±äºè¢«è°ƒç”¨äº†sleep()ã€wait()ã€join()ç­‰æ–¹æ³•è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼›è‹¥æ­¤æ—¶è°ƒç”¨çº¿ç¨‹çš„interrupt()å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueã€‚ç”±äºå¤„äºé˜»å¡çŠ¶æ€ï¼Œä¸­æ–­æ ‡è®°ä¼šè¢«æ¸…é™¤ï¼ŒåŒæ—¶äº§ç”Ÿä¸€ä¸ªInterruptedExceptionå¼‚å¸¸ã€‚å°†InterruptedExceptionæ”¾åœ¨é€‚å½“çš„ä½ç½®å°±èƒ½ç»ˆæ­¢çº¿ç¨‹ï¼Œå½¢å¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 @Override public void run() { try { while (true) { // æ‰§è¡Œä»»åŠ¡... } } catch (InterruptedException ie) { // ç”±äºäº§ç”ŸInterruptedExceptionå¼‚å¸¸ï¼Œé€€å‡ºwhile(true)å¾ªç¯ï¼Œçº¿ç¨‹ç»ˆæ­¢ï¼ } } è¯´æ˜ï¼šåœ¨while(true)ä¸­ä¸æ–­çš„æ‰§è¡Œä»»åŠ¡ï¼Œå½“çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹çš„interrupt()äº§ç”ŸInterruptedExceptionä¸­æ–­ã€‚ä¸­æ–­çš„æ•è·åœ¨while(true)ä¹‹å¤–ï¼Œè¿™æ ·å°±é€€å‡ºäº†while(true)å¾ªç¯ã€‚ æ³¨æ„ï¼šå¯¹InterruptedExceptionçš„æ•è·åŠ¡ä¸€èˆ¬æ”¾åœ¨while(true)å¾ªç¯ä½“çš„å¤–é¢ï¼Œè¿™æ ·ï¼Œåœ¨äº§ç”Ÿå¼‚å¸¸æ—¶å°±é€€å‡ºäº†while(true)å¾ªç¯ã€‚å¦åˆ™ï¼ŒInterruptedExceptionåœ¨while(true)å¾ªç¯ä½“ä¹‹å†…ï¼Œå°±éœ€è¦é¢å¤–çš„æ·»åŠ é€€å‡ºå¤„ç†ã€‚å½¢å¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 @Override public void run() { while (true) { try { // æ‰§è¡Œä»»åŠ¡... } catch (InterruptedException ie) { // InterruptedExceptionåœ¨while(true)å¾ªç¯ä½“å†…ã€‚ // å½“çº¿ç¨‹äº§ç”Ÿäº†InterruptedExceptionå¼‚å¸¸æ—¶ï¼Œwhile(true)ä»èƒ½ç»§ç»­è¿è¡Œï¼éœ€è¦æ‰‹åŠ¨é€€å‡º break; } } } è¯´æ˜ï¼šä¸Šé¢çš„InterruptedExceptionå¼‚å¸¸çš„æ•è·åœ¨whle(true)ä¹‹å†…ã€‚å½“äº§ç”ŸInterruptedExceptionå¼‚å¸¸æ—¶ï¼Œè¢«catchå¤„ç†ä¹‹å¤–ï¼Œä»ç„¶åœ¨while(true)å¾ªç¯ä½“å†…ï¼›è¦é€€å‡ºwhile(true)å¾ªç¯ä½“ï¼Œéœ€è¦é¢å¤–çš„æ‰§è¡Œé€€å‡ºwhile(true)çš„æ“ä½œã€‚\nç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡æ ‡è®°æ–¹å¼ç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ã€‚å…¶ä¸­ï¼ŒåŒ…æ‹¬ä¸­æ–­æ ‡è®°å’Œé¢å¤–æ·»åŠ æ ‡è®°ã€‚\né€šè¿‡ä¸­æ–­æ ‡è®°ç»ˆæ­¢çº¿ç¨‹ã€‚ å½¢å¼å¦‚ä¸‹ï¼š 1 2 3 4 5 6 @Override public void run() { while (!isInterrupted()) { // æ‰§è¡Œä»»åŠ¡... } } è¯´æ˜ï¼š`isInterrupted()`æ˜¯åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°æ˜¯ä¸æ˜¯ä¸º`true`ã€‚å½“çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦ç»ˆæ­¢å®ƒæ—¶ï¼›å¯ä»¥è°ƒç”¨çº¿ç¨‹çš„`interrupt()`æ–¹æ³•ï¼Œä½¿ç”¨çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¸º`true`ï¼Œå³`isInterrupted()`ä¼šè¿”å›`true`ã€‚æ­¤æ—¶ï¼Œå°±ä¼šé€€å‡º`while`å¾ªç¯ã€‚ æ³¨æ„ï¼šinterrupt()å¹¶ä¸ä¼šç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹ï¼å®ƒä¼šå°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueã€‚\né¢å¤–æ·»åŠ æ ‡è®° å½¢å¼å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 private volatile boolean flag= true; protected void stopTask() { flag = false; } @Override public void run() { while (flag) { // æ‰§è¡Œä»»åŠ¡... } } è¯´æ˜ï¼šçº¿ç¨‹ä¸­æœ‰ä¸€ä¸ªflagæ ‡è®°ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯trueï¼›å¹¶ä¸”æˆ‘ä»¬æä¾›`stopTask()`æ¥è®¾ç½®flagæ ‡è®°ã€‚å½“æˆ‘ä»¬éœ€è¦ç»ˆæ­¢è¯¥çº¿ç¨‹æ—¶ï¼Œè°ƒç”¨è¯¥çº¿ç¨‹çš„`stopTask()`æ–¹æ³•å°±å¯ä»¥è®©çº¿ç¨‹é€€å‡ºwhileå¾ªç¯ã€‚ æ³¨æ„ï¼šå°†flagå®šä¹‰ä¸º`volatile`ç±»å‹ï¼Œæ˜¯ä¸ºäº†ä¿è¯flagçš„å¯è§æ€§ã€‚å³å…¶å®ƒçº¿ç¨‹é€šè¿‡`stopTask()`ä¿®æ”¹äº†flagä¹‹åï¼Œæœ¬çº¿ç¨‹èƒ½çœ‹åˆ°ä¿®æ”¹åçš„flagçš„å€¼ã€‚ é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼ ç»¼åˆçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€å’Œè¿è¡ŒçŠ¶æ€çš„ç»ˆæ­¢æ–¹å¼ï¼Œæ¯”è¾ƒé€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹çš„å½¢å¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 @Override public void run() { try { // 1. isInterrupted()ä¿è¯ï¼Œåªè¦ä¸­æ–­æ ‡è®°ä¸ºtrueå°±ç»ˆæ­¢çº¿ç¨‹ã€‚ while (!isInterrupted()) { // æ‰§è¡Œä»»åŠ¡... } } catch (InterruptedException ie) { // 2. InterruptedExceptionå¼‚å¸¸ä¿è¯ï¼Œå½“InterruptedExceptionå¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œçº¿ç¨‹è¢«ç»ˆæ­¢ã€‚ } } ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹ interrupt()å¸¸å¸¸è¢«ç”¨æ¥ç»ˆæ­¢é˜»å¡çŠ¶æ€çº¿ç¨‹ã€‚å‚è€ƒä¸‹é¢ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 // Demo1.javaçš„æºç  class MyThread extends Thread { public MyThread(String name) { super(name); } @Override public void run() { try { int i=0; while (!isInterrupted()) { Thread.sleep(100); // ä¼‘çœ 100ms i++; System.out.println(Thread.currentThread().getName()+\" (\"+this.getState()+\") loop \" + i); } } catch (InterruptedException e) { System.out.println(Thread.currentThread().getName() +\" (\"+this.getState()+\") catch InterruptedException.\"); } } } public class Demo1 { public static void main(String[] args) { try { Thread t1 = new MyThread(\"t1\"); // æ–°å»ºâ€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is new.\"); t1.start(); // å¯åŠ¨â€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is started.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚ Thread.sleep(300); t1.interrupt(); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚ Thread.sleep(300); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted now.\"); } catch (InterruptedException e) { e.printStackTrace(); } } } è¿è¡Œç»“æœï¼š\n1 2 3 4 5 6 7 t1 (NEW) is new. t1 (RUNNABLE) is started. t1 (RUNNABLE) loop 1 t1 (RUNNABLE) loop 2 t1 (TIMED_WAITING) is interrupted. t1 (RUNNABLE) catch InterruptedException. t1 (TERMINATED) is interrupted now. ç»“æœè¯´æ˜ï¼š\nä¸»çº¿ç¨‹mainä¸­é€šè¿‡new MyThread(â€œt1â€)åˆ›å»ºçº¿ç¨‹t1ï¼Œä¹‹åé€šè¿‡t1.start()å¯åŠ¨çº¿ç¨‹t1ã€‚ t1å¯åŠ¨ä¹‹åï¼Œä¼šä¸æ–­çš„æ£€æŸ¥å®ƒçš„ä¸­æ–­æ ‡è®°ï¼Œå¦‚æœä¸­æ–­æ ‡è®°ä¸ºâ€œfalseâ€ï¼›åˆ™ä¼‘çœ 100msã€‚ t1ä¼‘çœ ä¹‹åï¼Œä¼šåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹mainï¼›ä¸»çº¿ç¨‹å†æ¬¡è¿è¡Œæ—¶ï¼Œä¼šæ‰§è¡Œt1.interrupt()ä¸­æ–­çº¿ç¨‹t1ã€‚t1æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ä¹‹åï¼Œä¼šå°†t1çš„ä¸­æ–­æ ‡è®°è®¾ç½®â€œfalseâ€ï¼Œè€Œä¸”ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚åœ¨t1çš„run()æ–¹æ³•ä¸­ï¼Œæ˜¯åœ¨å¾ªç¯ä½“whileä¹‹å¤–æ•è·çš„å¼‚å¸¸ï¼›å› æ­¤å¾ªç¯è¢«ç»ˆæ­¢ã€‚ æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç»“æœè¿›è¡Œå°å°çš„ä¿®æ”¹ï¼Œå°†run()æ–¹æ³•ä¸­æ•è·InterruptedExceptionå¼‚å¸¸çš„ä»£ç å—ç§»åˆ°whileå¾ªç¯ä½“å†…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 // Demo2.javaçš„æºç  class MyThread extends Thread { public MyThread(String name) { super(name); } @Override public void run() { int i=0; while (!isInterrupted()) { try { Thread.sleep(100); // ä¼‘çœ 100ms } catch (InterruptedException ie) { System.out.println(Thread.currentThread().getName() +\" (\"+this.getState()+\") catch InterruptedException.\"); } i++; System.out.println(Thread.currentThread().getName()+\" (\"+this.getState()+\") loop \" + i); } } } public class Demo2 { public static void main(String[] args) { try { Thread t1 = new MyThread(\"t1\"); // æ–°å»ºâ€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is new.\"); t1.start(); // å¯åŠ¨â€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is started.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚ Thread.sleep(300); t1.interrupt(); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚ Thread.sleep(300); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted now.\"); } catch (InterruptedException e) { e.printStackTrace(); } } } è¿è¡Œç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 t1 (NEW) is new. t1 (RUNNABLE) is started. t1 (RUNNABLE) loop 1 t1 (RUNNABLE) loop 2 t1 (TIMED_WAITING) is interrupted. t1 (RUNNABLE) catch InterruptedException. t1 (RUNNABLE) loop 3 t1 (RUNNABLE) loop 4 t1 (RUNNABLE) loop 5 t1 (TIMED_WAITING) is interrupted now. t1 (RUNNABLE) loop 6 t1 (RUNNABLE) loop 7 t1 (RUNNABLE) loop 8 t1 (RUNNABLE) loop 9 ç»“æœè¯´æ˜ï¼š ç¨‹åºè¿›å…¥äº†æ­»å¾ªç¯ï¼ ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼Œt1åœ¨ç­‰å¾…(é˜»å¡)çŠ¶æ€æ—¶ï¼Œè¢«interrupt()ä¸­æ–­ï¼›æ­¤æ—¶ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°(å³isInterrupted()ä¼šè¿”å›false)ï¼Œè€Œä¸”ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸(è¯¥å¼‚å¸¸åœ¨whileå¾ªç¯ä½“å†…è¢«æ•è·)ã€‚å› æ­¤ï¼Œt1ç†æ‰€å½“ç„¶çš„ä¼šè¿›å…¥æ­»å¾ªç¯äº†ã€‚ è§£å†³è¯¥é—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬åœ¨æ•è·å¼‚å¸¸æ—¶ï¼Œé¢å¤–çš„è¿›è¡Œé€€å‡ºwhileå¾ªç¯çš„å¤„ç†ã€‚ ä¾‹å¦‚ï¼Œåœ¨MyThreadçš„catch(InterruptedException)ä¸­æ·»åŠ breakæˆ–returnå°±èƒ½è§£å†³è¯¥é—®é¢˜ã€‚\nä¸‹é¢æ˜¯é€šè¿‡é¢å¤–æ·»åŠ æ ‡è®°çš„æ–¹å¼ç»ˆæ­¢è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹çš„ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 // Demo3.javaçš„æºç  class MyThread extends Thread { private volatile boolean flag= true; public void stopTask() { flag = false; } public MyThread(String name) { super(name); } @Override public void run() { synchronized(this) { try { int i=0; while (flag) { Thread.sleep(100); // ä¼‘çœ 100ms i++; System.out.println(Thread.currentThread().getName()+\" (\"+this.getState()+\") loop \" + i); } } catch (InterruptedException ie) { System.out.println(Thread.currentThread().getName() +\" (\"+this.getState()+\") catch InterruptedException.\"); } } } } public class Demo3 { public static void main(String[] args) { try { MyThread t1 = new MyThread(\"t1\"); // æ–°å»ºâ€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is new.\"); t1.start(); // å¯åŠ¨â€œçº¿ç¨‹t1â€ System.out.println(t1.getName() +\" (\"+t1.getState()+\") is started.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚ Thread.sleep(300); t1.stopTask(); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted.\"); // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚ Thread.sleep(300); System.out.println(t1.getName() +\" (\"+t1.getState()+\") is interrupted now.\"); } catch (InterruptedException e) { e.printStackTrace(); } } } è¿è¡Œç»“æœï¼š\n1 2 3 4 5 6 7 t1 (NEW) is new. t1 (RUNNABLE) is started. t1 (RUNNABLE) loop 1 t1 (RUNNABLE) loop 2 t1 (TIMED_WAITING) is interrupted. t1 (RUNNABLE) loop 3 t1 (TERMINATED) is interrupted now. interrupted() å’Œ isInterrupted()çš„åŒºåˆ« interrupted()å’ŒisInterrupted()éƒ½èƒ½å¤Ÿç”¨äºæ£€æµ‹å¯¹è±¡çš„ä¸­æ–­æ ‡è®°ã€‚ åŒºåˆ«æ˜¯ï¼Œinterrupted()é™¤äº†è¿”å›ä¸­æ–­æ ‡è®°ä¹‹å¤–ï¼Œå®ƒè¿˜ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°(å³å°†ä¸­æ–­æ ‡è®°è®¾ä¸ºfalse)ï¼›è€ŒisInterrupted()ä»…ä»…è¿”å›ä¸­æ–­æ ‡è®°ã€‚\n",
  "wordCount" : "4032",
  "inLanguage": "en",
  "datePublished": "2019-03-26T16:50:17Z",
  "dateModified": "2019-03-26T16:50:17Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/posts/%E5%A4%9A%E7%BA%BF%E7%A8%8B/multithreading-interrupt/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcss.com/mathjax/3.0.5/es5/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      multithreading-interrupt
    </h1>
    <div class="post-meta"><span title='2019-03-26 16:50:17 +0000 UTC'>2019-03-26</span>&nbsp;Â·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#interrupt%e4%bb%8b%e7%bb%8d" aria-label="interruptä»‹ç»">interruptä»‹ç»</a></li>
                <li>
                    <a href="#%e7%bb%88%e6%ad%a2%e7%ba%bf%e7%a8%8b%e7%9a%84%e6%96%b9%e5%bc%8f" aria-label="ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼">ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼</a><ul>
                        
                <li>
                    <a href="#%e7%bb%88%e6%ad%a2%e5%a4%84%e4%ba%8e%e9%98%bb%e5%a1%9e%e7%8a%b6%e6%80%81%e7%9a%84%e7%ba%bf%e7%a8%8b" aria-label="ç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹">ç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹</a></li>
                <li>
                    <a href="#%e7%bb%88%e6%ad%a2%e5%a4%84%e4%ba%8e%e8%bf%90%e8%a1%8c%e7%8a%b6%e6%80%81%e7%9a%84%e7%ba%bf%e7%a8%8b" aria-label="ç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹">ç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹</a></li>
                <li>
                    <a href="#%e9%80%9a%e7%94%a8%e7%9a%84%e7%bb%88%e6%ad%a2%e7%ba%bf%e7%a8%8b%e6%96%b9%e5%bc%8f" aria-label="é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼">é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%bb%88%e6%ad%a2%e7%ba%bf%e7%a8%8b%e7%a4%ba%e4%be%8b" aria-label="ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹">ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹</a></li>
                <li>
                    <a href="#interrupted-%e5%92%8c-isinterrupted%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="interrupted() å’Œ isInterrupted()çš„åŒºåˆ«">interrupted() å’Œ isInterrupted()çš„åŒºåˆ«</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="interruptä»‹ç»">interruptä»‹ç»<a hidden class="anchor" aria-hidden="true" href="#interruptä»‹ç»">#</a></h1>
<p>JDK1.8å®˜æ–¹æ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š
Interrupts this thread.
Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown.
If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.
If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread&rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException.
If this thread is blocked in a Selector then the thread&rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector&rsquo;s wakeup method were invoked.
If none of the previous conditions hold then this thread&rsquo;s interrupt status will be set.
Interrupting a thread that is not alive need not have any effect.</p>
<p>interrupt()çš„ä½œç”¨æ˜¯ä¸­æ–­æœ¬çº¿ç¨‹ã€‚
æœ¬çº¿ç¨‹ä¸­æ–­è‡ªå·±æ˜¯è¢«å…è®¸çš„ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨æœ¬çº¿ç¨‹çš„interrupt()æ–¹æ³•æ—¶ï¼Œä¼šé€šè¿‡checkAccess()æ£€æŸ¥æƒé™ã€‚è¿™æœ‰å¯èƒ½æŠ›å‡ºSecurityExceptionå¼‚å¸¸ã€‚
å¦‚æœæœ¬çº¿ç¨‹æ˜¯å¤„äºé˜»å¡çŠ¶æ€ï¼Œè°ƒç”¨çº¿ç¨‹çš„<code>wait(), wait(long)æˆ–wait(long, int)</code>ã€<code>join(), join(long), join(long, int)</code>ã€<code>sleep(long), sleep(long, int)</code>ï¼Œéƒ½ä¼šè®©å®ƒè¿›å…¥é˜»å¡çŠ¶æ€ã€‚
è‹¥çº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨äº†å®ƒçš„<code>interrupt()</code>æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„<code>ä¸­æ–­çŠ¶æ€</code>ä¼šè¢«æ¸…é™¤å¹¶ä¸”ä¼šæ”¶åˆ°ä¸€ä¸ª<code>InterruptedException</code>å¼‚å¸¸ã€‚
ä¾‹å¦‚ï¼Œçº¿ç¨‹é€šè¿‡<code>wait()</code>è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡<code>interrupt()</code>ä¸­æ–­è¯¥çº¿ç¨‹ï¼›è°ƒç”¨<code>interrupt()</code>ä¼šç«‹å³å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸º<code>true</code>ï¼Œä½†æ˜¯ç”±äºçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥è¯¥<code>ä¸­æ–­æ ‡è®°</code>ä¼šç«‹å³è¢«æ¸…é™¤ä¸º<code>false</code>ï¼ŒåŒæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª<code>InterruptedException</code>çš„å¼‚å¸¸ã€‚
å¦‚æœçº¿ç¨‹è¢«é˜»å¡åœ¨ä¸€ä¸ª<code>Selectoré€‰æ‹©å™¨</code>ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡<code>interrupt()</code>ä¸­æ–­å®ƒæ—¶ï¼›çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸º<code>interrupt()</code>ï¼Œå¹¶ä¸”å®ƒä¼šç«‹å³ä»é€‰æ‹©æ“ä½œä¸­è¿”å›ã€‚
å¦‚æœä¸å±äºå‰é¢æ‰€è¯´çš„æƒ…å†µï¼Œé‚£ä¹ˆé€šè¿‡<code>interrupt()</code>ä¸­æ–­çº¿ç¨‹æ—¶ï¼Œå®ƒçš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸º<code>true</code>ã€‚
ä¸­æ–­ä¸€ä¸ª<code>å·²ç»ˆæ­¢çš„çº¿ç¨‹</code>ä¸ä¼šäº§ç”Ÿä»»ä½•æ“ä½œã€‚</p>
<h1 id="ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼">ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼<a hidden class="anchor" aria-hidden="true" href="#ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼">#</a></h1>
<p>Threadä¸­çš„stop()å’Œsuspend()æ–¹æ³•ï¼Œç”±äºå›ºæœ‰çš„ä¸å®‰å…¨æ€§ï¼Œå·²ç»å»ºè®®ä¸å†ä½¿ç”¨ã€‚
ä¸‹é¢ï¼Œæˆ‘å…ˆåˆ†åˆ«è®¨è®ºçº¿ç¨‹åœ¨<code>é˜»å¡çŠ¶æ€</code>å’Œ<code>è¿è¡ŒçŠ¶æ€</code>çš„ç»ˆæ­¢æ–¹å¼ï¼Œç„¶åå†æ€»ç»“å‡ºä¸€ä¸ªé€šç”¨çš„æ–¹å¼ã€‚</p>
<h2 id="ç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹">ç»ˆæ­¢å¤„äº<code>é˜»å¡çŠ¶æ€</code>çš„çº¿ç¨‹<a hidden class="anchor" aria-hidden="true" href="#ç»ˆæ­¢å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹">#</a></h2>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡<code>ä¸­æ–­</code>æ–¹å¼ç»ˆæ­¢å¤„äº<code>é˜»å¡çŠ¶æ€</code>çš„çº¿ç¨‹ã€‚
å½“çº¿ç¨‹ç”±äºè¢«è°ƒç”¨äº†<code>sleep()ã€wait()ã€join()</code>ç­‰æ–¹æ³•è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼›è‹¥æ­¤æ—¶è°ƒç”¨çº¿ç¨‹çš„<code>interrupt()</code>å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸º<code>true</code>ã€‚ç”±äºå¤„äºé˜»å¡çŠ¶æ€ï¼Œä¸­æ–­æ ‡è®°ä¼šè¢«æ¸…é™¤ï¼ŒåŒæ—¶äº§ç”Ÿä¸€ä¸ª<code>InterruptedException</code>å¼‚å¸¸ã€‚å°†<code>InterruptedException</code>æ”¾åœ¨é€‚å½“çš„ä½ç½®å°±èƒ½ç»ˆæ­¢çº¿ç¨‹ï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Override
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">while</span> (<span style="color:#fff;font-weight:bold">true</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ‰§è¡Œä»»åŠ¡...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException ie) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ç”±äºäº§ç”ŸInterruptedExceptionå¼‚å¸¸ï¼Œé€€å‡ºwhile(true)å¾ªç¯ï¼Œçº¿ç¨‹ç»ˆæ­¢ï¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼šåœ¨<code>while(true)</code>ä¸­ä¸æ–­çš„æ‰§è¡Œä»»åŠ¡ï¼Œå½“çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹çš„<code>interrupt()</code>äº§ç”Ÿ<code>InterruptedException</code>ä¸­æ–­ã€‚ä¸­æ–­çš„æ•è·åœ¨<code>while(true)</code>ä¹‹å¤–ï¼Œè¿™æ ·å°±é€€å‡ºäº†<code>while(true)</code>å¾ªç¯ã€‚
æ³¨æ„ï¼šå¯¹<code>InterruptedException</code>çš„æ•è·åŠ¡ä¸€èˆ¬æ”¾åœ¨<code>while(true)</code>å¾ªç¯ä½“çš„å¤–é¢ï¼Œè¿™æ ·ï¼Œåœ¨äº§ç”Ÿå¼‚å¸¸æ—¶å°±é€€å‡ºäº†<code>while(true)</code>å¾ªç¯ã€‚å¦åˆ™ï¼Œ<code>InterruptedException</code>åœ¨<code>while(true)</code>å¾ªç¯ä½“ä¹‹å†…ï¼Œå°±éœ€è¦é¢å¤–çš„æ·»åŠ é€€å‡ºå¤„ç†ã€‚å½¢å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Override
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (<span style="color:#fff;font-weight:bold">true</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ‰§è¡Œä»»åŠ¡...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException ie) {  
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// InterruptedExceptionåœ¨while(true)å¾ªç¯ä½“å†…ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#007f7f">// å½“çº¿ç¨‹äº§ç”Ÿäº†InterruptedExceptionå¼‚å¸¸æ—¶ï¼Œwhile(true)ä»èƒ½ç»§ç»­è¿è¡Œï¼éœ€è¦æ‰‹åŠ¨é€€å‡º
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            <span style="color:#fff;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼šä¸Šé¢çš„<code>InterruptedException</code>å¼‚å¸¸çš„æ•è·åœ¨<code>whle(true)</code>ä¹‹å†…ã€‚å½“äº§ç”Ÿ<code>InterruptedException</code>å¼‚å¸¸æ—¶ï¼Œè¢«catchå¤„ç†ä¹‹å¤–ï¼Œä»ç„¶åœ¨<code>while(true)</code>å¾ªç¯ä½“å†…ï¼›è¦é€€å‡º<code>while(true)</code>å¾ªç¯ä½“ï¼Œéœ€è¦é¢å¤–çš„æ‰§è¡Œé€€å‡º<code>while(true)</code>çš„æ“ä½œã€‚</p>
<h2 id="ç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹">ç»ˆæ­¢å¤„äº<code>è¿è¡ŒçŠ¶æ€</code>çš„çº¿ç¨‹<a hidden class="anchor" aria-hidden="true" href="#ç»ˆæ­¢å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹">#</a></h2>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡<code>æ ‡è®°</code>æ–¹å¼ç»ˆæ­¢å¤„äº<code>è¿è¡ŒçŠ¶æ€</code>çš„çº¿ç¨‹ã€‚å…¶ä¸­ï¼ŒåŒ…æ‹¬<code>ä¸­æ–­æ ‡è®°</code>å’Œ<code>é¢å¤–æ·»åŠ æ ‡è®°</code>ã€‚</p>
<ol>
<li>é€šè¿‡<code>ä¸­æ–­æ ‡è®°</code>ç»ˆæ­¢çº¿ç¨‹ã€‚
å½¢å¼å¦‚ä¸‹ï¼š</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Override
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (!isInterrupted()) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// æ‰§è¡Œä»»åŠ¡...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>è¯´æ˜ï¼š`isInterrupted()`æ˜¯åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°æ˜¯ä¸æ˜¯ä¸º`true`ã€‚å½“çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦ç»ˆæ­¢å®ƒæ—¶ï¼›å¯ä»¥è°ƒç”¨çº¿ç¨‹çš„`interrupt()`æ–¹æ³•ï¼Œä½¿ç”¨çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¸º`true`ï¼Œå³`isInterrupted()`ä¼šè¿”å›`true`ã€‚æ­¤æ—¶ï¼Œå°±ä¼šé€€å‡º`while`å¾ªç¯ã€‚
</code></pre>
<p>æ³¨æ„ï¼š<code>interrupt()</code>å¹¶ä¸ä¼šç»ˆæ­¢å¤„äº<code>è¿è¡ŒçŠ¶æ€</code>çš„çº¿ç¨‹ï¼å®ƒä¼šå°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueã€‚</p>
<ol start="2">
<li>é¢å¤–æ·»åŠ æ ‡è®°
å½¢å¼å¦‚ä¸‹ï¼š</li>
</ol>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">volatile</span> <span style="color:#fff;font-weight:bold">boolean</span> flag= <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> stopTask() {
</span></span><span style="display:flex;"><span>    flag = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@Override
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (flag) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// æ‰§è¡Œä»»åŠ¡...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>è¯´æ˜ï¼šçº¿ç¨‹ä¸­æœ‰ä¸€ä¸ªflagæ ‡è®°ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯trueï¼›å¹¶ä¸”æˆ‘ä»¬æä¾›`stopTask()`æ¥è®¾ç½®flagæ ‡è®°ã€‚å½“æˆ‘ä»¬éœ€è¦ç»ˆæ­¢è¯¥çº¿ç¨‹æ—¶ï¼Œè°ƒç”¨è¯¥çº¿ç¨‹çš„`stopTask()`æ–¹æ³•å°±å¯ä»¥è®©çº¿ç¨‹é€€å‡ºwhileå¾ªç¯ã€‚
æ³¨æ„ï¼šå°†flagå®šä¹‰ä¸º`volatile`ç±»å‹ï¼Œæ˜¯ä¸ºäº†ä¿è¯flagçš„å¯è§æ€§ã€‚å³å…¶å®ƒçº¿ç¨‹é€šè¿‡`stopTask()`ä¿®æ”¹äº†flagä¹‹åï¼Œæœ¬çº¿ç¨‹èƒ½çœ‹åˆ°ä¿®æ”¹åçš„flagçš„å€¼ã€‚
</code></pre>
<h2 id="é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼">é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼<a hidden class="anchor" aria-hidden="true" href="#é€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹æ–¹å¼">#</a></h2>
<p>ç»¼åˆçº¿ç¨‹å¤„äº<code>é˜»å¡çŠ¶æ€</code>å’Œ<code>è¿è¡ŒçŠ¶æ€</code>çš„ç»ˆæ­¢æ–¹å¼ï¼Œæ¯”è¾ƒé€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹çš„å½¢å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Override
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 1. isInterrupted()ä¿è¯ï¼Œåªè¦ä¸­æ–­æ ‡è®°ä¸ºtrueå°±ç»ˆæ­¢çº¿ç¨‹ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        <span style="color:#fff;font-weight:bold">while</span> (!isInterrupted()) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ‰§è¡Œä»»åŠ¡...
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException ie) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// 2. InterruptedExceptionå¼‚å¸¸ä¿è¯ï¼Œå½“InterruptedExceptionå¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œçº¿ç¨‹è¢«ç»ˆæ­¢ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹">ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#ç»ˆæ­¢çº¿ç¨‹ç¤ºä¾‹">#</a></h1>
<p><code>interrupt()</code>å¸¸å¸¸è¢«ç”¨æ¥ç»ˆæ­¢<code>é˜»å¡çŠ¶æ€</code>çº¿ç¨‹ã€‚å‚è€ƒä¸‹é¢ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// Demo1.javaçš„æºç 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> MyThread <span style="color:#fff;font-weight:bold">extends</span> Thread {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyThread(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {  
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">while</span> (!isInterrupted()) {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">100</span>); <span style="color:#007f7f">// ä¼‘çœ 100ms
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                i++;
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()+<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) loop &#34;</span> + i);  
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {  
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) catch InterruptedException.&#34;</span>);  
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo1 {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {  
</span></span><span style="display:flex;"><span>            Thread t1 = <span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t1&#34;</span>);  <span style="color:#007f7f">// æ–°å»ºâ€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is new.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨â€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is started.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">interrupt</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted now.&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {  
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>t1 (NEW) is new.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) is started.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 1
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 2
</span></span><span style="display:flex;"><span>t1 (TIMED_WAITING) is interrupted.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) catch InterruptedException.
</span></span><span style="display:flex;"><span>t1 (TERMINATED) is interrupted now.
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¯´æ˜ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹mainä¸­é€šè¿‡new MyThread(&ldquo;t1&rdquo;)åˆ›å»ºçº¿ç¨‹t1ï¼Œä¹‹åé€šè¿‡t1.start()å¯åŠ¨çº¿ç¨‹t1ã€‚</li>
<li>t1å¯åŠ¨ä¹‹åï¼Œä¼šä¸æ–­çš„æ£€æŸ¥å®ƒçš„ä¸­æ–­æ ‡è®°ï¼Œå¦‚æœä¸­æ–­æ ‡è®°ä¸ºâ€œfalseâ€ï¼›åˆ™ä¼‘çœ 100msã€‚</li>
<li>t1ä¼‘çœ ä¹‹åï¼Œä¼šåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹mainï¼›ä¸»çº¿ç¨‹å†æ¬¡è¿è¡Œæ—¶ï¼Œä¼šæ‰§è¡Œt1.interrupt()ä¸­æ–­çº¿ç¨‹t1ã€‚t1æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ä¹‹åï¼Œä¼šå°†t1çš„ä¸­æ–­æ ‡è®°è®¾ç½®â€œfalseâ€ï¼Œè€Œä¸”ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚åœ¨t1çš„run()æ–¹æ³•ä¸­ï¼Œæ˜¯åœ¨å¾ªç¯ä½“whileä¹‹å¤–æ•è·çš„å¼‚å¸¸ï¼›å› æ­¤å¾ªç¯è¢«ç»ˆæ­¢ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯¹ä¸Šé¢çš„ç»“æœè¿›è¡Œå°å°çš„ä¿®æ”¹ï¼Œå°†run()æ–¹æ³•ä¸­æ•è·InterruptedExceptionå¼‚å¸¸çš„ä»£ç å—ç§»åˆ°whileå¾ªç¯ä½“å†…ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// Demo2.javaçš„æºç 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> MyThread <span style="color:#fff;font-weight:bold">extends</span> Thread {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyThread(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">while</span> (!isInterrupted()) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">100</span>); <span style="color:#007f7f">// ä¼‘çœ 100ms
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException ie) {  
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) catch InterruptedException.&#34;</span>);  
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            i++;
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()+<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) loop &#34;</span> + i);  
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo2 {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {  
</span></span><span style="display:flex;"><span>            Thread t1 = <span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t1&#34;</span>);  <span style="color:#007f7f">// æ–°å»ºâ€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is new.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨â€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is started.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">interrupt</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted now.&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {  
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>t1 (NEW) is new.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) is started.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 1
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 2
</span></span><span style="display:flex;"><span>t1 (TIMED_WAITING) is interrupted.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) catch InterruptedException.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 3
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 4
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 5
</span></span><span style="display:flex;"><span>t1 (TIMED_WAITING) is interrupted now.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 6
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 7
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 8
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 9
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœè¯´æ˜ï¼š
ç¨‹åºè¿›å…¥äº†æ­»å¾ªç¯ï¼
ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼Œt1åœ¨<code>ç­‰å¾…(é˜»å¡)çŠ¶æ€</code>æ—¶ï¼Œè¢«<code>interrupt()</code>ä¸­æ–­ï¼›æ­¤æ—¶ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°(å³<code>isInterrupted()</code>ä¼šè¿”å›false)ï¼Œè€Œä¸”ä¼šæŠ›å‡º<code>InterruptedException</code>å¼‚å¸¸(è¯¥å¼‚å¸¸åœ¨whileå¾ªç¯ä½“å†…è¢«æ•è·)ã€‚å› æ­¤ï¼Œt1ç†æ‰€å½“ç„¶çš„ä¼šè¿›å…¥æ­»å¾ªç¯äº†ã€‚
è§£å†³è¯¥é—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬åœ¨æ•è·å¼‚å¸¸æ—¶ï¼Œé¢å¤–çš„è¿›è¡Œé€€å‡ºwhileå¾ªç¯çš„å¤„ç†ã€‚
ä¾‹å¦‚ï¼Œåœ¨<code>MyThreadçš„catch(InterruptedException)</code>ä¸­æ·»åŠ <code>break</code>æˆ–<code>return</code>å°±èƒ½è§£å†³è¯¥é—®é¢˜ã€‚</p>
<p>ä¸‹é¢æ˜¯é€šè¿‡<code>é¢å¤–æ·»åŠ æ ‡è®°</code>çš„æ–¹å¼ç»ˆæ­¢<code>è¿è¡ŒçŠ¶æ€</code>çš„çº¿ç¨‹çš„ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// Demo3.javaçš„æºç 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">class</span> MyThread <span style="color:#fff;font-weight:bold">extends</span> Thread {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">volatile</span> <span style="color:#fff;font-weight:bold">boolean</span> flag= <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> stopTask() {
</span></span><span style="display:flex;"><span>        flag = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> MyThread(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">super</span>(name);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">synchronized</span>(<span style="color:#fff;font-weight:bold">this</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">int</span> i=<span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">while</span> (flag) {
</span></span><span style="display:flex;"><span>                    Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">100</span>); <span style="color:#007f7f">// ä¼‘çœ 100ms
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>                    i++;
</span></span><span style="display:flex;"><span>                    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>()+<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) loop &#34;</span> + i);  
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException ie) {  
</span></span><span style="display:flex;"><span>                System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(Thread.<span style="color:#007f7f">currentThread</span>().<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+<span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) catch InterruptedException.&#34;</span>);  
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }  
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> Demo3 {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">try</span> {  
</span></span><span style="display:flex;"><span>            MyThread t1 = <span style="color:#fff;font-weight:bold">new</span> MyThread(<span style="color:#0ff;font-weight:bold">&#34;t1&#34;</span>);  <span style="color:#007f7f">// æ–°å»ºâ€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is new.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">start</span>();                      <span style="color:#007f7f">// å¯åŠ¨â€œçº¿ç¨‹t1â€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is started.&#34;</span>);  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            t1.<span style="color:#007f7f">stopTask</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted.&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>            Thread.<span style="color:#007f7f">sleep</span>(<span style="color:#ff0;font-weight:bold">300</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(t1.<span style="color:#007f7f">getName</span>() +<span style="color:#0ff;font-weight:bold">&#34; (&#34;</span>+t1.<span style="color:#007f7f">getState</span>()+<span style="color:#0ff;font-weight:bold">&#34;) is interrupted now.&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#fff;font-weight:bold">catch</span> (InterruptedException e) {  
</span></span><span style="display:flex;"><span>            e.<span style="color:#007f7f">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>t1 (NEW) is new.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) is started.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 1
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 2
</span></span><span style="display:flex;"><span>t1 (TIMED_WAITING) is interrupted.
</span></span><span style="display:flex;"><span>t1 (RUNNABLE) loop 3
</span></span><span style="display:flex;"><span>t1 (TERMINATED) is interrupted now.
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="interrupted-å’Œ-isinterruptedçš„åŒºåˆ«">interrupted() å’Œ isInterrupted()çš„åŒºåˆ«<a hidden class="anchor" aria-hidden="true" href="#interrupted-å’Œ-isinterruptedçš„åŒºåˆ«">#</a></h1>
<p><code>interrupted()</code>å’Œ<code>isInterrupted()</code>éƒ½èƒ½å¤Ÿç”¨äºæ£€æµ‹å¯¹è±¡çš„<code>ä¸­æ–­æ ‡è®°</code>ã€‚
åŒºåˆ«æ˜¯ï¼Œ<code>interrupted()</code>é™¤äº†è¿”å›ä¸­æ–­æ ‡è®°ä¹‹å¤–ï¼Œå®ƒè¿˜ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°(å³å°†ä¸­æ–­æ ‡è®°è®¾ä¸ºfalse)ï¼›è€Œ<code>isInterrupted()</code>ä»…ä»…è¿”å›ä¸­æ–­æ ‡è®°ã€‚</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/tags/multithreading/">multithreading</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://funny-toffee-4aa7c3.netlify.app/">Wjy&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>