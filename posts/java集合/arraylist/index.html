<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ArrayList | Wjy&#39;s Blog</title>
<meta name="keywords" content="Javaé›†åˆ">
<meta name="description" content="ArrayListæ¦‚è¿°
ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚
å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚

ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚
ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚
ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚
ArrayList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚
">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://funny-toffee-4aa7c3.netlify.app/posts/java%E9%9B%86%E5%90%88/arraylist/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://funny-toffee-4aa7c3.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://funny-toffee-4aa7c3.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://funny-toffee-4aa7c3.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://funny-toffee-4aa7c3.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://funny-toffee-4aa7c3.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://funny-toffee-4aa7c3.netlify.app/posts/java%E9%9B%86%E5%90%88/arraylist/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:url" content="https://funny-toffee-4aa7c3.netlify.app/posts/java%E9%9B%86%E5%90%88/arraylist/">
  <meta property="og:site_name" content="Wjy&#39;s Blog">
  <meta property="og:title" content="ArrayList">
  <meta property="og:description" content="ArrayListæ¦‚è¿° ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚ å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚
ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚ ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚ ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚ ArrayList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚ ">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-12-11T09:01:24+00:00">
    <meta property="article:modified_time" content="2016-12-11T09:01:24+00:00">
    <meta property="article:tag" content="Javaé›†åˆ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ArrayList">
<meta name="twitter:description" content="ArrayListæ¦‚è¿°
ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚
å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚

ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚
ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚
ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚
ArrayList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚
">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ArrayList",
      "item": "https://funny-toffee-4aa7c3.netlify.app/posts/java%E9%9B%86%E5%90%88/arraylist/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ArrayList",
  "name": "ArrayList",
  "description": "ArrayListæ¦‚è¿° ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚ å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚\nArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚ ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚ ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚ ArrayList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚ ",
  "keywords": [
    "Javaé›†åˆ"
  ],
  "articleBody": "ArrayListæ¦‚è¿° ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚ å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚\nArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚ ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚ ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚ ArrayList å®ç°java.io.Serializableæ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚ æ¯ä¸ªArrayListå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ï¼Œè¯¥å®¹é‡æ˜¯æŒ‡ç”¨æ¥å­˜å‚¨åˆ—è¡¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ï¼Œå®ƒæ€»æ˜¯è‡³å°‘ç­‰äºåˆ—è¡¨çš„å¤§å°ã€‚ éšç€å‘ArrayListä¸­ä¸æ–­æ·»åŠ å…ƒç´ ï¼Œå…¶å®¹é‡ä¹Ÿè‡ªåŠ¨å¢é•¿ã€‚è‡ªåŠ¨å¢é•¿ä¼šå¸¦æ¥æ•°æ®å‘æ–°æ•°ç»„çš„é‡æ–°æ‹·è´ï¼Œå› æ­¤ï¼Œå¦‚æœå¯é¢„çŸ¥æ•°æ®é‡çš„å¤šå°‘ï¼Œå¯åœ¨æ„é€ ArrayListæ—¶æŒ‡å®šå…¶å®¹é‡ã€‚ åœ¨æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œåº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥ä½¿ç”¨ensureCapacityæ“ä½œæ¥å¢åŠ ArrayListå®ä¾‹çš„å®¹é‡ï¼Œè¿™å¯ä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚ æ³¨ï¼šå»ºè®®åœ¨å•çº¿ç¨‹ä¸­æ‰ä½¿ç”¨ArrayListï¼Œè€Œåœ¨å¤šçº¿ç¨‹ä¸­ä½¿ç”¨CopyOnWriteArrayListã€‚\nArrayListæ„é€ å‡½æ•° ArrayList æœ‰ä¸‰ä¸ªæ„é€ å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 /** * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºåˆ—è¡¨ * @param initialCapacity ArrayListçš„åˆå§‹å®¹é‡ * @throws IllegalArgumentException å¦‚æœç»™å®šçš„åˆå§‹å®¹é‡ä¸ºè´Ÿå€¼ */ public ArrayList(int initialCapacity) { if (initialCapacity \u003e 0) { this.elementData = new Object[initialCapacity]; } else if (initialCapacity == 0) { this.elementData = EMPTY_ELEMENTDATA; } else { throw new IllegalArgumentException(\"Illegal Capacity: \"+ initialCapacity); } } // æ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡ä¸º10çš„ç©ºåˆ—è¡¨ public ArrayList() { this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA; } /** * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šcollectionçš„å…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ æŒ‰ç…§è¯¥collectionçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåºæ’åˆ—çš„ * @param c åŒ…å«ç”¨äºå»æ„é€ ArrayListçš„å…ƒç´ çš„collection * @throws NullPointerException å¦‚æœæŒ‡å®šçš„collectionä¸ºç©º */ public ArrayList(Collection\u003c? extends E\u003e c) { elementData = c.toArray(); if ((size = elementData.length) != 0) { // c.toArray()å¯èƒ½ä¸ä¼šæ­£ç¡®åœ°è¿”å›ä¸€ä¸ª Object[]æ•°ç»„ï¼Œé‚£ä¹ˆä½¿ç”¨Arrays.copyOf()æ–¹æ³• if (elementData.getClass() != Object[].class) //Arrays.copyOf()è¿”å›ä¸€ä¸ª Object[].classç±»å‹çš„ï¼Œå¤§å°ä¸ºsizeï¼Œå…ƒç´ ä¸ºelementData[0,...,size-1] elementData = Arrays.copyOf(elementData, size, Object[].class); } else { // replace with empty array. this.elementData = EMPTY_ELEMENTDATA; } } ArrayListæ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡ä¸º10çš„ç©ºåˆ—è¡¨è¿‡ç¨‹ï¼š\nåˆå§‹æƒ…å†µï¼šelementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}ï¼› size = 0; å½“å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œé€šè¿‡add(E e)æ–¹æ³•ä¸­è°ƒç”¨çš„ensureCapacityInternal(size + 1)æ–¹æ³•ï¼Œå³ensureCapacityInternal(1)ï¼› åœ¨ensureCapacityInternal(int minCapacity)æ–¹æ³•ä¸­ï¼Œå¯å¾—çš„minCapacity=DEFAULT_CAPACITY=10ï¼Œç„¶åå†è°ƒç”¨ensureExplicitCapacity(minCapacity)æ–¹æ³•ï¼Œå³ensureExplicitCapacity(10)ï¼› åœ¨ensureExplicitCapacity(minCapacity)æ–¹æ³•ä¸­è°ƒç”¨grow(minCapacity)æ–¹æ³•ï¼Œå³grow(10)ï¼Œæ­¤å¤„ä¸ºçœŸæ­£å…·ä½“çš„æ•°ç»„æ‰©å®¹çš„ç®—æ³•ï¼Œåœ¨æ­¤æ–¹æ³•ä¸­ï¼Œé€šè¿‡elementData = Arrays.copyOf(elementData, 10)å…·ä½“å®ç°äº†elementDataæ•°ç»„åˆå§‹å®¹é‡ä¸º10çš„æ„é€ ã€‚ API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // Collectionä¸­å®šä¹‰çš„API boolean add(E object) boolean addAll(Collection\u003c? extends E\u003e collection) void clear() boolean contains(Object object) boolean containsAll(Collection\u003c?\u003e collection) boolean equals(Object object) int hashCode() boolean isEmpty() Iterator iterator() boolean remove(Object object) boolean removeAll(Collection\u003c?\u003e collection) boolean retainAll(Collection\u003c?\u003e collection) int size() T[] toArray(T[] array) Object[] toArray() // AbstractCollectionä¸­å®šä¹‰çš„API void add(int location, E object) boolean addAll(int location, Collection\u003c? extends E\u003e collection) E get(int location) int indexOf(Object object) int lastIndexOf(Object object) ListIterator listIterator(int location) ListIterator listIterator() E remove(int location) E set(int location, E object) List subList(int start, int end) // ArrayListæ–°å¢çš„API Object clone() void ensureCapacity(int minimumCapacity) void trimToSize() void removeRange(int fromIndex, int toIndex) ArrayListæ•°æ®ç»“æ„ ArrayListçš„ç»§æ‰¿å…³ç³»\n1 2 3 4 5 6 7 java.lang.Object â†³ java.util.AbstractCollection â†³ java.util.AbstractList â†³ java.util.ArrayList public class ArrayList extends AbstractList implements List, RandomAccess, Cloneable, java.io.Serializable {} ArrayListä¸Collectionçš„å…³ç³»å›¾ ArrayListåŒ…å«äº†ä¸¤ä¸ªé‡è¦çš„å¯¹è±¡ï¼šelementData å’Œ sizeã€‚\nelementDataæ˜¯Object[]ç±»å‹çš„æ•°ç»„ï¼Œå®ƒä¿å­˜äº†æ·»åŠ åˆ°ArrayListä¸­çš„å…ƒç´ ã€‚ å®é™…ä¸Šï¼ŒelementDataæ˜¯ä¸ªåŠ¨æ€æ•°ç»„ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡æ„é€ å‡½æ•°ArrayList(int initialCapacity)æ¥ç¡®ä¿å®ƒçš„åˆå§‹å®¹é‡ä¸ºinitialCapacityã€‚ å¦‚æœé€šè¿‡ä¸å«å‚æ•°çš„æ„é€ å‡½æ•°ArrayList()æ¥åˆ›å»º ArrayListï¼Œåˆ™elementDataçš„å®¹é‡é»˜è®¤æ˜¯10ã€‚ elementDataæ•°ç»„çš„å¤§å°ä¼šæ ¹æ®ArrayListå®¹é‡çš„å¢é•¿è€ŒåŠ¨æ€çš„å¢é•¿ï¼Œå…·ä½“çš„å¢é•¿æ–¹å¼ï¼Œè¯·å‚è€ƒæºç åˆ†æä¸­çš„ensureCapacity()å‡½æ•°ã€‚ size åˆ™æ˜¯åŠ¨æ€æ•°ç»„çš„å®é™…å¤§å°ã€‚ é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªç»å¸¸ç”¨åˆ°çš„å±æ€§å°±æ˜¯ä»AbstractListç»§æ‰¿è¿‡æ¥çš„modCountå±æ€§ï¼Œä»£è¡¨ArrayListé›†åˆçš„ä¿®æ”¹æ¬¡æ•°ã€‚\nArrayListæºç è§£æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 //é€šè¿‡ArrayListå®ç°çš„æ¥å£å¯çŸ¥ï¼Œå…¶æ”¯æŒéšæœºè®¿é—®ï¼Œèƒ½è¢«å…‹éš†ï¼Œæ”¯æŒåºåˆ—åŒ– public class ArrayList extends AbstractList implements List, RandomAccess, Cloneable, java.io.Serializable { //åºåˆ—ç‰ˆæœ¬å· private static final long serialVersionUID = 8683452581122892189L; //é»˜è®¤åˆå§‹å®¹é‡ private static final int DEFAULT_CAPACITY = 10; //è¢«ç”¨äºç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ private static final Object[] EMPTY_ELEMENTDATA = {}; //è¢«ç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹çš„å…±äº«æ•°ç»„å®ä¾‹ã€‚å…¶ä¸EMPTY_ELEMENTDATAçš„åŒºåˆ«æ˜¯ï¼šå½“æˆ‘ä»¬å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼ŒçŸ¥é“æ•°ç»„è¯¥æ‰©å……å¤šå°‘ã€‚ private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}; /** * Object[]ç±»å‹çš„æ•°ç»„ï¼Œä¿å­˜äº†æ·»åŠ åˆ°ArrayListä¸­çš„å…ƒç´ ã€‚ArrayListçš„å®¹é‡æ˜¯è¯¥Object[]ç±»å‹æ•°ç»„çš„é•¿åº¦ * å½“ç¬¬ä¸€ä¸ªå…ƒç´ è¢«æ·»åŠ æ—¶ï¼Œä»»ä½•ç©ºArrayListä¸­çš„elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATAå°†ä¼šè¢« * æ‰©å……åˆ°DEFAULT_CAPACITYï¼ˆé»˜è®¤å®¹é‡ï¼‰ã€‚ */ transient Object[] elementData; //éprivateæ˜¯ä¸ºäº†æ–¹ä¾¿åµŒå¥—ç±»çš„è®¿é—® // ArrayListçš„å¤§å°ï¼ˆæŒ‡å…¶æ‰€å«çš„å…ƒç´ ä¸ªæ•°ï¼‰ private int size; ...... } ArrayList å®é™…ä¸Šæ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„å»ä¿å­˜æ•°æ®çš„ã€‚å½“æˆ‘ä»¬æ„é€ ArrayListæ—¶ï¼›è‹¥ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼Œåˆ™ArrayListçš„é»˜è®¤å®¹é‡å¤§å°æ˜¯10ã€‚\nè°ƒæ•´æ•°ç»„çš„å®¹é‡ jdk1.8 ä»add()ä¸addAll()æ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯å½“å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œéƒ½è¦å»æ£€æŸ¥æ·»åŠ å…ƒç´ åçš„ä¸ªæ•°æ˜¯å¦ä¼šè¶…å‡ºå½“å‰æ•°ç»„çš„é•¿åº¦ï¼Œå¦‚æœè¶…å‡ºï¼Œæ•°ç»„å°†ä¼šè¿›è¡Œæ‰©å®¹ï¼Œä»¥æ»¡è¶³æ·»åŠ æ•°æ®çš„éœ€æ±‚ã€‚æ•°ç»„æ‰©å®¹å®è´¨ä¸Šæ˜¯é€šè¿‡ç§æœ‰çš„æ–¹æ³•grow(int minCapacity)æ¥å®ç°çš„ï¼Œä½†åœ¨jdk1.8ä¸­ï¼Œå‘ç”¨æˆ·æä¾›äº†ä¸€ä¸ªpublicçš„æ–¹æ³•ensureCapacity(int minCapacity)ä½¿ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨çš„è®¾ç½®ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚ æ­¤å¤„ä¸jdk1.6ä¸­ç›´æ¥é€šè¿‡ä¸€ä¸ªå…¬å¼€çš„æ–¹æ³• ensureCapacity(int minCapacity) æ¥å®ç°æ•°ç»„å®¹é‡çš„è°ƒæ•´æœ‰åŒºåˆ«ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 /** * publicæ–¹æ³•ï¼Œè®©ç”¨æˆ·èƒ½æ‰‹åŠ¨è®¾ç½®ArrayListçš„å®¹é‡ * @param minCapacity æœŸæœ›çš„æœ€å°å®¹é‡ */ public void ensureCapacity(int minCapacity) { int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) // any size if not default element table ? 0 // larger than default for default empty table. It's already // supposed to be at default size. : DEFAULT_CAPACITY; if (minCapacity \u003e minExpand) { ensureExplicitCapacity(minCapacity); } } private void ensureCapacityInternal(int minCapacity) { //å½“elementDataä¸ºç©ºæ—¶ï¼ŒArrayListçš„åˆå§‹å®¹é‡æœ€å°ä¸ºDEFAULT_CAPACITYï¼ˆ10ï¼‰ if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); } ensureExplicitCapacity(minCapacity); } private void ensureExplicitCapacity(int minCapacity) { modCount++; // overflow-conscious code if (minCapacity - elementData.length \u003e 0) grow(minCapacity); } //æ•°ç»„å¯è¢«åˆ†é…çš„æœ€å¤§å®¹é‡ï¼›å½“éœ€è¦çš„æ•°ç»„å°ºå¯¸è¶…è¿‡VMçš„é™åˆ¶æ—¶ï¼Œå¯èƒ½å¯¼è‡´OutOfMemoryError private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; /** * å¢åŠ æ•°ç»„çš„å®¹é‡ï¼Œç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³æŒ‡å®šçš„æœ€å°å®¹é‡çš„å…ƒç´ é‡ * @param minCapacity æœŸæœ›çš„æœ€å°å®¹é‡ */ private void grow(int minCapacity) { // overflow-conscious code int oldCapacity = elementData.length; //æ³¨æ„æ­¤å¤„æ‰©å……capacityçš„æ–¹å¼æ˜¯å°†å…¶å‘å³ä¸€ä½å†åŠ ä¸ŠåŸæ¥çš„æ•°ï¼Œå®é™…ä¸Šæ˜¯æ‰©å……äº†1.5å€ int newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1); if (newCapacity - minCapacity \u003c 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE \u003e 0) newCapacity = hugeCapacity(minCapacity); //è®¾ç½®æ•°ç»„å¯è¢«åˆ†é…çš„æœ€å¤§å®¹é‡ // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); } private static int hugeCapacity(int minCapacity) { if (minCapacity \u003c 0) // overflow throw new OutOfMemoryError(); return (minCapacity \u003e MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE; } ä¸ºä»€ä¹ˆArrayListè‡ªåŠ¨å®¹é‡æ‰©å……é€‰æ‹©æ‰©å……1.5å€ï¼Ÿ è¿™ç§ç®—æ³•æ„é€ å‡ºæ¥çš„æ–°çš„æ•°ç»„é•¿åº¦çš„å¢é‡éƒ½ä¼šæ¯”ä¸Šä¸€æ¬¡å¤§( è€Œä¸”æ˜¯è¶Šæ¥è¶Šå¤§) ï¼Œå³è®¤ä¸ºç”¨æˆ·éœ€è¦å¢åŠ çš„æ•°æ®å¾ˆå¤šï¼Œè€Œé¿å…é¢‘ç¹newInstanceçš„æƒ…å†µã€‚\næ·»åŠ å…ƒç´  1 2 3 4 add(E e) add(int index, E element) addAll(Collection\u003c? extends E\u003e c) addAll(int index, Collection\u003c? extends E\u003e c) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 //å°†æŒ‡å®šçš„å…ƒç´ (E e)æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„å°¾éƒ¨ public boolean add(E e) { ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true; } //å°†æŒ‡å®šçš„å…ƒç´ (E e)æ’å…¥åˆ°åˆ—è¡¨çš„æŒ‡å®šä½ç½®(index) public void add(int index, E element) { rangeCheckForAdd(index); //åˆ¤æ–­å‚æ•°indexæ˜¯å¦IndexOutOfBoundsException ensureCapacityInternal(size + 1); // Increments modCount!! å¦‚æœæ•°ç»„é•¿åº¦ä¸è¶³ï¼Œå°†è¿›è¡Œæ‰©å®¹ System.arraycopy(elementData, index, elementData, index + 1, size - index); //å°†æºæ•°ç»„ä¸­ä»indexä½ç½®å¼€å§‹åçš„size-indexä¸ªå…ƒç´ ç»Ÿä¸€åç§»ä¸€ä½ elementData[index] = element; size++; } /** * æŒ‰ç…§æŒ‡å®šcollectionçš„è¿­ä»£å™¨æ‰€è¿”å›çš„å…ƒç´ é¡ºåºï¼Œå°†è¯¥collectionä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„å°¾éƒ¨ * @throws NullPointerException if the specified collection is null */ public boolean addAll(Collection\u003c? extends E\u003e c) { Object[] a = c.toArray(); int numNew = a.length; ensureCapacityInternal(size + numNew); // Increments modCount //å°†æ•°ç»„a[0,...,numNew-1]å¤åˆ¶åˆ°æ•°ç»„elementData[size,...,size+numNew-1] System.arraycopy(a, 0, elementData, size, numNew); size += numNew; return numNew != 0; } /** * ä»æŒ‡å®šçš„ä½ç½®å¼€å§‹ï¼Œå°†æŒ‡å®šcollectionä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°æ­¤åˆ—è¡¨ä¸­ï¼Œæ–°å…ƒç´ çš„é¡ºåºä¸ºæŒ‡å®šcollectionçš„è¿­ä»£å™¨æ‰€è¿”å›çš„å…ƒç´ é¡ºåº * @throws IndexOutOfBoundsException {@inheritDoc} * @throws NullPointerException if the specified collection is null */ public boolean addAll(int index, Collection\u003c? extends E\u003e c) { rangeCheckForAdd(index); //åˆ¤æ–­å‚æ•°indexæ˜¯å¦IndexOutOfBoundsException Object[] a = c.toArray(); int numNew = a.length; ensureCapacityInternal(size + numNew); // Increments modCount int numMoved = size - index; if (numMoved \u003e 0) //å…ˆå°†æ•°ç»„elementData[index,...,index+numMoved-1]å¤åˆ¶åˆ°elementData[index+numMoved,...,index+2*numMoved-1] //å³ï¼Œå°†æºæ•°ç»„ä¸­ä»indexä½ç½®å¼€å§‹çš„ånumMovedä¸ªå…ƒç´ ç»Ÿä¸€åç§»numNewä½ System.arraycopy(elementData, index, elementData, index + numNew, numMoved); //å†å°†æ•°ç»„a[0,...,numNew-1]å¤åˆ¶åˆ°æ•°ç»„elementData[index,...,index+numNew-1] System.arraycopy(a, 0, elementData, index, numNew); size += numNew; return numNew != 0; } åˆ é™¤å…ƒç´  1 2 3 4 5 6 remove(int index) remove(Object o) clear() removeRange(int fromIndex, int toIndex) removeAll(Collection\u003c?\u003e c) retainAll(Collection\u003c?\u003e c) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 /** * ç§»é™¤æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´  * @param index éœ€è¢«ç§»é™¤çš„å…ƒç´ çš„ç´¢å¼• * @return the element è¢«ç§»é™¤çš„å…ƒç´ å€¼ * @throws IndexOutOfBoundsException {@inheritDoc} */ public E remove(int index) { rangeCheck(index); //åˆ¤æ–­indexæ˜¯å¦ \u003c= size modCount++; E oldValue = elementData(index); //å°†æ•°ç»„elementDataä¸­indexä½ç½®ä¹‹åçš„æ‰€æœ‰å…ƒç´ å‘å‰ç§»ä¸€ä½ int numMoved = size - index - 1; if (numMoved \u003e 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; //å°†åŸæ•°ç»„æœ€åä¸€ä¸ªä½ç½®ç½®ä¸ºnullï¼Œç”±GCæ¸…ç† return oldValue; } //ç§»é™¤ArrayListä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ (å¦‚æœå­˜åœ¨)ï¼ŒArrayListä¸­å…è®¸å­˜æ”¾é‡å¤çš„å…ƒç´  public boolean remove(Object o) { // ç”±äºArrayListä¸­å…è®¸å­˜æ”¾nullï¼Œå› æ­¤ä¸‹é¢é€šè¿‡ä¸¤ç§æƒ…å†µæ¥åˆ†åˆ«å¤„ç†ã€‚ if (o == null) { for (int index = 0; index \u003c size; index++) if (elementData[index] == null) { fastRemove(index); //ç§æœ‰çš„ç§»é™¤æ–¹æ³•ï¼Œè·³è¿‡indexå‚æ•°çš„è¾¹ç•Œæ£€æŸ¥ä»¥åŠä¸è¿”å›ä»»ä½•å€¼ return true; } } else { for (int index = 0; index \u003c size; index++) if (o.equals(elementData[index])) { fastRemove(index); return true; } } return false; } //ç§æœ‰çš„åˆ é™¤æŒ‡å®šä½ç½®å…ƒç´ çš„æ–¹æ³•ï¼Œè·³è¿‡indexå‚æ•°çš„è¾¹ç•Œæ£€æŸ¥ä»¥åŠä¸è¿”å›ä»»ä½•å€¼ private void fastRemove(int index) { modCount++; int numMoved = size - index - 1; if (numMoved \u003e 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; // clear to let GC do its work } //æ¸…ç©ºArrayListï¼Œå°†å…¨éƒ¨çš„å…ƒç´ è®¾ä¸ºnull public void clear() { modCount++; // clear to let GC do its work for (int i = 0; i \u003c size; i++) elementData[i] = null; size = 0; } //åˆ é™¤ArrayListä¸­ä»fromIndexï¼ˆåŒ…å«ï¼‰åˆ°toIndexï¼ˆä¸åŒ…å«ï¼‰ä¹‹é—´æ‰€æœ‰çš„å…ƒç´ ï¼Œå…±ç§»é™¤äº†toIndex-fromIndexä¸ªå…ƒç´  protected void removeRange(int fromIndex, int toIndex) { modCount++; int numMoved = size - toIndex; //éœ€å‘å‰ç§»åŠ¨çš„å…ƒç´ çš„ä¸ªæ•° System.arraycopy(elementData, toIndex, elementData, fromIndex, numMoved); // clear to let GC do its work int newSize = size - (toIndex-fromIndex); for (int i = newSize; i \u003c size; i++) { elementData[i] = null; } size = newSize; } //åˆ é™¤ArrayListä¸­åŒ…å«åœ¨æŒ‡å®šå®¹å™¨cä¸­çš„æ‰€æœ‰å…ƒç´  public boolean removeAll(Collection\u003c?\u003e c) { Objects.requireNonNull(c); //æ£€æŸ¥æŒ‡å®šçš„å¯¹è±¡cæ˜¯å¦ä¸ºç©º return batchRemove(c, false); } //ç§»é™¤ArrayListä¸­ä¸åŒ…å«åœ¨æŒ‡å®šå®¹å™¨cä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œä¸removeAll(Collection\u003c?\u003e c)æ­£å¥½ç›¸å public boolean retainAll(Collection\u003c?\u003e c) { Objects.requireNonNull(c); return batchRemove(c, true); } private boolean batchRemove(Collection\u003c?\u003e c, boolean complement) { final Object[] elementData = this.elementData; int r = 0, w = 0; //è¯»å†™åŒæŒ‡é’ˆ boolean modified = false; try { for (; r \u003c size; r++) if (c.contains(elementData[r]) == complement) //åˆ¤æ–­æŒ‡å®šå®¹å™¨cä¸­æ˜¯å¦å«æœ‰elementData[r]å…ƒç´  elementData[w++] = elementData[r]; } finally { // Preserve behavioral compatibility with AbstractCollection, // even if c.contains() throws. if (r != size) { System.arraycopy(elementData, r, elementData, w, size - r); w += size - r; } if (w != size) { // clear to let GC do its work for (int i = w; i \u003c size; i++) elementData[i] = null; modCount += size - w; size = w; modified = true; } } return modified; } ä¿®æ”¹å…ƒç´  set(int index, E element)\n1 2 3 4 5 6 7 8 //å°†æŒ‡å®šç´¢å¼•ä¸Šçš„å€¼æ›¿æ¢ä¸ºæ–°å€¼ï¼Œå¹¶è¿”å›æ—§å€¼ public E set(int index, E element) { rangeCheck(index); E oldValue = elementData(index); elementData[index] = element; return oldValue; } æŸ¥æ‰¾å…ƒç´  1 2 3 4 5 get(int index) contains(Object o) indexOf(Object o) lastIndexOf(Object o) get(int index) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 //åˆ¤æ–­ArrayListä¸­æ˜¯å¦åŒ…å«Object(o) public boolean contains(Object o) { return indexOf(o) \u003e= 0; } //æ­£å‘æŸ¥æ‰¾ï¼Œè¿”å›ArrayListä¸­å…ƒç´ Object oç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1 public int indexOf(Object o) { if (o == null) { for (int i = 0; i \u003c size; i++) if (elementData[i]==null) return i; } else { for (int i = 0; i \u003c size; i++) if (o.equals(elementData[i])) return i; } return -1; } //é€†å‘æŸ¥æ‰¾ï¼Œè¿”å›ArrayListä¸­å…ƒç´ Object oæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1 public int lastIndexOf(Object o) { if (o == null) { for (int i = size-1; i \u003e= 0; i--) if (elementData[i]==null) return i; } else { for (int i = size-1; i \u003e= 0; i--) if (o.equals(elementData[i])) return i; } return -1; } @SuppressWarnings(\"unchecked\") E elementData(int index) { return (E) elementData[index]; } //è¿”å›æŒ‡å®šç´¢å¼•å¤„çš„å€¼ public E get(int index) { rangeCheck(index); return elementData(index); //å®è´¨ä¸Šreturn (E) elementData[index] } å…¶ä»–publicæ–¹æ³• 1 2 3 4 5 6 trimToSize() size() isEmpty() clone() toArray() toArray(T[] a) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 //å°†åº•å±‚æ•°ç»„çš„å®¹é‡è°ƒæ•´ä¸ºå½“å‰åˆ—è¡¨ä¿å­˜çš„å®é™…å…ƒç´ çš„å¤§å°çš„åŠŸèƒ½ public void trimToSize() { modCount++; if (size \u003c elementData.length) { elementData = (size == 0) ? EMPTY_ELEMENTDATA : Arrays.copyOf(elementData, size); } } //è¿”å›ArrayListçš„å¤§å°ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰ public int size() { return size; } //åˆ¤æ–­ArrayListæ˜¯å¦ä¸ºç©º public boolean isEmpty() { return size == 0; } //è¿”å›æ­¤ ArrayListå®ä¾‹çš„æµ…æ‹·è´ public Object clone() { try { ArrayList\u003c?\u003e v = (ArrayList\u003c?\u003e) super.clone(); v.elementData = Arrays.copyOf(elementData, size); v.modCount = 0; return v; } catch (CloneNotSupportedException e) { // this shouldn't happen, since we are Cloneable throw new InternalError(e); } } //è¿”å›ä¸€ä¸ªåŒ…å«ArrayListä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ public Object[] toArray() { return Arrays.copyOf(elementData, size); } //å¦‚æœç»™å®šçš„å‚æ•°æ•°ç»„é•¿åº¦è¶³å¤Ÿï¼Œåˆ™å°†ArrayListä¸­æ‰€æœ‰å…ƒç´ æŒ‰åºå­˜æ”¾äºå‚æ•°æ•°ç»„ä¸­ï¼Œå¹¶è¿”å› //å¦‚æœç»™å®šçš„å‚æ•°æ•°ç»„é•¿åº¦å°äºArrayListçš„é•¿åº¦ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ–°åˆ†é…çš„ã€é•¿åº¦ç­‰äºArrayListé•¿åº¦çš„ã€åŒ…å«ArrayListä¸­æ‰€æœ‰å…ƒç´ çš„æ–°æ•°ç»„ @SuppressWarnings(\"unchecked\") public T[] toArray(T[] a) { if (a.length \u003c size) // Make a new array of a's runtime type, but my contents: return (T[]) Arrays.copyOf(elementData, size, a.getClass()); System.arraycopy(elementData, 0, a, 0, size); if (a.length \u003e size) a[size] = null; return a; } æ”¯æŒåºåˆ—åŒ–çš„å†™å…¥å‡½æ•°ï¼šwriteObject(java.io.ObjectOutputStream s) è¯»å–å‡½æ•°ï¼šreadObject(java.io.ObjectInputStream s)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 //åºåˆ—åŒ–ï¼šå°†ArrayListçš„â€œå¤§å°ï¼Œæ‰€æœ‰çš„å…ƒç´ å€¼â€éƒ½å†™å…¥åˆ°è¾“å‡ºæµä¸­ private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException{ // Write out element count, and any hidden stuff int expectedModCount = modCount; s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() s.writeInt(size); // Write out all elements in the proper order. for (int i=0; i",
  "wordCount" : "12211",
  "inLanguage": "en",
  "datePublished": "2016-12-11T09:01:24Z",
  "dateModified": "2016-12-11T09:01:24Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://funny-toffee-4aa7c3.netlify.app/posts/java%E9%9B%86%E5%90%88/arraylist/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://funny-toffee-4aa7c3.netlify.app/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.min.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://funny-toffee-4aa7c3.netlify.app/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://funny-toffee-4aa7c3.netlify.app/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://funny-toffee-4aa7c3.netlify.app/">Home</a>&nbsp;Â»&nbsp;<a href="https://funny-toffee-4aa7c3.netlify.app/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      ArrayList
    </h1>
    <div class="post-meta"><span title='2016-12-11 09:01:24 +0000 UTC'>2016-12-11</span>&nbsp;Â·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#arraylist%e6%a6%82%e8%bf%b0" aria-label="ArrayListæ¦‚è¿°">ArrayListæ¦‚è¿°</a></li>
                <li>
                    <a href="#arraylist%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0" aria-label="ArrayListæ„é€ å‡½æ•°">ArrayListæ„é€ å‡½æ•°</a></li>
                <li>
                    <a href="#api" aria-label="API">API</a></li>
                <li>
                    <a href="#arraylist%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84" aria-label="ArrayListæ•°æ®ç»“æ„">ArrayListæ•°æ®ç»“æ„</a></li>
                <li>
                    <a href="#arraylist%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90" aria-label="ArrayListæºç è§£æ">ArrayListæºç è§£æ</a></li>
                <li>
                    <a href="#%e8%b0%83%e6%95%b4%e6%95%b0%e7%bb%84%e7%9a%84%e5%ae%b9%e9%87%8f-jdk18" aria-label="è°ƒæ•´æ•°ç»„çš„å®¹é‡ jdk1.8">è°ƒæ•´æ•°ç»„çš„å®¹é‡ jdk1.8</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e5%85%83%e7%b4%a0" aria-label="æ·»åŠ å…ƒç´ ">æ·»åŠ å…ƒç´ </a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e5%85%83%e7%b4%a0" aria-label="åˆ é™¤å…ƒç´ ">åˆ é™¤å…ƒç´ </a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9%e5%85%83%e7%b4%a0" aria-label="ä¿®æ”¹å…ƒç´ ">ä¿®æ”¹å…ƒç´ </a></li>
                <li>
                    <a href="#%e6%9f%a5%e6%89%be%e5%85%83%e7%b4%a0" aria-label="æŸ¥æ‰¾å…ƒç´ ">æŸ¥æ‰¾å…ƒç´ </a></li>
                <li>
                    <a href="#%e5%85%b6%e4%bb%96public%e6%96%b9%e6%b3%95" aria-label="å…¶ä»–publicæ–¹æ³•">å…¶ä»–publicæ–¹æ³•</a></li>
                <li>
                    <a href="#arraylist%e7%9a%84%e5%9b%9b%e7%a7%8d%e9%81%8d%e5%8e%86%e6%96%b9%e5%bc%8f" aria-label="ArrayListçš„å››ç§éå†æ–¹å¼">ArrayListçš„å››ç§éå†æ–¹å¼</a><ul>
                        
                <li>
                    <a href="#%e9%80%9a%e8%bf%87%e8%bf%ad%e4%bb%a3%e5%99%a8iterator%e9%81%8d%e5%8e%86" aria-label="é€šè¿‡è¿­ä»£å™¨Iteratoréå†">é€šè¿‡è¿­ä»£å™¨Iteratoréå†</a></li>
                <li>
                    <a href="#%e9%80%9a%e8%bf%87%e8%bf%ad%e4%bb%a3%e5%99%a8-listiterator-%e9%81%8d%e5%8e%86" aria-label="é€šè¿‡è¿­ä»£å™¨ ListIterator éå†">é€šè¿‡è¿­ä»£å™¨ ListIterator éå†</a></li>
                <li>
                    <a href="#%e9%9a%8f%e6%9c%ba%e8%ae%bf%e9%97%ae%e5%8d%b3%e9%80%9a%e8%bf%87%e7%b4%a2%e5%bc%95%e5%80%bc%e9%81%8d%e5%8e%86" aria-label="éšæœºè®¿é—®ï¼Œå³é€šè¿‡ç´¢å¼•å€¼éå†">éšæœºè®¿é—®ï¼Œå³é€šè¿‡ç´¢å¼•å€¼éå†</a></li>
                <li>
                    <a href="#foreach%e5%be%aa%e7%8e%af%e9%81%8d%e5%8e%86" aria-label="foreachå¾ªç¯éå†">foreachå¾ªç¯éå†</a></li>
                <li>
                    <a href="#%e6%95%88%e7%8e%87%e6%af%94%e5%af%b9" aria-label="æ•ˆç‡æ¯”å¯¹">æ•ˆç‡æ¯”å¯¹</a></li></ul>
                </li>
                <li>
                    <a href="#toarray%e5%bc%82%e5%b8%b8" aria-label="toArray()å¼‚å¸¸">toArray()å¼‚å¸¸</a></li>
                <li>
                    <a href="#arraylist-%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="Arraylist ä½¿ç”¨ç¤ºä¾‹">Arraylist ä½¿ç”¨ç¤ºä¾‹</a></li>
                <li>
                    <a href="#fail-fast%e6%9c%ba%e5%88%b6" aria-label="Fail-Fastæœºåˆ¶">Fail-Fastæœºåˆ¶</a><ul>
                        
                <li>
                    <a href="#fail-fast%e7%a4%ba%e4%be%8b" aria-label="fail-fastç¤ºä¾‹">fail-fastç¤ºä¾‹</a></li>
                <li>
                    <a href="#fail-fast%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95" aria-label="fail-fastè§£å†³åŠæ³•">fail-fastè§£å†³åŠæ³•</a></li>
                <li>
                    <a href="#fail-fast%e5%8e%9f%e7%90%86" aria-label="fail-faståŸç†">fail-faståŸç†</a></li>
                <li>
                    <a href="#%e8%a7%a3%e5%86%b3fail-fast%e7%9a%84%e5%8e%9f%e7%90%86" aria-label="è§£å†³fail-fastçš„åŸç†">è§£å†³fail-fastçš„åŸç†</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="arraylistæ¦‚è¿°">ArrayListæ¦‚è¿°<a hidden class="anchor" aria-hidden="true" href="#arraylistæ¦‚è¿°">#</a></h1>
<p>ArrayList æ˜¯å®¹é‡å¯å˜çš„éçº¿ç¨‹å®‰å…¨é›†åˆã€‚
å†…éƒ¨ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé›†åˆæ‰©å®¹æ—¶ä¼šåˆ›å»ºæ›´å¤§çš„æ•°ç»„ç©ºé—´ï¼ŒæŠŠåŸæœ‰æ•°æ®å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
ArrayList æ”¯æŒå¯¹å…ƒç´ çš„å¿«é€Ÿéšæœºè®¿é—®ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤æ—¶é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹å¾ˆæœ‰å¯èƒ½éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ã€‚</p>
<ul>
<li>ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚æä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚</li>
<li>ArrayList å®ç°äº†RandmoAccessæ¥å£ï¼Œå³æä¾›äº†éšæœºè®¿é—®åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚</li>
<li>ArrayList å®ç°äº†Cloneableæ¥å£ï¼Œå³è¦†ç›–äº†å‡½æ•°clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚</li>
<li>ArrayList å®ç°<code>java.io.Serializable</code>æ¥å£ï¼Œè¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚</li>
</ul>
<p>æ¯ä¸ªArrayListå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ï¼Œè¯¥å®¹é‡æ˜¯æŒ‡ç”¨æ¥å­˜å‚¨åˆ—è¡¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ï¼Œå®ƒæ€»æ˜¯è‡³å°‘ç­‰äºåˆ—è¡¨çš„å¤§å°ã€‚
éšç€å‘ArrayListä¸­ä¸æ–­æ·»åŠ å…ƒç´ ï¼Œå…¶å®¹é‡ä¹Ÿè‡ªåŠ¨å¢é•¿ã€‚è‡ªåŠ¨å¢é•¿ä¼šå¸¦æ¥æ•°æ®å‘æ–°æ•°ç»„çš„é‡æ–°æ‹·è´ï¼Œå› æ­¤ï¼Œå¦‚æœå¯é¢„çŸ¥æ•°æ®é‡çš„å¤šå°‘ï¼Œå¯åœ¨æ„é€ ArrayListæ—¶æŒ‡å®šå…¶å®¹é‡ã€‚
åœ¨æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œåº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥ä½¿ç”¨<code>ensureCapacity</code>æ“ä½œæ¥å¢åŠ ArrayListå®ä¾‹çš„å®¹é‡ï¼Œè¿™å¯ä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚
æ³¨ï¼šå»ºè®®åœ¨å•çº¿ç¨‹ä¸­æ‰ä½¿ç”¨ArrayListï¼Œè€Œåœ¨å¤šçº¿ç¨‹ä¸­ä½¿ç”¨<code>CopyOnWriteArrayList</code>ã€‚</p>
<h1 id="arraylistæ„é€ å‡½æ•°">ArrayListæ„é€ å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#arraylistæ„é€ å‡½æ•°">#</a></h1>
<p>ArrayList æœ‰ä¸‰ä¸ªæ„é€ å‡½æ•°ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * æ„é€ ä¸€ä¸ªæŒ‡å®šåˆå§‹å®¹é‡çš„ç©ºåˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param  initialCapacity  ArrayListçš„åˆå§‹å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws IllegalArgumentException å¦‚æœç»™å®šçš„åˆå§‹å®¹é‡ä¸ºè´Ÿå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> ArrayList(<span style="color:#fff;font-weight:bold">int</span> initialCapacity) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (initialCapacity &gt; 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">elementData</span> = <span style="color:#fff;font-weight:bold">new</span> Object[initialCapacity];
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> <span style="color:#fff;font-weight:bold">if</span> (initialCapacity == 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">elementData</span> = EMPTY_ELEMENTDATA;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> IllegalArgumentException(<span style="color:#0ff;font-weight:bold">&#34;Illegal Capacity: &#34;</span>+
</span></span><span style="display:flex;"><span>                                           initialCapacity);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// æ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡ä¸º10çš„ç©ºåˆ—è¡¨</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> ArrayList() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">elementData</span> = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šcollectionçš„å…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ æŒ‰ç…§è¯¥collectionçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåºæ’åˆ—çš„
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param c åŒ…å«ç”¨äºå»æ„é€ ArrayListçš„å…ƒç´ çš„collection
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws NullPointerException å¦‚æœæŒ‡å®šçš„collectionä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> ArrayList(Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c) {
</span></span><span style="display:flex;"><span>    elementData = c.<span style="color:#007f7f">toArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> ((size = elementData.<span style="color:#007f7f">length</span>) != 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// c.toArray()å¯èƒ½ä¸ä¼šæ­£ç¡®åœ°è¿”å›ä¸€ä¸ª Object[]æ•°ç»„ï¼Œé‚£ä¹ˆä½¿ç”¨Arrays.copyOf()æ–¹æ³•</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (elementData.<span style="color:#007f7f">getClass</span>() != Object[].<span style="color:#007f7f">class</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">//Arrays.copyOf()è¿”å›ä¸€ä¸ª Object[].classç±»å‹çš„ï¼Œå¤§å°ä¸ºsizeï¼Œå…ƒç´ ä¸ºelementData[0,...,size-1]</span>
</span></span><span style="display:flex;"><span>            elementData = Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size, Object[].<span style="color:#007f7f">class</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// replace with empty array.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">elementData</span> = EMPTY_ELEMENTDATA;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ArrayListæ„é€ ä¸€ä¸ªé»˜è®¤åˆå§‹å®¹é‡ä¸º10çš„ç©ºåˆ—è¡¨è¿‡ç¨‹ï¼š</p>
<ul>
<li>åˆå§‹æƒ…å†µï¼š<code>elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}ï¼› size = 0;</code></li>
<li>å½“å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œé€šè¿‡<code>add(E e)</code>æ–¹æ³•ä¸­è°ƒç”¨çš„<code>ensureCapacityInternal(size + 1)</code>æ–¹æ³•ï¼Œå³<code>ensureCapacityInternal(1)ï¼›</code></li>
<li>åœ¨<code>ensureCapacityInternal(int minCapacity)</code>æ–¹æ³•ä¸­ï¼Œå¯å¾—çš„<code>minCapacity=DEFAULT_CAPACITY=10</code>ï¼Œç„¶åå†è°ƒç”¨<code>ensureExplicitCapacity(minCapacity)</code>æ–¹æ³•ï¼Œå³<code>ensureExplicitCapacity(10)ï¼›</code></li>
<li>åœ¨<code>ensureExplicitCapacity(minCapacity)</code>æ–¹æ³•ä¸­è°ƒç”¨<code>grow(minCapacity)</code>æ–¹æ³•ï¼Œå³<code>grow(10)</code>ï¼Œæ­¤å¤„ä¸ºçœŸæ­£å…·ä½“çš„æ•°ç»„æ‰©å®¹çš„ç®—æ³•ï¼Œåœ¨æ­¤æ–¹æ³•ä¸­ï¼Œé€šè¿‡<code>elementData = Arrays.copyOf(elementData, 10)</code>å…·ä½“å®ç°äº†<code>elementData</code>æ•°ç»„åˆå§‹å®¹é‡ä¸º10çš„æ„é€ ã€‚</li>
</ul>
<h1 id="api">API<a hidden class="anchor" aria-hidden="true" href="#api">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">// Collectionä¸­å®šä¹‰çš„API</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             add(E object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             addAll(Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; collection)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span>                clear()
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             contains(Object object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             containsAll(Collection&lt;?&gt; collection)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             equals(Object object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span>                 hashCode()
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             isEmpty()
</span></span><span style="display:flex;"><span>Iterator&lt;E&gt;         iterator()
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             remove(Object object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             removeAll(Collection&lt;?&gt; collection)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             retainAll(Collection&lt;?&gt; collection)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span>                 size()
</span></span><span style="display:flex;"><span>&lt;T&gt; T[]             toArray(T[] array)
</span></span><span style="display:flex;"><span>Object[]            toArray()
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// AbstractCollectionä¸­å®šä¹‰çš„API</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span>                add(<span style="color:#fff;font-weight:bold">int</span> location, E object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">boolean</span>             addAll(<span style="color:#fff;font-weight:bold">int</span> location, Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; collection)
</span></span><span style="display:flex;"><span>E                   get(<span style="color:#fff;font-weight:bold">int</span> location)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span>                 indexOf(Object object)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span>                 lastIndexOf(Object object)
</span></span><span style="display:flex;"><span>ListIterator&lt;E&gt;     listIterator(<span style="color:#fff;font-weight:bold">int</span> location)
</span></span><span style="display:flex;"><span>ListIterator&lt;E&gt;     listIterator()
</span></span><span style="display:flex;"><span>E                   remove(<span style="color:#fff;font-weight:bold">int</span> location)
</span></span><span style="display:flex;"><span>E                   set(<span style="color:#fff;font-weight:bold">int</span> location, E object)
</span></span><span style="display:flex;"><span>List&lt;E&gt;             subList(<span style="color:#fff;font-weight:bold">int</span> start, <span style="color:#fff;font-weight:bold">int</span> end)
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ArrayListæ–°å¢çš„API</span>
</span></span><span style="display:flex;"><span>Object               clone()
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span>                 ensureCapacity(<span style="color:#fff;font-weight:bold">int</span> minimumCapacity)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span>                 trimToSize()
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span>                 removeRange(<span style="color:#fff;font-weight:bold">int</span> fromIndex, <span style="color:#fff;font-weight:bold">int</span> toIndex)
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="arraylistæ•°æ®ç»“æ„">ArrayListæ•°æ®ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#arraylistæ•°æ®ç»“æ„">#</a></h1>
<p>ArrayListçš„ç»§æ‰¿å…³ç³»</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>java.<span style="color:#007f7f">lang</span>.<span style="color:#007f7f">Object</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f00">â†³</span>     java.<span style="color:#007f7f">util</span>.<span style="color:#007f7f">AbstractCollection</span>&lt;E&gt;
</span></span><span style="display:flex;"><span>         <span style="color:#f00">â†³</span>     java.<span style="color:#007f7f">util</span>.<span style="color:#007f7f">AbstractList</span>&lt;E&gt;
</span></span><span style="display:flex;"><span>               <span style="color:#f00">â†³</span>     java.<span style="color:#007f7f">util</span>.<span style="color:#007f7f">ArrayList</span>&lt;E&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ArrayList&lt;E&gt; <span style="color:#fff;font-weight:bold">extends</span> AbstractList&lt;E&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">implements</span> List&lt;E&gt;, RandomAccess, Cloneable, java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">Serializable</span> {}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ArrayListä¸Collectionçš„å…³ç³»å›¾
<img loading="lazy" src="/posts/java%E9%9B%86%E5%90%88/arraylist/1.jpg"></p>
<p>ArrayListåŒ…å«äº†ä¸¤ä¸ªé‡è¦çš„å¯¹è±¡ï¼šelementData å’Œ sizeã€‚</p>
<ul>
<li>elementDataæ˜¯<code>Object[]ç±»å‹çš„æ•°ç»„</code>ï¼Œå®ƒä¿å­˜äº†æ·»åŠ åˆ°ArrayListä¸­çš„å…ƒç´ ã€‚
å®é™…ä¸Šï¼ŒelementDataæ˜¯ä¸ªåŠ¨æ€æ•°ç»„ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡æ„é€ å‡½æ•°<code>ArrayList(int initialCapacity)</code>æ¥ç¡®ä¿å®ƒçš„åˆå§‹å®¹é‡ä¸ºinitialCapacityã€‚
å¦‚æœé€šè¿‡ä¸å«å‚æ•°çš„æ„é€ å‡½æ•°ArrayList()æ¥åˆ›å»º ArrayListï¼Œåˆ™elementDataçš„å®¹é‡é»˜è®¤æ˜¯10ã€‚
elementDataæ•°ç»„çš„å¤§å°ä¼šæ ¹æ®ArrayListå®¹é‡çš„å¢é•¿è€ŒåŠ¨æ€çš„å¢é•¿ï¼Œå…·ä½“çš„å¢é•¿æ–¹å¼ï¼Œè¯·å‚è€ƒæºç åˆ†æä¸­çš„<code>ensureCapacity()</code>å‡½æ•°ã€‚</li>
<li>size åˆ™æ˜¯åŠ¨æ€æ•°ç»„çš„å®é™…å¤§å°ã€‚</li>
</ul>
<p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªç»å¸¸ç”¨åˆ°çš„å±æ€§å°±æ˜¯ä»AbstractListç»§æ‰¿è¿‡æ¥çš„modCountå±æ€§ï¼Œä»£è¡¨ArrayListé›†åˆçš„ä¿®æ”¹æ¬¡æ•°ã€‚</p>
<h1 id="arraylistæºç è§£æ">ArrayListæºç è§£æ<a hidden class="anchor" aria-hidden="true" href="#arraylistæºç è§£æ">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//é€šè¿‡ArrayListå®ç°çš„æ¥å£å¯çŸ¥ï¼Œå…¶æ”¯æŒéšæœºè®¿é—®ï¼Œèƒ½è¢«å…‹éš†ï¼Œæ”¯æŒåºåˆ—åŒ–</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ArrayList&lt;E&gt; <span style="color:#fff;font-weight:bold">extends</span> AbstractList&lt;E&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">implements</span> List&lt;E&gt;, RandomAccess, Cloneable, java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">Serializable</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åºåˆ—ç‰ˆæœ¬å·</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">long</span> serialVersionUID = 8683452581122892189L;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//é»˜è®¤åˆå§‹å®¹é‡</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">int</span> DEFAULT_CAPACITY = 10;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¢«ç”¨äºç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> Object[] EMPTY_ELEMENTDATA = {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¢«ç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹çš„å…±äº«æ•°ç»„å®ä¾‹ã€‚å…¶ä¸EMPTY_ELEMENTDATAçš„åŒºåˆ«æ˜¯ï¼šå½“æˆ‘ä»¬å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼ŒçŸ¥é“æ•°ç»„è¯¥æ‰©å……å¤šå°‘ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * Object[]ç±»å‹çš„æ•°ç»„ï¼Œä¿å­˜äº†æ·»åŠ åˆ°ArrayListä¸­çš„å…ƒç´ ã€‚ArrayListçš„å®¹é‡æ˜¯è¯¥Object[]ç±»å‹æ•°ç»„çš„é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * å½“ç¬¬ä¸€ä¸ªå…ƒç´ è¢«æ·»åŠ æ—¶ï¼Œä»»ä½•ç©ºArrayListä¸­çš„elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATAå°†ä¼šè¢«
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * æ‰©å……åˆ°DEFAULT_CAPACITYï¼ˆé»˜è®¤å®¹é‡ï¼‰ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">transient</span> Object[] elementData; <span style="color:#007f7f">//éprivateæ˜¯ä¸ºäº†æ–¹ä¾¿åµŒå¥—ç±»çš„è®¿é—®</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ArrayListçš„å¤§å°ï¼ˆæŒ‡å…¶æ‰€å«çš„å…ƒç´ ä¸ªæ•°ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> size;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...... 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ArrayList å®é™…ä¸Šæ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„å»ä¿å­˜æ•°æ®çš„ã€‚å½“æˆ‘ä»¬æ„é€ ArrayListæ—¶ï¼›è‹¥ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼Œåˆ™ArrayListçš„é»˜è®¤å®¹é‡å¤§å°æ˜¯10ã€‚</p>
<h1 id="è°ƒæ•´æ•°ç»„çš„å®¹é‡-jdk18">è°ƒæ•´æ•°ç»„çš„å®¹é‡ jdk1.8<a hidden class="anchor" aria-hidden="true" href="#è°ƒæ•´æ•°ç»„çš„å®¹é‡-jdk18">#</a></h1>
<p>ä»<code>add()</code>ä¸<code>addAll()</code>æ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯å½“å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œéƒ½è¦å»æ£€æŸ¥æ·»åŠ å…ƒç´ åçš„ä¸ªæ•°æ˜¯å¦ä¼šè¶…å‡ºå½“å‰æ•°ç»„çš„é•¿åº¦ï¼Œå¦‚æœè¶…å‡ºï¼Œæ•°ç»„å°†ä¼šè¿›è¡Œæ‰©å®¹ï¼Œä»¥æ»¡è¶³æ·»åŠ æ•°æ®çš„éœ€æ±‚ã€‚æ•°ç»„æ‰©å®¹å®è´¨ä¸Šæ˜¯é€šè¿‡ç§æœ‰çš„æ–¹æ³•<code>grow(int minCapacity)</code>æ¥å®ç°çš„ï¼Œä½†åœ¨jdk1.8ä¸­ï¼Œå‘ç”¨æˆ·æä¾›äº†ä¸€ä¸ªpublicçš„æ–¹æ³•<code>ensureCapacity(int minCapacity)</code>ä½¿ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨çš„è®¾ç½®ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚
æ­¤å¤„ä¸jdk1.6ä¸­ç›´æ¥é€šè¿‡ä¸€ä¸ªå…¬å¼€çš„æ–¹æ³• <code>ensureCapacity(int minCapacity) </code>æ¥å®ç°æ•°ç»„å®¹é‡çš„è°ƒæ•´æœ‰åŒºåˆ«ã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * publicæ–¹æ³•ï¼Œè®©ç”¨æˆ·èƒ½æ‰‹åŠ¨è®¾ç½®ArrayListçš„å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param   minCapacity æœŸæœ›çš„æœ€å°å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> ensureCapacity(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">int</span> minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// any size if not default element table</span>
</span></span><span style="display:flex;"><span>		? 0
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// larger than default for default empty table. It&#39;s already</span>
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// supposed to be at default size.</span>
</span></span><span style="display:flex;"><span>		: DEFAULT_CAPACITY;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (minCapacity &gt; minExpand) {
</span></span><span style="display:flex;"><span>		ensureExplicitCapacity(minCapacity);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> ensureCapacityInternal(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//å½“elementDataä¸ºç©ºæ—¶ï¼ŒArrayListçš„åˆå§‹å®¹é‡æœ€å°ä¸ºDEFAULT_CAPACITYï¼ˆ10ï¼‰</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
</span></span><span style="display:flex;"><span>		minCapacity = Math.<span style="color:#007f7f">max</span>(DEFAULT_CAPACITY, minCapacity);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	ensureExplicitCapacity(minCapacity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> ensureExplicitCapacity(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>	modCount++;
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// overflow-conscious code</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (minCapacity - elementData.<span style="color:#007f7f">length</span> &gt; 0)
</span></span><span style="display:flex;"><span>		grow(minCapacity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ•°ç»„å¯è¢«åˆ†é…çš„æœ€å¤§å®¹é‡ï¼›å½“éœ€è¦çš„æ•°ç»„å°ºå¯¸è¶…è¿‡VMçš„é™åˆ¶æ—¶ï¼Œå¯èƒ½å¯¼è‡´OutOfMemoryError</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">int</span> MAX_ARRAY_SIZE = Integer.<span style="color:#007f7f">MAX_VALUE</span> - 8;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * å¢åŠ æ•°ç»„çš„å®¹é‡ï¼Œç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³æŒ‡å®šçš„æœ€å°å®¹é‡çš„å…ƒç´ é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param minCapacity æœŸæœ›çš„æœ€å°å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> grow(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// overflow-conscious code</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">int</span> oldCapacity = elementData.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">//æ³¨æ„æ­¤å¤„æ‰©å……capacityçš„æ–¹å¼æ˜¯å°†å…¶å‘å³ä¸€ä½å†åŠ ä¸ŠåŸæ¥çš„æ•°ï¼Œå®é™…ä¸Šæ˜¯æ‰©å……äº†1.5å€</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (newCapacity - minCapacity &lt; 0)
</span></span><span style="display:flex;"><span>		newCapacity = minCapacity;
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; 0) 
</span></span><span style="display:flex;"><span>		newCapacity = hugeCapacity(minCapacity); <span style="color:#007f7f">//è®¾ç½®æ•°ç»„å¯è¢«åˆ†é…çš„æœ€å¤§å®¹é‡</span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// minCapacity is usually close to size, so this is a win:</span>
</span></span><span style="display:flex;"><span>	elementData = Arrays.<span style="color:#007f7f">copyOf</span>(elementData, newCapacity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">int</span> hugeCapacity(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (minCapacity &lt; 0) <span style="color:#007f7f">// overflow</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> OutOfMemoryError();
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?
</span></span><span style="display:flex;"><span>		Integer.<span style="color:#007f7f">MAX_VALUE</span> :
</span></span><span style="display:flex;"><span>		MAX_ARRAY_SIZE;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ºä»€ä¹ˆArrayListè‡ªåŠ¨å®¹é‡æ‰©å……é€‰æ‹©æ‰©å……1.5å€ï¼Ÿ
è¿™ç§ç®—æ³•æ„é€ å‡ºæ¥çš„æ–°çš„æ•°ç»„é•¿åº¦çš„å¢é‡éƒ½ä¼šæ¯”ä¸Šä¸€æ¬¡å¤§( è€Œä¸”æ˜¯è¶Šæ¥è¶Šå¤§) ï¼Œå³è®¤ä¸ºç”¨æˆ·éœ€è¦å¢åŠ çš„æ•°æ®å¾ˆå¤šï¼Œè€Œé¿å…é¢‘ç¹newInstanceçš„æƒ…å†µã€‚</p>
<h1 id="æ·»åŠ å…ƒç´ ">æ·»åŠ å…ƒç´ <a hidden class="anchor" aria-hidden="true" href="#æ·»åŠ å…ƒç´ ">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>add(E e)
</span></span><span style="display:flex;"><span>add(<span style="color:#fff;font-weight:bold">int</span> index, E element)
</span></span><span style="display:flex;"><span>addAll(Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c)
</span></span><span style="display:flex;"><span>addAll(<span style="color:#fff;font-weight:bold">int</span> index, Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//å°†æŒ‡å®šçš„å…ƒç´ (E e)æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„å°¾éƒ¨</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> add(E e) {
</span></span><span style="display:flex;"><span>    ensureCapacityInternal(size + 1);  <span style="color:#007f7f">// Increments modCount!!</span>
</span></span><span style="display:flex;"><span>    elementData[size++] = e;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å°†æŒ‡å®šçš„å…ƒç´ (E e)æ’å…¥åˆ°åˆ—è¡¨çš„æŒ‡å®šä½ç½®(index)</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> add(<span style="color:#fff;font-weight:bold">int</span> index, E element) {
</span></span><span style="display:flex;"><span>    rangeCheckForAdd(index); <span style="color:#007f7f">//åˆ¤æ–­å‚æ•°indexæ˜¯å¦IndexOutOfBoundsException</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ensureCapacityInternal(size + 1);  <span style="color:#007f7f">// Increments modCount!!  å¦‚æœæ•°ç»„é•¿åº¦ä¸è¶³ï¼Œå°†è¿›è¡Œæ‰©å®¹</span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(elementData, index, elementData, index + 1,
</span></span><span style="display:flex;"><span>                     size - index); <span style="color:#007f7f">//å°†æºæ•°ç»„ä¸­ä»indexä½ç½®å¼€å§‹åçš„size-indexä¸ªå…ƒç´ ç»Ÿä¸€åç§»ä¸€ä½</span>
</span></span><span style="display:flex;"><span>    elementData[index] = element;
</span></span><span style="display:flex;"><span>    size++;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * æŒ‰ç…§æŒ‡å®šcollectionçš„è¿­ä»£å™¨æ‰€è¿”å›çš„å…ƒç´ é¡ºåºï¼Œå°†è¯¥collectionä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„å°¾éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws NullPointerException if the specified collection is null
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> addAll(Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c) {
</span></span><span style="display:flex;"><span>    Object[] a = c.<span style="color:#007f7f">toArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numNew = a.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>    ensureCapacityInternal(size + numNew);  <span style="color:#007f7f">// Increments modCount</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å°†æ•°ç»„a[0,...,numNew-1]å¤åˆ¶åˆ°æ•°ç»„elementData[size,...,size+numNew-1]</span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(a, 0, elementData, size, numNew); 
</span></span><span style="display:flex;"><span>    size += numNew;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> numNew != 0;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * ä»æŒ‡å®šçš„ä½ç½®å¼€å§‹ï¼Œå°†æŒ‡å®šcollectionä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°æ­¤åˆ—è¡¨ä¸­ï¼Œæ–°å…ƒç´ çš„é¡ºåºä¸ºæŒ‡å®šcollectionçš„è¿­ä»£å™¨æ‰€è¿”å›çš„å…ƒç´ é¡ºåº
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws IndexOutOfBoundsException {@inheritDoc}
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws NullPointerException if the specified collection is null
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> addAll(<span style="color:#fff;font-weight:bold">int</span> index, Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c) {
</span></span><span style="display:flex;"><span>    rangeCheckForAdd(index); <span style="color:#007f7f">//åˆ¤æ–­å‚æ•°indexæ˜¯å¦IndexOutOfBoundsException</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Object[] a = c.<span style="color:#007f7f">toArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numNew = a.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>    ensureCapacityInternal(size + numNew);  <span style="color:#007f7f">// Increments modCount</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numMoved = size - index;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (numMoved &gt; 0)
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å…ˆå°†æ•°ç»„elementData[index,...,index+numMoved-1]å¤åˆ¶åˆ°elementData[index+numMoved,...,index+2*numMoved-1]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">//å³ï¼Œå°†æºæ•°ç»„ä¸­ä»indexä½ç½®å¼€å§‹çš„ånumMovedä¸ªå…ƒç´ ç»Ÿä¸€åç§»numNewä½</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">arraycopy</span>(elementData, index, elementData, index + numNew,
</span></span><span style="display:flex;"><span>                         numMoved);
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å†å°†æ•°ç»„a[0,...,numNew-1]å¤åˆ¶åˆ°æ•°ç»„elementData[index,...,index+numNew-1]</span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(a, 0, elementData, index, numNew);
</span></span><span style="display:flex;"><span>    size += numNew;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> numNew != 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="åˆ é™¤å…ƒç´ ">åˆ é™¤å…ƒç´ <a hidden class="anchor" aria-hidden="true" href="#åˆ é™¤å…ƒç´ ">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>remove(<span style="color:#fff;font-weight:bold">int</span> index)
</span></span><span style="display:flex;"><span>remove(Object o)
</span></span><span style="display:flex;"><span>clear()
</span></span><span style="display:flex;"><span>removeRange(<span style="color:#fff;font-weight:bold">int</span> fromIndex, <span style="color:#fff;font-weight:bold">int</span> toIndex)
</span></span><span style="display:flex;"><span>removeAll(Collection&lt;?&gt; c)
</span></span><span style="display:flex;"><span>retainAll(Collection&lt;?&gt; c)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * ç§»é™¤æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @param index éœ€è¢«ç§»é™¤çš„å…ƒç´ çš„ç´¢å¼•
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @return the element è¢«ç§»é™¤çš„å…ƒç´ å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @throws IndexOutOfBoundsException {@inheritDoc}
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> E remove(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>    rangeCheck(index);  <span style="color:#007f7f">//åˆ¤æ–­indexæ˜¯å¦ &lt;= size</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    modCount++;
</span></span><span style="display:flex;"><span>    E oldValue = elementData(index);
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//å°†æ•°ç»„elementDataä¸­indexä½ç½®ä¹‹åçš„æ‰€æœ‰å…ƒç´ å‘å‰ç§»ä¸€ä½</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numMoved = size - index - 1;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (numMoved &gt; 0)
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">arraycopy</span>(elementData, index+1, elementData, index,
</span></span><span style="display:flex;"><span>                         numMoved);
</span></span><span style="display:flex;"><span>    elementData[--size] = <span style="color:#fff;font-weight:bold">null</span>; <span style="color:#007f7f">//å°†åŸæ•°ç»„æœ€åä¸€ä¸ªä½ç½®ç½®ä¸ºnullï¼Œç”±GCæ¸…ç†</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> oldValue;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ç§»é™¤ArrayListä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ (å¦‚æœå­˜åœ¨)ï¼ŒArrayListä¸­å…è®¸å­˜æ”¾é‡å¤çš„å…ƒç´ </span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> remove(Object o) {
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ç”±äºArrayListä¸­å…è®¸å­˜æ”¾nullï¼Œå› æ­¤ä¸‹é¢é€šè¿‡ä¸¤ç§æƒ…å†µæ¥åˆ†åˆ«å¤„ç†ã€‚</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (o == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> index = 0; index &lt; size; index++)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (elementData[index] == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                fastRemove(index); <span style="color:#007f7f">//ç§æœ‰çš„ç§»é™¤æ–¹æ³•ï¼Œè·³è¿‡indexå‚æ•°çš„è¾¹ç•Œæ£€æŸ¥ä»¥åŠä¸è¿”å›ä»»ä½•å€¼</span>
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> index = 0; index &lt; size; index++)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (o.<span style="color:#007f7f">equals</span>(elementData[index])) {
</span></span><span style="display:flex;"><span>                fastRemove(index);
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ç§æœ‰çš„åˆ é™¤æŒ‡å®šä½ç½®å…ƒç´ çš„æ–¹æ³•ï¼Œè·³è¿‡indexå‚æ•°çš„è¾¹ç•Œæ£€æŸ¥ä»¥åŠä¸è¿”å›ä»»ä½•å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> fastRemove(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>    modCount++;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numMoved = size - index - 1;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (numMoved &gt; 0)
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">arraycopy</span>(elementData, index+1, elementData, index,
</span></span><span style="display:flex;"><span>                         numMoved);
</span></span><span style="display:flex;"><span>    elementData[--size] = <span style="color:#fff;font-weight:bold">null</span>; <span style="color:#007f7f">// clear to let GC do its work</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ¸…ç©ºArrayListï¼Œå°†å…¨éƒ¨çš„å…ƒç´ è®¾ä¸ºnull</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> clear() {
</span></span><span style="display:flex;"><span>    modCount++;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// clear to let GC do its work</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = 0; i &lt; size; i++)
</span></span><span style="display:flex;"><span>        elementData[i] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    size = 0;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ é™¤ArrayListä¸­ä»fromIndexï¼ˆåŒ…å«ï¼‰åˆ°toIndexï¼ˆä¸åŒ…å«ï¼‰ä¹‹é—´æ‰€æœ‰çš„å…ƒç´ ï¼Œå…±ç§»é™¤äº†toIndex-fromIndexä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">void</span> removeRange(<span style="color:#fff;font-weight:bold">int</span> fromIndex, <span style="color:#fff;font-weight:bold">int</span> toIndex) {
</span></span><span style="display:flex;"><span>    modCount++;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> numMoved = size - toIndex;  <span style="color:#007f7f">//éœ€å‘å‰ç§»åŠ¨çš„å…ƒç´ çš„ä¸ªæ•°</span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(elementData, toIndex, elementData, fromIndex,
</span></span><span style="display:flex;"><span>                     numMoved);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// clear to let GC do its work</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> newSize = size - (toIndex-fromIndex);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = newSize; i &lt; size; i++) {
</span></span><span style="display:flex;"><span>        elementData[i] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    size = newSize;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ é™¤ArrayListä¸­åŒ…å«åœ¨æŒ‡å®šå®¹å™¨cä¸­çš„æ‰€æœ‰å…ƒç´ </span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> removeAll(Collection&lt;?&gt; c) {
</span></span><span style="display:flex;"><span>    Objects.<span style="color:#007f7f">requireNonNull</span>(c);  <span style="color:#007f7f">//æ£€æŸ¥æŒ‡å®šçš„å¯¹è±¡cæ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> batchRemove(c, <span style="color:#fff;font-weight:bold">false</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ç§»é™¤ArrayListä¸­ä¸åŒ…å«åœ¨æŒ‡å®šå®¹å™¨cä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œä¸removeAll(Collection&lt;?&gt; c)æ­£å¥½ç›¸å</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> retainAll(Collection&lt;?&gt; c) {
</span></span><span style="display:flex;"><span>    Objects.<span style="color:#007f7f">requireNonNull</span>(c); 
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> batchRemove(c, <span style="color:#fff;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">boolean</span> batchRemove(Collection&lt;?&gt; c, <span style="color:#fff;font-weight:bold">boolean</span> complement) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">final</span> Object[] elementData = <span style="color:#fff;font-weight:bold">this</span>.<span style="color:#007f7f">elementData</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> r = 0, w = 0;  <span style="color:#007f7f">//è¯»å†™åŒæŒ‡é’ˆ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">boolean</span> modified = <span style="color:#fff;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (; r &lt; size; r++)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (c.<span style="color:#007f7f">contains</span>(elementData[r]) == complement) <span style="color:#007f7f">//åˆ¤æ–­æŒ‡å®šå®¹å™¨cä¸­æ˜¯å¦å«æœ‰elementData[r]å…ƒç´ </span>
</span></span><span style="display:flex;"><span>                elementData[w++] = elementData[r];
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">finally</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// Preserve behavioral compatibility with AbstractCollection,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// even if c.contains() throws.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (r != size) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">arraycopy</span>(elementData, r,
</span></span><span style="display:flex;"><span>                             elementData, w,
</span></span><span style="display:flex;"><span>                             size - r);
</span></span><span style="display:flex;"><span>            w += size - r;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (w != size) {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// clear to let GC do its work</span>
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = w; i &lt; size; i++)
</span></span><span style="display:flex;"><span>                elementData[i] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>            modCount += size - w;
</span></span><span style="display:flex;"><span>            size = w;
</span></span><span style="display:flex;"><span>            modified = <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> modified;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="ä¿®æ”¹å…ƒç´ ">ä¿®æ”¹å…ƒç´ <a hidden class="anchor" aria-hidden="true" href="#ä¿®æ”¹å…ƒç´ ">#</a></h1>
<p><code>set(int index, E element)</code></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//å°†æŒ‡å®šç´¢å¼•ä¸Šçš„å€¼æ›¿æ¢ä¸ºæ–°å€¼ï¼Œå¹¶è¿”å›æ—§å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> E set(<span style="color:#fff;font-weight:bold">int</span> index, E element) {
</span></span><span style="display:flex;"><span>    rangeCheck(index);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    E oldValue = elementData(index);
</span></span><span style="display:flex;"><span>    elementData[index] = element;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> oldValue;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="æŸ¥æ‰¾å…ƒç´ ">æŸ¥æ‰¾å…ƒç´ <a hidden class="anchor" aria-hidden="true" href="#æŸ¥æ‰¾å…ƒç´ ">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>get(<span style="color:#fff;font-weight:bold">int</span> index)
</span></span><span style="display:flex;"><span>contains(Object o)
</span></span><span style="display:flex;"><span>indexOf(Object o)
</span></span><span style="display:flex;"><span>lastIndexOf(Object o)
</span></span><span style="display:flex;"><span>get(<span style="color:#fff;font-weight:bold">int</span> index)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//åˆ¤æ–­ArrayListä¸­æ˜¯å¦åŒ…å«Object(o)</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> contains(Object o) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> indexOf(o) &gt;= 0;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//æ­£å‘æŸ¥æ‰¾ï¼Œè¿”å›ArrayListä¸­å…ƒç´ Object oç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">int</span> indexOf(Object o) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (o == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = 0; i &lt; size; i++)                 
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (elementData[i]==<span style="color:#fff;font-weight:bold">null</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> i;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = 0; i &lt; size; i++)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (o.<span style="color:#007f7f">equals</span>(elementData[i]))
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> i;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> -1;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//é€†å‘æŸ¥æ‰¾ï¼Œè¿”å›ArrayListä¸­å…ƒç´ Object oæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">int</span> lastIndexOf(Object o) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (o == <span style="color:#fff;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = size-1; i &gt;= 0; i--)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (elementData[i]==<span style="color:#fff;font-weight:bold">null</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> i;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = size-1; i &gt;= 0; i--)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (o.<span style="color:#007f7f">equals</span>(elementData[i]))
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> i;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> -1;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@SuppressWarnings(<span style="color:#0ff;font-weight:bold">&#34;unchecked&#34;</span>)
</span></span><span style="display:flex;"><span>E elementData(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (E) elementData[index];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¿”å›æŒ‡å®šç´¢å¼•å¤„çš„å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> E get(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>    rangeCheck(index);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> elementData(index); <span style="color:#007f7f">//å®è´¨ä¸Šreturn (E) elementData[index]</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="å…¶ä»–publicæ–¹æ³•">å…¶ä»–publicæ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#å…¶ä»–publicæ–¹æ³•">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>trimToSize()
</span></span><span style="display:flex;"><span>size()
</span></span><span style="display:flex;"><span>isEmpty()
</span></span><span style="display:flex;"><span>clone()
</span></span><span style="display:flex;"><span>toArray()
</span></span><span style="display:flex;"><span>toArray(T[] a)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//å°†åº•å±‚æ•°ç»„çš„å®¹é‡è°ƒæ•´ä¸ºå½“å‰åˆ—è¡¨ä¿å­˜çš„å®é™…å…ƒç´ çš„å¤§å°çš„åŠŸèƒ½</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> trimToSize() {
</span></span><span style="display:flex;"><span>    modCount++;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (size &lt; elementData.<span style="color:#007f7f">length</span>) {
</span></span><span style="display:flex;"><span>        elementData = (size == 0)
</span></span><span style="display:flex;"><span>            ? EMPTY_ELEMENTDATA
</span></span><span style="display:flex;"><span>            : Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¿”å›ArrayListçš„å¤§å°ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">int</span> size() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> size;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//åˆ¤æ–­ArrayListæ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> isEmpty() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> size == 0;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¿”å›æ­¤ ArrayListå®ä¾‹çš„æµ…æ‹·è´</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> Object clone() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) <span style="color:#fff;font-weight:bold">super</span>.<span style="color:#007f7f">clone</span>();
</span></span><span style="display:flex;"><span>        v.<span style="color:#007f7f">elementData</span> = Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size);
</span></span><span style="display:flex;"><span>        v.<span style="color:#007f7f">modCount</span> = 0;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> v;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">catch</span> (CloneNotSupportedException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// this shouldn&#39;t happen, since we are Cloneable</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> InternalError(e);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¿”å›ä¸€ä¸ªåŒ…å«ArrayListä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> Object[] toArray() {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å¦‚æœç»™å®šçš„å‚æ•°æ•°ç»„é•¿åº¦è¶³å¤Ÿï¼Œåˆ™å°†ArrayListä¸­æ‰€æœ‰å…ƒç´ æŒ‰åºå­˜æ”¾äºå‚æ•°æ•°ç»„ä¸­ï¼Œå¹¶è¿”å›</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//å¦‚æœç»™å®šçš„å‚æ•°æ•°ç»„é•¿åº¦å°äºArrayListçš„é•¿åº¦ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ–°åˆ†é…çš„ã€é•¿åº¦ç­‰äºArrayListé•¿åº¦çš„ã€åŒ…å«ArrayListä¸­æ‰€æœ‰å…ƒç´ çš„æ–°æ•°ç»„</span>
</span></span><span style="display:flex;"><span>@SuppressWarnings(<span style="color:#0ff;font-weight:bold">&#34;unchecked&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> &lt;T&gt; T[] toArray(T[] a) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (a.<span style="color:#007f7f">length</span> &lt; size)
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// Make a new array of a&#39;s runtime type, but my contents:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> (T[]) Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size, a.<span style="color:#007f7f">getClass</span>());
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(elementData, 0, a, 0, size);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (a.<span style="color:#007f7f">length</span> &gt; size)
</span></span><span style="display:flex;"><span>        a[size] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> a;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ”¯æŒåºåˆ—åŒ–çš„å†™å…¥å‡½æ•°ï¼šwriteObject(java.io.ObjectOutputStream s)
è¯»å–å‡½æ•°ï¼šreadObject(java.io.ObjectInputStream s)</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#007f7f">//åºåˆ—åŒ–ï¼šå°†ArrayListçš„â€œå¤§å°ï¼Œæ‰€æœ‰çš„å…ƒç´ å€¼â€éƒ½å†™å…¥åˆ°è¾“å‡ºæµä¸­</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> writeObject(java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">ObjectOutputStream</span> s)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">throws</span> java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">IOException</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Write out element count, and any hidden stuff</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">int</span> expectedModCount = modCount;
</span></span><span style="display:flex;"><span>	s.<span style="color:#007f7f">defaultWriteObject</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Write out size as capacity for behavioural compatibility with clone()</span>
</span></span><span style="display:flex;"><span>	s.<span style="color:#007f7f">writeInt</span>(size);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Write out all elements in the proper order.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i=0; i&lt;size; i++) {
</span></span><span style="display:flex;"><span>		s.<span style="color:#007f7f">writeObject</span>(elementData[i]);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (modCount != expectedModCount) {
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> ConcurrentModificationException();
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//ååºåˆ—åŒ–ï¼šå…ˆå°†ArrayListçš„â€œå¤§å°â€è¯»å‡ºï¼Œç„¶åå°†â€œæ‰€æœ‰çš„å…ƒç´ å€¼â€è¯»å‡º</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> readObject(java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">ObjectInputStream</span> s)
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">throws</span> java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">IOException</span>, ClassNotFoundException {
</span></span><span style="display:flex;"><span>	elementData = EMPTY_ELEMENTDATA;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Read in size, and any hidden stuff</span>
</span></span><span style="display:flex;"><span>	s.<span style="color:#007f7f">defaultReadObject</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// Read in capacity</span>
</span></span><span style="display:flex;"><span>	s.<span style="color:#007f7f">readInt</span>(); <span style="color:#007f7f">// ignored</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#fff;font-weight:bold">if</span> (size &gt; 0) {
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// be like clone(), allocate array based upon size not capacity</span>
</span></span><span style="display:flex;"><span>		ensureCapacityInternal(size);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		Object[] a = elementData;
</span></span><span style="display:flex;"><span>		<span style="color:#007f7f">// Read in all elements in the proper order.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i=0; i&lt;size; i++) {
</span></span><span style="display:flex;"><span>			a[i] = s.<span style="color:#007f7f">readObject</span>();
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="arraylistçš„å››ç§éå†æ–¹å¼">ArrayListçš„å››ç§éå†æ–¹å¼<a hidden class="anchor" aria-hidden="true" href="#arraylistçš„å››ç§éå†æ–¹å¼">#</a></h1>
<h2 id="é€šè¿‡è¿­ä»£å™¨iteratoréå†">é€šè¿‡è¿­ä»£å™¨Iteratoréå†<a hidden class="anchor" aria-hidden="true" href="#é€šè¿‡è¿­ä»£å™¨iteratoréå†">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Iterator iter = list.<span style="color:#007f7f">iterator</span>();
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">while</span> (iter.<span style="color:#007f7f">hasNext</span>()){
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(iter.<span style="color:#007f7f">next</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="é€šè¿‡è¿­ä»£å™¨-listiterator-éå†">é€šè¿‡è¿­ä»£å™¨ ListIterator éå†<a hidden class="anchor" aria-hidden="true" href="#é€šè¿‡è¿­ä»£å™¨-listiterator-éå†">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ListIterator&lt;String&gt; lIter = list.<span style="color:#007f7f">listIterator</span>();
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//é¡ºå‘éå†</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">while</span>(lIter.<span style="color:#007f7f">hasNext</span>()){
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(lIter.<span style="color:#007f7f">next</span>());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//é€†å‘éå†</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">while</span>(lIter.<span style="color:#007f7f">hasPrevious</span>()){
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(lIter.<span style="color:#007f7f">previous</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Iterator ä¸ ListIterator ä¸»è¦çš„åŒºåˆ«ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th>é€‚ç”¨å¯¹è±¡</th>
<th>éå†æ–¹å¼</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Iterator</td>
<td>Listã€Setã€Mapç­‰</td>
<td>åªèƒ½é¡ºåºå‘åéå†</td>
<td>åªèƒ½remove()</td>
</tr>
<tr>
<td style="text-align:left">ListIterator</td>
<td>List</td>
<td>é¡ºåºå‘åå’Œé¡ºåºå‘å‰ï¼ˆé€†å‘ï¼‰</td>
<td>remove()ã€add()ã€set()</td>
</tr>
</tbody>
</table>
<h2 id="éšæœºè®¿é—®å³é€šè¿‡ç´¢å¼•å€¼éå†">éšæœºè®¿é—®ï¼Œå³é€šè¿‡ç´¢å¼•å€¼éå†<a hidden class="anchor" aria-hidden="true" href="#éšæœºè®¿é—®å³é€šè¿‡ç´¢å¼•å€¼éå†">#</a></h2>
<p>å› ä¸ºArrayListå®ç°äº†RandomAccessæ¥å£</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> size = list.<span style="color:#007f7f">size</span>();
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = 0; i &lt; size; i++) {
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(list.<span style="color:#007f7f">get</span>(i));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="foreachå¾ªç¯éå†">foreachå¾ªç¯éå†<a hidden class="anchor" aria-hidden="true" href="#foreachå¾ªç¯éå†">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">for</span>(String str : list){
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(str);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ•ˆç‡æ¯”å¯¹">æ•ˆç‡æ¯”å¯¹<a hidden class="anchor" aria-hidden="true" href="#æ•ˆç‡æ¯”å¯¹">#</a></h2>
<p>è¿­ä»£å™¨æœ€æ…¢ï¼Œforå¾ªç¯æœ€å¿«</p>
<h1 id="toarrayå¼‚å¸¸">toArray()å¼‚å¸¸<a hidden class="anchor" aria-hidden="true" href="#toarrayå¼‚å¸¸">#</a></h1>
<p>ArrayList æä¾›äº†2ä¸ª toArray() å‡½æ•°ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Object[] toArray()
</span></span><span style="display:flex;"><span>&lt;T&gt; T[] toArray(T[] contents)
</span></span></code></pre></td></tr></table>
</div>
</div><p>è°ƒç”¨ç¬¬ä¸€ä¸ª toArray() å¯èƒ½ä¼šæŠ›å‡º<code>java.lang.ClassCastException</code>å¼‚å¸¸ï¼Œæ˜¯å› ä¸º toArray() è¿”å›çš„æ˜¯ Object[] æ•°ç»„ï¼Œå°† Object[] è½¬æ¢ä¸ºå…¶å®ƒç±»å‹(å¦‚ï¼šå°†Object[]è½¬æ¢ä¸ºçš„Integer[])ï¼Œåˆ™ä¼šæŠ›å‡º<code>java.lang.ClassCastException</code>å¼‚å¸¸ï¼Œ<strong>å› ä¸ºJavaä¸æ”¯æŒå‘ä¸‹è½¬å‹</strong>ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨ç¬¬äºŒä¸ª toArrayã€‚</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List&lt;Integer&gt; list = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;&gt;(3);
</span></span><span style="display:flex;"><span>list.<span style="color:#007f7f">add</span>(1);
</span></span><span style="display:flex;"><span>list.<span style="color:#007f7f">add</span>(2);
</span></span><span style="display:flex;"><span>list.<span style="color:#007f7f">add</span>(3);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//è¿™é‡Œnew Integer[0]ï¼Œè€Œä¸æ˜¯new Integer[list.size()]</span>
</span></span><span style="display:flex;"><span>Integer[] arr = list.<span style="color:#007f7f">toArray</span>(<span style="color:#fff;font-weight:bold">new</span> Integer[0]);
</span></span><span style="display:flex;"><span>System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(arr.<span style="color:#007f7f">length</span>);
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯´æ˜ï¼šä½¿ç”¨ toArray å¸¦å‚æ–¹æ³•ï¼Œæ•°ç»„ç©ºé—´å¤§å°çš„ lengthï¼š
1ï¼‰ ç­‰äº 0ï¼ŒåŠ¨æ€åˆ›å»ºä¸ size ç›¸åŒçš„æ•°ç»„ï¼Œæ€§èƒ½æœ€å¥½ã€‚
2ï¼‰ å¤§äº 0 ä½†å°äº sizeï¼Œé‡æ–°åˆ›å»ºå¤§å°ç­‰äº size çš„æ•°ç»„ï¼Œå¢åŠ  GC è´Ÿæ‹…ã€‚
3ï¼‰ ç­‰äº sizeï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œæ•°ç»„åˆ›å»ºå®Œæˆä¹‹åï¼Œsize æ­£åœ¨å˜å¤§çš„æƒ…å†µä¸‹ï¼Œè´Ÿé¢å½±å“ä¸ 2 ç›¸åŒã€‚
4ï¼‰ å¤§äº sizeï¼Œç©ºé—´æµªè´¹ï¼Œä¸”åœ¨ size å¤„æ’å…¥ null å€¼ï¼Œå­˜åœ¨ NPE éšæ‚£ã€‚</p>
<p>å‚è€ƒtoArrayæºç </p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> &lt;T&gt; T[] toArray(T[] a) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (a.<span style="color:#007f7f">length</span> &lt; size)
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// Make a new array of a&#39;s runtime type, but my contents:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> (T[]) Arrays.<span style="color:#007f7f">copyOf</span>(elementData, size, a.<span style="color:#007f7f">getClass</span>());
</span></span><span style="display:flex;"><span>    System.<span style="color:#007f7f">arraycopy</span>(elementData, 0, a, 0, size);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (a.<span style="color:#007f7f">length</span> &gt; size)
</span></span><span style="display:flex;"><span>        a[size] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> a;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="arraylist-ä½¿ç”¨ç¤ºä¾‹">Arraylist ä½¿ç”¨ç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#arraylist-ä½¿ç”¨ç¤ºä¾‹">#</a></h1>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ArrayListTest {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åˆ›å»ºArrayList</span>
</span></span><span style="display:flex;"><span>        ArrayList list = <span style="color:#fff;font-weight:bold">new</span> ArrayList();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å°†â€œâ€</span>
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">add</span>(<span style="color:#0ff;font-weight:bold">&#34;1&#34;</span>);
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">add</span>(<span style="color:#0ff;font-weight:bold">&#34;2&#34;</span>);
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">add</span>(<span style="color:#0ff;font-weight:bold">&#34;3&#34;</span>);
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">add</span>(<span style="color:#0ff;font-weight:bold">&#34;4&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å°†ä¸‹é¢çš„å…ƒç´ æ·»åŠ åˆ°ç¬¬1ä¸ªä½ç½®</span>
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">add</span>(0, <span style="color:#0ff;font-weight:bold">&#34;5&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// è·å–ç¬¬1ä¸ªå…ƒç´ </span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;the first element is: &#34;</span>+ list.<span style="color:#007f7f">get</span>(0));
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åˆ é™¤â€œ3â€</span>
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">remove</span>(<span style="color:#0ff;font-weight:bold">&#34;3&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// è·å–ArrayListçš„å¤§å°</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;Arraylist size=: &#34;</span>+ list.<span style="color:#007f7f">size</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åˆ¤æ–­listä¸­æ˜¯å¦åŒ…å«&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ArrayList contains 3 is: &#34;</span>+ list.<span style="color:#007f7f">contains</span>(3));
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// è®¾ç½®ç¬¬2ä¸ªå…ƒç´ ä¸º10</span>
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">set</span>(1, <span style="color:#0ff;font-weight:bold">&#34;10&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// é€šè¿‡Iteratoréå†ArrayList</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span>(Iterator iter = list.<span style="color:#007f7f">iterator</span>(); iter.<span style="color:#007f7f">hasNext</span>(); ) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;next is: &#34;</span>+ iter.<span style="color:#007f7f">next</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// å°†ArrayListè½¬æ¢ä¸ºæ•°ç»„</span>
</span></span><span style="display:flex;"><span>        String[] arr = (String[])list.<span style="color:#007f7f">toArray</span>(<span style="color:#fff;font-weight:bold">new</span> String[0]);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (String str:arr)
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;str: &#34;</span>+ str);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// æ¸…ç©ºArrayList</span>
</span></span><span style="display:flex;"><span>        list.<span style="color:#007f7f">clear</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åˆ¤æ–­ArrayListæ˜¯å¦ä¸ºç©º</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;ArrayList is empty: &#34;</span>+ list.<span style="color:#007f7f">isEmpty</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="fail-fastæœºåˆ¶">Fail-Fastæœºåˆ¶<a hidden class="anchor" aria-hidden="true" href="#fail-fastæœºåˆ¶">#</a></h1>
<p>fail-fast æœºåˆ¶æ˜¯javaé›†åˆ(Collection)ä¸­çš„ä¸€ç§é”™è¯¯æœºåˆ¶ã€‚å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆçš„å†…å®¹è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±å¯èƒ½ä¼šäº§ç”Ÿfail-fastäº‹ä»¶ã€‚
ä¾‹å¦‚ï¼šå½“æŸä¸€ä¸ªçº¿ç¨‹Aé€šè¿‡iteratorå»éå†æŸé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè‹¥è¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›é‚£ä¹ˆçº¿ç¨‹Aè®¿é—®é›†åˆæ—¶ï¼Œå°±ä¼šæŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</p>
<h2 id="fail-fastç¤ºä¾‹">fail-fastç¤ºä¾‹<a hidden class="anchor" aria-hidden="true" href="#fail-fastç¤ºä¾‹">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.*;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.concurrent.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">/*
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> * @desc javaé›†åˆä¸­Fast-Failçš„æµ‹è¯•ç¨‹åºã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *   fast-failäº‹ä»¶äº§ç”Ÿçš„æ¡ä»¶ï¼šå½“å¤šä¸ªçº¿ç¨‹å¯¹Collectionè¿›è¡Œæ“ä½œæ—¶ï¼Œè‹¥å…¶ä¸­æŸä¸€ä¸ªçº¿ç¨‹é€šè¿‡iteratorå»éå†é›†åˆæ—¶ï¼Œè¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜ï¼›åˆ™ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *   fast-failè§£å†³åŠæ³•ï¼šé€šè¿‡util.concurrenté›†åˆåŒ…ä¸‹çš„ç›¸åº”ç±»å»å¤„ç†ï¼Œåˆ™ä¸ä¼šäº§ç”Ÿfast-failäº‹ä»¶ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *   æœ¬ä¾‹ä¸­ï¼Œåˆ†åˆ«æµ‹è¯•ArrayListå’ŒCopyOnWriteArrayListè¿™ä¸¤ç§æƒ…å†µã€‚ArrayListä¼šäº§ç”Ÿfast-failäº‹ä»¶ï¼Œè€ŒCopyOnWriteArrayListä¸ä¼šäº§ç”Ÿfast-failäº‹ä»¶ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *   (01) ä½¿ç”¨ArrayListæ—¶ï¼Œä¼šäº§ç”Ÿfast-failäº‹ä»¶ï¼ŒæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼›å®šä¹‰å¦‚ä¸‹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *            private static List&lt;String&gt; list = new ArrayList&lt;String&gt;();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *   (02) ä½¿ç”¨æ—¶CopyOnWriteArrayListï¼Œä¸ä¼šäº§ç”Ÿfast-failäº‹ä»¶ï¼›å®šä¹‰å¦‚ä¸‹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> *            private static List&lt;String&gt; list = new CopyOnWriteArrayList&lt;String&gt;();
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> FastFailTest {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> List&lt;String&gt; list = <span style="color:#fff;font-weight:bold">new</span> ArrayList&lt;String&gt;();
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//private static List&lt;String&gt; list = new CopyOnWriteArrayList&lt;String&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> main(String[] args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// åŒæ—¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹å¯¹listè¿›è¡Œæ“ä½œ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">new</span> ThreadOne().<span style="color:#007f7f">start</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">new</span> ThreadTwo().<span style="color:#007f7f">start</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">void</span> printAll() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">println</span>(<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        String value = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        Iterator iter = list.<span style="color:#007f7f">iterator</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">while</span>(iter.<span style="color:#007f7f">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            value = (String)iter.<span style="color:#007f7f">next</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">out</span>.<span style="color:#007f7f">print</span>(value+<span style="color:#0ff;font-weight:bold">&#34;, &#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘listä¸­ä¾æ¬¡æ·»åŠ 0,1,2,3,4,5ï¼Œæ¯æ·»åŠ ä¸€ä¸ªæ•°ä¹‹åï¼Œå°±é€šè¿‡printAll()éå†æ•´ä¸ªlist
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">class</span> ThreadOne <span style="color:#fff;font-weight:bold">extends</span> Thread {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">int</span> i = 0;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">while</span> (i&lt;6) {
</span></span><span style="display:flex;"><span>                list.<span style="color:#007f7f">add</span>(String.<span style="color:#007f7f">valueOf</span>(i));
</span></span><span style="display:flex;"><span>                printAll();
</span></span><span style="display:flex;"><span>                i++;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/**
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     * å‘listä¸­ä¾æ¬¡æ·»åŠ 10,11,12,13,14,15ï¼Œæ¯æ·»åŠ ä¸€ä¸ªæ•°ä¹‹åï¼Œå°±é€šè¿‡printAll()éå†æ•´ä¸ªlist
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">class</span> ThreadTwo <span style="color:#fff;font-weight:bold">extends</span> Thread {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> run() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">int</span> i = 10;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">while</span> (i&lt;16) {
</span></span><span style="display:flex;"><span>                list.<span style="color:#007f7f">add</span>(String.<span style="color:#007f7f">valueOf</span>(i));
</span></span><span style="display:flex;"><span>                printAll();
</span></span><span style="display:flex;"><span>                i++;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š
è¿è¡Œè¯¥ä»£ç ï¼ŒæŠ›å‡ºå¼‚å¸¸<code>java.util.ConcurrentModificationException</code>å³ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</p>
<p>ç»“æœè¯´æ˜ï¼š</p>
<ul>
<li>FastFailTestä¸­é€šè¿‡ new ThreadOne().start() å’Œ new ThreadTwo().start() åŒæ—¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹å»æ“ä½œlistã€‚
ThreadOneçº¿ç¨‹ï¼šå‘listä¸­ä¾æ¬¡æ·»åŠ 0,1,2,3,4,5ã€‚æ¯æ·»åŠ ä¸€ä¸ªæ•°ä¹‹åï¼Œå°±é€šè¿‡printAll()éå†æ•´ä¸ªlistã€‚
ThreadTwoçº¿ç¨‹ï¼šå‘listä¸­ä¾æ¬¡æ·»åŠ 10,11,12,13,14,15ã€‚æ¯æ·»åŠ ä¸€ä¸ªæ•°ä¹‹åï¼Œå°±é€šè¿‡printAll()éå†æ•´ä¸ªlistã€‚</li>
<li>å½“æŸä¸€ä¸ªçº¿ç¨‹éå†listçš„è¿‡ç¨‹ä¸­ï¼Œlistçš„å†…å®¹è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰€æ”¹å˜äº†ï¼›å°±ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</li>
</ul>
<h2 id="fail-fastè§£å†³åŠæ³•">fail-fastè§£å†³åŠæ³•<a hidden class="anchor" aria-hidden="true" href="#fail-fastè§£å†³åŠæ³•">#</a></h2>
<p>fail-fastæœºåˆ¶ï¼Œæ˜¯ä¸€ç§é”™è¯¯æ£€æµ‹æœºåˆ¶ã€‚å®ƒåªèƒ½è¢«ç”¨æ¥æ£€æµ‹é”™è¯¯ï¼Œå› ä¸ºJDKå¹¶ä¸ä¿è¯fail-fastæœºåˆ¶ä¸€å®šä¼šå‘ç”Ÿã€‚è‹¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨fail-fastæœºåˆ¶çš„é›†åˆï¼Œå»ºè®®ä½¿ç”¨<code>java.util.concurrent</code>åŒ…ä¸‹çš„ç±»â€å»å–ä»£<code>java.utilåŒ…ä¸‹çš„ç±»</code>ã€‚
æ‰€ä»¥ï¼Œæœ¬ä¾‹ä¸­åªéœ€è¦å°†ArrayListæ›¿æ¢æˆjava.util.concurrentåŒ…ä¸‹å¯¹åº”çš„ç±»å³å¯ã€‚
å³ï¼Œå°†ä»£ç 
<code>List&lt;String&gt; list = new ArrayList&lt;String&gt;();</code>
æ›¿æ¢ä¸º
<code>List&lt;String&gt; cList = new CopyOnWriteArrayList&lt;&gt;();</code>
å³å¯è§£å†³</p>
<h2 id="fail-faståŸç†">fail-faståŸç†<a hidden class="anchor" aria-hidden="true" href="#fail-faståŸç†">#</a></h2>
<p>äº§ç”Ÿfail-fastäº‹ä»¶ï¼Œæ˜¯é€šè¿‡æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸æ¥è§¦å‘çš„ã€‚é‚£ä¹ˆï¼ŒArrayListæ˜¯å¦‚ä½•æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸çš„å‘¢?
æˆ‘ä»¬çŸ¥é“ï¼Œ<code>ConcurrentModificationException</code>æ˜¯åœ¨æ“ä½œIteratoræ—¶æŠ›å‡ºçš„å¼‚å¸¸ã€‚é€šè¿‡æŸ¥çœ‹Iteratorçš„æºç (ArrayListçš„ Iterator æ˜¯åœ¨çˆ¶ç±»<code>AbstractList.java</code>ä¸­å®ç°çš„)</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> java.util;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">abstract</span> <span style="color:#fff;font-weight:bold">class</span> AbstractList&lt;E&gt; <span style="color:#fff;font-weight:bold">extends</span> AbstractCollection&lt;E&gt; <span style="color:#fff;font-weight:bold">implements</span> List&lt;E&gt; {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// AbstractListä¸­å”¯ä¸€çš„å±æ€§</span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ç”¨æ¥è®°å½•Listä¿®æ”¹çš„æ¬¡æ•°ï¼šæ¯ä¿®æ”¹ä¸€æ¬¡(æ·»åŠ /åˆ é™¤ç­‰æ“ä½œ)ï¼Œå°†modCount+1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">protected</span> <span style="color:#fff;font-weight:bold">transient</span> <span style="color:#fff;font-weight:bold">int</span> modCount = 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è¿”å›Listå¯¹åº”è¿­ä»£å™¨ã€‚å®é™…ä¸Šï¼Œæ˜¯è¿”å›Itrå¯¹è±¡ã€‚</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Iterator&lt;E&gt; iterator() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> Itr();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// Itræ˜¯Iterator(è¿­ä»£å™¨)çš„å®ç°ç±»</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">class</span> Itr <span style="color:#fff;font-weight:bold">implements</span> Iterator&lt;E&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> cursor = 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> lastRet = -1;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹æ•°çš„è®°å½•å€¼ã€‚</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// æ¯æ¬¡æ–°å»ºItr()å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šä¿å­˜æ–°å»ºè¯¥å¯¹è±¡æ—¶å¯¹åº”çš„modCountï¼›</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä»¥åæ¯æ¬¡éå†Listä¸­çš„å…ƒç´ çš„æ—¶å€™ï¼Œéƒ½ä¼šæ¯”è¾ƒexpectedModCountå’ŒmodCountæ˜¯å¦ç›¸ç­‰ï¼›</span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// è‹¥ä¸ç›¸ç­‰ï¼Œåˆ™æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> expectedModCount = modCount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hasNext() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> cursor != size();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> E next() {
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šåˆ¤æ–­â€œæ–°å»ºItrå¯¹è±¡æ—¶ä¿å­˜çš„modCountâ€å’Œâ€œå½“å‰çš„modCountâ€æ˜¯å¦ç›¸ç­‰ï¼›</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// è‹¥ä¸ç›¸ç­‰ï¼Œåˆ™æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</span>
</span></span><span style="display:flex;"><span>            checkForComodification();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                E next = get(cursor);
</span></span><span style="display:flex;"><span>                lastRet = cursor++;
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">return</span> next;
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">catch</span> (IndexOutOfBoundsException e) {
</span></span><span style="display:flex;"><span>                checkForComodification();
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> NoSuchElementException();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> remove() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (lastRet == -1)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> IllegalStateException();
</span></span><span style="display:flex;"><span>            checkForComodification();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                AbstractList.<span style="color:#007f7f">this</span>.<span style="color:#007f7f">remove</span>(lastRet);
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">if</span> (lastRet &lt; cursor)
</span></span><span style="display:flex;"><span>                    cursor--;
</span></span><span style="display:flex;"><span>                lastRet = -1;
</span></span><span style="display:flex;"><span>                expectedModCount = modCount;
</span></span><span style="display:flex;"><span>            } <span style="color:#fff;font-weight:bold">catch</span> (IndexOutOfBoundsException e) {
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> ConcurrentModificationException();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">final</span> <span style="color:#fff;font-weight:bold">void</span> checkForComodification() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (modCount != expectedModCount)
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> ConcurrentModificationException();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»æºä»£ç ä¸­å‘ç°ï¼Œåœ¨è°ƒç”¨ next() å’Œ remove()æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œ <code>checkForComodification()</code>ã€‚è‹¥ <code>modCount != expectedModCount</code>ï¼Œåˆ™æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚
è¦ææ˜ç™½ fail-fastæœºåˆ¶ï¼Œéœ€è¦ç†è§£ä»€ä¹ˆæ—¶å€™<code>modCount != expectedModCount</code>
è§‚å¯ŸItrç±»ï¼Œæˆ‘ä»¬å‘ç°åœ¨åˆ›å»ºItrå¯¹è±¡æ—¶ï¼Œ<code>expectedModCount </code>è¢«èµ‹å€¼ä¸º <code>modCount</code>ã€‚å¹¶ä¸”<code>expectedModCount</code>ä¸å¯èƒ½è¢«ä¿®æ”¹ä¸ºä¸ç­‰äº <code>modCount</code>ã€‚æ‰€ä»¥ï¼Œéœ€è¦è€ƒè¯çš„å°±æ˜¯<code>modCount</code>ä½•æ—¶ä¼šè¢«ä¿®æ”¹ã€‚æŸ¥çœ‹ArrayListçš„æºç ï¼Œæ¥çœ‹çœ‹modCountæ˜¯å¦‚ä½•è¢«ä¿®æ”¹çš„ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> java.util;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> ArrayList&lt;E&gt; <span style="color:#fff;font-weight:bold">extends</span> AbstractList&lt;E&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">implements</span> List&lt;E&gt;, RandomAccess, Cloneable, java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">Serializable</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// listä¸­å®¹é‡å˜åŒ–æ—¶ï¼Œå¯¹åº”çš„åŒæ­¥å‡½æ•°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> ensureCapacity(<span style="color:#fff;font-weight:bold">int</span> minCapacity) {
</span></span><span style="display:flex;"><span>        modCount++;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> oldCapacity = elementData.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (minCapacity &gt; oldCapacity) {
</span></span><span style="display:flex;"><span>            Object oldData[] = elementData;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">int</span> newCapacity = (oldCapacity * 3)/2 + 1;
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (newCapacity &lt; minCapacity)
</span></span><span style="display:flex;"><span>                newCapacity = minCapacity;
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// minCapacity is usually close to size, so this is a win:</span>
</span></span><span style="display:flex;"><span>            elementData = Arrays.<span style="color:#007f7f">copyOf</span>(elementData, newCapacity);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ·»åŠ å…ƒç´ åˆ°é˜Ÿåˆ—æœ€å</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> add(E e) {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        ensureCapacity(size + 1);  <span style="color:#007f7f">// Increments modCount!!</span>
</span></span><span style="display:flex;"><span>        elementData[size++] = e;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ·»åŠ å…ƒç´ åˆ°æŒ‡å®šçš„ä½ç½®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> add(<span style="color:#fff;font-weight:bold">int</span> index, E element) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (index &gt; size || index &lt; 0)
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> IndexOutOfBoundsException(
</span></span><span style="display:flex;"><span>            <span style="color:#0ff;font-weight:bold">&#34;Index: &#34;</span>+index+<span style="color:#0ff;font-weight:bold">&#34;, Size: &#34;</span>+size);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        ensureCapacity(size+1);  <span style="color:#007f7f">// Increments modCount!!</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">arraycopy</span>(elementData, index, elementData, index + 1,
</span></span><span style="display:flex;"><span>                         size - index);
</span></span><span style="display:flex;"><span>        elementData[index] = element;
</span></span><span style="display:flex;"><span>        size++;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ·»åŠ é›†åˆ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> addAll(Collection&lt;? <span style="color:#fff;font-weight:bold">extends</span> E&gt; c) {
</span></span><span style="display:flex;"><span>        Object[] a = c.<span style="color:#007f7f">toArray</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> numNew = a.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        ensureCapacity(size + numNew);  <span style="color:#007f7f">// Increments modCount</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#007f7f">arraycopy</span>(a, 0, elementData, size, numNew);
</span></span><span style="display:flex;"><span>        size += numNew;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> numNew != 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> E remove(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>        RangeCheck(index);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        modCount++;
</span></span><span style="display:flex;"><span>        E oldValue = (E) elementData[index];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> numMoved = size - index - 1;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (numMoved &gt; 0)
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">arraycopy</span>(elementData, index+1, elementData, index, numMoved);
</span></span><span style="display:flex;"><span>        elementData[--size] = <span style="color:#fff;font-weight:bold">null</span>; <span style="color:#007f7f">// Let gc do its work</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> oldValue;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// å¿«é€Ÿåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">void</span> fastRemove(<span style="color:#fff;font-weight:bold">int</span> index) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        modCount++;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">int</span> numMoved = size - index - 1;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (numMoved &gt; 0)
</span></span><span style="display:flex;"><span>            System.<span style="color:#007f7f">arraycopy</span>(elementData, index+1, elementData, index,
</span></span><span style="display:flex;"><span>                             numMoved);
</span></span><span style="display:flex;"><span>        elementData[--size] = <span style="color:#fff;font-weight:bold">null</span>; <span style="color:#007f7f">// Let gc do its work</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// æ¸…ç©ºé›†åˆ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> clear() {
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// ä¿®æ”¹modCount</span>
</span></span><span style="display:flex;"><span>        modCount++;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#007f7f">// Let gc do its work</span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = 0; i &lt; size; i++)
</span></span><span style="display:flex;"><span>            elementData[i] = <span style="color:#fff;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        size = 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼šæ— è®ºæ˜¯add()ã€remove()ï¼Œè¿˜æ˜¯clear()ï¼Œåªè¦æ¶‰åŠåˆ°ä¿®æ”¹é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°æ—¶ï¼Œéƒ½ä¼šæ”¹å˜modCountçš„å€¼ã€‚
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç³»ç»Ÿçš„æ¢³ç†ä¸€ä¸‹fail-fastæ˜¯æ€ä¹ˆäº§ç”Ÿçš„ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ–°å»ºäº†ä¸€ä¸ªArrayListï¼Œåç§°ä¸ºarrayListã€‚</li>
<li>å‘arrayListä¸­æ·»åŠ å†…å®¹ã€‚</li>
<li>æ–°å»ºä¸€ä¸ªâ€œçº¿ç¨‹aâ€ï¼Œå¹¶åœ¨â€œçº¿ç¨‹aâ€ä¸­é€šè¿‡Iteratoråå¤çš„è¯»å–arrayListçš„å€¼ã€‚</li>
<li>æ–°å»ºä¸€ä¸ªâ€œçº¿ç¨‹bâ€ï¼Œåœ¨â€œçº¿ç¨‹bâ€ä¸­åˆ é™¤arrayListä¸­çš„ä¸€ä¸ªâ€œèŠ‚ç‚¹Aâ€ã€‚</li>
<li>è¿™æ—¶ï¼Œå°±ä¼šäº§ç”Ÿæœ‰è¶£çš„äº‹ä»¶äº†ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œâ€œçº¿ç¨‹aâ€åˆ›å»ºäº†arrayListçš„Iteratorã€‚æ­¤æ—¶â€œèŠ‚ç‚¹Aâ€ä»ç„¶å­˜åœ¨äºarrayListä¸­ï¼Œåˆ›å»ºarrayListæ—¶ï¼ŒexpectedModCount = modCount(å‡è®¾å®ƒä»¬æ­¤æ—¶çš„å€¼ä¸ºN)ã€‚</li>
<li>åœ¨â€œçº¿ç¨‹aâ€åœ¨éå†arrayListè¿‡ç¨‹ä¸­çš„æŸä¸€æ—¶åˆ»ï¼Œâ€œçº¿ç¨‹bâ€æ‰§è¡Œäº†ï¼Œå¹¶ä¸”â€œçº¿ç¨‹bâ€åˆ é™¤äº†arrayListä¸­çš„â€œèŠ‚ç‚¹Aâ€ã€‚â€œçº¿ç¨‹bâ€æ‰§è¡Œremove()è¿›è¡Œåˆ é™¤æ“ä½œæ—¶ï¼Œåœ¨remove()ä¸­æ‰§è¡Œäº†â€œmodCount++â€ï¼Œæ­¤æ—¶modCountå˜æˆäº†N+1ã€‚</li>
<li>â€œçº¿ç¨‹aâ€æ¥ç€éå†ï¼Œå½“å®ƒæ‰§è¡Œåˆ°next()å‡½æ•°æ—¶ï¼Œè°ƒç”¨<code>checkForComodification()æ¯”è¾ƒexpectedModCountå’ŒmodCount</code>çš„å¤§å°ï¼›è€Œâ€œexpectedModCount=Nâ€ï¼Œâ€œmodCount=N+1â€,è¿™æ ·ï¼Œä¾¿æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œå…¨äº†è§£äº†fail-fastæ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚
å³ï¼Œå½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªé›†åˆè¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼ŒæŸçº¿ç¨‹è®¿é—®é›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œè¯¥é›†åˆçš„å†…å®¹è¢«å…¶ä»–çº¿ç¨‹æ‰€æ”¹å˜(å³å…¶å®ƒçº¿ç¨‹é€šè¿‡addã€removeã€clearç­‰æ–¹æ³•ï¼Œæ”¹å˜äº†modCountçš„å€¼)ï¼›è¿™æ—¶ï¼Œå°±ä¼šæŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ï¼Œäº§ç”Ÿfail-fastäº‹ä»¶ã€‚</p>
<h2 id="è§£å†³fail-fastçš„åŸç†">è§£å†³fail-fastçš„åŸç†<a hidden class="anchor" aria-hidden="true" href="#è§£å†³fail-fastçš„åŸç†">#</a></h2>
<p>ä¸Šé¢ï¼Œè¯´æ˜äº†â€œè§£å†³fail-fastæœºåˆ¶çš„åŠæ³•â€ï¼Œä¹ŸçŸ¥é“äº†â€œfail-fastäº§ç”Ÿçš„æ ¹æœ¬åŸå› â€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†è¿›ä¸€æ­¥è°ˆè°ˆjava.util.concurrentåŒ…ä¸­æ˜¯å¦‚ä½•è§£å†³fail-fastäº‹ä»¶çš„ã€‚
è¿˜æ˜¯ä»¥å’ŒArrayListå¯¹åº”çš„CopyOnWriteArrayListè¿›è¡Œè¯´æ˜ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹CopyOnWriteArrayListçš„æºç ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">73
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">package</span> java.util.concurrent;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.*;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> java.util.concurrent.locks.*;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">import</span> sun.misc.Unsafe;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">class</span> CopyOnWriteArrayList&lt;E&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">implements</span> List&lt;E&gt;, RandomAccess, Cloneable, java.<span style="color:#007f7f">io</span>.<span style="color:#007f7f">Serializable</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è¿”å›é›†åˆå¯¹åº”çš„è¿­ä»£å™¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">public</span> Iterator&lt;E&gt; iterator() {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> <span style="color:#fff;font-weight:bold">new</span> COWIterator&lt;E&gt;(getArray(), 0);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">static</span> <span style="color:#fff;font-weight:bold">class</span> COWIterator&lt;E&gt; <span style="color:#fff;font-weight:bold">implements</span> ListIterator&lt;E&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">final</span> Object[] snapshot;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">private</span> <span style="color:#fff;font-weight:bold">int</span> cursor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">private</span> COWIterator(Object[] elements, <span style="color:#fff;font-weight:bold">int</span> initialCursor) {
</span></span><span style="display:flex;"><span>            cursor = initialCursor;
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// æ–°å»ºCOWIteratoræ—¶ï¼Œå°†é›†åˆä¸­çš„å…ƒç´ ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„æ‹·è´æ•°ç»„ä¸­ã€‚</span>
</span></span><span style="display:flex;"><span>            <span style="color:#007f7f">// è¿™æ ·ï¼Œå½“åŸå§‹é›†åˆçš„æ•°æ®æ”¹å˜ï¼Œæ‹·è´æ•°æ®ä¸­çš„å€¼ä¹Ÿä¸ä¼šå˜åŒ–ã€‚</span>
</span></span><span style="display:flex;"><span>            snapshot = elements;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hasNext() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> cursor &lt; snapshot.<span style="color:#007f7f">length</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">boolean</span> hasPrevious() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> cursor &gt; 0;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> E next() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (! hasNext())
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> NoSuchElementException();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> (E) snapshot[cursor++];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> E previous() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">if</span> (! hasPrevious())
</span></span><span style="display:flex;"><span>                <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> NoSuchElementException();
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> (E) snapshot[--cursor];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">int</span> nextIndex() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> cursor;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">int</span> previousIndex() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">return</span> cursor-1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> remove() {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> UnsupportedOperationException();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> set(E e) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> UnsupportedOperationException();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">public</span> <span style="color:#fff;font-weight:bold">void</span> add(E e) {
</span></span><span style="display:flex;"><span>            <span style="color:#fff;font-weight:bold">throw</span> <span style="color:#fff;font-weight:bold">new</span> UnsupportedOperationException();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>å’ŒArrayListç»§æ‰¿äºAbstractListä¸åŒï¼Œ<code>CopyOnWriteArrayList</code>æ²¡æœ‰ç»§æ‰¿äº<code>AbstractList</code>ï¼Œå®ƒä»…ä»…åªæ˜¯å®ç°äº†Listæ¥å£ã€‚</li>
<li>ArrayListçš„<code>iterator()</code>å‡½æ•°è¿”å›çš„<code>Iterator</code>æ˜¯åœ¨<code>AbstractList</code>ä¸­å®ç°çš„ï¼›è€Œ<code>CopyOnWriteArrayList</code>æ˜¯è‡ªå·±å®ç°<code>Iterator</code>ã€‚</li>
<li>ArrayListçš„<code>Iterator</code>å®ç°ç±»ä¸­è°ƒç”¨<code>next()</code>æ—¶ï¼Œä¼šâ€œè°ƒç”¨<code>checkForComodification()</code>æ¯”è¾ƒ<code>expectedModCountå’ŒmodCount</code>çš„å¤§å°â€ï¼›ä½†æ˜¯ï¼Œ<code>CopyOnWriteArrayList</code>çš„<code>Iterator</code>å®ç°ç±»ä¸­ï¼Œæ²¡æœ‰æ‰€è°“çš„<code>checkForComodification()</code>ï¼Œæ›´ä¸ä¼šæŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚</li>
</ul>
<p>è‡³æ­¤ï¼Œå…³äºArraylistçš„å†…å®¹å…¨éƒ¨æ€»ç»“å®Œæ¯•ã€‚</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://funny-toffee-4aa7c3.netlify.app/tags/java%E9%9B%86%E5%90%88/">Javaé›†åˆ</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://funny-toffee-4aa7c3.netlify.app/">Wjy&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>