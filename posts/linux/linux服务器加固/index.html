<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>linux服务器加固 | Wjy&#39;s Blog</title>
<meta name="keywords" content="linux">
<meta name="description" content="linux加固 参考：一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO 【配置优化】我拿到VPS服务器必做的那些事 -">
<meta name="author" content="Wjy">
<link rel="canonical" href="https://009965.xyz/posts/linux/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://009965.xyz/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://009965.xyz/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://009965.xyz/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://009965.xyz/apple-touch-icon.png">
<link rel="mask-icon" href="https://009965.xyz/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://009965.xyz/posts/linux/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:url" content="https://009965.xyz/posts/linux/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA/">
  <meta property="og:site_name" content="Wjy&#39;s Blog">
  <meta property="og:title" content="linux服务器加固">
  <meta property="og:description" content="linux加固 参考：一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO 【配置优化】我拿到VPS服务器必做的那些事 -">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-04-17T11:05:53+00:00">
    <meta property="article:modified_time" content="2019-04-17T11:05:53+00:00">
    <meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="linux服务器加固">
<meta name="twitter:description" content="linux加固 参考：一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO 【配置优化】我拿到VPS服务器必做的那些事 -">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://009965.xyz/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "linux服务器加固",
      "item": "https://009965.xyz/posts/linux/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "linux服务器加固",
  "name": "linux服务器加固",
  "description": "linux加固 参考：一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO 【配置优化】我拿到VPS服务器必做的那些事 -",
  "keywords": [
    "linux"
  ],
  "articleBody": "linux加固 参考：一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO\n【配置优化】我拿到VPS服务器必做的那些事 - 开发调优 - LINUX DO\n更新组件，包管理 不推荐，安装时间太长了\n1 apt update \u0026\u0026 apt upgrade -y 推荐用下面两条\n1 2 3 4 #这个命令会更新软件包列表，让系统知道有哪些软件包可以更新。 sudo apt update #这个命令会安装所有可用的软件包更新。 sudo apt upgrade --only-upgrade 这两条合并使用：\n1 sudo apt update \u0026\u0026 sudo apt upgrade --only-upgrade 更新、安装必备软件 1 apt install sudo curl wget nano 校正系统时间 将时区改为改成上海\n1 sudo timedatectl set-timezone Asia/Shanghai 查看当前时区： 1 timedatectl 列出所有时区： 1 timedatectl list-timezones 系统参数调优 这个功能通过调整各种系统和网络参数来优化服务器的性能。\n实现方法：\n内核参数调整：例如，增加 TCP 缓冲区大小、修改系统队列长度等，这些改变有助于提高网络吞吐量和减少延迟。 性能优化：安装和配置 Tuned 和其他系统性能优化工具来自动调整和优化服务器的运行状态。 资源限制：例如，设置文件打开数量的限制，这可以防止某些类型的资源耗尽攻击。 通过这些功能，你的服务器不仅能够更有效地管理资源，还能提高对外部威胁的防护能力，保障系统稳定运行。\n1 bash \u003c(wget -qO- https://raw.githubusercontent.com/jerry048/Tune/main/tune.sh) -t 添加普通用户 1 2 adduser ubuntu {your-password} visudo 在 User Privilege Specification 下加入一行 ubuntu ALL=(ALL) NOPASSWD: ALL 即可。\n检验是否添加成功 1 2 3 4 su - newuser ls /root sudo ls /root exit #退出 防火墙配置 要在 Ubuntu 上使用 ufw（Uncomplicated Firewall）开启端口 22、80 和 443，你可以按照以下步骤进行配置：\n检查 ufw 是否安装： 如果尚未安装 ufw，你可以使用以下命令安装：sudo apt install ufw 开启端口： 开启端口 22：sudo ufw allow 22 开启端口 80：sudo ufw allow 80 开启端口 443：sudo ufw allow 443 启用防火墙： 启用 ufw 防火墙：sudo ufw enable 检查配置： 可以运行 sudo ufw status 来查看防火墙的状态和已开启的端口。 添加 SWAP 在 Linux 系统中，SWAP（交换空间）是指一块磁盘空间，用于在物理内存（RAM）不足时，作为临时的扩展内存来使用。当系统的物理内存使用量接近饱和，Linux 内核会将一些不常使用的内存页交换到 SWAP 分区中，从而为当前运行的程序腾出更多的物理内存。当这些被交换出去的内存页再次被需要时，它们会被重新换回到物理内存中。SWAP 分区的存在可以在一定程度上避免由于物理内存不足导致系统性能严重下降或进程被强制终止的情况。\n因此，SWAP 对于内存小的 VPS 非常有必要，可以提高我们的运行效率。\n这里我们用脚本来添加。\n1 wget -O swap.sh https://raw.githubusercontent.com/yuju520/Script/main/swap.sh \u0026\u0026 chmod +x swap.sh \u0026\u0026 clear \u0026\u0026 ./swap.sh 查看当前内存\n1 free -m 创建非 root 账户 使用以下命令创建一个具有提权能力的账户：\n1 useradd -m -G sudo -s /bin/bash 用户名 然后我们给这个用户设置一个至少为 16 位的随机大小写字母 + 数字的密码（个人建议的最低安全性需求）：\n1 passwd 用户名 禁用 root SSH 密码登陆 先不提 root 登录本身就是危险的行为，root 账户的用户名固定为”root”，如果允许其通过密码登录，攻击者只需进行密码穷举即可尝试攻破系统。之前我们已经创建了非 root 账户，在这里我们只需要禁用非 root 账户的 SSH 登录即可。\n执行以下命令编辑 SSH 配置文件：\n1 sudo vim /etc/ssh/sshd_config 找到 PermitRootLogin，把它的值改成 no。\n1 PermitRootLogin no 之后重启 SSH 服务生效：\n1 sudo systemctl restart ssh 修改ssh端口 修改 SSH 端口通常有以下几个主要原因：\n增强安全性：SSH 服务默认使用的 22 端口是攻击者经常扫描和尝试攻击的目标。通过将端口修改为一个不常见的数值，可以减少自动攻击和暴力破解的风险，因为攻击者通常会首先针对常见的默认端口进行攻击。 例如，如果攻击者使用自动化工具扫描大量服务器，这些工具可能主要集中在 22 端口。而修改了端口后，就降低了被这类工具轻易发现和攻击的可能性。\n减少误连接和非法访问尝试：一些网络环境中可能存在大量的随机连接请求或非法访问尝试，针对默认的 22 端口。更改端口可以减少这类无意义的连接请求。 假设您的服务器处于一个公共网络环境中，经常会收到大量的随机连接尝试，其中很多是针对常见端口的。修改 SSH 端口可以减少这类不必要的干扰。\n将默认的 22 端口修改为 54321\n1 sudo sed -i 's/^#\\?Port 22.*/Port 54321/g' /etc/ssh/sshd_config 重启 sshd 服务\n1 sudo systemctl restart sshd 密钥登录 注意：一键生成和手动生成，两种方式二选一！\n一键生成密钥 1 wget -O key.sh https://raw.githubusercontent.com/yuju520/Script/main/key.sh \u0026\u0026 chmod +x key.sh \u0026\u0026 clear \u0026\u0026 ./key.sh 注意：请牢记你生成的密钥，否则会有无法连接 SSH 的后果。！！！\n手动生成 这里有个注意点！如果你想禁用root密码登录，并用普通用户 {your-username} ssh登录服务器，这里SSH登录配置部分一定要用普通用户{your-username}配置，不然配置出来的文件权限和拥有者不对，ssh不能正确读取公钥！\n先在windows端生成ssh 公私钥对\n1 ssh-keygen -t rsa -f ~/.ssh/id_rsa_xxxx 在用户目录下创建authorized_keys文件，并将公钥（pub结尾）的内容粘入authorized_keys文件中\n1 2 3 4 5 6 mkdir -p ~/.ssh touch ~/.ssh/authorized_keys #并将公钥（pub结尾）的内容粘入`authorized_keys`文件中 vim ~/.ssh/authorized_keys chmod 600 ~/.ssh/authorized_keys ~ 是指在当前用户的主目录下（如果是root，就是在/root/下；如果是{your-username}则在/home/{your-username}/）。 如果配置在root目录下，那用ssh 密钥对登录时就要选择root用户登录！\n禁用root身份登录。\n找到PermitRootLogin Yes这一项，然后把它后面的设定值改为no即可。\n1 vim /etc/ssh/sshd_config 1 2 3 PermitRootLogin no #开启ssh密钥对登录 PubkeyAuthentication yes 把 PasswordAuthentication 设置成 no，禁止密码登录，更安全：\n1 PasswordAuthentication no SSH端口号改为其他数字，注意了，改成其他端口后，记得防火墙设置也要更新。\n1 Port {SSH端口号，最好在10000以上} 最后重启 SSH Server 生效：\n1 sudo systemctl restart sshd.service 安装 fail2ban 1 apt install fail2ban 配置 fail2ban\nfail2ban 的配置文件通常位于 /etc/fail2ban/ 目录下，fail2ban 的.conf 配置文件都是可以被.local 覆盖，所以配置方式建议是添加.local 文件，不修改原来的配置文件。\n1 nano /etc/fail2ban/jail.local 配置文件如下：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 [DEFAULT] # 忽略的IP列表,不受设置限制（白名单） ignoreip = 127.0.0.1 # 允许ipv6 allowipv6 = auto # 日志修改检测机制（gamin、polling和auto这三种） backend = systemd # 针对各服务的检查配置，如设置bantime、findtime、maxretry和全局冲突，服务优先级大于全局设置 [sshd] # 是否激活此项（true/false） enabled = true # 过滤规则filter的名字，对应filter.d目录下的sshd.conf filter = sshd # ssh端口 port = ssh # 动作的相关参数 action = iptables[name=SSH, port=ssh, protocol=tcp] action = %(action_)s[port=\"%(port)s\", protocol=\"%(protocol)s\", logpath=\"%(logpath)s\", chain=\"%(chain)s\"] # 检测的系统的登陆日志文件 logpath = /var/log/secure # 封禁时间，单位：秒 bantime = 86400 # 这个时间段内超过规定次数会被ban掉 findtime = 86400 # 最大尝试次数 maxretry = 3 # 禁用方式 banaction = iptables-multiport # SSH 登陆日志位置 logpath = /var/log/auth.log Ctrl+S 保存并退出\n设置开机自动启动 fail2ban\n1 sudo systemctl enable fail2ban 重新启动 fail2ban\n1 sudo systemctl restart fail2ban 查看 fail2ban 的状态\n1 sudo systemctl status fail2ban 查看所有可用 jail 的状态\n1 fail2ban-client status xShell使用密钥登录服务器 新建会话属性的连接 配置中输入会话名称和您的云服务器IP地址\n点击连接中的用户身份验证，方法选择Public Key，然后在用户密钥处单击浏览。\n在弹出的用户密钥界面，单击导入。\n选择您保存到本地系统的密钥对文件，然后单击 打开，点击确定。\n此时可以看到用户身份验证界面，用户密钥已经是刚才创建的用户密钥，单击确定，保存连接会话。密码不用填写。\n在会话界面，选择刚才创建的会话，然后点击连接。\n输入用户名root，即可通过密钥方式登录您的Linux服务器。\n安装 Docker、Docker-compose 以及修改配置 非大陆服务器 1 wget -qO- get.docker.com | bash 或\n1 curl -fsSL https://get.docker.com -o get-docker.sh \u0026\u0026 sh get-docker.sh 大陆服务器 Docker 安装 1 curl https://install.1panel.live/docker-install -o docker-install \u0026\u0026 sudo bash ./docker-install \u0026\u0026 rm -f ./docker-install 查看 Docker 版本 1 docker -v 开机自动启动 1 sudo systemctl enable docker 卸载 Docker 1 2 3 4 sudo apt-get purge docker-ce docker-ce-cli containerd.io sudo apt-get remove docker docker-engine sudo rm -rf /var/lib/docker sudo rm -rf /var/lib/containerd Docker-compose 安装 经佬友反馈，Docker 从 18.06.0-ce 版本就开始自带 Docker Compose 工具，因此，我们只需要检验 Docker Compose 的版本。\n查看 Docker Compose 版本 1 docker compose version 检测工具 IP 质量 1 bash \u003c(curl -Ls IP.Check.Place) 性能测试 VPS融合怪服务器测评脚本(VPS Fusion Monster Server Test Script)\n1 curl -L https://github.com/spiritLHLS/ecs/raw/main/ecs.sh -o ecs.sh \u0026\u0026 chmod +x ecs.sh \u0026\u0026 bash ecs.sh 路由追踪 一款追求轻量化的开源可视化路由跟踪工具，看ASN号以及对应的归属非常方便。\n1 curl nxtrace.org/nt |bash 其他 IP 检测工具 DNSCHECKER ipapi.is ip-api ipdata ipinfo.io IPinsight IPIP ping.pe SCAMALYTICS WebRTC Leak Test 阿里云网站运维检测平台 BrowserScan ip滥用报告 ip下过bt没 ip以前有哪些网站 查询网站长啥样 查询网站长啥样 查询网站以前解析的ip ",
  "wordCount" : "3250",
  "inLanguage": "en",
  "datePublished": "2019-04-17T11:05:53Z",
  "dateModified": "2019-04-17T11:05:53Z",
  "author":{
    "@type": "Person",
    "name": "Wjy"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://009965.xyz/posts/linux/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8A%A0%E5%9B%BA/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Wjy's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://009965.xyz/favicon.ico"
    }
  }
}
</script>

  <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.min.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath:  [['\\(', '\\)'], ['$', '$']],  
    }
  };
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://009965.xyz/" accesskey="h" title="Wjy&#39;s Blog (Alt + H)">Wjy&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://009965.xyz/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://009965.xyz/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://009965.xyz/archives/" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://009965.xyz/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://009965.xyz/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://009965.xyz/">Home</a>&nbsp;»&nbsp;<a href="https://009965.xyz/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      linux服务器加固
    </h1>
    <div class="post-meta"><span title='2019-04-17 11:05:53 +0000 UTC'>2019-04-17</span>&nbsp;·&nbsp;Wjy

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#linux%e5%8a%a0%e5%9b%ba" aria-label="linux加固">linux加固</a><ul>
                        
                <li>
                    <a href="#%e6%9b%b4%e6%96%b0%e7%bb%84%e4%bb%b6%e5%8c%85%e7%ae%a1%e7%90%86" aria-label="更新组件，包管理">更新组件，包管理</a></li>
                <li>
                    <a href="#%e6%9b%b4%e6%96%b0%e5%ae%89%e8%a3%85%e5%bf%85%e5%a4%87%e8%bd%af%e4%bb%b6" aria-label="更新、安装必备软件">更新、安装必备软件</a></li>
                <li>
                    <a href="#%e6%a0%a1%e6%ad%a3%e7%b3%bb%e7%bb%9f%e6%97%b6%e9%97%b4" aria-label="校正系统时间">校正系统时间</a></li>
                <li>
                    <a href="#%e7%b3%bb%e7%bb%9f%e5%8f%82%e6%95%b0%e8%b0%83%e4%bc%98" aria-label="系统参数调优">系统参数调优</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e6%99%ae%e9%80%9a%e7%94%a8%e6%88%b7" aria-label="添加普通用户">添加普通用户</a></li>
                <li>
                    <a href="#%e9%98%b2%e7%81%ab%e5%a2%99%e9%85%8d%e7%bd%ae" aria-label="防火墙配置">防火墙配置</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0-swap" aria-label="添加 SWAP">添加 SWAP</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e9%9d%9e-root-%e8%b4%a6%e6%88%b7" aria-label="创建非 root 账户">创建非 root 账户</a></li>
                <li>
                    <a href="#%e7%a6%81%e7%94%a8-root-ssh-%e5%af%86%e7%a0%81%e7%99%bb%e9%99%86" aria-label="禁用 root SSH 密码登陆">禁用 root SSH 密码登陆</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9ssh%e7%ab%af%e5%8f%a3" aria-label="修改ssh端口">修改ssh端口</a></li>
                <li>
                    <a href="#%e5%af%86%e9%92%a5%e7%99%bb%e5%bd%95" aria-label="密钥登录">密钥登录</a><ul>
                        
                <li>
                    <a href="#%e4%b8%80%e9%94%ae%e7%94%9f%e6%88%90%e5%af%86%e9%92%a5" aria-label="一键生成密钥">一键生成密钥</a></li>
                <li>
                    <a href="#%e6%89%8b%e5%8a%a8%e7%94%9f%e6%88%90" aria-label="手动生成">手动生成</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-fail2ban" aria-label="安装 fail2ban">安装 fail2ban</a></li>
                <li>
                    <a href="#xshell%e4%bd%bf%e7%94%a8%e5%af%86%e9%92%a5%e7%99%bb%e5%bd%95%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="xShell使用密钥登录服务器">xShell使用密钥登录服务器</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-dockerdocker-compose-%e4%bb%a5%e5%8f%8a%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae" aria-label="安装 Docker、Docker-compose 以及修改配置">安装 Docker、Docker-compose 以及修改配置</a><ul>
                        
                <li>
                    <a href="#%e9%9d%9e%e5%a4%a7%e9%99%86%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="非大陆服务器">非大陆服务器</a></li>
                <li>
                    <a href="#%e5%a4%a7%e9%99%86%e6%9c%8d%e5%8a%a1%e5%99%a8-docker-%e5%ae%89%e8%a3%85" aria-label="大陆服务器 Docker 安装">大陆服务器 Docker 安装</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b-docker-%e7%89%88%e6%9c%ac" aria-label="查看 Docker 版本">查看 Docker 版本</a></li>
                <li>
                    <a href="#%e5%bc%80%e6%9c%ba%e8%87%aa%e5%8a%a8%e5%90%af%e5%8a%a8" aria-label="开机自动启动">开机自动启动</a></li>
                <li>
                    <a href="#%e5%8d%b8%e8%bd%bd-docker" aria-label="卸载 Docker">卸载 Docker</a></li>
                <li>
                    <a href="#docker-compose-%e5%ae%89%e8%a3%85" aria-label="Docker-compose 安装">Docker-compose 安装</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b-docker-compose-%e7%89%88%e6%9c%ac" aria-label="查看 Docker Compose 版本">查看 Docker Compose 版本</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%a3%80%e6%b5%8b%e5%b7%a5%e5%85%b7" aria-label="检测工具">检测工具</a><ul>
                        
                <li>
                    <a href="#ip-%e8%b4%a8%e9%87%8f" aria-label="IP 质量">IP 质量</a></li>
                <li>
                    <a href="#%e6%80%a7%e8%83%bd%e6%b5%8b%e8%af%95" aria-label="性能测试">性能测试</a></li>
                <li>
                    <a href="#%e8%b7%af%e7%94%b1%e8%bf%bd%e8%b8%aa" aria-label="路由追踪">路由追踪</a></li>
                <li>
                    <a href="#%e5%85%b6%e4%bb%96-ip-%e6%a3%80%e6%b5%8b%e5%b7%a5%e5%85%b7httpsdigvpscomtoolsother-tools%e5%85%b6%e4%bb%96-ip-%e6%a3%80%e6%b5%8b%e5%b7%a5%e5%85%b7" aria-label="其他 IP 检测工具">其他 IP 检测工具</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="linux加固">linux加固<a hidden class="anchor" aria-hidden="true" href="#linux加固">#</a></h1>
<p>参考：<a href="https://linux.do/t/topic/115839">一台新到手的VPS服务器必做十二项配置（以Ubuntu为例） - 开发调优 - LINUX DO</a></p>
<p><a href="https://linux.do/t/topic/160305">【配置优化】我拿到VPS服务器必做的那些事 - 开发调优 - LINUX DO</a></p>
<h2 id="更新组件包管理">更新组件，包管理<a hidden class="anchor" aria-hidden="true" href="#更新组件包管理">#</a></h2>
<p>不推荐，安装时间太长了</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt update &amp;&amp; apt upgrade -y
</span></span></code></pre></td></tr></table>
</div>
</div><p>推荐用下面两条</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#007f7f">#这个命令会更新软件包列表，让系统知道有哪些软件包可以更新。</span>
</span></span><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#这个命令会安装所有可用的软件包更新。</span>
</span></span><span style="display:flex;"><span>sudo apt upgrade --only-upgrade
</span></span></code></pre></td></tr></table>
</div>
</div><p>这两条合并使用：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update &amp;&amp; sudo apt upgrade --only-upgrade
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="更新安装必备软件">更新、安装必备软件<a hidden class="anchor" aria-hidden="true" href="#更新安装必备软件">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt install sudo curl wget nano
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="校正系统时间">校正系统时间<a hidden class="anchor" aria-hidden="true" href="#校正系统时间">#</a></h2>
<p>将时区改为改成上海</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo timedatectl set-timezone Asia/Shanghai
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查看当前时区：</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>timedatectl
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>列出所有时区：</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>timedatectl list-timezones
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="系统参数调优">系统参数调优<a hidden class="anchor" aria-hidden="true" href="#系统参数调优">#</a></h2>
<p>这个功能通过调整各种系统和网络参数来优化服务器的性能。</p>
<p><strong>实现方法</strong>：</p>
<ul>
<li><strong>内核参数调整</strong>：例如，增加 TCP 缓冲区大小、修改系统队列长度等，这些改变有助于提高网络吞吐量和减少延迟。</li>
<li><strong>性能优化</strong>：安装和配置 <code>Tuned</code> 和其他系统性能优化工具来自动调整和优化服务器的运行状态。</li>
<li><strong>资源限制</strong>：例如，设置文件打开数量的限制，这可以防止某些类型的资源耗尽攻击。</li>
</ul>
<p>通过这些功能，你的服务器不仅能够更有效地管理资源，还能提高对外部威胁的防护能力，保障系统稳定运行。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash &lt;(wget -qO- https://raw.githubusercontent.com/jerry048/Tune/main/tune.sh) -t
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="添加普通用户">添加普通用户<a hidden class="anchor" aria-hidden="true" href="#添加普通用户">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adduser ubuntu  {your-password}
</span></span><span style="display:flex;"><span>visudo
</span></span></code></pre></td></tr></table>
</div>
</div><p>在 <code>User Privilege Specification</code> 下加入一行 <code>ubuntu ALL=(ALL) NOPASSWD: ALL</code> 即可。</p>
<ul>
<li>检验是否添加成功</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>su - newuser 
</span></span><span style="display:flex;"><span>ls /root
</span></span><span style="display:flex;"><span>sudo ls /root
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">exit</span> <span style="color:#007f7f">#退出</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="防火墙配置">防火墙配置<a hidden class="anchor" aria-hidden="true" href="#防火墙配置">#</a></h2>
<p>要在 Ubuntu 上使用 <code>ufw</code>（Uncomplicated Firewall）开启端口 22、80 和 443，你可以按照以下步骤进行配置：</p>
<ol>
<li><strong>检查 <code>ufw</code> 是否安装</strong>：
<ul>
<li>如果尚未安装 <code>ufw</code>，你可以使用以下命令安装：<code>sudo apt install ufw</code></li>
</ul>
</li>
<li><strong>开启端口</strong>：
<ul>
<li>开启端口 22：<code>sudo ufw allow 22</code></li>
<li>开启端口 80：<code>sudo ufw allow 80</code></li>
<li>开启端口 443：<code>sudo ufw allow 443</code></li>
</ul>
</li>
<li><strong>启用防火墙</strong>：
<ul>
<li>启用 <code>ufw</code> 防火墙：<code>sudo ufw enable</code></li>
</ul>
</li>
<li><strong>检查配置</strong>：
<ul>
<li>可以运行 <code>sudo ufw status</code> 来查看防火墙的状态和已开启的端口。</li>
</ul>
</li>
</ol>
<h2 id="添加-swap"><strong>添加 SWAP</strong><a hidden class="anchor" aria-hidden="true" href="#添加-swap">#</a></h2>
<p>在 Linux 系统中，<code>SWAP</code>（交换空间）是指一块磁盘空间，用于在物理内存（RAM）不足时，作为临时的扩展内存来使用。当系统的物理内存使用量接近饱和，Linux 内核会将一些不常使用的内存页交换到 <code>SWAP</code> 分区中，从而为当前运行的程序腾出更多的物理内存。当这些被交换出去的内存页再次被需要时，它们会被重新换回到物理内存中。<code>SWAP</code> 分区的存在可以在一定程度上避免由于物理内存不足导致系统性能严重下降或进程被强制终止的情况。</p>
<p>因此，<code>SWAP</code> 对于内存小的 VPS 非常有必要，可以提高我们的运行效率。</p>
<p><strong>这里我们用脚本来添加。</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget -O swap.sh https://raw.githubusercontent.com/yuju520/Script/main/swap.sh &amp;&amp; chmod +x swap.sh &amp;&amp; clear &amp;&amp; ./swap.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>查看当前内存</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">free</span> -m
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="创建非-root-账户">创建非 root 账户<a hidden class="anchor" aria-hidden="true" href="#创建非-root-账户">#</a></h2>
<p>使用以下命令创建一个具有提权能力的账户：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>useradd -m -G sudo -s /bin/bash 用户名
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后我们给这个用户设置一个至少为 16 位的随机大小写字母 + 数字的密码（个人建议的最低安全性需求）：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>passwd 用户名
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="禁用-root-ssh-密码登陆">禁用 root SSH 密码登陆<a hidden class="anchor" aria-hidden="true" href="#禁用-root-ssh-密码登陆">#</a></h2>
<p>先不提 root 登录本身就是危险的行为，root 账户的用户名固定为”root”，如果允许其通过密码登录，攻击者只需进行密码穷举即可尝试攻破系统。之前我们已经创建了非 root 账户，在这里我们只需要禁用非 root 账户的 SSH 登录即可。</p>
<p>执行以下命令编辑 SSH 配置文件：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vim /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><p>找到 PermitRootLogin，把它的值改成 no。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span>PermitRootLogin <span style="color:#fff;font-weight:bold">no</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>之后重启 SSH 服务生效：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart ssh
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="修改ssh端口">修改ssh端口<a hidden class="anchor" aria-hidden="true" href="#修改ssh端口">#</a></h2>
<p>修改 SSH 端口通常有以下几个主要原因：</p>
<ol>
<li><strong>增强安全性</strong>：SSH 服务默认使用的 22 端口是攻击者经常扫描和尝试攻击的目标。通过将端口修改为一个不常见的数值，可以减少自动攻击和暴力破解的风险，因为攻击者通常会首先针对常见的默认端口进行攻击。</li>
</ol>
<p>例如，如果攻击者使用自动化工具扫描大量服务器，这些工具可能主要集中在 22 端口。而修改了端口后，就降低了被这类工具轻易发现和攻击的可能性。</p>
<ol>
<li><strong>减少误连接和非法访问尝试</strong>：一些网络环境中可能存在大量的随机连接请求或非法访问尝试，针对默认的 22 端口。更改端口可以减少这类无意义的连接请求。</li>
</ol>
<p>假设您的服务器处于一个公共网络环境中，经常会收到大量的随机连接尝试，其中很多是针对常见端口的。修改 SSH 端口可以减少这类不必要的干扰。</p>
<p><strong>将默认的 22 端口修改为 54321</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sed -i <span style="color:#0ff;font-weight:bold">&#39;s/^#\?Port 22.*/Port 54321/g&#39;</span> /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>重启 sshd 服务</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart sshd
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="密钥登录">密钥登录<a hidden class="anchor" aria-hidden="true" href="#密钥登录">#</a></h2>
<p>注意：一键生成和手动生成，两种方式二选一！</p>
<h3 id="一键生成密钥"><strong>一键生成密钥</strong><a hidden class="anchor" aria-hidden="true" href="#一键生成密钥">#</a></h3>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget -O key.sh https://raw.githubusercontent.com/yuju520/Script/main/key.sh &amp;&amp; chmod +x key.sh &amp;&amp; clear &amp;&amp; ./key.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>注意：请牢记你生成的密钥，否则会有无法连接 SSH 的后果。！！！</strong></p>
<h3 id="手动生成">手动生成<a hidden class="anchor" aria-hidden="true" href="#手动生成">#</a></h3>
<p>这里有个注意点！如果你想禁用root密码登录，并用普通用户 {your-username} ssh登录服务器，这里SSH登录配置部分一定要用普通用户{your-username}配置，不然配置出来的文件权限和拥有者不对，ssh不能正确读取公钥！</p>
<p>先在windows端生成ssh 公私钥对</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ssh-keygen -t rsa -f ~/.ssh/id_rsa_xxxx
</span></span></code></pre></td></tr></table>
</div>
</div><p>在用户目录下创建<code>authorized_keys</code>文件，并将公钥（pub结尾）的内容粘入<code>authorized_keys</code>文件中</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p ~/.ssh
</span></span><span style="display:flex;"><span>touch ~/.ssh/authorized_keys
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#并将公钥（pub结尾）的内容粘入`authorized_keys`文件中</span>
</span></span><span style="display:flex;"><span>vim ~/.ssh/authorized_keys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod <span style="color:#ff0;font-weight:bold">600</span> ~/.ssh/authorized_keys
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>~</code> 是指在当前用户的主目录下（如果是root，就是在<code>/root/</code>下；如果是{your-username}则在<code>/home/{your-username}/</code>）。
如果配置在root目录下，那用ssh 密钥对登录时就要选择root用户登录！</p>
<p>禁用root身份登录。</p>
<p>找到<code>PermitRootLogin Yes</code>这一项，然后把它后面的设定值改为<code>no</code>即可。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>vim /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PermitRootLogin no
</span></span><span style="display:flex;"><span><span style="color:#007f7f">#开启ssh密钥对登录</span>
</span></span><span style="display:flex;"><span>PubkeyAuthentication yes  
</span></span></code></pre></td></tr></table>
</div>
</div><p>把 <code>PasswordAuthentication</code> 设置成 no，禁止密码登录，更安全：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PasswordAuthentication no
</span></span></code></pre></td></tr></table>
</div>
</div><p>SSH端口号改为其他数字，注意了，改成其他端口后，记得<strong>防火墙设置也要更新</strong>。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Port {SSH端口号，最好在10000以上}
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后重启 SSH Server 生效：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart sshd.service
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="安装-fail2ban">安装 fail2ban<a hidden class="anchor" aria-hidden="true" href="#安装-fail2ban">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt install fail2ban
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>配置 fail2ban</strong></p>
<p>fail2ban 的配置文件通常位于 <code>/etc/fail2ban/</code> 目录下，fail2ban 的.conf 配置文件都是可以被.local 覆盖，所以配置方式建议是添加.local 文件，不修改原来的配置文件。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nano /etc/fail2ban/jail.local
</span></span></code></pre></td></tr></table>
</div>
</div><p>配置文件如下：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>[DEFAULT]
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 忽略的IP列表,不受设置限制（白名单）</span>
</span></span><span style="display:flex;"><span>ignoreip = 127.0.0.1
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 允许ipv6</span>
</span></span><span style="display:flex;"><span>allowipv6 = auto
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 日志修改检测机制（gamin、polling和auto这三种）</span>
</span></span><span style="display:flex;"><span>backend = systemd
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 针对各服务的检查配置，如设置bantime、findtime、maxretry和全局冲突，服务优先级大于全局设置</span>
</span></span><span style="display:flex;"><span>[sshd]
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 是否激活此项（true/false）</span>
</span></span><span style="display:flex;"><span>enabled = <span style="color:#fff;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 过滤规则filter的名字，对应filter.d目录下的sshd.conf</span>
</span></span><span style="display:flex;"><span>filter = sshd
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># ssh端口</span>
</span></span><span style="display:flex;"><span>port = ssh
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 动作的相关参数</span>
</span></span><span style="display:flex;"><span>action = iptables[name=SSH, port=ssh, protocol=tcp]
</span></span><span style="display:flex;"><span>action = %(action_)s[port=<span style="color:#0ff;font-weight:bold">&#34;%(port)s&#34;</span>, protocol=<span style="color:#0ff;font-weight:bold">&#34;%(protocol)s&#34;</span>, logpath=<span style="color:#0ff;font-weight:bold">&#34;%(logpath)s&#34;</span>, chain=<span style="color:#0ff;font-weight:bold">&#34;%(chain)s&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 检测的系统的登陆日志文件</span>
</span></span><span style="display:flex;"><span>logpath = /var/log/secure
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 封禁时间，单位：秒</span>
</span></span><span style="display:flex;"><span>bantime = <span style="color:#ff0;font-weight:bold">86400</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 这个时间段内超过规定次数会被ban掉</span>
</span></span><span style="display:flex;"><span>findtime = <span style="color:#ff0;font-weight:bold">86400</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 最大尝试次数</span>
</span></span><span style="display:flex;"><span>maxretry = <span style="color:#ff0;font-weight:bold">3</span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># 禁用方式</span>
</span></span><span style="display:flex;"><span>banaction = iptables-multiport
</span></span><span style="display:flex;"><span><span style="color:#007f7f"># SSH 登陆日志位置</span>
</span></span><span style="display:flex;"><span>logpath = /var/log/auth.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ctrl+S 保存并退出</p>
<p><strong>设置开机自动启动 fail2ban</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl <span style="color:#fff;font-weight:bold">enable</span> fail2ban
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>重新启动 fail2ban</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart fail2ban
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>查看 fail2ban 的状态</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl status fail2ban
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>查看所有可用 jail 的状态</strong></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>fail2ban-client status
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="xshell使用密钥登录服务器">xShell使用密钥登录服务器<a hidden class="anchor" aria-hidden="true" href="#xshell使用密钥登录服务器">#</a></h2>
<p>新建会话属性的<strong>连接</strong> 配置中输入会话名称和您的云服务器IP地址</p>
<p>点击<strong>连接</strong>中的用户身份验证，方法选择<strong>Public Key</strong>，然后在用户密钥处单击<strong>浏览</strong>。</p>
<p>在弹出的用户密钥界面，单击<strong>导入</strong>。</p>
<p>选择您保存到本地系统的密钥对文件，然后单击 <strong>打开</strong>，点击确定。</p>
<p>此时可以看到用户身份验证界面，用户密钥已经是刚才创建的用户密钥，单击<strong>确定</strong>，保存连接会话。密码不用填写。</p>
<p>在会话界面，选择刚才创建的会话，然后点击<strong>连接</strong>。</p>
<p>输入用户名<strong>root</strong>，即可通过密钥方式登录您的Linux服务器。</p>
<h1 id="安装-dockerdocker-compose-以及修改配置"><strong>安装 Docker、Docker-compose</strong> 以及修改配置<a hidden class="anchor" aria-hidden="true" href="#安装-dockerdocker-compose-以及修改配置">#</a></h1>
<h2 id="非大陆服务器">非大陆服务器<a hidden class="anchor" aria-hidden="true" href="#非大陆服务器">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span>wget -qO- <span style="color:#fff;font-weight:bold">get</span>.docker.com | bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>或</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>curl -fsSL https://<span style="color:#fff;font-weight:bold">get</span>.docker.com -o <span style="color:#fff;font-weight:bold">get</span>-docker.sh &amp;&amp; sh <span style="color:#fff;font-weight:bold">get</span>-docker.sh
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="大陆服务器-docker-安装">大陆服务器 Docker 安装<a hidden class="anchor" aria-hidden="true" href="#大陆服务器-docker-安装">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl https://install.1panel.live/docker-install -o docker-install &amp;&amp; sudo bash ./docker-install &amp;&amp; rm -f ./docker-install
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看-docker-版本">查看 Docker 版本<a hidden class="anchor" aria-hidden="true" href="#查看-docker-版本">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker -v
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="开机自动启动">开机自动启动<a hidden class="anchor" aria-hidden="true" href="#开机自动启动">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl <span style="color:#fff;font-weight:bold">enable</span> docker
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="卸载-docker">卸载 Docker<a hidden class="anchor" aria-hidden="true" href="#卸载-docker">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt-get purge docker-ce docker-ce-cli containerd.io
</span></span><span style="display:flex;"><span>sudo apt-get remove docker docker-engine
</span></span><span style="display:flex;"><span>sudo rm -rf /var/lib/docker
</span></span><span style="display:flex;"><span>sudo rm -rf /var/lib/containerd
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="docker-compose-安装">Docker-compose 安装<a hidden class="anchor" aria-hidden="true" href="#docker-compose-安装">#</a></h2>
<p>经佬友反馈，Docker 从 18.06.0-ce 版本就开始自带 Docker Compose 工具，因此，我们只需要检验 Docker Compose 的版本。</p>
<h2 id="查看-docker-compose-版本">查看 Docker Compose 版本<a hidden class="anchor" aria-hidden="true" href="#查看-docker-compose-版本">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker compose version
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="检测工具">检测工具<a hidden class="anchor" aria-hidden="true" href="#检测工具">#</a></h1>
<h2 id="ip-质量">IP 质量<a hidden class="anchor" aria-hidden="true" href="#ip-质量">#</a></h2>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash &lt;(curl -Ls IP.Check.Place)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="性能测试">性能测试<a hidden class="anchor" aria-hidden="true" href="#性能测试">#</a></h2>
<p>VPS融合怪服务器测评脚本(VPS Fusion Monster Server Test Script)</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -L https://github.com/spiritLHLS/ecs/raw/main/ecs.sh -o ecs.sh &amp;&amp; chmod +x ecs.sh &amp;&amp; bash ecs.sh
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="路由追踪">路由追踪<a hidden class="anchor" aria-hidden="true" href="#路由追踪">#</a></h2>
<p>一款追求轻量化的开源可视化路由跟踪工具，看ASN号以及对应的归属非常方便。</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl nxtrace.org/nt |bash
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="其他-ip-检测工具httpsdigvpscomtoolsother-tools其他-ip-检测工具"><a href="https://digvps.com/tools/other-tools#%E5%85%B6%E4%BB%96-ip-%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7">其他 IP 检测工具</a><a hidden class="anchor" aria-hidden="true" href="#其他-ip-检测工具httpsdigvpscomtoolsother-tools其他-ip-检测工具">#</a></h2>
<ul>
<li><a href="https://dnschecker.org/">DNSCHECKER</a></li>
<li><a href="https://ipapi.is/">ipapi.is</a></li>
<li><a href="https://ip-api.com/">ip-api</a></li>
<li><a href="https://ipdata.co/">ipdata</a></li>
<li><a href="https://ipinfo.io/">ipinfo.io</a></li>
<li><a href="https://ipinsight.io/">IPinsight</a></li>
<li><a href="https://www.ipip.net/">IPIP</a></li>
<li><a href="https://ping.pe/">ping.pe</a></li>
<li><a href="https://scamalytics.com/">SCAMALYTICS</a></li>
<li><a href="https://browserleaks.com/webrtc">WebRTC Leak Test</a></li>
<li><a href="https://boce.aliyun.com/detect/ping">阿里云网站运维检测平台</a></li>
<li><a href="https://www.browserscan.net/">BrowserScan</a></li>
<li><a href="https://www.abuseipdb.com/check/">ip滥用报告</a></li>
<li><a href="https://iknowwhatyoudownload.com/">ip下过bt没</a></li>
<li><a href="https://site.ip138.com/">ip以前有哪些网站</a></li>
<li><a href="https://web.archive.org/">查询网站长啥样</a> <a href="https://archive.md/">查询网站长啥样</a></li>
<li><a href="https://viewdns.info/iphistory/?domain">查询网站以前解析的ip</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://009965.xyz/tags/linux/">Linux</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://009965.xyz/">Wjy&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>